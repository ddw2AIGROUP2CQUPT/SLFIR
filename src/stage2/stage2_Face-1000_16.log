nohup: ignoring input
Namespace(attn_model_dir='../stage1/Face-1000_16_attn_best.pth', backbone_model_dir='../stage1/Face-1000_16_backbone_best.pth', batchsize=32, dataset_name='Face-1000', device=device(type='cuda', index=2), epoches=300, feature_num=16, lr=0.0005, nThreads=4, print_freq_iter=50, root_dir='../')
epoch: 0, iter: 1, loss: 9.33543586730957, time cost4.947636127471924
epoch: 0, iter: 2, loss: 8.95765209197998, time cost4.218634843826294
epoch: 0, iter: 3, loss: 7.979739189147949, time cost4.295260906219482
epoch: 0, iter: 4, loss: 7.326802730560303, time cost4.07638692855835
epoch: 0, iter: 5, loss: 6.685507774353027, time cost4.091005086898804
epoch: 0, iter: 6, loss: 5.675130367279053, time cost4.248416423797607
epoch: 0, iter: 7, loss: 4.683149337768555, time cost4.136324882507324
epoch: 0, iter: 8, loss: 4.3071699142456055, time cost4.22432279586792
epoch: 0, iter: 9, loss: 4.4856462478637695, time cost4.388340950012207
epoch: 0, iter: 10, loss: 4.465336799621582, time cost4.3996148109436035
epoch: 0, iter: 11, loss: 3.5614426136016846, time cost3.9954421520233154
epoch: 0, iter: 12, loss: 3.2177562713623047, time cost4.090512990951538
epoch: 0, iter: 13, loss: 3.4316418170928955, time cost4.280352354049683
epoch: 0, iter: 14, loss: 3.669161319732666, time cost4.359408855438232
epoch: 0, iter: 15, loss: 3.6414883136749268, time cost4.154119968414307
epoch: 0, iter: 16, loss: 3.2921488285064697, time cost4.259851932525635
epoch: 0, iter: 17, loss: 2.552978038787842, time cost4.1643407344818115
epoch: 0, iter: 18, loss: 2.962862730026245, time cost4.142842054367065
epoch: 0, iter: 19, loss: 3.0941860675811768, time cost4.214240312576294
epoch: 0, iter: 20, loss: 3.380120277404785, time cost4.184851169586182
epoch: 0, iter: 21, loss: 4.421931266784668, time cost4.328955173492432
epoch: 0, iter: 22, loss: 3.6570491790771484, time cost4.187474727630615
epoch: 0, iter: 23, loss: 2.974663734436035, time cost4.016080856323242
epoch: 0, iter: 24, loss: 2.7698521614074707, time cost4.060364723205566
epoch: 0, iter: 25, loss: 2.2031986713409424, time cost4.0023369789123535
epoch: 0, iter: 26, loss: 2.771974802017212, time cost4.186095476150513
epoch: 0, iter: 27, loss: 3.1309256553649902, time cost4.218195915222168
epoch: 0, iter: 28, loss: 1.5574675798416138, time cost4.067090749740601
epoch: 0, iter: 29, loss: 3.0535106658935547, time cost3.9676928520202637
epoch: 0, iter: 30, loss: 2.5833370685577393, time cost4.223473072052002
epoch: 0, iter: 31, loss: 3.4075934886932373, time cost4.090064287185669
epoch: 0, iter: 32, loss: 3.640578031539917, time cost3.8456735610961914
epoch: 0, iter: 33, loss: 2.7661964893341064, time cost3.9648375511169434
epoch: 0, iter: 34, loss: 2.0976481437683105, time cost2.8242640495300293
epoch: 1, iter: 35, loss: 2.0653743743896484, time cost4.270787715911865
epoch: 1, iter: 36, loss: 1.8927226066589355, time cost4.113166093826294
epoch: 1, iter: 37, loss: 3.0412824153900146, time cost4.114082098007202
epoch: 1, iter: 38, loss: 2.2006824016571045, time cost4.132318019866943
epoch: 1, iter: 39, loss: 3.444683074951172, time cost4.1137375831604
epoch: 1, iter: 40, loss: 2.14835786819458, time cost4.146376848220825
epoch: 1, iter: 41, loss: 2.1322498321533203, time cost4.223315477371216
epoch: 1, iter: 42, loss: 1.394370675086975, time cost4.297871351242065
epoch: 1, iter: 43, loss: 2.6132147312164307, time cost4.346108913421631
epoch: 1, iter: 44, loss: 2.7859954833984375, time cost4.353278875350952
epoch: 1, iter: 45, loss: 1.9873533248901367, time cost4.298722982406616
epoch: 1, iter: 46, loss: 2.248547077178955, time cost4.3928141593933105
epoch: 1, iter: 47, loss: 2.4619691371917725, time cost4.2754011154174805
epoch: 1, iter: 48, loss: 1.4393953084945679, time cost4.10176944732666
epoch: 1, iter: 49, loss: 2.361468553543091, time cost4.0375816822052
epoch: 1, iter: 50, loss: 1.9155269861221313, time cost4.113599061965942
epoch: 1, iter: 51, loss: 1.7864810228347778, time cost4.2547290325164795
epoch: 1, iter: 52, loss: 1.9624751806259155, time cost4.086781740188599
epoch: 1, iter: 53, loss: 2.49472713470459, time cost4.423814296722412
epoch: 1, iter: 54, loss: 2.105721950531006, time cost4.199581861495972
epoch: 1, iter: 55, loss: 2.120342493057251, time cost4.136209964752197
epoch: 1, iter: 56, loss: 2.215988874435425, time cost4.31739354133606
epoch: 1, iter: 57, loss: 2.0680744647979736, time cost4.049680948257446
epoch: 1, iter: 58, loss: 1.5947368144989014, time cost4.19753098487854
epoch: 1, iter: 59, loss: 2.2237508296966553, time cost4.338197708129883
epoch: 1, iter: 60, loss: 1.5929949283599854, time cost4.19671630859375
epoch: 1, iter: 61, loss: 1.7812745571136475, time cost4.265578269958496
epoch: 1, iter: 62, loss: 2.4013352394104004, time cost4.261011362075806
epoch: 1, iter: 63, loss: 1.7499961853027344, time cost4.132841348648071
epoch: 1, iter: 64, loss: 2.4025256633758545, time cost4.202907085418701
epoch: 1, iter: 65, loss: 2.0500190258026123, time cost4.111473560333252
epoch: 1, iter: 66, loss: 2.0107662677764893, time cost4.319890737533569
epoch: 1, iter: 67, loss: 2.0498645305633545, time cost3.967975378036499
epoch: 1, iter: 68, loss: 1.1506344079971313, time cost2.8369147777557373
epoch: 2, iter: 69, loss: 2.5804970264434814, time cost4.066041946411133
epoch: 2, iter: 70, loss: 1.8570082187652588, time cost4.32149600982666
epoch: 2, iter: 71, loss: 1.903923511505127, time cost4.157797336578369
epoch: 2, iter: 72, loss: 2.1122543811798096, time cost4.08575963973999
epoch: 2, iter: 73, loss: 2.344468355178833, time cost4.258651494979858
epoch: 2, iter: 74, loss: 1.3767552375793457, time cost4.250010251998901
epoch: 2, iter: 75, loss: 1.6846575736999512, time cost3.9620742797851562
epoch: 2, iter: 76, loss: 1.3304539918899536, time cost4.075842618942261
epoch: 2, iter: 77, loss: 1.6176464557647705, time cost4.27939772605896
epoch: 2, iter: 78, loss: 1.7160123586654663, time cost4.331322193145752
epoch: 2, iter: 79, loss: 2.7414913177490234, time cost4.021263122558594
epoch: 2, iter: 80, loss: 1.629565715789795, time cost4.042987585067749
epoch: 2, iter: 81, loss: 2.4533514976501465, time cost4.061339378356934
epoch: 2, iter: 82, loss: 2.223597288131714, time cost4.207705974578857
epoch: 2, iter: 83, loss: 1.4376978874206543, time cost3.200425148010254
epoch: 2, iter: 84, loss: 2.3804755210876465, time cost4.2865118980407715
epoch: 2, iter: 85, loss: 1.4726226329803467, time cost4.330657243728638
epoch: 2, iter: 86, loss: 2.918368339538574, time cost4.25423789024353
epoch: 2, iter: 87, loss: 1.950143575668335, time cost4.1574132442474365
epoch: 2, iter: 88, loss: 2.2561137676239014, time cost4.149383306503296
epoch: 2, iter: 89, loss: 2.6780741214752197, time cost4.1554954051971436
epoch: 2, iter: 90, loss: 2.0174288749694824, time cost4.2943174839019775
epoch: 2, iter: 91, loss: 1.8105415105819702, time cost4.394938945770264
epoch: 2, iter: 92, loss: 2.1946258544921875, time cost4.523460388183594
epoch: 2, iter: 93, loss: 2.0862538814544678, time cost4.125838279724121
epoch: 2, iter: 94, loss: 1.5541034936904907, time cost4.203925132751465
epoch: 2, iter: 95, loss: 2.1574645042419434, time cost4.296191930770874
epoch: 2, iter: 96, loss: 2.4798171520233154, time cost4.335647106170654
epoch: 2, iter: 97, loss: 1.6356050968170166, time cost4.274676561355591
epoch: 2, iter: 98, loss: 1.788961410522461, time cost4.512673377990723
epoch: 2, iter: 99, loss: 1.1762906312942505, time cost4.54520583152771
epoch: 2, iter: 100, loss: 1.9046220779418945, time cost4.290280342102051
epoch: 2, iter: 101, loss: 1.309531331062317, time cost4.158816814422607
epoch: 2, iter: 102, loss: 1.258476972579956, time cost3.290632963180542
epoch: 3, iter: 103, loss: 1.6795897483825684, time cost4.621741533279419
epoch: 3, iter: 104, loss: 2.3916046619415283, time cost4.313113451004028
epoch: 3, iter: 105, loss: 1.3078871965408325, time cost4.229813814163208
epoch: 3, iter: 106, loss: 1.8942347764968872, time cost4.334257125854492
epoch: 3, iter: 107, loss: 1.897679328918457, time cost4.337671995162964
epoch: 3, iter: 108, loss: 1.5497080087661743, time cost4.458924293518066
epoch: 3, iter: 109, loss: 2.053469657897949, time cost4.403246641159058
epoch: 3, iter: 110, loss: 2.9321935176849365, time cost4.293344497680664
epoch: 3, iter: 111, loss: 2.536173105239868, time cost4.344313859939575
epoch: 3, iter: 112, loss: 1.7949103116989136, time cost4.287854909896851
epoch: 3, iter: 113, loss: 2.0728065967559814, time cost4.397990465164185
epoch: 3, iter: 114, loss: 2.746382474899292, time cost4.171943664550781
epoch: 3, iter: 115, loss: 1.6499934196472168, time cost4.41028618812561
epoch: 3, iter: 116, loss: 2.3882558345794678, time cost4.135274648666382
epoch: 3, iter: 117, loss: 2.3763184547424316, time cost4.233174800872803
epoch: 3, iter: 118, loss: 2.157952070236206, time cost4.409827947616577
epoch: 3, iter: 119, loss: 1.8000231981277466, time cost4.163579940795898
epoch: 3, iter: 120, loss: 2.1072793006896973, time cost4.3431689739227295
epoch: 3, iter: 121, loss: 1.7163164615631104, time cost3.75569224357605
epoch: 3, iter: 122, loss: 2.0210680961608887, time cost3.7553505897521973
epoch: 3, iter: 123, loss: 1.856111764907837, time cost4.017829656600952
epoch: 3, iter: 124, loss: 1.595701813697815, time cost4.188727378845215
epoch: 3, iter: 125, loss: 2.0954818725585938, time cost4.132398843765259
epoch: 3, iter: 126, loss: 2.143887519836426, time cost4.014270305633545
epoch: 3, iter: 127, loss: 2.158850908279419, time cost3.9676740169525146
epoch: 3, iter: 128, loss: 2.4101569652557373, time cost4.033300876617432
epoch: 3, iter: 129, loss: 2.5458273887634277, time cost4.081120491027832
epoch: 3, iter: 130, loss: 2.056879758834839, time cost3.9004337787628174
epoch: 3, iter: 131, loss: 1.1641261577606201, time cost4.0999674797058105
epoch: 3, iter: 132, loss: 1.7871711254119873, time cost4.18970799446106
epoch: 3, iter: 133, loss: 2.0882394313812256, time cost3.885653495788574
epoch: 3, iter: 134, loss: 2.000894069671631, time cost4.064364910125732
epoch: 3, iter: 135, loss: 1.6263154745101929, time cost4.134241819381714
epoch: 3, iter: 136, loss: 1.3546890020370483, time cost2.8098304271698
epoch: 4, iter: 137, loss: 1.9510719776153564, time cost4.109331369400024
epoch: 4, iter: 138, loss: 1.6516296863555908, time cost4.024104595184326
epoch: 4, iter: 139, loss: 1.5679445266723633, time cost3.9200820922851562
epoch: 4, iter: 140, loss: 1.9131317138671875, time cost4.1690514087677
epoch: 4, iter: 141, loss: 1.9900791645050049, time cost4.010364294052124
epoch: 4, iter: 142, loss: 2.75920033454895, time cost3.9999008178710938
epoch: 4, iter: 143, loss: 1.9814168214797974, time cost3.996765613555908
epoch: 4, iter: 144, loss: 2.0053153038024902, time cost4.098467588424683
epoch: 4, iter: 145, loss: 2.4779069423675537, time cost4.223286867141724
epoch: 4, iter: 146, loss: 1.715578317642212, time cost4.090798616409302
epoch: 4, iter: 147, loss: 1.824371099472046, time cost3.9309637546539307
epoch: 4, iter: 148, loss: 1.8819290399551392, time cost4.121140956878662
epoch: 4, iter: 149, loss: 2.168536424636841, time cost3.9958653450012207
epoch: 4, iter: 150, loss: 2.0025081634521484, time cost4.070546388626099
epoch: 4, iter: 151, loss: 1.6334675550460815, time cost3.93769907951355
epoch: 4, iter: 152, loss: 2.6754682064056396, time cost4.1599555015563965
epoch: 4, iter: 153, loss: 1.2772337198257446, time cost4.067253828048706
epoch: 4, iter: 154, loss: 1.6908057928085327, time cost3.976219892501831
epoch: 4, iter: 155, loss: 2.3323123455047607, time cost3.9754767417907715
epoch: 4, iter: 156, loss: 2.0170247554779053, time cost4.264210939407349
epoch: 4, iter: 157, loss: 1.4913851022720337, time cost4.048784971237183
epoch: 4, iter: 158, loss: 1.4639548063278198, time cost4.068780183792114
epoch: 4, iter: 159, loss: 1.0405737161636353, time cost4.142334938049316
epoch: 4, iter: 160, loss: 1.9768273830413818, time cost4.034120559692383
epoch: 4, iter: 161, loss: 2.4193100929260254, time cost4.09355092048645
epoch: 4, iter: 162, loss: 1.570360779762268, time cost4.092263698577881
epoch: 4, iter: 163, loss: 1.5103381872177124, time cost3.981276273727417
epoch: 4, iter: 164, loss: 1.120741844177246, time cost3.9844956398010254
epoch: 4, iter: 165, loss: 2.3750534057617188, time cost4.025972604751587
epoch: 4, iter: 166, loss: 1.841096043586731, time cost3.8312559127807617
epoch: 4, iter: 167, loss: 2.109428882598877, time cost3.829671859741211
epoch: 4, iter: 168, loss: 1.7044214010238647, time cost3.890550374984741
epoch: 4, iter: 169, loss: 1.9468826055526733, time cost3.9597651958465576
epoch: 4, iter: 170, loss: 1.6893121004104614, time cost2.9004971981048584
epoch: 5, iter: 171, loss: 1.8730382919311523, time cost4.1302173137664795
epoch: 5, iter: 172, loss: 2.033433198928833, time cost4.2775256633758545
epoch: 5, iter: 173, loss: 1.7068791389465332, time cost3.9513707160949707
epoch: 5, iter: 174, loss: 1.9542205333709717, time cost4.068692445755005
epoch: 5, iter: 175, loss: 1.8957798480987549, time cost4.026848793029785
epoch: 5, iter: 176, loss: 1.2160738706588745, time cost4.036643028259277
epoch: 5, iter: 177, loss: 2.195937395095825, time cost4.040551662445068
epoch: 5, iter: 178, loss: 1.3245463371276855, time cost4.17590594291687
epoch: 5, iter: 179, loss: 1.8954321146011353, time cost4.141968727111816
epoch: 5, iter: 180, loss: 1.687332034111023, time cost4.10206937789917
epoch: 5, iter: 181, loss: 1.3433867692947388, time cost3.8374993801116943
epoch: 5, iter: 182, loss: 2.2984089851379395, time cost3.9833483695983887
epoch: 5, iter: 183, loss: 1.031959891319275, time cost4.110917806625366
epoch: 5, iter: 184, loss: 1.5816909074783325, time cost3.967583656311035
epoch: 5, iter: 185, loss: 2.252889394760132, time cost4.09959864616394
epoch: 5, iter: 186, loss: 1.2995620965957642, time cost4.199300050735474
epoch: 5, iter: 187, loss: 2.018033266067505, time cost4.0731892585754395
epoch: 5, iter: 188, loss: 1.9501924514770508, time cost4.026404857635498
epoch: 5, iter: 189, loss: 1.2550021409988403, time cost4.29650616645813
epoch: 5, iter: 190, loss: 1.9579439163208008, time cost4.071717262268066
epoch: 5, iter: 191, loss: 1.2833999395370483, time cost4.041152000427246
epoch: 5, iter: 192, loss: 1.5512508153915405, time cost4.213789939880371
epoch: 5, iter: 193, loss: 1.904794692993164, time cost4.2470383644104
epoch: 5, iter: 194, loss: 1.3644044399261475, time cost3.9966843128204346
epoch: 5, iter: 195, loss: 2.7371139526367188, time cost3.9852540493011475
epoch: 5, iter: 196, loss: 1.5252771377563477, time cost3.9307100772857666
epoch: 5, iter: 197, loss: 1.5541175603866577, time cost4.058691501617432
epoch: 5, iter: 198, loss: 1.9773463010787964, time cost4.056089401245117
epoch: 5, iter: 199, loss: 2.1757798194885254, time cost4.1043312549591064
epoch: 5, iter: 200, loss: 1.9587525129318237, time cost4.235972166061401
epoch: 5, iter: 201, loss: 1.4058529138565063, time cost3.9221479892730713
epoch: 5, iter: 202, loss: 2.0101070404052734, time cost4.077538967132568
epoch: 5, iter: 203, loss: 2.270442008972168, time cost4.0787060260772705
epoch: 5, iter: 204, loss: 1.3206709623336792, time cost2.883164644241333
epoch: 6, iter: 205, loss: 2.2765491008758545, time cost4.180115461349487
epoch: 6, iter: 206, loss: 1.5132339000701904, time cost4.230309724807739
epoch: 6, iter: 207, loss: 1.5937964916229248, time cost3.9593405723571777
epoch: 6, iter: 208, loss: 1.6504427194595337, time cost4.089874505996704
epoch: 6, iter: 209, loss: 2.0472826957702637, time cost4.048946142196655
epoch: 6, iter: 210, loss: 2.2135438919067383, time cost4.2246317863464355
epoch: 6, iter: 211, loss: 1.0214266777038574, time cost3.9775214195251465
epoch: 6, iter: 212, loss: 1.8413810729980469, time cost4.045671463012695
epoch: 6, iter: 213, loss: 2.3167343139648438, time cost4.085614442825317
epoch: 6, iter: 214, loss: 1.3271585702896118, time cost4.078897714614868
epoch: 6, iter: 215, loss: 3.037123680114746, time cost4.160357236862183
epoch: 6, iter: 216, loss: 1.6863248348236084, time cost4.200498104095459
epoch: 6, iter: 217, loss: 1.6789076328277588, time cost4.153166770935059
epoch: 6, iter: 218, loss: 1.5297662019729614, time cost4.005485773086548
epoch: 6, iter: 219, loss: 1.6666430234909058, time cost3.989222526550293
epoch: 6, iter: 220, loss: 1.250418782234192, time cost4.053760528564453
epoch: 6, iter: 221, loss: 1.0475047826766968, time cost4.001062393188477
epoch: 6, iter: 222, loss: 1.2008122205734253, time cost3.99360728263855
epoch: 6, iter: 223, loss: 1.4037857055664062, time cost4.022398233413696
epoch: 6, iter: 224, loss: 1.8481441736221313, time cost4.08045220375061
epoch: 6, iter: 225, loss: 1.7309157848358154, time cost4.147039175033569
epoch: 6, iter: 226, loss: 1.586732268333435, time cost3.945629119873047
epoch: 6, iter: 227, loss: 1.199334979057312, time cost4.03148341178894
epoch: 6, iter: 228, loss: 1.6044292449951172, time cost4.016818284988403
epoch: 6, iter: 229, loss: 1.7177603244781494, time cost4.064038991928101
epoch: 6, iter: 230, loss: 1.2398277521133423, time cost4.107872009277344
epoch: 6, iter: 231, loss: 1.3254103660583496, time cost3.974076509475708
epoch: 6, iter: 232, loss: 1.3526476621627808, time cost3.9200339317321777
epoch: 6, iter: 233, loss: 1.130069375038147, time cost4.053057670593262
epoch: 6, iter: 234, loss: 1.7225905656814575, time cost3.94990873336792
epoch: 6, iter: 235, loss: 2.180894374847412, time cost4.076348066329956
epoch: 6, iter: 236, loss: 1.238124132156372, time cost4.171350717544556
epoch: 6, iter: 237, loss: 1.391103982925415, time cost4.0255420207977295
epoch: 6, iter: 238, loss: 1.2600879669189453, time cost2.9688162803649902
epoch: 7, iter: 239, loss: 1.1630109548568726, time cost4.466248512268066
epoch: 7, iter: 240, loss: 1.6427947282791138, time cost4.246261358261108
epoch: 7, iter: 241, loss: 1.3620474338531494, time cost4.058687686920166
epoch: 7, iter: 242, loss: 1.8233948945999146, time cost4.145172834396362
epoch: 7, iter: 243, loss: 2.126312494277954, time cost4.101573467254639
epoch: 7, iter: 244, loss: 1.9043923616409302, time cost4.082279682159424
epoch: 7, iter: 245, loss: 1.3847919702529907, time cost4.083542823791504
epoch: 7, iter: 246, loss: 1.8257267475128174, time cost4.044779539108276
epoch: 7, iter: 247, loss: 1.8739666938781738, time cost4.116252660751343
epoch: 7, iter: 248, loss: 1.6366028785705566, time cost4.158905744552612
epoch: 7, iter: 249, loss: 1.4270840883255005, time cost4.186421871185303
epoch: 7, iter: 250, loss: 1.1892122030258179, time cost4.077498912811279
epoch: 7, iter: 251, loss: 1.3354380130767822, time cost4.018772840499878
epoch: 7, iter: 252, loss: 1.4629061222076416, time cost4.136574983596802
epoch: 7, iter: 253, loss: 1.6270122528076172, time cost4.119325876235962
epoch: 7, iter: 254, loss: 1.72239351272583, time cost4.107297897338867
epoch: 7, iter: 255, loss: 1.8071026802062988, time cost4.044273138046265
epoch: 7, iter: 256, loss: 1.5791854858398438, time cost4.061017274856567
epoch: 7, iter: 257, loss: 1.3166632652282715, time cost3.922245979309082
epoch: 7, iter: 258, loss: 0.8366677165031433, time cost4.161791086196899
epoch: 7, iter: 259, loss: 0.9288215041160583, time cost4.122430324554443
epoch: 7, iter: 260, loss: 1.161949872970581, time cost4.221376657485962
epoch: 7, iter: 261, loss: 2.277597427368164, time cost4.20046329498291
epoch: 7, iter: 262, loss: 1.8003276586532593, time cost4.035151243209839
epoch: 7, iter: 263, loss: 1.801023244857788, time cost4.128865718841553
epoch: 7, iter: 264, loss: 1.7113475799560547, time cost3.965569257736206
epoch: 7, iter: 265, loss: 1.42312490940094, time cost4.095771074295044
epoch: 7, iter: 266, loss: 1.4308222532272339, time cost3.92314076423645
epoch: 7, iter: 267, loss: 1.3588835000991821, time cost3.9369826316833496
epoch: 7, iter: 268, loss: 2.0276315212249756, time cost3.865724563598633
epoch: 7, iter: 269, loss: 1.5988121032714844, time cost4.013497352600098
epoch: 7, iter: 270, loss: 1.6769546270370483, time cost3.9681334495544434
epoch: 7, iter: 271, loss: 1.3868883848190308, time cost4.075868844985962
epoch: 7, iter: 272, loss: 0.7367492318153381, time cost2.797079563140869
epoch: 8, iter: 273, loss: 0.7739337682723999, time cost4.224725246429443
epoch: 8, iter: 274, loss: 2.362121105194092, time cost4.125520944595337
epoch: 8, iter: 275, loss: 0.8183679580688477, time cost4.005274057388306
epoch: 8, iter: 276, loss: 1.4023205041885376, time cost4.024832248687744
epoch: 8, iter: 277, loss: 1.5164088010787964, time cost4.069288492202759
epoch: 8, iter: 278, loss: 0.9218425154685974, time cost4.0616466999053955
epoch: 8, iter: 279, loss: 1.555259108543396, time cost4.01819920539856
epoch: 8, iter: 280, loss: 1.2440595626831055, time cost3.964176893234253
epoch: 8, iter: 281, loss: 1.479573369026184, time cost4.021845579147339
epoch: 8, iter: 282, loss: 2.2415714263916016, time cost4.040579795837402
epoch: 8, iter: 283, loss: 1.3137203454971313, time cost4.13557767868042
epoch: 8, iter: 284, loss: 2.553502321243286, time cost4.109173059463501
epoch: 8, iter: 285, loss: 1.8531463146209717, time cost4.106412649154663
epoch: 8, iter: 286, loss: 1.6098668575286865, time cost3.906877040863037
epoch: 8, iter: 287, loss: 2.307314157485962, time cost4.085444927215576
epoch: 8, iter: 288, loss: 2.2677078247070312, time cost4.1334228515625
epoch: 8, iter: 289, loss: 1.2708293199539185, time cost3.9543404579162598
epoch: 8, iter: 290, loss: 1.1271171569824219, time cost3.9743778705596924
epoch: 8, iter: 291, loss: 1.401981234550476, time cost4.052563428878784
epoch: 8, iter: 292, loss: 1.873445749282837, time cost3.963123321533203
epoch: 8, iter: 293, loss: 1.145274043083191, time cost4.1060380935668945
epoch: 8, iter: 294, loss: 2.5823121070861816, time cost4.022082090377808
epoch: 8, iter: 295, loss: 1.6899491548538208, time cost4.0518879890441895
epoch: 8, iter: 296, loss: 1.4154694080352783, time cost4.02491021156311
epoch: 8, iter: 297, loss: 1.8762667179107666, time cost4.013096570968628
epoch: 8, iter: 298, loss: 1.0724982023239136, time cost4.1347362995147705
epoch: 8, iter: 299, loss: 1.4815293550491333, time cost4.017540693283081
epoch: 8, iter: 300, loss: 1.7790483236312866, time cost3.980795383453369
epoch: 8, iter: 301, loss: 1.5863593816757202, time cost4.001232385635376
epoch: 8, iter: 302, loss: 1.6019059419631958, time cost3.973129987716675
epoch: 8, iter: 303, loss: 1.9327555894851685, time cost4.010997533798218
epoch: 8, iter: 304, loss: 1.6658704280853271, time cost4.035118103027344
epoch: 8, iter: 305, loss: 1.96579110622406, time cost4.239367961883545
epoch: 8, iter: 306, loss: 0.9266383051872253, time cost2.823767900466919
epoch: 9, iter: 307, loss: 1.0574883222579956, time cost4.124443531036377
epoch: 9, iter: 308, loss: 1.373184323310852, time cost4.145537853240967
epoch: 9, iter: 309, loss: 2.3269429206848145, time cost4.1430065631866455
epoch: 9, iter: 310, loss: 1.6540501117706299, time cost4.036623001098633
epoch: 9, iter: 311, loss: 1.504254698753357, time cost4.248326539993286
epoch: 9, iter: 312, loss: 1.9460662603378296, time cost4.11039924621582
epoch: 9, iter: 313, loss: 1.572902798652649, time cost4.086232900619507
epoch: 9, iter: 314, loss: 1.1744811534881592, time cost3.989966869354248
epoch: 9, iter: 315, loss: 2.078467607498169, time cost4.058154582977295
epoch: 9, iter: 316, loss: 1.8044772148132324, time cost4.117460489273071
epoch: 9, iter: 317, loss: 2.153262138366699, time cost4.082098960876465
epoch: 9, iter: 318, loss: 1.8423513174057007, time cost3.9320356845855713
epoch: 9, iter: 319, loss: 1.600492238998413, time cost3.9056222438812256
epoch: 9, iter: 320, loss: 1.657332420349121, time cost4.013079643249512
epoch: 9, iter: 321, loss: 1.2222273349761963, time cost3.9573514461517334
epoch: 9, iter: 322, loss: 1.8022381067276, time cost4.182262897491455
epoch: 9, iter: 323, loss: 2.1105313301086426, time cost4.262791156768799
epoch: 9, iter: 324, loss: 1.5690025091171265, time cost4.118224620819092
epoch: 9, iter: 325, loss: 1.6485633850097656, time cost3.937770128250122
epoch: 9, iter: 326, loss: 1.8722251653671265, time cost3.9828968048095703
epoch: 9, iter: 327, loss: 1.8723900318145752, time cost3.9399399757385254
epoch: 9, iter: 328, loss: 1.1673187017440796, time cost4.279549837112427
epoch: 9, iter: 329, loss: 1.7034978866577148, time cost4.262501001358032
epoch: 9, iter: 330, loss: 0.8959735035896301, time cost3.980412483215332
epoch: 9, iter: 331, loss: 0.7869138717651367, time cost4.100194215774536
epoch: 9, iter: 332, loss: 1.541958212852478, time cost4.018759489059448
epoch: 9, iter: 333, loss: 1.5413978099822998, time cost3.9806504249572754
epoch: 9, iter: 334, loss: 0.8534044027328491, time cost4.0419511795043945
epoch: 9, iter: 335, loss: 1.4995733499526978, time cost4.030679702758789
epoch: 9, iter: 336, loss: 1.5670779943466187, time cost3.9336838722229004
epoch: 9, iter: 337, loss: 1.864364504814148, time cost4.04332160949707
epoch: 9, iter: 338, loss: 1.642770528793335, time cost4.008274555206299
epoch: 9, iter: 339, loss: 1.3499040603637695, time cost3.989309787750244
epoch: 9, iter: 340, loss: 1.1044526100158691, time cost2.870272397994995
epoch: 10, iter: 341, loss: 2.0141570568084717, time cost4.066524267196655
epoch: 10, iter: 342, loss: 1.2373597621917725, time cost4.099384784698486
epoch: 10, iter: 343, loss: 1.4236302375793457, time cost4.285476207733154
epoch: 10, iter: 344, loss: 1.1809619665145874, time cost3.9648025035858154
epoch: 10, iter: 345, loss: 1.5835750102996826, time cost3.9963552951812744
epoch: 10, iter: 346, loss: 1.2356668710708618, time cost4.069530248641968
epoch: 10, iter: 347, loss: 1.028014898300171, time cost4.202284097671509
epoch: 10, iter: 348, loss: 1.338624358177185, time cost3.9462831020355225
epoch: 10, iter: 349, loss: 1.832234501838684, time cost3.9909651279449463
epoch: 10, iter: 350, loss: 1.8846290111541748, time cost4.090430974960327
epoch: 10, iter: 351, loss: 1.4868570566177368, time cost4.190237045288086
epoch: 10, iter: 352, loss: 1.4192770719528198, time cost4.142945051193237
epoch: 10, iter: 353, loss: 1.6934975385665894, time cost4.046263933181763
epoch: 10, iter: 354, loss: 1.4697966575622559, time cost4.046666383743286
epoch: 10, iter: 355, loss: 1.2933706045150757, time cost4.001757860183716
epoch: 10, iter: 356, loss: 1.4041635990142822, time cost4.128911733627319
epoch: 10, iter: 357, loss: 1.557549238204956, time cost4.179879665374756
epoch: 10, iter: 358, loss: 1.0133533477783203, time cost4.213592052459717
epoch: 10, iter: 359, loss: 1.5621411800384521, time cost4.143953084945679
epoch: 10, iter: 360, loss: 1.2496641874313354, time cost4.069272994995117
epoch: 10, iter: 361, loss: 1.3441041707992554, time cost4.040607213973999
epoch: 10, iter: 362, loss: 1.2072627544403076, time cost3.6195056438446045
epoch: 10, iter: 363, loss: 0.953345537185669, time cost3.6089181900024414
epoch: 10, iter: 364, loss: 1.5227890014648438, time cost4.1332621574401855
epoch: 10, iter: 365, loss: 2.541583299636841, time cost4.042758464813232
epoch: 10, iter: 366, loss: 2.310422658920288, time cost4.202368974685669
epoch: 10, iter: 367, loss: 1.5712367296218872, time cost4.000515937805176
epoch: 10, iter: 368, loss: 1.5572160482406616, time cost4.172208786010742
epoch: 10, iter: 369, loss: 1.7127041816711426, time cost4.029257297515869
epoch: 10, iter: 370, loss: 1.5134613513946533, time cost4.013390779495239
epoch: 10, iter: 371, loss: 1.0591155290603638, time cost3.964089870452881
epoch: 10, iter: 372, loss: 1.1898584365844727, time cost3.9195706844329834
epoch: 10, iter: 373, loss: 1.3596000671386719, time cost4.068463563919067
epoch: 10, iter: 374, loss: 1.3104053735733032, time cost2.850456476211548
epoch: 11, iter: 375, loss: 1.4565978050231934, time cost4.228337049484253
epoch: 11, iter: 376, loss: 1.225056529045105, time cost4.149234294891357
epoch: 11, iter: 377, loss: 1.0198602676391602, time cost4.077828645706177
epoch: 11, iter: 378, loss: 1.312278389930725, time cost4.259484767913818
epoch: 11, iter: 379, loss: 1.4202240705490112, time cost4.144747972488403
epoch: 11, iter: 380, loss: 1.5529805421829224, time cost4.218472957611084
epoch: 11, iter: 381, loss: 1.5364255905151367, time cost4.276639461517334
epoch: 11, iter: 382, loss: 1.5201783180236816, time cost4.158349275588989
epoch: 11, iter: 383, loss: 0.9570019245147705, time cost4.246731281280518
epoch: 11, iter: 384, loss: 1.3722182512283325, time cost4.29117488861084
epoch: 11, iter: 385, loss: 1.2271349430084229, time cost4.046962022781372
epoch: 11, iter: 386, loss: 1.3634480237960815, time cost4.387545585632324
epoch: 11, iter: 387, loss: 1.07220458984375, time cost4.228672504425049
epoch: 11, iter: 388, loss: 1.8839162588119507, time cost4.189481735229492
epoch: 11, iter: 389, loss: 2.233394145965576, time cost4.321386814117432
epoch: 11, iter: 390, loss: 1.0480707883834839, time cost4.348694562911987
epoch: 11, iter: 391, loss: 1.2702070474624634, time cost4.357177495956421
epoch: 11, iter: 392, loss: 1.8190865516662598, time cost4.438321352005005
epoch: 11, iter: 393, loss: 1.3334718942642212, time cost4.3067381381988525
epoch: 11, iter: 394, loss: 2.249270439147949, time cost4.406542539596558
epoch: 11, iter: 395, loss: 1.5097556114196777, time cost4.201798677444458
epoch: 11, iter: 396, loss: 1.8187416791915894, time cost4.256202936172485
epoch: 11, iter: 397, loss: 2.1658027172088623, time cost4.208983898162842
epoch: 11, iter: 398, loss: 1.56167733669281, time cost4.264712810516357
epoch: 11, iter: 399, loss: 1.1666653156280518, time cost4.130316257476807
epoch: 11, iter: 400, loss: 1.5807875394821167, time cost3.3830461502075195
epoch: 11, iter: 401, loss: 1.5311245918273926, time cost3.9776246547698975
epoch: 11, iter: 402, loss: 1.3419406414031982, time cost3.9682345390319824
epoch: 11, iter: 403, loss: 2.2520523071289062, time cost4.0553367137908936
epoch: 11, iter: 404, loss: 1.0476031303405762, time cost4.084908723831177
epoch: 11, iter: 405, loss: 1.5809751749038696, time cost3.938256025314331
epoch: 11, iter: 406, loss: 1.035131573677063, time cost3.9787163734436035
epoch: 11, iter: 407, loss: 1.8238962888717651, time cost4.093743085861206
epoch: 11, iter: 408, loss: 0.8596223592758179, time cost2.8676259517669678
epoch: 12, iter: 409, loss: 1.924850344657898, time cost3.9500858783721924
epoch: 12, iter: 410, loss: 1.7945457696914673, time cost3.99971866607666
epoch: 12, iter: 411, loss: 1.751979112625122, time cost3.9531447887420654
epoch: 12, iter: 412, loss: 1.110371470451355, time cost4.250296115875244
epoch: 12, iter: 413, loss: 1.7120671272277832, time cost4.013678312301636
epoch: 12, iter: 414, loss: 1.5774998664855957, time cost4.036577224731445
epoch: 12, iter: 415, loss: 1.9075828790664673, time cost4.0282142162323
epoch: 12, iter: 416, loss: 2.286864995956421, time cost4.105258941650391
epoch: 12, iter: 417, loss: 2.2099609375, time cost4.0067596435546875
epoch: 12, iter: 418, loss: 1.828904628753662, time cost4.106899976730347
epoch: 12, iter: 419, loss: 1.603188157081604, time cost4.071574926376343
epoch: 12, iter: 420, loss: 1.3488503694534302, time cost4.426883220672607
epoch: 12, iter: 421, loss: 1.1495332717895508, time cost4.005219221115112
epoch: 12, iter: 422, loss: 2.5675265789031982, time cost4.008807182312012
epoch: 12, iter: 423, loss: 1.5400303602218628, time cost4.008533239364624
epoch: 12, iter: 424, loss: 1.2958965301513672, time cost4.113240003585815
epoch: 12, iter: 425, loss: 2.552821636199951, time cost4.1489996910095215
epoch: 12, iter: 426, loss: 1.6224058866500854, time cost3.9906978607177734
epoch: 12, iter: 427, loss: 1.8562368154525757, time cost4.011819839477539
epoch: 12, iter: 428, loss: 1.6800756454467773, time cost4.112311363220215
epoch: 12, iter: 429, loss: 2.0319697856903076, time cost4.117677688598633
epoch: 12, iter: 430, loss: 1.6203315258026123, time cost3.9288315773010254
epoch: 12, iter: 431, loss: 1.868347406387329, time cost3.964601755142212
epoch: 12, iter: 432, loss: 1.0708707571029663, time cost3.9162421226501465
epoch: 12, iter: 433, loss: 1.887588381767273, time cost3.995302438735962
epoch: 12, iter: 434, loss: 1.182384967803955, time cost4.101341485977173
epoch: 12, iter: 435, loss: 1.1872726678848267, time cost4.133078575134277
epoch: 12, iter: 436, loss: 1.3033117055892944, time cost4.046483755111694
epoch: 12, iter: 437, loss: 1.3010767698287964, time cost3.949753522872925
epoch: 12, iter: 438, loss: 1.418505072593689, time cost4.087869167327881
epoch: 12, iter: 439, loss: 1.8923959732055664, time cost4.024149179458618
epoch: 12, iter: 440, loss: 1.198233723640442, time cost4.1152403354644775
epoch: 12, iter: 441, loss: 1.617531180381775, time cost3.947042942047119
epoch: 12, iter: 442, loss: 1.4983851909637451, time cost2.763845682144165
epoch: 13, iter: 443, loss: 1.9442771673202515, time cost4.1144585609436035
epoch: 13, iter: 444, loss: 1.340293526649475, time cost3.9897825717926025
epoch: 13, iter: 445, loss: 1.565781831741333, time cost4.197363376617432
epoch: 13, iter: 446, loss: 1.5892142057418823, time cost4.050151348114014
epoch: 13, iter: 447, loss: 1.4345985651016235, time cost3.9249820709228516
epoch: 13, iter: 448, loss: 1.110544204711914, time cost4.059779167175293
epoch: 13, iter: 449, loss: 0.9747605323791504, time cost4.111712217330933
epoch: 13, iter: 450, loss: 1.87030029296875, time cost3.9614315032958984
epoch: 13, iter: 451, loss: 1.2233978509902954, time cost3.989800214767456
epoch: 13, iter: 452, loss: 1.7910915613174438, time cost4.099507570266724
epoch: 13, iter: 453, loss: 1.7733538150787354, time cost4.105475902557373
epoch: 13, iter: 454, loss: 1.2080937623977661, time cost4.027449131011963
epoch: 13, iter: 455, loss: 1.6217632293701172, time cost4.198871850967407
epoch: 13, iter: 456, loss: 2.0394859313964844, time cost4.163973093032837
epoch: 13, iter: 457, loss: 1.048071026802063, time cost4.1811559200286865
epoch: 13, iter: 458, loss: 0.9955464601516724, time cost4.261051893234253
epoch: 13, iter: 459, loss: 1.443664789199829, time cost4.0343053340911865
epoch: 13, iter: 460, loss: 0.8906664848327637, time cost4.201959133148193
epoch: 13, iter: 461, loss: 1.1386548280715942, time cost4.1338372230529785
epoch: 13, iter: 462, loss: 1.0844470262527466, time cost4.1434080600738525
epoch: 13, iter: 463, loss: 0.6135103702545166, time cost4.132653474807739
epoch: 13, iter: 464, loss: 0.7180164456367493, time cost4.091719388961792
epoch: 13, iter: 465, loss: 1.1406967639923096, time cost3.982699155807495
epoch: 13, iter: 466, loss: 1.7899731397628784, time cost4.143489360809326
epoch: 13, iter: 467, loss: 1.5217657089233398, time cost3.9207675457000732
epoch: 13, iter: 468, loss: 1.2022647857666016, time cost4.038299798965454
epoch: 13, iter: 469, loss: 0.9987426400184631, time cost4.267145872116089
epoch: 13, iter: 470, loss: 1.387757420539856, time cost4.114794969558716
epoch: 13, iter: 471, loss: 1.3250476121902466, time cost4.02301549911499
epoch: 13, iter: 472, loss: 1.1750580072402954, time cost4.1662421226501465
epoch: 13, iter: 473, loss: 0.878868043422699, time cost4.082096099853516
epoch: 13, iter: 474, loss: 1.5588407516479492, time cost4.084859848022461
epoch: 13, iter: 475, loss: 1.231199860572815, time cost3.790238618850708
epoch: 13, iter: 476, loss: 1.1099809408187866, time cost3.0074899196624756
epoch: 14, iter: 477, loss: 1.5242304801940918, time cost4.114947557449341
epoch: 14, iter: 478, loss: 1.1560336351394653, time cost4.265597343444824
epoch: 14, iter: 479, loss: 1.7169002294540405, time cost4.185852289199829
epoch: 14, iter: 480, loss: 1.5478261709213257, time cost4.0131494998931885
epoch: 14, iter: 481, loss: 1.7883909940719604, time cost4.135181903839111
epoch: 14, iter: 482, loss: 3.1960337162017822, time cost4.1981329917907715
epoch: 14, iter: 483, loss: 1.8047770261764526, time cost4.1487767696380615
epoch: 14, iter: 484, loss: 1.097320556640625, time cost4.19635009765625
epoch: 14, iter: 485, loss: 2.312518835067749, time cost4.137852430343628
epoch: 14, iter: 486, loss: 1.768788456916809, time cost4.3003973960876465
epoch: 14, iter: 487, loss: 1.4981417655944824, time cost4.083847522735596
epoch: 14, iter: 488, loss: 1.545068621635437, time cost4.020940542221069
epoch: 14, iter: 489, loss: 1.5836941003799438, time cost4.1653993129730225
epoch: 14, iter: 490, loss: 2.0888450145721436, time cost4.184650182723999
epoch: 14, iter: 491, loss: 1.0693246126174927, time cost4.095850467681885
epoch: 14, iter: 492, loss: 1.6884443759918213, time cost4.18824577331543
epoch: 14, iter: 493, loss: 1.427362084388733, time cost4.16172194480896
epoch: 14, iter: 494, loss: 1.4229509830474854, time cost4.0337958335876465
epoch: 14, iter: 495, loss: 1.0835849046707153, time cost4.158604860305786
epoch: 14, iter: 496, loss: 1.5594149827957153, time cost4.038848400115967
epoch: 14, iter: 497, loss: 0.836235523223877, time cost3.988905906677246
epoch: 14, iter: 498, loss: 1.2403483390808105, time cost3.951753616333008
epoch: 14, iter: 499, loss: 1.3408194780349731, time cost4.04245400428772
epoch: 14, iter: 500, loss: 1.6471775770187378, time cost4.119704484939575
epoch: 14, iter: 501, loss: 1.7067968845367432, time cost3.989694595336914
epoch: 14, iter: 502, loss: 1.202046275138855, time cost4.014894723892212
epoch: 14, iter: 503, loss: 1.5650599002838135, time cost3.9618775844573975
epoch: 14, iter: 504, loss: 1.804210901260376, time cost4.009628057479858
epoch: 14, iter: 505, loss: 1.3941888809204102, time cost4.006386041641235
epoch: 14, iter: 506, loss: 0.9300712943077087, time cost3.9178385734558105
epoch: 14, iter: 507, loss: 1.052280306816101, time cost4.049688339233398
epoch: 14, iter: 508, loss: 1.0947304964065552, time cost3.9573028087615967
epoch: 14, iter: 509, loss: 1.708232045173645, time cost3.9663243293762207
epoch: 14, iter: 510, loss: 1.0161702632904053, time cost2.8369014263153076
epoch: 15, iter: 511, loss: 1.590952754020691, time cost4.099991083145142
epoch: 15, iter: 512, loss: 1.8261302709579468, time cost4.161472797393799
epoch: 15, iter: 513, loss: 1.6463427543640137, time cost4.045422792434692
epoch: 15, iter: 514, loss: 1.3688057661056519, time cost4.093167781829834
epoch: 15, iter: 515, loss: 0.9559662342071533, time cost4.009752035140991
epoch: 15, iter: 516, loss: 1.0642691850662231, time cost4.230157852172852
epoch: 15, iter: 517, loss: 1.48126220703125, time cost4.078732252120972
epoch: 15, iter: 518, loss: 1.1620597839355469, time cost4.203973770141602
epoch: 15, iter: 519, loss: 1.2434254884719849, time cost4.227433919906616
epoch: 15, iter: 520, loss: 1.0629926919937134, time cost4.145051956176758
epoch: 15, iter: 521, loss: 0.9889927506446838, time cost3.9708495140075684
epoch: 15, iter: 522, loss: 0.9475530982017517, time cost4.0136189460754395
epoch: 15, iter: 523, loss: 1.5666810274124146, time cost4.062748193740845
epoch: 15, iter: 524, loss: 1.163637638092041, time cost4.049934148788452
epoch: 15, iter: 525, loss: 1.3016752004623413, time cost4.083817005157471
epoch: 15, iter: 526, loss: 1.3750600814819336, time cost4.052034139633179
epoch: 15, iter: 527, loss: 1.5537736415863037, time cost3.966484546661377
epoch: 15, iter: 528, loss: 1.6952311992645264, time cost4.10877799987793
epoch: 15, iter: 529, loss: 1.9144400358200073, time cost4.1137659549713135
epoch: 15, iter: 530, loss: 1.6078803539276123, time cost4.072592496871948
epoch: 15, iter: 531, loss: 1.4332728385925293, time cost4.096941709518433
epoch: 15, iter: 532, loss: 1.5334761142730713, time cost4.049494028091431
epoch: 15, iter: 533, loss: 1.3154287338256836, time cost4.146288156509399
epoch: 15, iter: 534, loss: 1.5072603225708008, time cost4.063627243041992
epoch: 15, iter: 535, loss: 1.8306735754013062, time cost4.127381086349487
epoch: 15, iter: 536, loss: 1.5295608043670654, time cost4.021211624145508
epoch: 15, iter: 537, loss: 1.392372965812683, time cost4.0863564014434814
epoch: 15, iter: 538, loss: 1.6379804611206055, time cost4.099484205245972
epoch: 15, iter: 539, loss: 2.0813448429107666, time cost4.151054620742798
epoch: 15, iter: 540, loss: 1.5029948949813843, time cost4.058091878890991
epoch: 15, iter: 541, loss: 1.0322262048721313, time cost3.9678289890289307
epoch: 15, iter: 542, loss: 1.4805567264556885, time cost4.117355823516846
epoch: 15, iter: 543, loss: 0.6638186573982239, time cost4.119503736495972
epoch: 15, iter: 544, loss: 1.190665602684021, time cost2.7563679218292236
epoch: 16, iter: 545, loss: 1.3809808492660522, time cost4.362902402877808
epoch: 16, iter: 546, loss: 1.4107825756072998, time cost4.2411603927612305
epoch: 16, iter: 547, loss: 1.5998992919921875, time cost4.144959449768066
epoch: 16, iter: 548, loss: 1.4780731201171875, time cost4.036843538284302
epoch: 16, iter: 549, loss: 1.2406994104385376, time cost4.028411626815796
epoch: 16, iter: 550, loss: 1.4304463863372803, time cost4.054178953170776
epoch: 16, iter: 551, loss: 1.3936389684677124, time cost4.135611057281494
epoch: 16, iter: 552, loss: 1.3403645753860474, time cost3.9359774589538574
epoch: 16, iter: 553, loss: 1.9794905185699463, time cost4.195482492446899
epoch: 16, iter: 554, loss: 0.8508103489875793, time cost4.13478684425354
epoch: 16, iter: 555, loss: 1.4282797574996948, time cost4.163824796676636
epoch: 16, iter: 556, loss: 1.3594712018966675, time cost4.213770627975464
epoch: 16, iter: 557, loss: 1.5347568988800049, time cost4.131818771362305
epoch: 16, iter: 558, loss: 1.34926176071167, time cost3.9560372829437256
epoch: 16, iter: 559, loss: 1.3944779634475708, time cost4.100442886352539
epoch: 16, iter: 560, loss: 1.3186416625976562, time cost4.081228256225586
epoch: 16, iter: 561, loss: 1.420480489730835, time cost4.044513940811157
epoch: 16, iter: 562, loss: 1.7233256101608276, time cost4.199988842010498
epoch: 16, iter: 563, loss: 1.2591872215270996, time cost4.0905420780181885
epoch: 16, iter: 564, loss: 1.2393327951431274, time cost4.031526327133179
epoch: 16, iter: 565, loss: 1.5494015216827393, time cost3.981020450592041
epoch: 16, iter: 566, loss: 1.6087435483932495, time cost4.077682733535767
epoch: 16, iter: 567, loss: 0.8564652800559998, time cost4.023991584777832
epoch: 16, iter: 568, loss: 2.0967891216278076, time cost4.083893537521362
epoch: 16, iter: 569, loss: 1.0743284225463867, time cost4.217065334320068
epoch: 16, iter: 570, loss: 1.371437430381775, time cost4.268789291381836
epoch: 16, iter: 571, loss: 1.7613232135772705, time cost4.11834454536438
epoch: 16, iter: 572, loss: 0.8256925344467163, time cost3.9774773120880127
epoch: 16, iter: 573, loss: 1.727787733078003, time cost3.9882147312164307
epoch: 16, iter: 574, loss: 1.0618711709976196, time cost3.9372968673706055
epoch: 16, iter: 575, loss: 0.8252438306808472, time cost3.977023124694824
epoch: 16, iter: 576, loss: 1.0088566541671753, time cost3.947887420654297
epoch: 16, iter: 577, loss: 1.7951765060424805, time cost4.039022445678711
epoch: 16, iter: 578, loss: 1.0201356410980225, time cost3.0627448558807373
epoch: 17, iter: 579, loss: 1.4120768308639526, time cost4.073407888412476
epoch: 17, iter: 580, loss: 1.282098650932312, time cost4.048833131790161
epoch: 17, iter: 581, loss: 1.1107171773910522, time cost4.138585090637207
epoch: 17, iter: 582, loss: 1.1056450605392456, time cost4.117262125015259
epoch: 17, iter: 583, loss: 1.6805589199066162, time cost4.137156248092651
epoch: 17, iter: 584, loss: 0.851991593837738, time cost4.10196590423584
epoch: 17, iter: 585, loss: 1.4225188493728638, time cost4.155217409133911
epoch: 17, iter: 586, loss: 0.7554398775100708, time cost4.191152334213257
epoch: 17, iter: 587, loss: 1.02339768409729, time cost4.161300897598267
epoch: 17, iter: 588, loss: 0.9066314101219177, time cost4.063677072525024
epoch: 17, iter: 589, loss: 0.9944077730178833, time cost4.1023640632629395
epoch: 17, iter: 590, loss: 1.384087324142456, time cost4.037140846252441
epoch: 17, iter: 591, loss: 0.8382586240768433, time cost4.157284736633301
epoch: 17, iter: 592, loss: 1.6624943017959595, time cost4.027978181838989
epoch: 17, iter: 593, loss: 1.0006277561187744, time cost4.088979244232178
epoch: 17, iter: 594, loss: 1.0049718618392944, time cost4.132781028747559
epoch: 17, iter: 595, loss: 1.061765193939209, time cost3.911468505859375
epoch: 17, iter: 596, loss: 1.4597840309143066, time cost4.059847831726074
epoch: 17, iter: 597, loss: 1.3426433801651, time cost3.9202208518981934
epoch: 17, iter: 598, loss: 1.2998011112213135, time cost4.1941399574279785
epoch: 17, iter: 599, loss: 0.9694288969039917, time cost4.124884843826294
epoch: 17, iter: 600, loss: 1.6699855327606201, time cost4.300487041473389
epoch: 17, iter: 601, loss: 1.126168966293335, time cost4.1816418170928955
epoch: 17, iter: 602, loss: 1.3695679903030396, time cost4.103223562240601
epoch: 17, iter: 603, loss: 2.109800338745117, time cost4.003089904785156
epoch: 17, iter: 604, loss: 0.8429407477378845, time cost4.0539772510528564
epoch: 17, iter: 605, loss: 1.9418590068817139, time cost4.115924119949341
epoch: 17, iter: 606, loss: 2.0518429279327393, time cost4.0261170864105225
epoch: 17, iter: 607, loss: 1.5624076128005981, time cost4.147724628448486
epoch: 17, iter: 608, loss: 1.6678740978240967, time cost4.1848790645599365
epoch: 17, iter: 609, loss: 1.3553664684295654, time cost4.16001558303833
epoch: 17, iter: 610, loss: 1.0868102312088013, time cost3.977038860321045
epoch: 17, iter: 611, loss: 2.3121414184570312, time cost4.097050189971924
epoch: 17, iter: 612, loss: 0.9061321020126343, time cost2.8984737396240234
epoch: 18, iter: 613, loss: 1.196913719177246, time cost4.2658398151397705
epoch: 18, iter: 614, loss: 0.8169633150100708, time cost4.144199371337891
epoch: 18, iter: 615, loss: 0.966636061668396, time cost4.219253778457642
epoch: 18, iter: 616, loss: 1.0503214597702026, time cost4.103368759155273
epoch: 18, iter: 617, loss: 1.1144182682037354, time cost4.250224351882935
epoch: 18, iter: 618, loss: 1.111014723777771, time cost4.230502128601074
epoch: 18, iter: 619, loss: 1.1165162324905396, time cost4.045565843582153
epoch: 18, iter: 620, loss: 1.4937182664871216, time cost4.019465923309326
epoch: 18, iter: 621, loss: 1.1146442890167236, time cost4.175149202346802
epoch: 18, iter: 622, loss: 1.3479418754577637, time cost4.086105823516846
epoch: 18, iter: 623, loss: 0.9961214065551758, time cost4.007793188095093
epoch: 18, iter: 624, loss: 0.918336033821106, time cost4.14950966835022
epoch: 18, iter: 625, loss: 1.3439438343048096, time cost4.177258253097534
epoch: 18, iter: 626, loss: 1.285526990890503, time cost4.192255258560181
epoch: 18, iter: 627, loss: 1.6141868829727173, time cost4.108126401901245
epoch: 18, iter: 628, loss: 1.842691421508789, time cost3.984917163848877
epoch: 18, iter: 629, loss: 1.7703373432159424, time cost4.086559295654297
epoch: 18, iter: 630, loss: 0.749749481678009, time cost4.003017902374268
epoch: 18, iter: 631, loss: 1.19301438331604, time cost3.991701126098633
epoch: 18, iter: 632, loss: 1.5386922359466553, time cost4.088846683502197
epoch: 18, iter: 633, loss: 1.5161930322647095, time cost4.030999183654785
epoch: 18, iter: 634, loss: 1.452724575996399, time cost3.8861351013183594
epoch: 18, iter: 635, loss: 1.8777660131454468, time cost3.1202194690704346
epoch: 18, iter: 636, loss: 1.8643032312393188, time cost3.5247559547424316
epoch: 18, iter: 637, loss: 1.5278000831604004, time cost4.359055519104004
epoch: 18, iter: 638, loss: 1.4634265899658203, time cost4.234102725982666
epoch: 18, iter: 639, loss: 1.463706374168396, time cost4.355169773101807
epoch: 18, iter: 640, loss: 1.6478135585784912, time cost4.250856637954712
epoch: 18, iter: 641, loss: 1.7671475410461426, time cost4.160580396652222
epoch: 18, iter: 642, loss: 1.9409937858581543, time cost4.248544931411743
epoch: 18, iter: 643, loss: 1.3239251375198364, time cost4.0867297649383545
epoch: 18, iter: 644, loss: 1.4939637184143066, time cost4.143417596817017
epoch: 18, iter: 645, loss: 1.9454506635665894, time cost4.095574140548706
epoch: 18, iter: 646, loss: 0.9422956705093384, time cost2.963625431060791
epoch: 19, iter: 647, loss: 1.1443829536437988, time cost4.208682060241699
epoch: 19, iter: 648, loss: 0.9794484972953796, time cost4.387135028839111
epoch: 19, iter: 649, loss: 0.9956156611442566, time cost4.189661741256714
epoch: 19, iter: 650, loss: 1.567869782447815, time cost4.349839925765991
epoch: 19, iter: 651, loss: 1.126342535018921, time cost4.243716716766357
epoch: 19, iter: 652, loss: 1.4144326448440552, time cost4.4039459228515625
epoch: 19, iter: 653, loss: 2.098005771636963, time cost4.371080636978149
epoch: 19, iter: 654, loss: 1.0671786069869995, time cost4.3819739818573
epoch: 19, iter: 655, loss: 1.372478723526001, time cost4.3836705684661865
epoch: 19, iter: 656, loss: 1.7329130172729492, time cost4.436867952346802
epoch: 19, iter: 657, loss: 1.7458629608154297, time cost4.31095290184021
epoch: 19, iter: 658, loss: 1.1076918840408325, time cost4.34594988822937
epoch: 19, iter: 659, loss: 1.304896593093872, time cost4.346663236618042
epoch: 19, iter: 660, loss: 1.0992286205291748, time cost4.245840549468994
epoch: 19, iter: 661, loss: 1.285229206085205, time cost4.488905906677246
epoch: 19, iter: 662, loss: 1.7464019060134888, time cost4.330812215805054
epoch: 19, iter: 663, loss: 1.118786334991455, time cost4.475122451782227
epoch: 19, iter: 664, loss: 0.8795943856239319, time cost4.402581453323364
epoch: 19, iter: 665, loss: 1.6502162218093872, time cost4.437505483627319
epoch: 19, iter: 666, loss: 1.384069561958313, time cost4.427717685699463
epoch: 19, iter: 667, loss: 1.528407096862793, time cost4.4439051151275635
epoch: 19, iter: 668, loss: 1.576229453086853, time cost4.240847826004028
epoch: 19, iter: 669, loss: 0.9085306525230408, time cost4.192806959152222
epoch: 19, iter: 670, loss: 1.203568458557129, time cost3.326456069946289
epoch: 19, iter: 671, loss: 1.5946894884109497, time cost4.228190183639526
epoch: 19, iter: 672, loss: 0.8906794190406799, time cost4.098212718963623
epoch: 19, iter: 673, loss: 1.3571951389312744, time cost4.2199225425720215
epoch: 19, iter: 674, loss: 1.0882524251937866, time cost3.9632630348205566
epoch: 19, iter: 675, loss: 2.0762901306152344, time cost3.9643943309783936
epoch: 19, iter: 676, loss: 1.4911198616027832, time cost4.186376094818115
epoch: 19, iter: 677, loss: 1.284767985343933, time cost4.035766124725342
epoch: 19, iter: 678, loss: 1.1242003440856934, time cost3.957058906555176
epoch: 19, iter: 679, loss: 2.053985118865967, time cost3.947730302810669
epoch: 19, iter: 680, loss: 0.8128153085708618, time cost2.93631649017334
epoch: 20, iter: 681, loss: 1.6053506135940552, time cost4.053000211715698
epoch: 20, iter: 682, loss: 1.0185089111328125, time cost3.965914249420166
epoch: 20, iter: 683, loss: 1.0341572761535645, time cost4.05083441734314
epoch: 20, iter: 684, loss: 0.9084586501121521, time cost4.153586149215698
epoch: 20, iter: 685, loss: 1.8014737367630005, time cost4.20264196395874
epoch: 20, iter: 686, loss: 1.1707278490066528, time cost4.125102519989014
epoch: 20, iter: 687, loss: 1.2044557332992554, time cost4.057227373123169
epoch: 20, iter: 688, loss: 1.3659887313842773, time cost4.062643766403198
epoch: 20, iter: 689, loss: 1.1113154888153076, time cost4.024949073791504
epoch: 20, iter: 690, loss: 1.0845096111297607, time cost4.249292612075806
epoch: 20, iter: 691, loss: 1.0988729000091553, time cost4.06738543510437
epoch: 20, iter: 692, loss: 1.0295195579528809, time cost4.087026357650757
epoch: 20, iter: 693, loss: 1.40857994556427, time cost3.9459502696990967
epoch: 20, iter: 694, loss: 1.0493980646133423, time cost4.024314641952515
epoch: 20, iter: 695, loss: 1.3623348474502563, time cost4.062768936157227
epoch: 20, iter: 696, loss: 1.3799667358398438, time cost4.022583961486816
epoch: 20, iter: 697, loss: 0.5645402073860168, time cost4.300037384033203
epoch: 20, iter: 698, loss: 1.4338072538375854, time cost4.018129110336304
epoch: 20, iter: 699, loss: 1.4133177995681763, time cost4.173376798629761
epoch: 20, iter: 700, loss: 1.4155813455581665, time cost4.176440954208374
tensor([[ 97.,  84.,  96.,  ...,   4.,   4.,   3.],
        [  5.,   2.,   3.,  ...,   3.,   3.,   1.],
        [149., 226., 236.,  ...,  11.,  11.,   7.],
        ...,
        [103., 105.,  83.,  ...,   7.,   7.,   7.],
        [ 10.,   6.,   4.,  ...,   1.,   1.,   1.],
        [ 89.,  81., 125.,  ...,   7.,   7.,   5.]])
Epoch: 20, Iteration: 700:
TEST A@1: 0.4177777777777778
TEST A@5: 0.8133333333333334
TEST A@10: 0.9222222222222223
TEST M@B: 0.33584219120098563
TEST M@A: 0.9318302404469633
TEST W@MB: 0.17509713006629762
TEST W@MA: 0.5706814819796171
TEST Time: 530.9659759998322
Model Updated
REAL performance: Top1: 0.4177777777777778, Top5: 0.8133333333333334, Top10: 0.9222222222222223, MB: 0.33584219120098563, MA: 0.9318302404469633, WMB: 0.17509713006629762, WMA: 0.5706814819796171
epoch: 20, iter: 701, loss: 1.2911845445632935, time cost4.173457145690918
epoch: 20, iter: 702, loss: 2.1541831493377686, time cost4.029016733169556
epoch: 20, iter: 703, loss: 1.3094713687896729, time cost4.332154035568237
epoch: 20, iter: 704, loss: 0.7324238419532776, time cost4.1627302169799805
epoch: 20, iter: 705, loss: 0.8988887071609497, time cost4.22053861618042
epoch: 20, iter: 706, loss: 1.0544501543045044, time cost4.011380434036255
epoch: 20, iter: 707, loss: 1.0158820152282715, time cost4.19889497756958
epoch: 20, iter: 708, loss: 1.1058417558670044, time cost4.101608991622925
epoch: 20, iter: 709, loss: 1.0185394287109375, time cost4.108225345611572
epoch: 20, iter: 710, loss: 1.2719783782958984, time cost4.120661020278931
epoch: 20, iter: 711, loss: 1.2079654932022095, time cost4.062571048736572
epoch: 20, iter: 712, loss: 1.4406603574752808, time cost4.105264902114868
epoch: 20, iter: 713, loss: 0.7990354299545288, time cost4.123461961746216
epoch: 20, iter: 714, loss: 0.7712162137031555, time cost2.946763515472412
epoch: 21, iter: 715, loss: 1.6424965858459473, time cost4.1739490032196045
epoch: 21, iter: 716, loss: 1.9116297960281372, time cost3.9792966842651367
epoch: 21, iter: 717, loss: 1.5678315162658691, time cost4.270290851593018
epoch: 21, iter: 718, loss: 1.2705202102661133, time cost4.013297080993652
epoch: 21, iter: 719, loss: 1.0022631883621216, time cost4.090650796890259
epoch: 21, iter: 720, loss: 1.1507792472839355, time cost4.053604602813721
epoch: 21, iter: 721, loss: 0.9694699048995972, time cost4.215924501419067
epoch: 21, iter: 722, loss: 1.5180331468582153, time cost4.063779592514038
epoch: 21, iter: 723, loss: 1.1169664859771729, time cost4.141697883605957
epoch: 21, iter: 724, loss: 2.1530110836029053, time cost4.274310111999512
epoch: 21, iter: 725, loss: 1.3164522647857666, time cost4.3476598262786865
epoch: 21, iter: 726, loss: 1.3429088592529297, time cost4.1848015785217285
epoch: 21, iter: 727, loss: 1.250026822090149, time cost4.29215931892395
epoch: 21, iter: 728, loss: 1.1151536703109741, time cost4.194786071777344
epoch: 21, iter: 729, loss: 0.7442417144775391, time cost4.03246545791626
epoch: 21, iter: 730, loss: 1.3179898262023926, time cost4.170511960983276
epoch: 21, iter: 731, loss: 0.7822453379631042, time cost4.188472509384155
epoch: 21, iter: 732, loss: 1.0116441249847412, time cost4.117426872253418
epoch: 21, iter: 733, loss: 1.364953875541687, time cost4.174229860305786
epoch: 21, iter: 734, loss: 1.5282976627349854, time cost3.9672162532806396
epoch: 21, iter: 735, loss: 1.0690330266952515, time cost4.206342458724976
epoch: 21, iter: 736, loss: 0.9293631315231323, time cost3.9786202907562256
epoch: 21, iter: 737, loss: 2.036090850830078, time cost4.078649997711182
epoch: 21, iter: 738, loss: 1.486097812652588, time cost4.014679431915283
epoch: 21, iter: 739, loss: 1.2766788005828857, time cost3.9363889694213867
epoch: 21, iter: 740, loss: 0.7899606823921204, time cost3.984809160232544
epoch: 21, iter: 741, loss: 1.1360244750976562, time cost3.967918634414673
epoch: 21, iter: 742, loss: 1.1105785369873047, time cost4.030274391174316
epoch: 21, iter: 743, loss: 0.87980055809021, time cost4.098520755767822
epoch: 21, iter: 744, loss: 1.2350654602050781, time cost3.950801134109497
epoch: 21, iter: 745, loss: 1.2081501483917236, time cost4.093116998672485
epoch: 21, iter: 746, loss: 0.8540355563163757, time cost4.0512659549713135
epoch: 21, iter: 747, loss: 1.6572844982147217, time cost4.170639991760254
epoch: 21, iter: 748, loss: 1.1930466890335083, time cost3.025214195251465
epoch: 22, iter: 749, loss: 1.2847535610198975, time cost4.190768241882324
epoch: 22, iter: 750, loss: 1.3763978481292725, time cost4.1130053997039795
tensor([[144., 126., 145.,  ...,   1.,   1.,   2.],
        [ 24.,  22.,  22.,  ...,  16.,  16.,  12.],
        [207., 260., 251.,  ...,  25.,  25.,  19.],
        ...,
        [122., 133.,  89.,  ...,  26.,  26.,  20.],
        [  9.,   5.,   6.,  ...,   1.,   1.,   1.],
        [113., 131., 187.,  ...,  17.,  17.,  21.]])
Epoch: 22, Iteration: 750:
TEST A@1: 0.4177777777777778
TEST A@5: 0.7555555555555555
TEST A@10: 0.8844444444444445
TEST M@B: 0.3302263392509321
TEST M@A: 0.9332575398633064
TEST W@MB: 0.1741228507505533
TEST W@MA: 0.5721920462405804
TEST Time: 532.4812319278717
REAL performance: Top1: 0.4177777777777778, Top5: 0.8133333333333334, Top10: 0.9222222222222223, MB: 0.33584219120098563, MA: 0.9318302404469633, WMB: 0.17509713006629762, WMA: 0.5706814819796171
epoch: 22, iter: 751, loss: 1.4320608377456665, time cost3.947312355041504
epoch: 22, iter: 752, loss: 1.5594557523727417, time cost3.9611704349517822
epoch: 22, iter: 753, loss: 0.8023408055305481, time cost4.185580492019653
epoch: 22, iter: 754, loss: 1.3067982196807861, time cost4.384702682495117
epoch: 22, iter: 755, loss: 1.5970031023025513, time cost4.155888319015503
epoch: 22, iter: 756, loss: 0.8385594487190247, time cost4.188976287841797
epoch: 22, iter: 757, loss: 0.9874938130378723, time cost4.067479848861694
epoch: 22, iter: 758, loss: 0.9790538549423218, time cost4.024083375930786
epoch: 22, iter: 759, loss: 0.9807950258255005, time cost3.987478017807007
epoch: 22, iter: 760, loss: 1.30837082862854, time cost4.182512283325195
epoch: 22, iter: 761, loss: 1.3249872922897339, time cost4.068461656570435
epoch: 22, iter: 762, loss: 1.8230764865875244, time cost4.12097954750061
epoch: 22, iter: 763, loss: 0.784161388874054, time cost3.9583957195281982
epoch: 22, iter: 764, loss: 0.943239688873291, time cost4.184550762176514
epoch: 22, iter: 765, loss: 0.9682438969612122, time cost4.047434329986572
epoch: 22, iter: 766, loss: 1.3779619932174683, time cost4.06527304649353
epoch: 22, iter: 767, loss: 1.279862880706787, time cost4.0410425662994385
epoch: 22, iter: 768, loss: 1.095748782157898, time cost4.114724636077881
epoch: 22, iter: 769, loss: 0.7840855121612549, time cost4.358492612838745
epoch: 22, iter: 770, loss: 1.9334888458251953, time cost4.099219083786011
epoch: 22, iter: 771, loss: 0.7082979679107666, time cost4.113341331481934
epoch: 22, iter: 772, loss: 0.800289511680603, time cost4.056023597717285
epoch: 22, iter: 773, loss: 1.3303035497665405, time cost4.085654973983765
epoch: 22, iter: 774, loss: 1.7936122417449951, time cost4.000988245010376
epoch: 22, iter: 775, loss: 0.8386785984039307, time cost3.9185068607330322
epoch: 22, iter: 776, loss: 0.7620363831520081, time cost3.9582784175872803
epoch: 22, iter: 777, loss: 1.5111448764801025, time cost4.076228618621826
epoch: 22, iter: 778, loss: 1.9595621824264526, time cost4.165624618530273
epoch: 22, iter: 779, loss: 0.5455367565155029, time cost4.139368772506714
epoch: 22, iter: 780, loss: 0.8826913833618164, time cost4.0881874561309814
epoch: 22, iter: 781, loss: 1.1452288627624512, time cost4.189977645874023
epoch: 22, iter: 782, loss: 0.6881711483001709, time cost2.8416457176208496
epoch: 23, iter: 783, loss: 1.2814393043518066, time cost3.9616074562072754
epoch: 23, iter: 784, loss: 1.6997588872909546, time cost4.088799476623535
epoch: 23, iter: 785, loss: 0.7407822608947754, time cost4.097608327865601
epoch: 23, iter: 786, loss: 0.8514271378517151, time cost4.0964789390563965
epoch: 23, iter: 787, loss: 0.8992124795913696, time cost4.329136610031128
epoch: 23, iter: 788, loss: 0.9746733903884888, time cost4.244112253189087
epoch: 23, iter: 789, loss: 1.2570593357086182, time cost4.1155548095703125
epoch: 23, iter: 790, loss: 1.1534748077392578, time cost4.273126125335693
epoch: 23, iter: 791, loss: 1.017592191696167, time cost4.221806049346924
epoch: 23, iter: 792, loss: 0.8631837368011475, time cost4.2172346115112305
epoch: 23, iter: 793, loss: 0.9352419376373291, time cost3.9947586059570312
epoch: 23, iter: 794, loss: 1.1958235502243042, time cost4.010986089706421
epoch: 23, iter: 795, loss: 1.1361029148101807, time cost4.237192153930664
epoch: 23, iter: 796, loss: 1.5490562915802002, time cost4.172692060470581
epoch: 23, iter: 797, loss: 1.5660696029663086, time cost4.285467147827148
epoch: 23, iter: 798, loss: 1.2378419637680054, time cost4.150062084197998
epoch: 23, iter: 799, loss: 0.8347707390785217, time cost4.1899261474609375
epoch: 23, iter: 800, loss: 1.1057636737823486, time cost4.119553089141846
tensor([[153., 150., 163.,  ...,  12.,  12.,   9.],
        [ 83.,  68.,  72.,  ...,  15.,  15.,   7.],
        [ 61., 125.,  97.,  ...,   1.,   1.,   1.],
        ...,
        [ 37.,  44.,  28.,  ...,   5.,   5.,   7.],
        [ 65.,  34.,  29.,  ...,   1.,   1.,   1.],
        [137., 135., 174.,  ...,  11.,  11.,  23.]])
Epoch: 23, Iteration: 800:
TEST A@1: 0.39111111111111113
TEST A@5: 0.7533333333333333
TEST A@10: 0.8977777777777778
TEST M@B: 0.3313787370101771
TEST M@A: 0.933289355980587
TEST W@MB: 0.17562980392242625
TEST W@MA: 0.57227342865389
TEST Time: 530.6410939693451
REAL performance: Top1: 0.4177777777777778, Top5: 0.8133333333333334, Top10: 0.9222222222222223, MB: 0.33584219120098563, MA: 0.9318302404469633, WMB: 0.17509713006629762, WMA: 0.5706814819796171
epoch: 23, iter: 801, loss: 1.3278660774230957, time cost4.230796813964844
epoch: 23, iter: 802, loss: 1.2630040645599365, time cost4.076862573623657
epoch: 23, iter: 803, loss: 1.0587841272354126, time cost3.973794937133789
epoch: 23, iter: 804, loss: 1.83673894405365, time cost4.111790180206299
epoch: 23, iter: 805, loss: 1.2282599210739136, time cost4.075934410095215
epoch: 23, iter: 806, loss: 1.9025620222091675, time cost4.022742986679077
epoch: 23, iter: 807, loss: 1.1647087335586548, time cost3.955188274383545
epoch: 23, iter: 808, loss: 1.4952367544174194, time cost4.024370193481445
epoch: 23, iter: 809, loss: 1.639906406402588, time cost4.137374401092529
epoch: 23, iter: 810, loss: 1.1334552764892578, time cost4.152000188827515
epoch: 23, iter: 811, loss: 0.9250909090042114, time cost4.1565515995025635
epoch: 23, iter: 812, loss: 0.8049193620681763, time cost4.111372232437134
epoch: 23, iter: 813, loss: 1.3270930051803589, time cost4.110860824584961
epoch: 23, iter: 814, loss: 1.2819972038269043, time cost4.000243186950684
epoch: 23, iter: 815, loss: 1.0167970657348633, time cost3.8852524757385254
epoch: 23, iter: 816, loss: 0.5577028393745422, time cost2.9248604774475098
epoch: 24, iter: 817, loss: 1.4715933799743652, time cost4.354944229125977
epoch: 24, iter: 818, loss: 1.5746464729309082, time cost4.256164789199829
epoch: 24, iter: 819, loss: 2.281811475753784, time cost4.216372728347778
epoch: 24, iter: 820, loss: 1.8442373275756836, time cost4.401839256286621
epoch: 24, iter: 821, loss: 2.1594533920288086, time cost4.2026543617248535
epoch: 24, iter: 822, loss: 1.5898288488388062, time cost4.184839725494385
epoch: 24, iter: 823, loss: 1.3034588098526, time cost4.2241363525390625
epoch: 24, iter: 824, loss: 1.816695213317871, time cost4.239582061767578
epoch: 24, iter: 825, loss: 0.7599233984947205, time cost4.053900718688965
epoch: 24, iter: 826, loss: 0.7897281050682068, time cost4.076645612716675
epoch: 24, iter: 827, loss: 1.0042661428451538, time cost4.035831689834595
epoch: 24, iter: 828, loss: 0.9632854461669922, time cost4.083340644836426
epoch: 24, iter: 829, loss: 1.177476167678833, time cost3.987257719039917
epoch: 24, iter: 830, loss: 1.4062621593475342, time cost4.123232364654541
epoch: 24, iter: 831, loss: 1.0123258829116821, time cost4.094898462295532
epoch: 24, iter: 832, loss: 1.7165385484695435, time cost4.228849649429321
epoch: 24, iter: 833, loss: 1.0702060461044312, time cost4.0911781787872314
epoch: 24, iter: 834, loss: 1.6596813201904297, time cost3.8368887901306152
epoch: 24, iter: 835, loss: 1.2015565633773804, time cost3.198707342147827
epoch: 24, iter: 836, loss: 0.9902461767196655, time cost3.7478325366973877
epoch: 24, iter: 837, loss: 1.8981468677520752, time cost4.321171522140503
epoch: 24, iter: 838, loss: 1.0602939128875732, time cost4.1508824825286865
epoch: 24, iter: 839, loss: 1.5529305934906006, time cost4.291274785995483
epoch: 24, iter: 840, loss: 1.1782742738723755, time cost4.337596416473389
epoch: 24, iter: 841, loss: 1.8027111291885376, time cost4.288825511932373
epoch: 24, iter: 842, loss: 1.6925404071807861, time cost4.2993786334991455
epoch: 24, iter: 843, loss: 1.4005974531173706, time cost4.307760238647461
epoch: 24, iter: 844, loss: 1.006945013999939, time cost4.251004934310913
epoch: 24, iter: 845, loss: 0.655515730381012, time cost3.9996886253356934
epoch: 24, iter: 846, loss: 1.8081196546554565, time cost4.182824611663818
epoch: 24, iter: 847, loss: 0.9954417943954468, time cost4.2680652141571045
epoch: 24, iter: 848, loss: 0.6067310571670532, time cost4.1818015575408936
epoch: 24, iter: 849, loss: 1.2827156782150269, time cost4.119478702545166
epoch: 24, iter: 850, loss: 0.4477609395980835, time cost3.038203239440918
tensor([[207., 197., 210.,  ...,  23.,  23.,  21.],
        [ 39.,  17.,  17.,  ...,  12.,  12.,   4.],
        [ 63., 127., 103.,  ...,   9.,   9.,   5.],
        ...,
        [174., 181., 147.,  ...,  28.,  28.,  25.],
        [ 72.,  52.,  32.,  ...,   1.,   1.,   1.],
        [146., 134., 227.,  ...,  29.,  29.,  32.]])
Epoch: 24, Iteration: 850:
TEST A@1: 0.3288888888888889
TEST A@5: 0.6866666666666666
TEST A@10: 0.8333333333333334
TEST M@B: 0.28847078369058654
TEST M@A: 0.9265811157133949
TEST W@MB: 0.15318916951611938
TEST W@MA: 0.5673193795202974
TEST Time: 576.2022845745087
REAL performance: Top1: 0.4177777777777778, Top5: 0.8133333333333334, Top10: 0.9222222222222223, MB: 0.33584219120098563, MA: 0.9318302404469633, WMB: 0.17509713006629762, WMA: 0.5706814819796171
epoch: 25, iter: 851, loss: 0.9587005376815796, time cost4.262287378311157
epoch: 25, iter: 852, loss: 1.6069319248199463, time cost4.0399909019470215
epoch: 25, iter: 853, loss: 1.4655357599258423, time cost4.130249738693237
epoch: 25, iter: 854, loss: 1.258989930152893, time cost4.037500619888306
epoch: 25, iter: 855, loss: 1.453225016593933, time cost4.271650791168213
epoch: 25, iter: 856, loss: 1.1422841548919678, time cost4.250385999679565
epoch: 25, iter: 857, loss: 1.0206739902496338, time cost4.326806545257568
epoch: 25, iter: 858, loss: 1.5375500917434692, time cost4.399740695953369
epoch: 25, iter: 859, loss: 1.0942178964614868, time cost4.415096998214722
epoch: 25, iter: 860, loss: 1.2605818510055542, time cost4.095940828323364
epoch: 25, iter: 861, loss: 1.5145083665847778, time cost4.2153332233428955
epoch: 25, iter: 862, loss: 1.4953917264938354, time cost4.081794738769531
epoch: 25, iter: 863, loss: 1.7491052150726318, time cost4.100468397140503
epoch: 25, iter: 864, loss: 1.1994366645812988, time cost4.196748971939087
epoch: 25, iter: 865, loss: 1.413996934890747, time cost4.26879096031189
epoch: 25, iter: 866, loss: 1.3268166780471802, time cost4.116107225418091
epoch: 25, iter: 867, loss: 1.3168083429336548, time cost4.159355401992798
epoch: 25, iter: 868, loss: 1.8778681755065918, time cost4.0639636516571045
epoch: 25, iter: 869, loss: 1.2198145389556885, time cost4.155765533447266
epoch: 25, iter: 870, loss: 1.0213725566864014, time cost4.363518476486206
epoch: 25, iter: 871, loss: 1.312769889831543, time cost3.970201253890991
epoch: 25, iter: 872, loss: 1.3710386753082275, time cost4.167790174484253
epoch: 25, iter: 873, loss: 1.7677522897720337, time cost3.9142746925354004
epoch: 25, iter: 874, loss: 1.7104246616363525, time cost4.081939458847046
epoch: 25, iter: 875, loss: 1.5663970708847046, time cost3.9931163787841797
epoch: 25, iter: 876, loss: 0.9704068303108215, time cost4.0609519481658936
epoch: 25, iter: 877, loss: 0.8457964062690735, time cost4.220155954360962
epoch: 25, iter: 878, loss: 1.4025812149047852, time cost4.138563871383667
epoch: 25, iter: 879, loss: 1.2995400428771973, time cost4.048993349075317
epoch: 25, iter: 880, loss: 1.2200106382369995, time cost4.005815029144287
epoch: 25, iter: 881, loss: 1.7723149061203003, time cost4.0909576416015625
epoch: 25, iter: 882, loss: 1.7985860109329224, time cost3.9092824459075928
epoch: 25, iter: 883, loss: 1.8010963201522827, time cost4.1001198291778564
epoch: 25, iter: 884, loss: 0.7981328368186951, time cost2.842238664627075
epoch: 26, iter: 885, loss: 1.5082104206085205, time cost4.139517068862915
epoch: 26, iter: 886, loss: 0.824492335319519, time cost4.101332902908325
epoch: 26, iter: 887, loss: 1.2521589994430542, time cost4.184263467788696
epoch: 26, iter: 888, loss: 1.1549235582351685, time cost3.9695253372192383
epoch: 26, iter: 889, loss: 1.1712408065795898, time cost4.1994664669036865
epoch: 26, iter: 890, loss: 0.9054124355316162, time cost4.393149375915527
epoch: 26, iter: 891, loss: 1.3671870231628418, time cost4.0848493576049805
epoch: 26, iter: 892, loss: 1.5383943319320679, time cost4.122621059417725
epoch: 26, iter: 893, loss: 1.558447003364563, time cost4.0606348514556885
epoch: 26, iter: 894, loss: 1.5697115659713745, time cost4.084781169891357
epoch: 26, iter: 895, loss: 1.1515991687774658, time cost4.338071346282959
epoch: 26, iter: 896, loss: 1.0446906089782715, time cost4.101627826690674
epoch: 26, iter: 897, loss: 0.593401312828064, time cost4.231832981109619
epoch: 26, iter: 898, loss: 0.5550130009651184, time cost4.090707778930664
epoch: 26, iter: 899, loss: 0.7923375964164734, time cost3.9266645908355713
epoch: 26, iter: 900, loss: 0.8191618323326111, time cost4.204574108123779
tensor([[110., 106., 113.,  ...,   1.,   1.,   1.],
        [ 10.,   9.,   8.,  ...,  11.,  11.,   8.],
        [ 22., 111.,  64.,  ...,   5.,   5.,   2.],
        ...,
        [131., 132., 123.,  ...,  51.,  51.,  39.],
        [148.,  65., 118.,  ...,   1.,   1.,   1.],
        [154., 154., 192.,  ...,  44.,  44.,  33.]])
Epoch: 26, Iteration: 900:
TEST A@1: 0.4066666666666667
TEST A@5: 0.7755555555555556
TEST A@10: 0.8755555555555555
TEST M@B: 0.34046531534187846
TEST M@A: 0.932610034001762
TEST W@MB: 0.18012451574135854
TEST W@MA: 0.572190798622208
TEST Time: 532.6711504459381
Model Updated
REAL performance: Top1: 0.4066666666666667, Top5: 0.7755555555555556, Top10: 0.8755555555555555, MB: 0.34046531534187846, MA: 0.932610034001762, WMB: 0.18012451574135854, WMA: 0.572190798622208
epoch: 26, iter: 901, loss: 1.9312431812286377, time cost3.86820650100708
epoch: 26, iter: 902, loss: 2.0345523357391357, time cost4.112819194793701
epoch: 26, iter: 903, loss: 0.8438524007797241, time cost4.157482862472534
epoch: 26, iter: 904, loss: 1.0865050554275513, time cost4.099371910095215
epoch: 26, iter: 905, loss: 1.1623623371124268, time cost3.981041669845581
epoch: 26, iter: 906, loss: 0.7821794748306274, time cost3.9913554191589355
epoch: 26, iter: 907, loss: 1.3688364028930664, time cost4.1709980964660645
epoch: 26, iter: 908, loss: 1.4326838254928589, time cost4.394780397415161
epoch: 26, iter: 909, loss: 1.6060067415237427, time cost4.191607475280762
epoch: 26, iter: 910, loss: 0.9193216562271118, time cost4.238524913787842
epoch: 26, iter: 911, loss: 1.184095859527588, time cost4.126140356063843
epoch: 26, iter: 912, loss: 1.2228639125823975, time cost4.044801235198975
epoch: 26, iter: 913, loss: 1.2317214012145996, time cost4.131510019302368
epoch: 26, iter: 914, loss: 1.6901456117630005, time cost4.2030229568481445
epoch: 26, iter: 915, loss: 0.7098828554153442, time cost4.03738808631897
epoch: 26, iter: 916, loss: 1.197014570236206, time cost4.176535606384277
epoch: 26, iter: 917, loss: 0.9013007879257202, time cost4.103090286254883
epoch: 26, iter: 918, loss: 0.9002615213394165, time cost3.2132623195648193
epoch: 27, iter: 919, loss: 0.9560208916664124, time cost4.441599369049072
epoch: 27, iter: 920, loss: 1.6219693422317505, time cost4.158617734909058
epoch: 27, iter: 921, loss: 1.1670749187469482, time cost4.202383041381836
epoch: 27, iter: 922, loss: 1.4553412199020386, time cost4.1096577644348145
epoch: 27, iter: 923, loss: 1.3809823989868164, time cost3.993204355239868
epoch: 27, iter: 924, loss: 1.041126012802124, time cost4.168320417404175
epoch: 27, iter: 925, loss: 0.6378793120384216, time cost4.207063913345337
epoch: 27, iter: 926, loss: 1.3357797861099243, time cost4.019188642501831
epoch: 27, iter: 927, loss: 1.8950146436691284, time cost4.229065895080566
epoch: 27, iter: 928, loss: 1.9846374988555908, time cost4.087562084197998
epoch: 27, iter: 929, loss: 1.0993272066116333, time cost4.212173223495483
epoch: 27, iter: 930, loss: 0.516435980796814, time cost4.1736133098602295
epoch: 27, iter: 931, loss: 1.0708402395248413, time cost4.117764949798584
epoch: 27, iter: 932, loss: 0.987555742263794, time cost4.1297078132629395
epoch: 27, iter: 933, loss: 1.0076904296875, time cost4.301090240478516
epoch: 27, iter: 934, loss: 0.7786612510681152, time cost4.098374128341675
epoch: 27, iter: 935, loss: 0.8720268607139587, time cost4.089701414108276
epoch: 27, iter: 936, loss: 0.8760884404182434, time cost4.138342380523682
epoch: 27, iter: 937, loss: 1.1538418531417847, time cost4.27469801902771
epoch: 27, iter: 938, loss: 1.760952115058899, time cost4.170011520385742
epoch: 27, iter: 939, loss: 0.7320213913917542, time cost4.106355667114258
epoch: 27, iter: 940, loss: 0.758519172668457, time cost4.0927674770355225
epoch: 27, iter: 941, loss: 1.1481101512908936, time cost4.306283950805664
epoch: 27, iter: 942, loss: 1.5324684381484985, time cost4.100392580032349
epoch: 27, iter: 943, loss: 0.8705359697341919, time cost4.108253002166748
epoch: 27, iter: 944, loss: 1.4624671936035156, time cost4.145363807678223
epoch: 27, iter: 945, loss: 1.0819169282913208, time cost4.043197154998779
epoch: 27, iter: 946, loss: 1.2042689323425293, time cost4.110487699508667
epoch: 27, iter: 947, loss: 0.9226666688919067, time cost4.202389478683472
epoch: 27, iter: 948, loss: 0.9696853756904602, time cost4.184935569763184
epoch: 27, iter: 949, loss: 1.4746971130371094, time cost4.063231468200684
epoch: 27, iter: 950, loss: 1.047448754310608, time cost4.385080575942993
tensor([[119., 115., 124.,  ...,   1.,   1.,   1.],
        [ 64.,  57.,  55.,  ...,  29.,  29.,  25.],
        [ 59., 144.,  82.,  ...,  22.,  22.,  13.],
        ...,
        [109., 115.,  89.,  ...,  31.,  31.,  31.],
        [219., 115.,  71.,  ...,   1.,   1.,   1.],
        [125.,  71.,  96.,  ...,  38.,  38.,  37.]])
Epoch: 27, Iteration: 950:
TEST A@1: 0.3844444444444444
TEST A@5: 0.7666666666666667
TEST A@10: 0.9044444444444445
TEST M@B: 0.31890013103372383
TEST M@A: 0.9369077675405758
TEST W@MB: 0.16887351554149607
TEST W@MA: 0.5753999186679585
TEST Time: 535.676066160202
REAL performance: Top1: 0.4066666666666667, Top5: 0.7755555555555556, Top10: 0.8755555555555555, MB: 0.34046531534187846, MA: 0.932610034001762, WMB: 0.18012451574135854, WMA: 0.572190798622208
epoch: 27, iter: 951, loss: 1.2645959854125977, time cost4.070675373077393
epoch: 27, iter: 952, loss: 0.7779407501220703, time cost2.9183340072631836
epoch: 28, iter: 953, loss: 0.5127253532409668, time cost4.299784898757935
epoch: 28, iter: 954, loss: 1.0922646522521973, time cost4.2215423583984375
epoch: 28, iter: 955, loss: 0.9927120804786682, time cost4.057038068771362
epoch: 28, iter: 956, loss: 0.9603756666183472, time cost4.1274943351745605
epoch: 28, iter: 957, loss: 0.9200029373168945, time cost4.100896120071411
epoch: 28, iter: 958, loss: 1.3531497716903687, time cost4.178086519241333
epoch: 28, iter: 959, loss: 1.1176809072494507, time cost4.236160039901733
epoch: 28, iter: 960, loss: 0.9887896776199341, time cost4.135864496231079
epoch: 28, iter: 961, loss: 1.3326760530471802, time cost4.0810558795928955
epoch: 28, iter: 962, loss: 1.2820160388946533, time cost4.056005001068115
epoch: 28, iter: 963, loss: 0.9741907715797424, time cost4.167356014251709
epoch: 28, iter: 964, loss: 0.864623486995697, time cost4.271059274673462
epoch: 28, iter: 965, loss: 1.032454490661621, time cost4.099516868591309
epoch: 28, iter: 966, loss: 0.7046586275100708, time cost4.123340845108032
epoch: 28, iter: 967, loss: 1.0892982482910156, time cost4.109082460403442
epoch: 28, iter: 968, loss: 1.2715402841567993, time cost4.070747375488281
epoch: 28, iter: 969, loss: 1.3001298904418945, time cost4.137868165969849
epoch: 28, iter: 970, loss: 1.4528967142105103, time cost4.165656089782715
epoch: 28, iter: 971, loss: 1.4381399154663086, time cost4.2154858112335205
epoch: 28, iter: 972, loss: 1.3217358589172363, time cost3.9555110931396484
epoch: 28, iter: 973, loss: 0.9227924346923828, time cost4.208170413970947
epoch: 28, iter: 974, loss: 1.0499913692474365, time cost4.18855094909668
epoch: 28, iter: 975, loss: 1.3071918487548828, time cost4.181593418121338
epoch: 28, iter: 976, loss: 1.0160415172576904, time cost4.040802717208862
epoch: 28, iter: 977, loss: 0.8019189238548279, time cost4.319095849990845
epoch: 28, iter: 978, loss: 0.7917081713676453, time cost4.199283599853516
epoch: 28, iter: 979, loss: 1.1055911779403687, time cost4.107159614562988
epoch: 28, iter: 980, loss: 1.9506914615631104, time cost4.06922459602356
epoch: 28, iter: 981, loss: 1.0002864599227905, time cost4.106996774673462
epoch: 28, iter: 982, loss: 1.2640818357467651, time cost3.8801727294921875
epoch: 28, iter: 983, loss: 0.43340471386909485, time cost3.850564956665039
epoch: 28, iter: 984, loss: 0.9591140151023865, time cost4.041430234909058
epoch: 28, iter: 985, loss: 0.6948935389518738, time cost4.182968378067017
epoch: 28, iter: 986, loss: 0.8862314224243164, time cost3.034513473510742
epoch: 29, iter: 987, loss: 1.2297685146331787, time cost4.219456672668457
epoch: 29, iter: 988, loss: 1.0599117279052734, time cost4.200739622116089
epoch: 29, iter: 989, loss: 1.6290051937103271, time cost4.1649391651153564
epoch: 29, iter: 990, loss: 0.548422634601593, time cost4.182498216629028
epoch: 29, iter: 991, loss: 1.4642499685287476, time cost4.086074113845825
epoch: 29, iter: 992, loss: 1.2727553844451904, time cost4.154562473297119
epoch: 29, iter: 993, loss: 1.1717305183410645, time cost4.1681272983551025
epoch: 29, iter: 994, loss: 1.570231556892395, time cost4.003842115402222
epoch: 29, iter: 995, loss: 1.4517489671707153, time cost4.216620683670044
epoch: 29, iter: 996, loss: 1.1157019138336182, time cost4.316951036453247
epoch: 29, iter: 997, loss: 1.2709206342697144, time cost4.076140642166138
epoch: 29, iter: 998, loss: 1.6813685894012451, time cost4.173385381698608
epoch: 29, iter: 999, loss: 1.505496621131897, time cost4.202800512313843
epoch: 29, iter: 1000, loss: 1.1165595054626465, time cost4.19981050491333
tensor([[333., 312., 324.,  ...,   6.,   6.,   6.],
        [ 13.,   8.,   8.,  ...,   6.,   6.,   6.],
        [ 23.,  50.,  24.,  ...,  11.,  11.,   8.],
        ...,
        [252., 280., 205.,  ...,  20.,  20.,  27.],
        [ 36.,  20.,  22.,  ...,   2.,   2.,   1.],
        [371., 288., 368.,  ...,  24.,  24.,  22.]])
Epoch: 29, Iteration: 1000:
TEST A@1: 0.38222222222222224
TEST A@5: 0.7644444444444445
TEST A@10: 0.9155555555555556
TEST M@B: 0.3163681933106285
TEST M@A: 0.9323063605610976
TEST W@MB: 0.16668950402862248
TEST W@MA: 0.5717107774861478
TEST Time: 528.2281069755554
REAL performance: Top1: 0.4066666666666667, Top5: 0.7755555555555556, Top10: 0.8755555555555555, MB: 0.34046531534187846, MA: 0.932610034001762, WMB: 0.18012451574135854, WMA: 0.572190798622208
epoch: 29, iter: 1001, loss: 0.9191481471061707, time cost4.1384665966033936
epoch: 29, iter: 1002, loss: 1.4191089868545532, time cost4.130746841430664
epoch: 29, iter: 1003, loss: 1.2931779623031616, time cost4.050631284713745
epoch: 29, iter: 1004, loss: 1.2597626447677612, time cost4.147143363952637
epoch: 29, iter: 1005, loss: 0.9784466028213501, time cost4.185311555862427
epoch: 29, iter: 1006, loss: 0.8699432611465454, time cost4.058129549026489
epoch: 29, iter: 1007, loss: 1.4918608665466309, time cost4.209542512893677
epoch: 29, iter: 1008, loss: 1.8610999584197998, time cost4.119401931762695
epoch: 29, iter: 1009, loss: 1.4374593496322632, time cost4.123819589614868
epoch: 29, iter: 1010, loss: 1.014434814453125, time cost3.936685800552368
epoch: 29, iter: 1011, loss: 1.057271122932434, time cost4.263190269470215
epoch: 29, iter: 1012, loss: 1.2768012285232544, time cost4.153758525848389
epoch: 29, iter: 1013, loss: 1.0404502153396606, time cost4.06046986579895
epoch: 29, iter: 1014, loss: 0.8071250915527344, time cost4.100359201431274
epoch: 29, iter: 1015, loss: 1.2338752746582031, time cost2.9615142345428467
epoch: 29, iter: 1016, loss: 0.9486967325210571, time cost3.338674306869507
epoch: 29, iter: 1017, loss: 1.0332497358322144, time cost4.394750595092773
epoch: 29, iter: 1018, loss: 1.1777139902114868, time cost4.311692953109741
epoch: 29, iter: 1019, loss: 1.0354423522949219, time cost4.155723333358765
epoch: 29, iter: 1020, loss: 0.8056161403656006, time cost3.1327550411224365
epoch: 30, iter: 1021, loss: 0.6601312160491943, time cost4.483387231826782
epoch: 30, iter: 1022, loss: 0.8235617876052856, time cost4.455372095108032
epoch: 30, iter: 1023, loss: 1.5570943355560303, time cost4.226418733596802
epoch: 30, iter: 1024, loss: 0.7797524929046631, time cost4.335068941116333
epoch: 30, iter: 1025, loss: 1.296767234802246, time cost4.463724851608276
epoch: 30, iter: 1026, loss: 1.439218282699585, time cost4.495856046676636
epoch: 30, iter: 1027, loss: 1.2585190534591675, time cost4.368482351303101
epoch: 30, iter: 1028, loss: 1.426318883895874, time cost4.48125147819519
epoch: 30, iter: 1029, loss: 1.109549641609192, time cost4.440073490142822
epoch: 30, iter: 1030, loss: 0.9873760938644409, time cost4.39993691444397
epoch: 30, iter: 1031, loss: 0.7523496747016907, time cost4.316852569580078
epoch: 30, iter: 1032, loss: 1.7137880325317383, time cost4.327163219451904
epoch: 30, iter: 1033, loss: 1.4810773134231567, time cost4.448660373687744
epoch: 30, iter: 1034, loss: 0.8620983362197876, time cost4.379617214202881
epoch: 30, iter: 1035, loss: 1.1258556842803955, time cost4.493492364883423
epoch: 30, iter: 1036, loss: 1.0098797082901, time cost4.534601926803589
epoch: 30, iter: 1037, loss: 0.9699444770812988, time cost4.4299726486206055
epoch: 30, iter: 1038, loss: 1.0588157176971436, time cost4.495518684387207
epoch: 30, iter: 1039, loss: 1.244660496711731, time cost4.571038722991943
epoch: 30, iter: 1040, loss: 0.793309211730957, time cost4.4315345287323
epoch: 30, iter: 1041, loss: 0.7459444999694824, time cost4.4988391399383545
epoch: 30, iter: 1042, loss: 1.2997692823410034, time cost4.444270372390747
epoch: 30, iter: 1043, loss: 1.555885672569275, time cost4.665309429168701
epoch: 30, iter: 1044, loss: 1.803922176361084, time cost4.464664936065674
epoch: 30, iter: 1045, loss: 1.4354044198989868, time cost4.509797096252441
epoch: 30, iter: 1046, loss: 1.0949082374572754, time cost4.214249610900879
epoch: 30, iter: 1047, loss: 1.8616734743118286, time cost3.585519790649414
epoch: 30, iter: 1048, loss: 1.0782899856567383, time cost3.9808413982391357
epoch: 30, iter: 1049, loss: 1.3080270290374756, time cost4.0444581508636475
epoch: 30, iter: 1050, loss: 1.2737685441970825, time cost3.911543130874634
tensor([[208., 201., 214.,  ...,   2.,   2.,   2.],
        [  8.,   9.,   9.,  ...,  11.,  11.,  12.],
        [ 40., 149., 103.,  ...,   3.,   3.,   2.],
        ...,
        [220., 228., 180.,  ...,  16.,  16.,  17.],
        [  8.,   5.,  20.,  ...,   2.,   2.,   2.],
        [ 79., 100., 151.,  ...,  13.,  13.,   3.]])
Epoch: 30, Iteration: 1050:
TEST A@1: 0.43555555555555553
TEST A@5: 0.82
TEST A@10: 0.9066666666666666
TEST M@B: 0.35513993516042586
TEST M@A: 0.9388225693333865
TEST W@MB: 0.18788490023595159
TEST W@MA: 0.5769716361307105
TEST Time: 537.9413208961487
Model Updated
REAL performance: Top1: 0.43555555555555553, Top5: 0.82, Top10: 0.9066666666666666, MB: 0.35513993516042586, MA: 0.9388225693333865, WMB: 0.18788490023595159, WMA: 0.5769716361307105
epoch: 30, iter: 1051, loss: 1.0863444805145264, time cost4.140065670013428
epoch: 30, iter: 1052, loss: 1.3980599641799927, time cost4.066312789916992
epoch: 30, iter: 1053, loss: 1.3085590600967407, time cost4.271898984909058
epoch: 30, iter: 1054, loss: 0.7097636461257935, time cost2.9255361557006836
epoch: 31, iter: 1055, loss: 1.3260059356689453, time cost4.072484016418457
epoch: 31, iter: 1056, loss: 0.7734322547912598, time cost4.257678747177124
epoch: 31, iter: 1057, loss: 0.7490100860595703, time cost4.014098167419434
epoch: 31, iter: 1058, loss: 1.2561371326446533, time cost4.077503681182861
epoch: 31, iter: 1059, loss: 1.2699722051620483, time cost4.061372518539429
epoch: 31, iter: 1060, loss: 1.2756785154342651, time cost4.050498723983765
epoch: 31, iter: 1061, loss: 0.7436615228652954, time cost4.3898231983184814
epoch: 31, iter: 1062, loss: 1.0738083124160767, time cost4.43984842300415
epoch: 31, iter: 1063, loss: 1.8064241409301758, time cost4.254532337188721
epoch: 31, iter: 1064, loss: 1.3057594299316406, time cost4.124530792236328
epoch: 31, iter: 1065, loss: 1.2640310525894165, time cost4.164055824279785
epoch: 31, iter: 1066, loss: 1.0871812105178833, time cost4.091049909591675
epoch: 31, iter: 1067, loss: 0.8268274664878845, time cost4.156038522720337
epoch: 31, iter: 1068, loss: 1.0822598934173584, time cost4.126162528991699
epoch: 31, iter: 1069, loss: 1.2700976133346558, time cost4.01865553855896
epoch: 31, iter: 1070, loss: 1.2233762741088867, time cost4.15386438369751
epoch: 31, iter: 1071, loss: 0.947860598564148, time cost4.123003959655762
epoch: 31, iter: 1072, loss: 1.3351926803588867, time cost3.956587791442871
epoch: 31, iter: 1073, loss: 0.9238762259483337, time cost4.074658393859863
epoch: 31, iter: 1074, loss: 0.6813880205154419, time cost4.213801145553589
epoch: 31, iter: 1075, loss: 1.2802757024765015, time cost3.9292044639587402
epoch: 31, iter: 1076, loss: 1.187726616859436, time cost3.9857540130615234
epoch: 31, iter: 1077, loss: 1.1219743490219116, time cost4.081454038619995
epoch: 31, iter: 1078, loss: 1.2082620859146118, time cost4.043913125991821
epoch: 31, iter: 1079, loss: 0.9204692840576172, time cost4.000910758972168
epoch: 31, iter: 1080, loss: 1.1502580642700195, time cost4.121068477630615
epoch: 31, iter: 1081, loss: 1.2207297086715698, time cost4.125994682312012
epoch: 31, iter: 1082, loss: 0.7057114839553833, time cost3.959209442138672
epoch: 31, iter: 1083, loss: 0.7312731146812439, time cost4.029122591018677
epoch: 31, iter: 1084, loss: 0.7044633626937866, time cost4.021865606307983
epoch: 31, iter: 1085, loss: 1.2622265815734863, time cost4.064125061035156
epoch: 31, iter: 1086, loss: 1.178628921508789, time cost3.997415542602539
epoch: 31, iter: 1087, loss: 0.7376249432563782, time cost4.172797441482544
epoch: 31, iter: 1088, loss: 0.8895922303199768, time cost3.062429666519165
epoch: 32, iter: 1089, loss: 1.4668376445770264, time cost4.1186864376068115
epoch: 32, iter: 1090, loss: 1.1133404970169067, time cost4.057944059371948
epoch: 32, iter: 1091, loss: 1.5296400785446167, time cost4.0310914516448975
epoch: 32, iter: 1092, loss: 0.8087970018386841, time cost4.210750579833984
epoch: 32, iter: 1093, loss: 0.9443422555923462, time cost4.120173215866089
epoch: 32, iter: 1094, loss: 1.0736525058746338, time cost4.098611116409302
epoch: 32, iter: 1095, loss: 0.8615624904632568, time cost4.068994522094727
epoch: 32, iter: 1096, loss: 1.1218513250350952, time cost4.168894529342651
epoch: 32, iter: 1097, loss: 1.0332976579666138, time cost4.044623613357544
epoch: 32, iter: 1098, loss: 1.0308105945587158, time cost4.421784400939941
epoch: 32, iter: 1099, loss: 1.3181802034378052, time cost4.239509105682373
epoch: 32, iter: 1100, loss: 1.0831959247589111, time cost4.2181715965271
tensor([[ 82.,  81.,  97.,  ...,   8.,   8.,   6.],
        [ 22.,  14.,  14.,  ...,   2.,   2.,   1.],
        [ 75., 139.,  91.,  ...,   3.,   3.,   1.],
        ...,
        [ 63.,  64.,  34.,  ...,  23.,  23.,  18.],
        [ 20.,  11.,   9.,  ...,   1.,   1.,   1.],
        [137., 106., 160.,  ...,   5.,   5.,   8.]])
Epoch: 32, Iteration: 1100:
TEST A@1: 0.4888888888888889
TEST A@5: 0.8133333333333334
TEST A@10: 0.9
TEST M@B: 0.3787341227600549
TEST M@A: 0.944456323647783
TEST W@MB: 0.20213599404508614
TEST W@MA: 0.5817264444488689
TEST Time: 531.9413228034973
Model Updated
REAL performance: Top1: 0.4888888888888889, Top5: 0.8133333333333334, Top10: 0.9, MB: 0.3787341227600549, MA: 0.944456323647783, WMB: 0.20213599404508614, WMA: 0.5817264444488689
epoch: 32, iter: 1101, loss: 1.198539137840271, time cost4.214449644088745
epoch: 32, iter: 1102, loss: 1.0099374055862427, time cost4.0531322956085205
epoch: 32, iter: 1103, loss: 1.2910850048065186, time cost4.279296636581421
epoch: 32, iter: 1104, loss: 1.5559346675872803, time cost4.164194583892822
epoch: 32, iter: 1105, loss: 0.8447734117507935, time cost3.9924628734588623
epoch: 32, iter: 1106, loss: 1.7071255445480347, time cost4.215720891952515
epoch: 32, iter: 1107, loss: 1.0349907875061035, time cost3.926283121109009
epoch: 32, iter: 1108, loss: 1.009538173675537, time cost4.003126859664917
epoch: 32, iter: 1109, loss: 0.9500608444213867, time cost4.1376824378967285
epoch: 32, iter: 1110, loss: 1.0830917358398438, time cost4.06459903717041
epoch: 32, iter: 1111, loss: 0.9295534491539001, time cost4.292174816131592
epoch: 32, iter: 1112, loss: 0.7996809482574463, time cost4.163259983062744
epoch: 32, iter: 1113, loss: 1.2433927059173584, time cost4.1788530349731445
epoch: 32, iter: 1114, loss: 1.0445820093154907, time cost4.16744327545166
epoch: 32, iter: 1115, loss: 0.8504518270492554, time cost4.1762800216674805
epoch: 32, iter: 1116, loss: 1.2895681858062744, time cost4.135540723800659
epoch: 32, iter: 1117, loss: 1.7999378442764282, time cost4.144053936004639
epoch: 32, iter: 1118, loss: 1.2016897201538086, time cost4.030196905136108
epoch: 32, iter: 1119, loss: 1.2668699026107788, time cost4.042791366577148
epoch: 32, iter: 1120, loss: 0.8380275964736938, time cost4.34730339050293
epoch: 32, iter: 1121, loss: 1.092594861984253, time cost4.224088907241821
epoch: 32, iter: 1122, loss: 1.3658490180969238, time cost3.030472993850708
epoch: 33, iter: 1123, loss: 0.750758171081543, time cost4.2097697257995605
epoch: 33, iter: 1124, loss: 0.9689306020736694, time cost4.163822889328003
epoch: 33, iter: 1125, loss: 0.8443439602851868, time cost4.16096568107605
epoch: 33, iter: 1126, loss: 1.2508472204208374, time cost4.1486358642578125
epoch: 33, iter: 1127, loss: 1.181388258934021, time cost4.302850246429443
epoch: 33, iter: 1128, loss: 0.8488304615020752, time cost4.184255838394165
epoch: 33, iter: 1129, loss: 0.6626852750778198, time cost3.9522907733917236
epoch: 33, iter: 1130, loss: 1.133808970451355, time cost4.179317474365234
epoch: 33, iter: 1131, loss: 1.2405556440353394, time cost4.12056303024292
epoch: 33, iter: 1132, loss: 1.523319125175476, time cost4.180935382843018
epoch: 33, iter: 1133, loss: 0.9755074977874756, time cost4.111620664596558
epoch: 33, iter: 1134, loss: 1.1914434432983398, time cost4.26692008972168
epoch: 33, iter: 1135, loss: 1.4990143775939941, time cost4.220640659332275
epoch: 33, iter: 1136, loss: 1.2352875471115112, time cost4.122695684432983
epoch: 33, iter: 1137, loss: 1.2605197429656982, time cost4.322134494781494
epoch: 33, iter: 1138, loss: 0.8723195791244507, time cost4.326432466506958
epoch: 33, iter: 1139, loss: 0.9724856615066528, time cost4.145536661148071
epoch: 33, iter: 1140, loss: 0.633169949054718, time cost4.0923402309417725
epoch: 33, iter: 1141, loss: 1.10586678981781, time cost4.209367275238037
epoch: 33, iter: 1142, loss: 0.8032795786857605, time cost4.087385416030884
epoch: 33, iter: 1143, loss: 0.9929596781730652, time cost4.105499505996704
epoch: 33, iter: 1144, loss: 0.936317503452301, time cost4.172487497329712
epoch: 33, iter: 1145, loss: 0.9184308052062988, time cost4.376850366592407
epoch: 33, iter: 1146, loss: 1.2579785585403442, time cost4.149242639541626
epoch: 33, iter: 1147, loss: 1.3494786024093628, time cost4.231749057769775
epoch: 33, iter: 1148, loss: 1.1897869110107422, time cost4.0135180950164795
epoch: 33, iter: 1149, loss: 0.9450079202651978, time cost4.246236801147461
epoch: 33, iter: 1150, loss: 0.9168129563331604, time cost4.0137248039245605
tensor([[117., 113., 130.,  ...,   2.,   2.,   1.],
        [ 14.,  14.,  13.,  ...,   6.,   6.,   3.],
        [ 47., 122.,  49.,  ...,   2.,   2.,   1.],
        ...,
        [115., 119.,  71.,  ...,  16.,  16.,  10.],
        [ 19.,  14.,  12.,  ...,   1.,   1.,   1.],
        [ 96., 100., 162.,  ...,  11.,  11.,  23.]])
Epoch: 33, Iteration: 1150:
TEST A@1: 0.5155555555555555
TEST A@5: 0.8555555555555555
TEST A@10: 0.94
TEST M@B: 0.39635164502169196
TEST M@A: 0.9467796523219552
TEST W@MB: 0.21074742869268315
TEST W@MA: 0.583053714710171
TEST Time: 538.0588858127594
Model Updated
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 33, iter: 1151, loss: 0.8855319619178772, time cost3.932654857635498
epoch: 33, iter: 1152, loss: 0.766630232334137, time cost3.859147787094116
epoch: 33, iter: 1153, loss: 1.3966190814971924, time cost4.165006637573242
epoch: 33, iter: 1154, loss: 1.1879234313964844, time cost4.051071643829346
epoch: 33, iter: 1155, loss: 0.9871655106544495, time cost4.087201356887817
epoch: 33, iter: 1156, loss: 1.0033193826675415, time cost2.925434112548828
epoch: 34, iter: 1157, loss: 0.9848584532737732, time cost4.339223861694336
epoch: 34, iter: 1158, loss: 0.824865460395813, time cost4.6087892055511475
epoch: 34, iter: 1159, loss: 0.8649560213088989, time cost4.310869455337524
epoch: 34, iter: 1160, loss: 1.1273794174194336, time cost4.161266803741455
epoch: 34, iter: 1161, loss: 1.3377375602722168, time cost4.134932279586792
epoch: 34, iter: 1162, loss: 0.8862119913101196, time cost4.214926242828369
epoch: 34, iter: 1163, loss: 1.1443063020706177, time cost4.133850574493408
epoch: 34, iter: 1164, loss: 1.2693933248519897, time cost4.149097442626953
epoch: 34, iter: 1165, loss: 1.3888249397277832, time cost4.1453375816345215
epoch: 34, iter: 1166, loss: 1.633323311805725, time cost4.175910949707031
epoch: 34, iter: 1167, loss: 0.6980451941490173, time cost4.064857006072998
epoch: 34, iter: 1168, loss: 1.3111662864685059, time cost4.217716932296753
epoch: 34, iter: 1169, loss: 0.9487573504447937, time cost3.9494524002075195
epoch: 34, iter: 1170, loss: 1.5617808103561401, time cost4.037989139556885
epoch: 34, iter: 1171, loss: 1.1923094987869263, time cost4.1810102462768555
epoch: 34, iter: 1172, loss: 1.6588490009307861, time cost4.1999006271362305
epoch: 34, iter: 1173, loss: 1.26479971408844, time cost4.285426378250122
epoch: 34, iter: 1174, loss: 1.0924211740493774, time cost4.052520275115967
epoch: 34, iter: 1175, loss: 1.7243061065673828, time cost4.023038625717163
epoch: 34, iter: 1176, loss: 1.0423065423965454, time cost3.9896352291107178
epoch: 34, iter: 1177, loss: 0.9290661215782166, time cost3.9641835689544678
epoch: 34, iter: 1178, loss: 0.9582745432853699, time cost4.030583143234253
epoch: 34, iter: 1179, loss: 1.7820266485214233, time cost4.109937429428101
epoch: 34, iter: 1180, loss: 1.2547345161437988, time cost4.122092008590698
epoch: 34, iter: 1181, loss: 1.0578807592391968, time cost4.152768135070801
epoch: 34, iter: 1182, loss: 1.7324668169021606, time cost4.001545667648315
epoch: 34, iter: 1183, loss: 0.9392061829566956, time cost4.1686811447143555
epoch: 34, iter: 1184, loss: 1.279471755027771, time cost4.061946153640747
epoch: 34, iter: 1185, loss: 1.3644095659255981, time cost4.0087385177612305
epoch: 34, iter: 1186, loss: 0.9427368640899658, time cost4.1187450885772705
epoch: 34, iter: 1187, loss: 1.2428102493286133, time cost4.111640930175781
epoch: 34, iter: 1188, loss: 1.1295956373214722, time cost3.93666672706604
epoch: 34, iter: 1189, loss: 1.570986032485962, time cost3.940833568572998
epoch: 34, iter: 1190, loss: 0.4378170967102051, time cost2.9719274044036865
epoch: 35, iter: 1191, loss: 0.773419976234436, time cost3.9974770545959473
epoch: 35, iter: 1192, loss: 1.4422588348388672, time cost4.081864595413208
epoch: 35, iter: 1193, loss: 0.9997811317443848, time cost4.167406797409058
epoch: 35, iter: 1194, loss: 0.7844744920730591, time cost4.173678636550903
epoch: 35, iter: 1195, loss: 0.9756672978401184, time cost4.151556730270386
epoch: 35, iter: 1196, loss: 1.007785439491272, time cost4.235768556594849
epoch: 35, iter: 1197, loss: 1.0094612836837769, time cost4.22957181930542
epoch: 35, iter: 1198, loss: 1.0784320831298828, time cost4.125874280929565
epoch: 35, iter: 1199, loss: 1.1550774574279785, time cost3.638894557952881
epoch: 35, iter: 1200, loss: 1.1857786178588867, time cost2.9278652667999268
tensor([[286., 246., 261.,  ...,   1.,   1.,   1.],
        [ 29.,  18.,  19.,  ...,   2.,   2.,   1.],
        [ 74., 146.,  83.,  ...,  14.,  14.,   9.],
        ...,
        [221., 250., 147.,  ...,  21.,  21.,  22.],
        [ 11.,   5.,   3.,  ...,   1.,   1.,   1.],
        [329., 271., 332.,  ...,  18.,  18.,  19.]])
Epoch: 35, Iteration: 1200:
TEST A@1: 0.44222222222222224
TEST A@5: 0.8266666666666667
TEST A@10: 0.9355555555555556
TEST M@B: 0.37783591921792425
TEST M@A: 0.9430807805218188
TEST W@MB: 0.20115055961898642
TEST W@MA: 0.5798462761355287
TEST Time: 561.5018072128296
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 35, iter: 1201, loss: 1.176759958267212, time cost4.103939771652222
epoch: 35, iter: 1202, loss: 1.0307321548461914, time cost4.4192540645599365
epoch: 35, iter: 1203, loss: 1.3937567472457886, time cost4.639051675796509
epoch: 35, iter: 1204, loss: 0.9302456378936768, time cost4.328130722045898
epoch: 35, iter: 1205, loss: 1.047669768333435, time cost4.412006616592407
epoch: 35, iter: 1206, loss: 1.0249743461608887, time cost4.471920013427734
epoch: 35, iter: 1207, loss: 0.7269395589828491, time cost4.446917533874512
epoch: 35, iter: 1208, loss: 2.038174867630005, time cost4.491316795349121
epoch: 35, iter: 1209, loss: 1.11980402469635, time cost4.2372965812683105
epoch: 35, iter: 1210, loss: 1.2698553800582886, time cost4.460612773895264
epoch: 35, iter: 1211, loss: 1.0143439769744873, time cost4.379990339279175
epoch: 35, iter: 1212, loss: 1.379376769065857, time cost4.4088664054870605
epoch: 35, iter: 1213, loss: 1.6477041244506836, time cost4.306894302368164
epoch: 35, iter: 1214, loss: 1.3990495204925537, time cost4.398606061935425
epoch: 35, iter: 1215, loss: 1.348215937614441, time cost4.169037818908691
epoch: 35, iter: 1216, loss: 0.8007278442382812, time cost4.3583550453186035
epoch: 35, iter: 1217, loss: 0.6993067860603333, time cost4.39557671546936
epoch: 35, iter: 1218, loss: 1.4813700914382935, time cost4.537950277328491
epoch: 35, iter: 1219, loss: 0.8174548149108887, time cost3.114499807357788
epoch: 35, iter: 1220, loss: 1.4393078088760376, time cost4.181267261505127
epoch: 35, iter: 1221, loss: 0.8675288558006287, time cost4.02964448928833
epoch: 35, iter: 1222, loss: 1.4859633445739746, time cost4.1595563888549805
epoch: 35, iter: 1223, loss: 1.1510367393493652, time cost4.066992521286011
epoch: 35, iter: 1224, loss: 0.8298147916793823, time cost2.948294162750244
epoch: 36, iter: 1225, loss: 1.046818733215332, time cost4.140867710113525
epoch: 36, iter: 1226, loss: 1.0386247634887695, time cost4.227333307266235
epoch: 36, iter: 1227, loss: 1.0865157842636108, time cost4.040271997451782
epoch: 36, iter: 1228, loss: 1.017134189605713, time cost4.239349842071533
epoch: 36, iter: 1229, loss: 1.125540852546692, time cost4.1529622077941895
epoch: 36, iter: 1230, loss: 1.1506282091140747, time cost4.31723690032959
epoch: 36, iter: 1231, loss: 0.6238182783126831, time cost4.423254013061523
epoch: 36, iter: 1232, loss: 0.8653756380081177, time cost4.193470478057861
epoch: 36, iter: 1233, loss: 1.3559616804122925, time cost4.133481979370117
epoch: 36, iter: 1234, loss: 1.0368369817733765, time cost4.190296173095703
epoch: 36, iter: 1235, loss: 0.8110526204109192, time cost4.308433294296265
epoch: 36, iter: 1236, loss: 1.6627817153930664, time cost4.3018927574157715
epoch: 36, iter: 1237, loss: 1.341238021850586, time cost4.157894134521484
epoch: 36, iter: 1238, loss: 1.362043857574463, time cost4.185922861099243
epoch: 36, iter: 1239, loss: 1.1392523050308228, time cost4.261762857437134
epoch: 36, iter: 1240, loss: 1.1716192960739136, time cost4.347491025924683
epoch: 36, iter: 1241, loss: 1.2903738021850586, time cost4.368928909301758
epoch: 36, iter: 1242, loss: 0.6967437267303467, time cost4.135850429534912
epoch: 36, iter: 1243, loss: 1.2236573696136475, time cost4.448668718338013
epoch: 36, iter: 1244, loss: 0.7536529302597046, time cost4.251262903213501
epoch: 36, iter: 1245, loss: 1.9395067691802979, time cost4.052635431289673
epoch: 36, iter: 1246, loss: 1.6300899982452393, time cost4.103994846343994
epoch: 36, iter: 1247, loss: 1.5239859819412231, time cost4.0543532371521
epoch: 36, iter: 1248, loss: 0.9274478554725647, time cost4.245652675628662
epoch: 36, iter: 1249, loss: 1.6912363767623901, time cost4.186342239379883
epoch: 36, iter: 1250, loss: 0.8830862641334534, time cost4.093822717666626
tensor([[253., 242., 243.,  ...,   4.,   4.,   4.],
        [ 43.,  35.,  35.,  ...,  10.,  10.,   6.],
        [128., 221., 135.,  ...,  22.,  22.,  11.],
        ...,
        [207., 218., 171.,  ...,  29.,  29.,  25.],
        [ 30.,  25.,  24.,  ...,   2.,   2.,   1.],
        [102., 109., 194.,  ...,  35.,  35.,  28.]])
Epoch: 36, Iteration: 1250:
TEST A@1: 0.3288888888888889
TEST A@5: 0.6777777777777778
TEST A@10: 0.8222222222222222
TEST M@B: 0.2938584851849545
TEST M@A: 0.9305150786285097
TEST W@MB: 0.15602319326714068
TEST W@MA: 0.5708671440307023
TEST Time: 552.2982294559479
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 36, iter: 1251, loss: 1.2136683464050293, time cost4.051425218582153
epoch: 36, iter: 1252, loss: 1.0427474975585938, time cost4.112707853317261
epoch: 36, iter: 1253, loss: 1.5131891965866089, time cost4.107380628585815
epoch: 36, iter: 1254, loss: 1.7173527479171753, time cost3.986745595932007
epoch: 36, iter: 1255, loss: 1.0328917503356934, time cost4.188011169433594
epoch: 36, iter: 1256, loss: 1.301547884941101, time cost4.043642044067383
epoch: 36, iter: 1257, loss: 1.6842041015625, time cost4.221514701843262
epoch: 36, iter: 1258, loss: 1.5008574724197388, time cost2.8788352012634277
epoch: 37, iter: 1259, loss: 1.3681837320327759, time cost4.245253324508667
epoch: 37, iter: 1260, loss: 1.0397273302078247, time cost4.1623828411102295
epoch: 37, iter: 1261, loss: 0.8595476150512695, time cost3.940018892288208
epoch: 37, iter: 1262, loss: 1.6690447330474854, time cost4.1482226848602295
epoch: 37, iter: 1263, loss: 1.3597451448440552, time cost4.078312873840332
epoch: 37, iter: 1264, loss: 1.6271835565567017, time cost4.1351318359375
epoch: 37, iter: 1265, loss: 1.2433093786239624, time cost4.143641233444214
epoch: 37, iter: 1266, loss: 1.2344542741775513, time cost4.041699171066284
epoch: 37, iter: 1267, loss: 0.6366492509841919, time cost4.333249807357788
epoch: 37, iter: 1268, loss: 1.7317744493484497, time cost4.0825231075286865
epoch: 37, iter: 1269, loss: 1.74796724319458, time cost4.137372970581055
epoch: 37, iter: 1270, loss: 1.6187371015548706, time cost4.083065986633301
epoch: 37, iter: 1271, loss: 1.047772765159607, time cost4.352146863937378
epoch: 37, iter: 1272, loss: 1.0869754552841187, time cost4.13637113571167
epoch: 37, iter: 1273, loss: 0.892671525478363, time cost4.1546032428741455
epoch: 37, iter: 1274, loss: 1.1844897270202637, time cost4.513070821762085
epoch: 37, iter: 1275, loss: 1.1838446855545044, time cost4.13546085357666
epoch: 37, iter: 1276, loss: 1.180678129196167, time cost4.405567169189453
epoch: 37, iter: 1277, loss: 0.9119141101837158, time cost4.077678918838501
epoch: 37, iter: 1278, loss: 1.4209033250808716, time cost4.0538787841796875
epoch: 37, iter: 1279, loss: 1.1153644323349, time cost4.073395013809204
epoch: 37, iter: 1280, loss: 0.9109847545623779, time cost4.0719358921051025
epoch: 37, iter: 1281, loss: 1.286588191986084, time cost3.828009605407715
epoch: 37, iter: 1282, loss: 0.6781482696533203, time cost4.074446439743042
epoch: 37, iter: 1283, loss: 1.089470624923706, time cost4.229816675186157
epoch: 37, iter: 1284, loss: 0.9375791549682617, time cost4.177342176437378
epoch: 37, iter: 1285, loss: 1.6597214937210083, time cost4.185405492782593
epoch: 37, iter: 1286, loss: 1.195091962814331, time cost4.036555290222168
epoch: 37, iter: 1287, loss: 1.4546657800674438, time cost4.281635999679565
epoch: 37, iter: 1288, loss: 1.9213716983795166, time cost4.093898296356201
epoch: 37, iter: 1289, loss: 0.86723792552948, time cost4.19821310043335
epoch: 37, iter: 1290, loss: 0.9245635867118835, time cost4.415739297866821
epoch: 37, iter: 1291, loss: 1.3413110971450806, time cost4.562695026397705
epoch: 37, iter: 1292, loss: 0.2914450764656067, time cost3.1020917892456055
epoch: 38, iter: 1293, loss: 1.5805442333221436, time cost4.350233554840088
epoch: 38, iter: 1294, loss: 1.2856725454330444, time cost4.327622413635254
epoch: 38, iter: 1295, loss: 1.8271839618682861, time cost4.483543395996094
epoch: 38, iter: 1296, loss: 1.4617291688919067, time cost4.186056137084961
epoch: 38, iter: 1297, loss: 1.1853290796279907, time cost4.4065258502960205
epoch: 38, iter: 1298, loss: 1.684112310409546, time cost4.330699682235718
epoch: 38, iter: 1299, loss: 1.0915675163269043, time cost4.33885645866394
epoch: 38, iter: 1300, loss: 0.8981110453605652, time cost4.457846641540527
tensor([[153., 134., 148.,  ...,   5.,   5.,   4.],
        [ 26.,  24.,  24.,  ...,   6.,   6.,   4.],
        [122., 232., 228.,  ...,   6.,   6.,   2.],
        ...,
        [ 80.,  77.,  59.,  ...,  17.,  17.,  17.],
        [100.,  40.,  29.,  ...,   2.,   2.,   2.],
        [ 24.,  41.,  57.,  ...,   6.,   6.,   8.]])
Epoch: 38, Iteration: 1300:
TEST A@1: 0.2733333333333333
TEST A@5: 0.6377777777777778
TEST A@10: 0.78
TEST M@B: 0.2664628725845362
TEST M@A: 0.9216715815435681
TEST W@MB: 0.14117288583551782
TEST W@MA: 0.564393853402851
TEST Time: 546.0125932693481
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 38, iter: 1301, loss: 1.1065778732299805, time cost4.110605478286743
epoch: 38, iter: 1302, loss: 1.4614155292510986, time cost4.232017517089844
epoch: 38, iter: 1303, loss: 1.5430198907852173, time cost4.303632497787476
epoch: 38, iter: 1304, loss: 1.3110876083374023, time cost4.266230583190918
epoch: 38, iter: 1305, loss: 1.285984992980957, time cost4.254104375839233
epoch: 38, iter: 1306, loss: 1.3300564289093018, time cost4.045095920562744
epoch: 38, iter: 1307, loss: 1.3999665975570679, time cost4.153784275054932
epoch: 38, iter: 1308, loss: 1.09147047996521, time cost4.521417856216431
epoch: 38, iter: 1309, loss: 0.9406235814094543, time cost4.505761623382568
epoch: 38, iter: 1310, loss: 1.1717396974563599, time cost4.215817451477051
epoch: 38, iter: 1311, loss: 0.814612090587616, time cost4.304764270782471
epoch: 38, iter: 1312, loss: 1.1599431037902832, time cost4.097308397293091
epoch: 38, iter: 1313, loss: 1.6317020654678345, time cost4.055187702178955
epoch: 38, iter: 1314, loss: 1.4804834127426147, time cost4.360475063323975
epoch: 38, iter: 1315, loss: 1.4019991159439087, time cost4.133599042892456
epoch: 38, iter: 1316, loss: 0.8681865334510803, time cost4.192946195602417
epoch: 38, iter: 1317, loss: 1.121275782585144, time cost4.22978401184082
epoch: 38, iter: 1318, loss: 1.4135708808898926, time cost3.978317975997925
epoch: 38, iter: 1319, loss: 1.3868162631988525, time cost4.48445200920105
epoch: 38, iter: 1320, loss: 1.2807531356811523, time cost4.196186065673828
epoch: 38, iter: 1321, loss: 0.7721231579780579, time cost4.450073719024658
epoch: 38, iter: 1322, loss: 1.0898187160491943, time cost4.292123079299927
epoch: 38, iter: 1323, loss: 0.9648192524909973, time cost4.416810035705566
epoch: 38, iter: 1324, loss: 1.3387982845306396, time cost4.124942064285278
epoch: 38, iter: 1325, loss: 1.7461789846420288, time cost4.285109281539917
epoch: 38, iter: 1326, loss: 1.119776725769043, time cost3.0981500148773193
epoch: 39, iter: 1327, loss: 1.1371210813522339, time cost4.19507360458374
epoch: 39, iter: 1328, loss: 1.1539117097854614, time cost4.2261810302734375
epoch: 39, iter: 1329, loss: 0.9011508226394653, time cost4.216522932052612
epoch: 39, iter: 1330, loss: 0.7314996719360352, time cost4.223624229431152
epoch: 39, iter: 1331, loss: 1.3749663829803467, time cost4.2789082527160645
epoch: 39, iter: 1332, loss: 1.30451238155365, time cost4.437028884887695
epoch: 39, iter: 1333, loss: 1.9885846376419067, time cost4.188024282455444
epoch: 39, iter: 1334, loss: 1.1376479864120483, time cost4.254637718200684
epoch: 39, iter: 1335, loss: 2.0127875804901123, time cost4.183861970901489
epoch: 39, iter: 1336, loss: 1.102192997932434, time cost4.60913872718811
epoch: 39, iter: 1337, loss: 1.6272485256195068, time cost4.55073618888855
epoch: 39, iter: 1338, loss: 1.042330026626587, time cost4.444000005722046
epoch: 39, iter: 1339, loss: 1.1938267946243286, time cost4.444140911102295
epoch: 39, iter: 1340, loss: 1.2182667255401611, time cost4.175072193145752
epoch: 39, iter: 1341, loss: 0.5922982096672058, time cost4.214053392410278
epoch: 39, iter: 1342, loss: 2.0191845893859863, time cost4.211912393569946
epoch: 39, iter: 1343, loss: 0.8501476645469666, time cost4.240565538406372
epoch: 39, iter: 1344, loss: 1.2867838144302368, time cost4.570185422897339
epoch: 39, iter: 1345, loss: 1.8642613887786865, time cost4.199236631393433
epoch: 39, iter: 1346, loss: 1.3059810400009155, time cost4.129706382751465
epoch: 39, iter: 1347, loss: 1.0914074182510376, time cost4.465310335159302
epoch: 39, iter: 1348, loss: 1.1430301666259766, time cost4.505736351013184
epoch: 39, iter: 1349, loss: 0.9216607213020325, time cost4.582548141479492
epoch: 39, iter: 1350, loss: 1.7750033140182495, time cost4.518309116363525
tensor([[ 76.,  69.,  74.,  ...,   6.,   6.,   5.],
        [ 65.,  62.,  61.,  ...,  13.,  13.,  11.],
        [106., 177.,  95.,  ...,  13.,  13.,   7.],
        ...,
        [ 94.,  97.,  67.,  ...,  32.,  32.,  24.],
        [ 80.,  47.,  21.,  ...,   4.,   4.,   4.],
        [138.,  88., 122.,  ...,   6.,   6.,  11.]])
Epoch: 39, Iteration: 1350:
TEST A@1: 0.31555555555555553
TEST A@5: 0.68
TEST A@10: 0.8333333333333334
TEST M@B: 0.27184940616745573
TEST M@A: 0.9271066578908691
TEST W@MB: 0.14445502293397736
TEST W@MA: 0.5685716857317986
TEST Time: 542.7638325691223
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 39, iter: 1351, loss: 1.0383065938949585, time cost3.9976212978363037
epoch: 39, iter: 1352, loss: 1.3623870611190796, time cost4.383204936981201
epoch: 39, iter: 1353, loss: 1.1623364686965942, time cost4.079010486602783
epoch: 39, iter: 1354, loss: 1.524261713027954, time cost4.011453866958618
epoch: 39, iter: 1355, loss: 1.2710353136062622, time cost4.032675743103027
epoch: 39, iter: 1356, loss: 1.145490288734436, time cost4.179595232009888
epoch: 39, iter: 1357, loss: 0.9531968832015991, time cost4.235550165176392
epoch: 39, iter: 1358, loss: 1.6990410089492798, time cost4.209290981292725
epoch: 39, iter: 1359, loss: 1.0714390277862549, time cost4.280537366867065
epoch: 39, iter: 1360, loss: 1.3788832426071167, time cost2.9375510215759277
epoch: 40, iter: 1361, loss: 1.6218138933181763, time cost4.1870880126953125
epoch: 40, iter: 1362, loss: 1.2733134031295776, time cost4.191187858581543
epoch: 40, iter: 1363, loss: 1.0664863586425781, time cost4.248719930648804
epoch: 40, iter: 1364, loss: 1.0468732118606567, time cost4.155301094055176
epoch: 40, iter: 1365, loss: 1.350704550743103, time cost4.302923202514648
epoch: 40, iter: 1366, loss: 0.8541563749313354, time cost4.337947368621826
epoch: 40, iter: 1367, loss: 0.5973945260047913, time cost4.255613803863525
epoch: 40, iter: 1368, loss: 0.6227405667304993, time cost4.210710287094116
epoch: 40, iter: 1369, loss: 1.2169381380081177, time cost4.102029085159302
epoch: 40, iter: 1370, loss: 1.388714075088501, time cost4.24270486831665
epoch: 40, iter: 1371, loss: 0.9625571966171265, time cost3.957843542098999
epoch: 40, iter: 1372, loss: 1.460788369178772, time cost4.106801271438599
epoch: 40, iter: 1373, loss: 1.7166732549667358, time cost4.218412160873413
epoch: 40, iter: 1374, loss: 1.245951533317566, time cost4.152314901351929
epoch: 40, iter: 1375, loss: 1.1385358572006226, time cost4.273266315460205
epoch: 40, iter: 1376, loss: 1.1060653924942017, time cost4.2423412799835205
epoch: 40, iter: 1377, loss: 1.3995784521102905, time cost4.1773693561553955
epoch: 40, iter: 1378, loss: 1.3312318325042725, time cost3.6542868614196777
epoch: 40, iter: 1379, loss: 1.205963134765625, time cost3.5556106567382812
epoch: 40, iter: 1380, loss: 1.4915320873260498, time cost4.396015882492065
epoch: 40, iter: 1381, loss: 1.1548413038253784, time cost4.489976644515991
epoch: 40, iter: 1382, loss: 1.4937119483947754, time cost4.349271535873413
epoch: 40, iter: 1383, loss: 1.1100581884384155, time cost4.202093839645386
epoch: 40, iter: 1384, loss: 1.2011102437973022, time cost4.285184383392334
epoch: 40, iter: 1385, loss: 1.17214834690094, time cost4.267215013504028
epoch: 40, iter: 1386, loss: 1.250313639640808, time cost4.426378488540649
epoch: 40, iter: 1387, loss: 0.830954909324646, time cost4.3968281745910645
epoch: 40, iter: 1388, loss: 1.0944632291793823, time cost4.468745470046997
epoch: 40, iter: 1389, loss: 0.9966574907302856, time cost4.259095907211304
epoch: 40, iter: 1390, loss: 1.1674909591674805, time cost4.561774015426636
epoch: 40, iter: 1391, loss: 1.1993722915649414, time cost4.182658672332764
epoch: 40, iter: 1392, loss: 1.6461987495422363, time cost4.277779817581177
epoch: 40, iter: 1393, loss: 1.271820306777954, time cost4.340712547302246
epoch: 40, iter: 1394, loss: 0.8312814235687256, time cost3.113464832305908
epoch: 41, iter: 1395, loss: 1.3619763851165771, time cost4.564131498336792
epoch: 41, iter: 1396, loss: 1.4066085815429688, time cost4.4871203899383545
epoch: 41, iter: 1397, loss: 1.7946629524230957, time cost4.38597297668457
epoch: 41, iter: 1398, loss: 1.370180368423462, time cost4.58273983001709
epoch: 41, iter: 1399, loss: 1.2090749740600586, time cost4.188467264175415
epoch: 41, iter: 1400, loss: 1.6157188415527344, time cost4.5192413330078125
tensor([[109.,  96.,  96.,  ...,   1.,   1.,   1.],
        [ 79.,  46.,  47.,  ...,  10.,  10.,   8.],
        [106., 171., 116.,  ...,   6.,   6.,   2.],
        ...,
        [ 24.,  28.,  14.,  ...,   7.,   7.,   5.],
        [ 78.,  54.,  21.,  ...,   4.,   4.,   2.],
        [ 80.,  53.,  81.,  ...,   8.,   8.,   6.]])
Epoch: 41, Iteration: 1400:
TEST A@1: 0.4488888888888889
TEST A@5: 0.7755555555555556
TEST A@10: 0.8888888888888888
TEST M@B: 0.3405188792883074
TEST M@A: 0.9352372475788664
TEST W@MB: 0.17914261189700786
TEST W@MA: 0.5738992015728737
TEST Time: 520.9109926223755
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 41, iter: 1401, loss: 0.34107136726379395, time cost4.085539102554321
epoch: 41, iter: 1402, loss: 1.1351954936981201, time cost4.183515310287476
epoch: 41, iter: 1403, loss: 0.8891541957855225, time cost4.121373414993286
epoch: 41, iter: 1404, loss: 1.4288761615753174, time cost4.2100419998168945
epoch: 41, iter: 1405, loss: 0.8729057312011719, time cost4.234352111816406
epoch: 41, iter: 1406, loss: 1.1999045610427856, time cost4.31193208694458
epoch: 41, iter: 1407, loss: 1.5828237533569336, time cost4.1856467723846436
epoch: 41, iter: 1408, loss: 1.3972108364105225, time cost4.194701671600342
epoch: 41, iter: 1409, loss: 1.515333652496338, time cost4.247887849807739
epoch: 41, iter: 1410, loss: 1.3171571493148804, time cost4.1594061851501465
epoch: 41, iter: 1411, loss: 1.004298210144043, time cost4.084183931350708
epoch: 41, iter: 1412, loss: 0.9162321090698242, time cost4.204957008361816
epoch: 41, iter: 1413, loss: 0.7714296579360962, time cost4.247898817062378
epoch: 41, iter: 1414, loss: 1.5818935632705688, time cost4.174665689468384
epoch: 41, iter: 1415, loss: 1.6283416748046875, time cost4.119002819061279
epoch: 41, iter: 1416, loss: 1.2931221723556519, time cost4.349124431610107
epoch: 41, iter: 1417, loss: 1.5208899974822998, time cost4.112482309341431
epoch: 41, iter: 1418, loss: 1.0542702674865723, time cost4.147834777832031
epoch: 41, iter: 1419, loss: 1.0826380252838135, time cost4.530287981033325
epoch: 41, iter: 1420, loss: 1.2549524307250977, time cost4.3153016567230225
epoch: 41, iter: 1421, loss: 0.8508334755897522, time cost4.170217752456665
epoch: 41, iter: 1422, loss: 1.3349202871322632, time cost4.237446308135986
epoch: 41, iter: 1423, loss: 0.904527485370636, time cost4.083774089813232
epoch: 41, iter: 1424, loss: 1.9808415174484253, time cost4.057278394699097
epoch: 41, iter: 1425, loss: 1.9474369287490845, time cost4.108887434005737
epoch: 41, iter: 1426, loss: 1.7681639194488525, time cost4.115406513214111
epoch: 41, iter: 1427, loss: 1.6414602994918823, time cost4.01597261428833
epoch: 41, iter: 1428, loss: 0.4720040559768677, time cost3.31333589553833
epoch: 42, iter: 1429, loss: 0.9317377209663391, time cost4.587168455123901
epoch: 42, iter: 1430, loss: 0.8650423884391785, time cost4.225948333740234
epoch: 42, iter: 1431, loss: 1.3019731044769287, time cost4.0611467361450195
epoch: 42, iter: 1432, loss: 0.7960513830184937, time cost4.166662931442261
epoch: 42, iter: 1433, loss: 1.486231803894043, time cost4.289759159088135
epoch: 42, iter: 1434, loss: 1.6350349187850952, time cost4.192262649536133
epoch: 42, iter: 1435, loss: 1.5149394273757935, time cost4.3756914138793945
epoch: 42, iter: 1436, loss: 1.7905292510986328, time cost4.123194694519043
epoch: 42, iter: 1437, loss: 1.5314760208129883, time cost4.124863862991333
epoch: 42, iter: 1438, loss: 1.2811275720596313, time cost4.006863832473755
epoch: 42, iter: 1439, loss: 0.8198384046554565, time cost4.139784097671509
epoch: 42, iter: 1440, loss: 1.2315282821655273, time cost4.629170656204224
epoch: 42, iter: 1441, loss: 1.1287307739257812, time cost4.245916366577148
epoch: 42, iter: 1442, loss: 0.874085545539856, time cost4.175123691558838
epoch: 42, iter: 1443, loss: 1.2011722326278687, time cost4.433437347412109
epoch: 42, iter: 1444, loss: 1.3571672439575195, time cost4.274893760681152
epoch: 42, iter: 1445, loss: 0.6112536191940308, time cost4.344473838806152
epoch: 42, iter: 1446, loss: 1.6116080284118652, time cost4.193609714508057
epoch: 42, iter: 1447, loss: 1.6367554664611816, time cost4.121773958206177
epoch: 42, iter: 1448, loss: 1.1895266771316528, time cost3.57170033454895
epoch: 42, iter: 1449, loss: 1.4924521446228027, time cost3.4223544597625732
epoch: 42, iter: 1450, loss: 1.36295485496521, time cost3.8439691066741943
tensor([[180., 139., 142.,  ...,   1.,   1.,   1.],
        [  2.,   2.,   2.,  ...,   3.,   3.,   1.],
        [ 51.,  97.,  72.,  ...,  12.,  12.,   8.],
        ...,
        [135., 147., 102.,  ...,  20.,  20.,  17.],
        [ 95.,  46.,  40.,  ...,   5.,   5.,   4.],
        [121.,  46.,  97.,  ...,   4.,   4.,   4.]])
Epoch: 42, Iteration: 1450:
TEST A@1: 0.3933333333333333
TEST A@5: 0.7711111111111111
TEST A@10: 0.9
TEST M@B: 0.3422066867523947
TEST M@A: 0.9436365829224638
TEST W@MB: 0.18266308183930519
TEST W@MA: 0.5807799035624646
TEST Time: 485.0792853832245
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 42, iter: 1451, loss: 0.642807126045227, time cost3.7879934310913086
epoch: 42, iter: 1452, loss: 0.8418360948562622, time cost4.005550146102905
epoch: 42, iter: 1453, loss: 0.7166385650634766, time cost3.8727331161499023
epoch: 42, iter: 1454, loss: 1.1324706077575684, time cost3.926729917526245
epoch: 42, iter: 1455, loss: 0.8022274971008301, time cost3.890526533126831
epoch: 42, iter: 1456, loss: 1.263851523399353, time cost3.711806058883667
epoch: 42, iter: 1457, loss: 1.0753822326660156, time cost3.848503589630127
epoch: 42, iter: 1458, loss: 0.7645146250724792, time cost3.745366334915161
epoch: 42, iter: 1459, loss: 0.9610798954963684, time cost4.008252859115601
epoch: 42, iter: 1460, loss: 0.970341682434082, time cost3.812394380569458
epoch: 42, iter: 1461, loss: 1.0101135969161987, time cost3.800349235534668
epoch: 42, iter: 1462, loss: 0.45217037200927734, time cost2.7108519077301025
epoch: 43, iter: 1463, loss: 1.211347222328186, time cost4.05011773109436
epoch: 43, iter: 1464, loss: 1.1072741746902466, time cost3.9675464630126953
epoch: 43, iter: 1465, loss: 1.2439665794372559, time cost3.9581618309020996
epoch: 43, iter: 1466, loss: 0.8352809548377991, time cost3.7775356769561768
epoch: 43, iter: 1467, loss: 1.132827639579773, time cost4.021634340286255
epoch: 43, iter: 1468, loss: 0.7695753574371338, time cost3.848655939102173
epoch: 43, iter: 1469, loss: 0.8103364706039429, time cost3.7520627975463867
epoch: 43, iter: 1470, loss: 0.3738967478275299, time cost3.994204521179199
epoch: 43, iter: 1471, loss: 1.288710117340088, time cost3.9061119556427
epoch: 43, iter: 1472, loss: 1.3423469066619873, time cost3.8730812072753906
epoch: 43, iter: 1473, loss: 1.428676724433899, time cost3.9588241577148438
epoch: 43, iter: 1474, loss: 0.8542488813400269, time cost3.8477189540863037
epoch: 43, iter: 1475, loss: 0.9606539011001587, time cost3.7614355087280273
epoch: 43, iter: 1476, loss: 0.8658618927001953, time cost3.936251640319824
epoch: 43, iter: 1477, loss: 1.0557352304458618, time cost3.946446657180786
epoch: 43, iter: 1478, loss: 1.6424634456634521, time cost3.9463882446289062
epoch: 43, iter: 1479, loss: 1.0386477708816528, time cost4.003759145736694
epoch: 43, iter: 1480, loss: 1.3960471153259277, time cost3.932589292526245
epoch: 43, iter: 1481, loss: 0.8834601640701294, time cost3.8685388565063477
epoch: 43, iter: 1482, loss: 1.4641470909118652, time cost4.169371843338013
epoch: 43, iter: 1483, loss: 1.1677924394607544, time cost3.7610840797424316
epoch: 43, iter: 1484, loss: 1.6546064615249634, time cost3.950392723083496
epoch: 43, iter: 1485, loss: 0.8570829629898071, time cost3.890004873275757
epoch: 43, iter: 1486, loss: 0.7665122747421265, time cost3.8201744556427
epoch: 43, iter: 1487, loss: 1.1377894878387451, time cost3.7758686542510986
epoch: 43, iter: 1488, loss: 1.3032865524291992, time cost3.866178274154663
epoch: 43, iter: 1489, loss: 0.9446907043457031, time cost3.9641976356506348
epoch: 43, iter: 1490, loss: 0.8957013487815857, time cost3.814472198486328
epoch: 43, iter: 1491, loss: 0.6313513517379761, time cost3.825181245803833
epoch: 43, iter: 1492, loss: 1.7747944593429565, time cost3.7959818840026855
epoch: 43, iter: 1493, loss: 1.1981810331344604, time cost3.8289661407470703
epoch: 43, iter: 1494, loss: 1.6308704614639282, time cost3.92014217376709
epoch: 43, iter: 1495, loss: 1.471298336982727, time cost3.7751057147979736
epoch: 43, iter: 1496, loss: 1.0208851099014282, time cost2.6788735389709473
epoch: 44, iter: 1497, loss: 1.042965292930603, time cost3.9931435585021973
epoch: 44, iter: 1498, loss: 0.9337384104728699, time cost4.003225088119507
epoch: 44, iter: 1499, loss: 1.3066294193267822, time cost3.9190902709960938
epoch: 44, iter: 1500, loss: 0.8460509181022644, time cost3.8640267848968506
tensor([[316., 266., 280.,  ...,   4.,   4.,   2.],
        [ 28.,  22.,  19.,  ...,   5.,   5.,   2.],
        [ 43., 174.,  84.,  ...,   4.,   4.,   3.],
        ...,
        [113., 130.,  73.,  ...,  16.,  16.,  18.],
        [ 60.,  33.,  14.,  ...,   1.,   1.,   1.],
        [211., 108., 195.,  ...,  12.,  12.,  15.]])
Epoch: 44, Iteration: 1500:
TEST A@1: 0.39555555555555555
TEST A@5: 0.7688888888888888
TEST A@10: 0.8844444444444445
TEST M@B: 0.3399846578470759
TEST M@A: 0.9405874084979886
TEST W@MB: 0.1816743055540985
TEST W@MA: 0.5786560645027148
TEST Time: 481.918288230896
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 44, iter: 1501, loss: 1.4685946702957153, time cost3.8710174560546875
epoch: 44, iter: 1502, loss: 1.1786774396896362, time cost3.864450216293335
epoch: 44, iter: 1503, loss: 1.766046404838562, time cost3.8535287380218506
epoch: 44, iter: 1504, loss: 1.6599457263946533, time cost3.9555017948150635
epoch: 44, iter: 1505, loss: 1.790345549583435, time cost3.9090521335601807
epoch: 44, iter: 1506, loss: 0.9893120527267456, time cost3.754378080368042
epoch: 44, iter: 1507, loss: 1.5603365898132324, time cost3.8727667331695557
epoch: 44, iter: 1508, loss: 1.415324091911316, time cost3.9519147872924805
epoch: 44, iter: 1509, loss: 1.0425719022750854, time cost3.965296983718872
epoch: 44, iter: 1510, loss: 1.3876769542694092, time cost3.8771352767944336
epoch: 44, iter: 1511, loss: 1.3360159397125244, time cost3.781904697418213
epoch: 44, iter: 1512, loss: 1.1800577640533447, time cost3.865382671356201
epoch: 44, iter: 1513, loss: 1.2602733373641968, time cost3.859952688217163
epoch: 44, iter: 1514, loss: 1.0170106887817383, time cost3.785599708557129
epoch: 44, iter: 1515, loss: 1.247497797012329, time cost3.844886064529419
epoch: 44, iter: 1516, loss: 1.0678613185882568, time cost3.9508910179138184
epoch: 44, iter: 1517, loss: 1.2640674114227295, time cost3.892798900604248
epoch: 44, iter: 1518, loss: 1.1460647583007812, time cost3.9042468070983887
epoch: 44, iter: 1519, loss: 1.0561128854751587, time cost3.8657798767089844
epoch: 44, iter: 1520, loss: 1.5810571908950806, time cost3.9165027141571045
epoch: 44, iter: 1521, loss: 1.6415752172470093, time cost3.950878858566284
epoch: 44, iter: 1522, loss: 1.0968948602676392, time cost3.8418128490448
epoch: 44, iter: 1523, loss: 1.113651156425476, time cost3.850576639175415
epoch: 44, iter: 1524, loss: 1.4532111883163452, time cost3.9166862964630127
epoch: 44, iter: 1525, loss: 1.149747610092163, time cost3.8520641326904297
epoch: 44, iter: 1526, loss: 1.016035795211792, time cost3.8860647678375244
epoch: 44, iter: 1527, loss: 0.926777720451355, time cost3.7483315467834473
epoch: 44, iter: 1528, loss: 1.356562852859497, time cost3.7677857875823975
epoch: 44, iter: 1529, loss: 1.86245858669281, time cost3.7675774097442627
epoch: 44, iter: 1530, loss: 0.7165011763572693, time cost2.7471418380737305
epoch: 45, iter: 1531, loss: 0.8942157030105591, time cost3.9987993240356445
epoch: 45, iter: 1532, loss: 0.976111114025116, time cost4.041773796081543
epoch: 45, iter: 1533, loss: 1.1841052770614624, time cost3.824580430984497
epoch: 45, iter: 1534, loss: 0.7949318289756775, time cost3.8952059745788574
epoch: 45, iter: 1535, loss: 0.7995020747184753, time cost4.030735015869141
epoch: 45, iter: 1536, loss: 1.3222026824951172, time cost3.8497016429901123
epoch: 45, iter: 1537, loss: 1.1519036293029785, time cost3.8712856769561768
epoch: 45, iter: 1538, loss: 0.8762232661247253, time cost3.756572723388672
epoch: 45, iter: 1539, loss: 1.2593796253204346, time cost3.781780242919922
epoch: 45, iter: 1540, loss: 1.5610421895980835, time cost4.037026643753052
epoch: 45, iter: 1541, loss: 1.14821195602417, time cost3.854247570037842
epoch: 45, iter: 1542, loss: 1.0547503232955933, time cost3.7637784481048584
epoch: 45, iter: 1543, loss: 1.3940104246139526, time cost3.830282211303711
epoch: 45, iter: 1544, loss: 1.7722487449645996, time cost3.8240957260131836
epoch: 45, iter: 1545, loss: 0.6422449350357056, time cost3.813551425933838
epoch: 45, iter: 1546, loss: 1.0801986455917358, time cost3.843594551086426
epoch: 45, iter: 1547, loss: 1.3392599821090698, time cost3.901484727859497
epoch: 45, iter: 1548, loss: 0.7479952573776245, time cost3.897472858428955
epoch: 45, iter: 1549, loss: 1.1123603582382202, time cost3.835052728652954
epoch: 45, iter: 1550, loss: 0.9300108551979065, time cost3.8745346069335938
tensor([[246., 211., 218.,  ...,   3.,   3.,   3.],
        [  4.,   3.,   3.,  ...,   2.,   2.,   1.],
        [ 44., 155.,  74.,  ...,  10.,  10.,   7.],
        ...,
        [134., 162., 101.,  ...,  21.,  21.,  22.],
        [ 29.,  15.,   1.,  ...,   1.,   1.,   1.],
        [198., 124., 185.,  ...,   9.,   9.,  10.]])
Epoch: 45, Iteration: 1550:
TEST A@1: 0.45555555555555555
TEST A@5: 0.8311111111111111
TEST A@10: 0.9133333333333333
TEST M@B: 0.3679891564174083
TEST M@A: 0.9429451698008334
TEST W@MB: 0.19539247391122855
TEST W@MA: 0.5800563958402265
TEST Time: 488.4482069015503
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 45, iter: 1551, loss: 0.8572546243667603, time cost3.8622941970825195
epoch: 45, iter: 1552, loss: 1.0313640832901, time cost3.9362542629241943
epoch: 45, iter: 1553, loss: 0.9491956830024719, time cost3.911400318145752
epoch: 45, iter: 1554, loss: 0.8731000423431396, time cost3.8225464820861816
epoch: 45, iter: 1555, loss: 0.7830347418785095, time cost3.9195199012756348
epoch: 45, iter: 1556, loss: 0.8759639263153076, time cost3.9824917316436768
epoch: 45, iter: 1557, loss: 1.4415931701660156, time cost3.8539576530456543
epoch: 45, iter: 1558, loss: 0.6982307434082031, time cost3.7886366844177246
epoch: 45, iter: 1559, loss: 0.9676290154457092, time cost3.670811176300049
epoch: 45, iter: 1560, loss: 1.397279143333435, time cost3.9148612022399902
epoch: 45, iter: 1561, loss: 1.2460294961929321, time cost3.8634397983551025
epoch: 45, iter: 1562, loss: 1.0862747430801392, time cost3.871047258377075
epoch: 45, iter: 1563, loss: 0.7433153390884399, time cost3.806097984313965
epoch: 45, iter: 1564, loss: 0.45018303394317627, time cost2.7722530364990234
epoch: 46, iter: 1565, loss: 1.0094318389892578, time cost3.9577953815460205
epoch: 46, iter: 1566, loss: 1.418135643005371, time cost3.956782579421997
epoch: 46, iter: 1567, loss: 0.9335203766822815, time cost4.069539546966553
epoch: 46, iter: 1568, loss: 1.0010206699371338, time cost3.9616103172302246
epoch: 46, iter: 1569, loss: 1.5455458164215088, time cost3.9430341720581055
epoch: 46, iter: 1570, loss: 1.3791776895523071, time cost3.9467647075653076
epoch: 46, iter: 1571, loss: 1.134657859802246, time cost3.875357151031494
epoch: 46, iter: 1572, loss: 0.8331380486488342, time cost3.9025819301605225
epoch: 46, iter: 1573, loss: 1.2391647100448608, time cost3.9569218158721924
epoch: 46, iter: 1574, loss: 1.1579324007034302, time cost4.120471477508545
epoch: 46, iter: 1575, loss: 0.7792469263076782, time cost4.069054126739502
epoch: 46, iter: 1576, loss: 0.9425963163375854, time cost3.8387670516967773
epoch: 46, iter: 1577, loss: 0.5709779262542725, time cost3.8934197425842285
epoch: 46, iter: 1578, loss: 1.0665253400802612, time cost3.882495641708374
epoch: 46, iter: 1579, loss: 1.2136948108673096, time cost3.8909695148468018
epoch: 46, iter: 1580, loss: 1.1289466619491577, time cost3.795891761779785
epoch: 46, iter: 1581, loss: 0.8791046738624573, time cost4.003338098526001
epoch: 46, iter: 1582, loss: 1.0845822095870972, time cost3.776798725128174
epoch: 46, iter: 1583, loss: 1.3069798946380615, time cost3.8931148052215576
epoch: 46, iter: 1584, loss: 0.6568872928619385, time cost3.8681962490081787
epoch: 46, iter: 1585, loss: 0.9830771684646606, time cost3.8898274898529053
epoch: 46, iter: 1586, loss: 0.9229245185852051, time cost3.8640472888946533
epoch: 46, iter: 1587, loss: 1.2000294923782349, time cost3.777268648147583
epoch: 46, iter: 1588, loss: 1.8549174070358276, time cost4.013976812362671
epoch: 46, iter: 1589, loss: 0.6824477910995483, time cost3.9237680435180664
epoch: 46, iter: 1590, loss: 0.8026086091995239, time cost3.8914287090301514
epoch: 46, iter: 1591, loss: 0.9204046130180359, time cost4.004387378692627
epoch: 46, iter: 1592, loss: 0.7862086296081543, time cost3.9506146907806396
epoch: 46, iter: 1593, loss: 1.431567907333374, time cost3.8951773643493652
epoch: 46, iter: 1594, loss: 0.8506728410720825, time cost3.807952880859375
epoch: 46, iter: 1595, loss: 0.9506708979606628, time cost4.070444107055664
epoch: 46, iter: 1596, loss: 1.422067403793335, time cost3.8004932403564453
epoch: 46, iter: 1597, loss: 1.1171120405197144, time cost3.865680456161499
epoch: 46, iter: 1598, loss: 0.36616313457489014, time cost2.7906010150909424
epoch: 47, iter: 1599, loss: 1.303353190422058, time cost4.115662574768066
epoch: 47, iter: 1600, loss: 0.9162616729736328, time cost3.954148292541504
tensor([[175., 156., 170.,  ...,   1.,   1.,   1.],
        [  1.,   2.,   2.,  ...,   2.,   2.,   1.],
        [ 43., 144.,  98.,  ...,   2.,   2.,   2.],
        ...,
        [ 91.,  91.,  57.,  ...,  11.,  11.,  13.],
        [ 38.,  26.,  12.,  ...,   1.,   1.,   1.],
        [ 34.,  52.,  93.,  ...,   1.,   1.,   5.]])
Epoch: 47, Iteration: 1600:
TEST A@1: 0.4488888888888889
TEST A@5: 0.8644444444444445
TEST A@10: 0.9244444444444444
TEST M@B: 0.3746600768261381
TEST M@A: 0.946208294298655
TEST W@MB: 0.19980868785200845
TEST W@MA: 0.5826650278595834
TEST Time: 502.8342695236206
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 47, iter: 1601, loss: 1.4407011270523071, time cost4.025810956954956
epoch: 47, iter: 1602, loss: 0.7171270251274109, time cost4.058360576629639
epoch: 47, iter: 1603, loss: 1.1852946281433105, time cost4.091901063919067
epoch: 47, iter: 1604, loss: 1.016309380531311, time cost4.310752868652344
epoch: 47, iter: 1605, loss: 1.1107678413391113, time cost4.159883499145508
epoch: 47, iter: 1606, loss: 0.9261081218719482, time cost4.363492250442505
epoch: 47, iter: 1607, loss: 1.5398552417755127, time cost4.448201656341553
epoch: 47, iter: 1608, loss: 1.0485851764678955, time cost4.224148988723755
epoch: 47, iter: 1609, loss: 1.3720875978469849, time cost4.277976989746094
epoch: 47, iter: 1610, loss: 1.2098286151885986, time cost4.385815143585205
epoch: 47, iter: 1611, loss: 0.9313006401062012, time cost4.241752624511719
epoch: 47, iter: 1612, loss: 1.4271835088729858, time cost4.149881601333618
epoch: 47, iter: 1613, loss: 1.1471056938171387, time cost4.313738822937012
epoch: 47, iter: 1614, loss: 0.9618300795555115, time cost4.018151044845581
epoch: 47, iter: 1615, loss: 0.8365179300308228, time cost4.30163836479187
epoch: 47, iter: 1616, loss: 0.7326658368110657, time cost4.030141353607178
epoch: 47, iter: 1617, loss: 0.9565150141716003, time cost4.460830926895142
epoch: 47, iter: 1618, loss: 1.0363625288009644, time cost4.344252109527588
epoch: 47, iter: 1619, loss: 1.0947353839874268, time cost4.214939594268799
epoch: 47, iter: 1620, loss: 0.7937219142913818, time cost4.173128604888916
epoch: 47, iter: 1621, loss: 1.6825826168060303, time cost3.448963165283203
epoch: 47, iter: 1622, loss: 1.3399971723556519, time cost3.9356651306152344
epoch: 47, iter: 1623, loss: 0.9482508897781372, time cost3.947469711303711
epoch: 47, iter: 1624, loss: 1.2504019737243652, time cost3.965938091278076
epoch: 47, iter: 1625, loss: 1.0565338134765625, time cost3.8384792804718018
epoch: 47, iter: 1626, loss: 0.8340532779693604, time cost3.9241116046905518
epoch: 47, iter: 1627, loss: 0.7671059966087341, time cost3.770063638687134
epoch: 47, iter: 1628, loss: 1.3409078121185303, time cost3.8574721813201904
epoch: 47, iter: 1629, loss: 1.2718533277511597, time cost4.016806125640869
epoch: 47, iter: 1630, loss: 0.8812806606292725, time cost4.003100156784058
epoch: 47, iter: 1631, loss: 1.223402738571167, time cost3.876554489135742
epoch: 47, iter: 1632, loss: 0.7645188570022583, time cost2.7959794998168945
epoch: 48, iter: 1633, loss: 0.7873525619506836, time cost3.9340779781341553
epoch: 48, iter: 1634, loss: 0.9418697357177734, time cost3.9204063415527344
epoch: 48, iter: 1635, loss: 1.0765093564987183, time cost3.878845453262329
epoch: 48, iter: 1636, loss: 1.1293290853500366, time cost4.074914932250977
epoch: 48, iter: 1637, loss: 1.4318026304244995, time cost3.9388389587402344
epoch: 48, iter: 1638, loss: 1.1180098056793213, time cost4.023276329040527
epoch: 48, iter: 1639, loss: 1.604092001914978, time cost3.889927625656128
epoch: 48, iter: 1640, loss: 1.2676478624343872, time cost3.9237539768218994
epoch: 48, iter: 1641, loss: 1.0468857288360596, time cost3.9811413288116455
epoch: 48, iter: 1642, loss: 1.051985263824463, time cost4.05211877822876
epoch: 48, iter: 1643, loss: 1.1396881341934204, time cost4.055440187454224
epoch: 48, iter: 1644, loss: 0.7127151489257812, time cost4.043529748916626
epoch: 48, iter: 1645, loss: 0.621676504611969, time cost3.9967780113220215
epoch: 48, iter: 1646, loss: 1.2313132286071777, time cost4.288636922836304
epoch: 48, iter: 1647, loss: 0.9325664639472961, time cost3.944603204727173
epoch: 48, iter: 1648, loss: 1.2410944700241089, time cost4.200325012207031
epoch: 48, iter: 1649, loss: 1.1628838777542114, time cost3.985258102416992
epoch: 48, iter: 1650, loss: 0.7860887050628662, time cost4.028740406036377
tensor([[126., 116., 121.,  ...,   3.,   3.,   3.],
        [  2.,   2.,   2.,  ...,   1.,   1.,   1.],
        [ 69., 151., 106.,  ...,   4.,   4.,   2.],
        ...,
        [ 59.,  62.,  38.,  ...,   9.,   9.,  12.],
        [ 48.,  19.,  28.,  ...,   1.,   1.,   1.],
        [ 16.,  47.,  66.,  ...,   4.,   4.,   6.]])
Epoch: 48, Iteration: 1650:
TEST A@1: 0.4955555555555556
TEST A@5: 0.8444444444444444
TEST A@10: 0.9244444444444444
TEST M@B: 0.37744819058374457
TEST M@A: 0.9414463894612317
TEST W@MB: 0.19987392012124958
TEST W@MA: 0.5785054098093823
TEST Time: 488.7868928909302
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 48, iter: 1651, loss: 0.8069323301315308, time cost3.987882137298584
epoch: 48, iter: 1652, loss: 1.1810557842254639, time cost4.012823820114136
epoch: 48, iter: 1653, loss: 0.7783313989639282, time cost4.0640692710876465
epoch: 48, iter: 1654, loss: 1.0768342018127441, time cost3.9293081760406494
epoch: 48, iter: 1655, loss: 0.9670259952545166, time cost3.951108455657959
epoch: 48, iter: 1656, loss: 1.0814725160598755, time cost3.858456611633301
epoch: 48, iter: 1657, loss: 1.1351741552352905, time cost3.88415789604187
epoch: 48, iter: 1658, loss: 0.9804709553718567, time cost3.9758715629577637
epoch: 48, iter: 1659, loss: 0.6553526520729065, time cost3.8950302600860596
epoch: 48, iter: 1660, loss: 1.27800714969635, time cost3.8906023502349854
epoch: 48, iter: 1661, loss: 1.5877097845077515, time cost3.8360891342163086
epoch: 48, iter: 1662, loss: 0.7346793413162231, time cost3.9729835987091064
epoch: 48, iter: 1663, loss: 0.793958842754364, time cost3.860639810562134
epoch: 48, iter: 1664, loss: 1.120531439781189, time cost3.8480489253997803
epoch: 48, iter: 1665, loss: 1.3836630582809448, time cost3.9426848888397217
epoch: 48, iter: 1666, loss: 0.6606588363647461, time cost2.696291923522949
epoch: 49, iter: 1667, loss: 0.9353641867637634, time cost3.9764347076416016
epoch: 49, iter: 1668, loss: 1.5551313161849976, time cost3.952064275741577
epoch: 49, iter: 1669, loss: 0.8119151592254639, time cost3.922851085662842
epoch: 49, iter: 1670, loss: 1.117314100265503, time cost4.01123046875
epoch: 49, iter: 1671, loss: 1.0383092164993286, time cost3.7735180854797363
epoch: 49, iter: 1672, loss: 0.9595709443092346, time cost3.9016735553741455
epoch: 49, iter: 1673, loss: 1.4333351850509644, time cost3.861747980117798
epoch: 49, iter: 1674, loss: 1.1211796998977661, time cost3.7675282955169678
epoch: 49, iter: 1675, loss: 1.7337827682495117, time cost3.7826125621795654
epoch: 49, iter: 1676, loss: 0.9175273180007935, time cost4.096477031707764
epoch: 49, iter: 1677, loss: 1.1164767742156982, time cost3.8737494945526123
epoch: 49, iter: 1678, loss: 1.2129440307617188, time cost3.883328914642334
epoch: 49, iter: 1679, loss: 0.9671069383621216, time cost3.838999032974243
epoch: 49, iter: 1680, loss: 0.9490141272544861, time cost3.7229433059692383
epoch: 49, iter: 1681, loss: 0.6745502948760986, time cost3.934237480163574
epoch: 49, iter: 1682, loss: 0.8789751529693604, time cost3.804818630218506
epoch: 49, iter: 1683, loss: 1.9096481800079346, time cost3.7981066703796387
epoch: 49, iter: 1684, loss: 1.7172266244888306, time cost3.8637197017669678
epoch: 49, iter: 1685, loss: 1.4608749151229858, time cost3.8664724826812744
epoch: 49, iter: 1686, loss: 1.005720853805542, time cost3.8949623107910156
epoch: 49, iter: 1687, loss: 0.6521092653274536, time cost3.9835240840911865
epoch: 49, iter: 1688, loss: 1.2891819477081299, time cost3.9382708072662354
epoch: 49, iter: 1689, loss: 1.4469503164291382, time cost3.691776752471924
epoch: 49, iter: 1690, loss: 0.8514304161071777, time cost3.8868021965026855
epoch: 49, iter: 1691, loss: 1.0908730030059814, time cost3.792820453643799
epoch: 49, iter: 1692, loss: 1.15006422996521, time cost3.813477039337158
epoch: 49, iter: 1693, loss: 1.4824457168579102, time cost3.9103341102600098
epoch: 49, iter: 1694, loss: 1.5566331148147583, time cost3.68060302734375
epoch: 49, iter: 1695, loss: 1.2297825813293457, time cost3.813528537750244
epoch: 49, iter: 1696, loss: 1.3586406707763672, time cost3.7724151611328125
epoch: 49, iter: 1697, loss: 1.3933998346328735, time cost3.816525936126709
epoch: 49, iter: 1698, loss: 1.7025450468063354, time cost3.8687262535095215
epoch: 49, iter: 1699, loss: 1.013864278793335, time cost3.7816274166107178
epoch: 49, iter: 1700, loss: 1.1350916624069214, time cost2.8979430198669434
tensor([[257., 249., 269.,  ...,  39.,  39.,  40.],
        [ 19.,  17.,  15.,  ...,  11.,  11.,   5.],
        [ 35.,  67.,  65.,  ...,   4.,   4.,   1.],
        ...,
        [ 94.,  94.,  74.,  ...,  29.,  29.,  26.],
        [ 58.,  33.,  38.,  ...,   3.,   3.,   3.],
        [180., 164., 298.,  ...,  34.,  34.,  30.]])
Epoch: 49, Iteration: 1700:
TEST A@1: 0.29777777777777775
TEST A@5: 0.5755555555555556
TEST A@10: 0.7422222222222222
TEST M@B: 0.2561263717064912
TEST M@A: 0.9268129536449791
TEST W@MB: 0.1364283695905378
TEST W@MA: 0.569291713785902
TEST Time: 488.8979778289795
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 50, iter: 1701, loss: 1.9506994485855103, time cost4.056791067123413
epoch: 50, iter: 1702, loss: 1.4119373559951782, time cost3.9705748558044434
epoch: 50, iter: 1703, loss: 0.9685724377632141, time cost3.9130945205688477
epoch: 50, iter: 1704, loss: 1.3019284009933472, time cost3.9945874214172363
epoch: 50, iter: 1705, loss: 1.4422824382781982, time cost3.970080614089966
epoch: 50, iter: 1706, loss: 1.0981147289276123, time cost3.9656786918640137
epoch: 50, iter: 1707, loss: 1.1593921184539795, time cost3.9646284580230713
epoch: 50, iter: 1708, loss: 0.8919985294342041, time cost4.044398546218872
epoch: 50, iter: 1709, loss: 1.3699134588241577, time cost4.013552904129028
epoch: 50, iter: 1710, loss: 1.785736322402954, time cost3.8238272666931152
epoch: 50, iter: 1711, loss: 1.1841026544570923, time cost4.023023843765259
epoch: 50, iter: 1712, loss: 1.0758033990859985, time cost3.871845245361328
epoch: 50, iter: 1713, loss: 0.7699805498123169, time cost3.9385874271392822
epoch: 50, iter: 1714, loss: 1.0661319494247437, time cost4.080817222595215
epoch: 50, iter: 1715, loss: 1.099829912185669, time cost3.804800271987915
epoch: 50, iter: 1716, loss: 1.2076008319854736, time cost3.969280242919922
epoch: 50, iter: 1717, loss: 0.9686897397041321, time cost3.9117422103881836
epoch: 50, iter: 1718, loss: 1.5882713794708252, time cost3.983978033065796
epoch: 50, iter: 1719, loss: 1.3262783288955688, time cost3.9687702655792236
epoch: 50, iter: 1720, loss: 1.6332918405532837, time cost3.94850754737854
epoch: 50, iter: 1721, loss: 1.3495081663131714, time cost3.99631404876709
epoch: 50, iter: 1722, loss: 0.575126051902771, time cost4.174402713775635
epoch: 50, iter: 1723, loss: 0.8688375949859619, time cost4.0051984786987305
epoch: 50, iter: 1724, loss: 1.4769287109375, time cost3.8534252643585205
epoch: 50, iter: 1725, loss: 0.9205768704414368, time cost4.099339723587036
epoch: 50, iter: 1726, loss: 1.0823490619659424, time cost4.02208685874939
epoch: 50, iter: 1727, loss: 1.438201904296875, time cost3.914097547531128
epoch: 50, iter: 1728, loss: 0.8120298981666565, time cost3.8480148315429688
epoch: 50, iter: 1729, loss: 1.2309095859527588, time cost3.989159345626831
epoch: 50, iter: 1730, loss: 1.0209195613861084, time cost4.020157098770142
epoch: 50, iter: 1731, loss: 0.748221755027771, time cost3.8809614181518555
epoch: 50, iter: 1732, loss: 0.5758514404296875, time cost3.844280958175659
epoch: 50, iter: 1733, loss: 1.094128131866455, time cost3.818939447402954
epoch: 50, iter: 1734, loss: 0.6053444147109985, time cost2.76632022857666
epoch: 51, iter: 1735, loss: 0.6287314891815186, time cost3.927842378616333
epoch: 51, iter: 1736, loss: 1.4104853868484497, time cost3.7515981197357178
epoch: 51, iter: 1737, loss: 1.1354906558990479, time cost4.0363593101501465
epoch: 51, iter: 1738, loss: 1.3488342761993408, time cost3.813838005065918
epoch: 51, iter: 1739, loss: 1.1318544149398804, time cost3.919440507888794
epoch: 51, iter: 1740, loss: 0.9346412420272827, time cost3.832763910293579
epoch: 51, iter: 1741, loss: 0.803998589515686, time cost3.997812509536743
epoch: 51, iter: 1742, loss: 1.8260700702667236, time cost3.692183494567871
epoch: 51, iter: 1743, loss: 0.9957339763641357, time cost3.8452672958374023
epoch: 51, iter: 1744, loss: 1.6259441375732422, time cost3.9785993099212646
epoch: 51, iter: 1745, loss: 1.719436764717102, time cost3.9608683586120605
epoch: 51, iter: 1746, loss: 0.9333463311195374, time cost3.8349263668060303
epoch: 51, iter: 1747, loss: 0.4008820354938507, time cost3.9607696533203125
epoch: 51, iter: 1748, loss: 0.7849711179733276, time cost4.070472002029419
epoch: 51, iter: 1749, loss: 1.140704870223999, time cost3.9575672149658203
epoch: 51, iter: 1750, loss: 1.160219430923462, time cost3.7905433177948
tensor([[ 56.,  54.,  65.,  ...,   6.,   6.,   7.],
        [  7.,   9.,  10.,  ...,   7.,   7.,   3.],
        [ 85., 221., 182.,  ...,   5.,   5.,   3.],
        ...,
        [157., 154., 121.,  ...,  35.,  35.,  23.],
        [  4.,   4.,   4.,  ...,   1.,   1.,   1.],
        [107., 126., 151.,  ...,  13.,  13.,  11.]])
Epoch: 51, Iteration: 1750:
TEST A@1: 0.47555555555555556
TEST A@5: 0.7955555555555556
TEST A@10: 0.9022222222222223
TEST M@B: 0.37983659729502267
TEST M@A: 0.9435737977937558
TEST W@MB: 0.20220567734244208
TEST W@MA: 0.5805573701705857
TEST Time: 486.75563383102417
REAL performance: Top1: 0.5155555555555555, Top5: 0.8555555555555555, Top10: 0.94, MB: 0.39635164502169196, MA: 0.9467796523219552, WMB: 0.21074742869268315, WMA: 0.583053714710171
epoch: 51, iter: 1751, loss: 1.1396738290786743, time cost3.7760589122772217
epoch: 51, iter: 1752, loss: 1.1682641506195068, time cost3.881559133529663
epoch: 51, iter: 1753, loss: 1.005458116531372, time cost3.854965925216675
epoch: 51, iter: 1754, loss: 1.0560576915740967, time cost3.986818313598633
epoch: 51, iter: 1755, loss: 0.8842014670372009, time cost3.919642210006714
epoch: 51, iter: 1756, loss: 0.9874147772789001, time cost3.833621025085449
epoch: 51, iter: 1757, loss: 1.4826728105545044, time cost4.054290056228638
epoch: 51, iter: 1758, loss: 1.0856623649597168, time cost3.8615853786468506
epoch: 51, iter: 1759, loss: 1.1789047718048096, time cost4.048575401306152
epoch: 51, iter: 1760, loss: 1.3115241527557373, time cost3.971161365509033
epoch: 51, iter: 1761, loss: 1.096261978149414, time cost3.8467695713043213
epoch: 51, iter: 1762, loss: 1.288921594619751, time cost3.9492623805999756
epoch: 51, iter: 1763, loss: 1.450493574142456, time cost3.808519124984741
epoch: 51, iter: 1764, loss: 2.1318066120147705, time cost3.764152765274048
epoch: 51, iter: 1765, loss: 0.8363783359527588, time cost3.906029224395752
epoch: 51, iter: 1766, loss: 0.9937878847122192, time cost3.8503642082214355
epoch: 51, iter: 1767, loss: 1.242368221282959, time cost3.835134267807007
epoch: 51, iter: 1768, loss: 0.574225664138794, time cost2.655407667160034
epoch: 52, iter: 1769, loss: 1.1640263795852661, time cost3.933041572570801
epoch: 52, iter: 1770, loss: 1.0842766761779785, time cost3.710756778717041
epoch: 52, iter: 1771, loss: 0.6185222268104553, time cost4.065785646438599
epoch: 52, iter: 1772, loss: 0.6059762239456177, time cost4.079124212265015
epoch: 52, iter: 1773, loss: 1.5167306661605835, time cost3.9981205463409424
epoch: 52, iter: 1774, loss: 1.1092967987060547, time cost3.960122585296631
epoch: 52, iter: 1775, loss: 0.8300490379333496, time cost3.7852163314819336
epoch: 52, iter: 1776, loss: 0.8714069724082947, time cost4.267202615737915
epoch: 52, iter: 1777, loss: 1.2348383665084839, time cost3.8948163986206055
epoch: 52, iter: 1778, loss: 1.0098611116409302, time cost3.9401016235351562
epoch: 52, iter: 1779, loss: 1.0865660905838013, time cost3.921821355819702
epoch: 52, iter: 1780, loss: 0.6337526440620422, time cost4.010030269622803
epoch: 52, iter: 1781, loss: 0.7799700498580933, time cost3.9907493591308594
epoch: 52, iter: 1782, loss: 0.7153215408325195, time cost3.928870916366577
epoch: 52, iter: 1783, loss: 0.8468345403671265, time cost3.9188811779022217
epoch: 52, iter: 1784, loss: 0.9670360088348389, time cost3.7917118072509766
epoch: 52, iter: 1785, loss: 1.177406668663025, time cost3.8988196849823
epoch: 52, iter: 1786, loss: 1.4363936185836792, time cost3.9537572860717773
epoch: 52, iter: 1787, loss: 1.1785099506378174, time cost3.8282384872436523
epoch: 52, iter: 1788, loss: 1.2024511098861694, time cost3.9806735515594482
epoch: 52, iter: 1789, loss: 0.8971755504608154, time cost3.9896795749664307
epoch: 52, iter: 1790, loss: 0.8386830687522888, time cost3.938688278198242
epoch: 52, iter: 1791, loss: 0.7913380861282349, time cost3.942185640335083
epoch: 52, iter: 1792, loss: 1.5625625848770142, time cost3.891411304473877
epoch: 52, iter: 1793, loss: 0.9777728319168091, time cost4.084580898284912
epoch: 52, iter: 1794, loss: 1.419595718383789, time cost3.8755862712860107
epoch: 52, iter: 1795, loss: 1.4295072555541992, time cost4.018700361251831
epoch: 52, iter: 1796, loss: 0.4980633556842804, time cost3.8958230018615723
epoch: 52, iter: 1797, loss: 0.6672933101654053, time cost3.7890841960906982
epoch: 52, iter: 1798, loss: 0.5122661590576172, time cost3.9105746746063232
epoch: 52, iter: 1799, loss: 0.9083840847015381, time cost3.8951950073242188
epoch: 52, iter: 1800, loss: 0.9982842206954956, time cost3.8381388187408447
tensor([[260., 219., 228.,  ...,   1.,   1.,   1.],
        [ 10.,  12.,  12.,  ...,   6.,   6.,   3.],
        [ 72., 169.,  85.,  ...,  13.,  13.,   6.],
        ...,
        [238., 241., 173.,  ...,  26.,  26.,  23.],
        [  8.,   5.,   4.,  ...,   1.,   1.,   1.],
        [270., 202., 290.,  ...,  15.,  15.,  16.]])
Epoch: 52, Iteration: 1800:
TEST A@1: 0.5422222222222223
TEST A@5: 0.8511111111111112
TEST A@10: 0.9444444444444444
TEST M@B: 0.4088912725782207
TEST M@A: 0.9496961862455373
TEST W@MB: 0.21789938269746806
TEST W@MA: 0.5850553450687236
TEST Time: 429.889221906662
Model Updated
REAL performance: Top1: 0.5422222222222223, Top5: 0.8511111111111112, Top10: 0.9444444444444444, MB: 0.4088912725782207, MA: 0.9496961862455373, WMB: 0.21789938269746806, WMA: 0.5850553450687236
epoch: 52, iter: 1801, loss: 1.2834118604660034, time cost3.976330518722534
epoch: 52, iter: 1802, loss: 0.6710577607154846, time cost2.8405115604400635
epoch: 53, iter: 1803, loss: 0.8080502152442932, time cost4.110045671463013
epoch: 53, iter: 1804, loss: 0.44057074189186096, time cost3.972968578338623
epoch: 53, iter: 1805, loss: 1.3427114486694336, time cost4.204181432723999
epoch: 53, iter: 1806, loss: 0.6736040711402893, time cost4.13346529006958
epoch: 53, iter: 1807, loss: 0.4853042960166931, time cost4.099914073944092
epoch: 53, iter: 1808, loss: 0.7619574069976807, time cost4.302809000015259
epoch: 53, iter: 1809, loss: 0.7927869558334351, time cost4.203871965408325
epoch: 53, iter: 1810, loss: 1.2750144004821777, time cost4.213771343231201
epoch: 53, iter: 1811, loss: 0.8543926477432251, time cost4.1840198040008545
epoch: 53, iter: 1812, loss: 0.9239168763160706, time cost4.256720781326294
epoch: 53, iter: 1813, loss: 0.6955461502075195, time cost4.141115427017212
epoch: 53, iter: 1814, loss: 0.8756324052810669, time cost4.166898488998413
epoch: 53, iter: 1815, loss: 1.057013750076294, time cost4.0825653076171875
epoch: 53, iter: 1816, loss: 0.9723348021507263, time cost4.1077964305877686
epoch: 53, iter: 1817, loss: 1.289908766746521, time cost4.142696380615234
epoch: 53, iter: 1818, loss: 1.109944462776184, time cost4.258685827255249
epoch: 53, iter: 1819, loss: 1.3636512756347656, time cost4.3254554271698
epoch: 53, iter: 1820, loss: 0.40034282207489014, time cost4.214398622512817
epoch: 53, iter: 1821, loss: 1.035210132598877, time cost4.061493873596191
epoch: 53, iter: 1822, loss: 1.3573731184005737, time cost4.300231695175171
epoch: 53, iter: 1823, loss: 0.8247312307357788, time cost4.066070556640625
epoch: 53, iter: 1824, loss: 1.2848060131072998, time cost4.12032151222229
epoch: 53, iter: 1825, loss: 0.6756690740585327, time cost4.037977933883667
epoch: 53, iter: 1826, loss: 0.9073625802993774, time cost4.348703384399414
epoch: 53, iter: 1827, loss: 1.1039419174194336, time cost4.107696771621704
epoch: 53, iter: 1828, loss: 0.863101065158844, time cost4.0375049114227295
epoch: 53, iter: 1829, loss: 0.5192906856536865, time cost4.067781448364258
epoch: 53, iter: 1830, loss: 1.7096459865570068, time cost4.0267674922943115
epoch: 53, iter: 1831, loss: 0.5866172313690186, time cost3.3110151290893555
epoch: 53, iter: 1832, loss: 1.1897670030593872, time cost3.948490619659424
epoch: 53, iter: 1833, loss: 0.9673283100128174, time cost3.820432662963867
epoch: 53, iter: 1834, loss: 1.5278898477554321, time cost3.9798052310943604
epoch: 53, iter: 1835, loss: 1.2907947301864624, time cost3.92364239692688
epoch: 53, iter: 1836, loss: 0.5701977014541626, time cost2.740513801574707
epoch: 54, iter: 1837, loss: 0.8346796631813049, time cost4.034115314483643
epoch: 54, iter: 1838, loss: 0.8871281743049622, time cost3.9494104385375977
epoch: 54, iter: 1839, loss: 0.9074554443359375, time cost4.0347065925598145
epoch: 54, iter: 1840, loss: 0.7615301609039307, time cost3.95473051071167
epoch: 54, iter: 1841, loss: 0.8892162442207336, time cost3.8448731899261475
epoch: 54, iter: 1842, loss: 1.2789361476898193, time cost3.9971659183502197
epoch: 54, iter: 1843, loss: 0.558164119720459, time cost3.7716150283813477
epoch: 54, iter: 1844, loss: 1.0678901672363281, time cost3.9020025730133057
epoch: 54, iter: 1845, loss: 0.8516755104064941, time cost3.82561993598938
epoch: 54, iter: 1846, loss: 1.3784302473068237, time cost3.8498311042785645
epoch: 54, iter: 1847, loss: 0.6065221428871155, time cost3.964046001434326
epoch: 54, iter: 1848, loss: 1.2106906175613403, time cost4.010030746459961
epoch: 54, iter: 1849, loss: 0.8535693883895874, time cost3.9903533458709717
epoch: 54, iter: 1850, loss: 1.5915522575378418, time cost3.9471189975738525
tensor([[ 38.,  28.,  36.,  ...,   5.,   5.,   6.],
        [ 30.,  36.,  35.,  ...,  10.,  10.,   4.],
        [ 28.,  95.,  61.,  ...,   6.,   6.,   1.],
        ...,
        [ 26.,  27.,  17.,  ...,  11.,  11.,  12.],
        [ 21.,  16.,   6.,  ...,   1.,   1.,   1.],
        [ 86.,  91., 193.,  ...,  14.,  14.,  23.]])
Epoch: 54, Iteration: 1850:
TEST A@1: 0.5244444444444445
TEST A@5: 0.84
TEST A@10: 0.9311111111111111
TEST M@B: 0.39317803382777156
TEST M@A: 0.9490438725614093
TEST W@MB: 0.20877738787236588
TEST W@MA: 0.5849246872715151
TEST Time: 492.97879552841187
REAL performance: Top1: 0.5422222222222223, Top5: 0.8511111111111112, Top10: 0.9444444444444444, MB: 0.4088912725782207, MA: 0.9496961862455373, WMB: 0.21789938269746806, WMA: 0.5850553450687236
epoch: 54, iter: 1851, loss: 0.7909296154975891, time cost3.825878858566284
epoch: 54, iter: 1852, loss: 0.9628496766090393, time cost3.9355709552764893
epoch: 54, iter: 1853, loss: 0.7681573033332825, time cost3.746185064315796
epoch: 54, iter: 1854, loss: 0.8112297058105469, time cost4.004346132278442
epoch: 54, iter: 1855, loss: 1.0197811126708984, time cost3.9556469917297363
epoch: 54, iter: 1856, loss: 0.9193682670593262, time cost4.129595994949341
epoch: 54, iter: 1857, loss: 1.5039762258529663, time cost4.036442518234253
epoch: 54, iter: 1858, loss: 1.2237365245819092, time cost3.9010560512542725
epoch: 54, iter: 1859, loss: 0.9369663000106812, time cost3.9487268924713135
epoch: 54, iter: 1860, loss: 1.0486888885498047, time cost3.8818609714508057
epoch: 54, iter: 1861, loss: 0.8155911564826965, time cost4.170933961868286
epoch: 54, iter: 1862, loss: 1.2459932565689087, time cost3.972104549407959
epoch: 54, iter: 1863, loss: 0.8471432328224182, time cost4.007891416549683
epoch: 54, iter: 1864, loss: 0.9852632880210876, time cost4.113812685012817
epoch: 54, iter: 1865, loss: 1.2399015426635742, time cost3.966294288635254
epoch: 54, iter: 1866, loss: 1.1058189868927002, time cost3.9257686138153076
epoch: 54, iter: 1867, loss: 1.1411479711532593, time cost3.889159917831421
epoch: 54, iter: 1868, loss: 0.9664355516433716, time cost4.019392013549805
epoch: 54, iter: 1869, loss: 0.8835229873657227, time cost3.897883892059326
epoch: 54, iter: 1870, loss: 0.8263826370239258, time cost2.9572558403015137
epoch: 55, iter: 1871, loss: 1.4862236976623535, time cost3.979475498199463
epoch: 55, iter: 1872, loss: 1.1478370428085327, time cost4.10731053352356
epoch: 55, iter: 1873, loss: 1.115343451499939, time cost3.9838948249816895
epoch: 55, iter: 1874, loss: 1.1191325187683105, time cost4.0279669761657715
epoch: 55, iter: 1875, loss: 0.9547648429870605, time cost3.905949592590332
epoch: 55, iter: 1876, loss: 0.9070557355880737, time cost4.065828084945679
epoch: 55, iter: 1877, loss: 1.3472455739974976, time cost3.891317129135132
epoch: 55, iter: 1878, loss: 1.0541476011276245, time cost3.854346990585327
epoch: 55, iter: 1879, loss: 1.2631630897521973, time cost3.9669594764709473
epoch: 55, iter: 1880, loss: 1.0903517007827759, time cost3.938657522201538
epoch: 55, iter: 1881, loss: 1.0426750183105469, time cost3.771617889404297
epoch: 55, iter: 1882, loss: 1.2657610177993774, time cost3.8232357501983643
epoch: 55, iter: 1883, loss: 0.7637203335762024, time cost3.9972193241119385
epoch: 55, iter: 1884, loss: 1.7493425607681274, time cost3.9216973781585693
epoch: 55, iter: 1885, loss: 1.244981288909912, time cost3.718289852142334
epoch: 55, iter: 1886, loss: 1.067057728767395, time cost3.9355411529541016
epoch: 55, iter: 1887, loss: 0.9401373863220215, time cost3.9206175804138184
epoch: 55, iter: 1888, loss: 0.8200436234474182, time cost3.8957762718200684
epoch: 55, iter: 1889, loss: 1.5719300508499146, time cost4.028386831283569
epoch: 55, iter: 1890, loss: 1.1366409063339233, time cost4.058060884475708
epoch: 55, iter: 1891, loss: 1.2865408658981323, time cost4.0329484939575195
epoch: 55, iter: 1892, loss: 0.9973347187042236, time cost3.856147527694702
epoch: 55, iter: 1893, loss: 0.9507559537887573, time cost3.7798867225646973
epoch: 55, iter: 1894, loss: 0.627805769443512, time cost3.9848179817199707
epoch: 55, iter: 1895, loss: 0.9148439764976501, time cost3.9066810607910156
epoch: 55, iter: 1896, loss: 1.091312050819397, time cost3.8072452545166016
epoch: 55, iter: 1897, loss: 0.556221067905426, time cost3.928649425506592
epoch: 55, iter: 1898, loss: 0.9979333281517029, time cost3.826190948486328
epoch: 55, iter: 1899, loss: 1.1899693012237549, time cost3.920289993286133
epoch: 55, iter: 1900, loss: 1.390326976776123, time cost3.8451993465423584
tensor([[193., 167., 175.,  ...,   1.,   1.,   1.],
        [  4.,   3.,   3.,  ...,   5.,   5.,   2.],
        [ 20., 146.,  47.,  ...,  11.,  11.,   8.],
        ...,
        [129., 137.,  76.,  ...,  10.,  10.,  14.],
        [ 11.,   7.,   6.,  ...,   1.,   1.,   1.],
        [117., 132., 242.,  ...,   5.,   5.,  10.]])
Epoch: 55, Iteration: 1900:
TEST A@1: 0.5
TEST A@5: 0.8755555555555555
TEST A@10: 0.94
TEST M@B: 0.39654411001189693
TEST M@A: 0.9495860299186353
TEST W@MB: 0.21063328649370122
TEST W@MA: 0.5851127573411911
TEST Time: 490.34040665626526
REAL performance: Top1: 0.5422222222222223, Top5: 0.8511111111111112, Top10: 0.9444444444444444, MB: 0.4088912725782207, MA: 0.9496961862455373, WMB: 0.21789938269746806, WMA: 0.5850553450687236
epoch: 55, iter: 1901, loss: 0.7888975143432617, time cost3.7834725379943848
epoch: 55, iter: 1902, loss: 1.351732611656189, time cost3.818704843521118
epoch: 55, iter: 1903, loss: 0.9919641613960266, time cost3.721919059753418
epoch: 55, iter: 1904, loss: 0.6303356885910034, time cost2.745208263397217
epoch: 56, iter: 1905, loss: 0.939020037651062, time cost4.01543116569519
epoch: 56, iter: 1906, loss: 1.2486599683761597, time cost3.7958858013153076
epoch: 56, iter: 1907, loss: 0.8674196004867554, time cost3.889918804168701
epoch: 56, iter: 1908, loss: 0.8615376353263855, time cost3.847797393798828
epoch: 56, iter: 1909, loss: 1.0066275596618652, time cost3.974628448486328
epoch: 56, iter: 1910, loss: 1.6763943433761597, time cost3.8451626300811768
epoch: 56, iter: 1911, loss: 0.7982847690582275, time cost3.8650667667388916
epoch: 56, iter: 1912, loss: 1.2476506233215332, time cost3.96083664894104
epoch: 56, iter: 1913, loss: 0.8188803195953369, time cost3.9450807571411133
epoch: 56, iter: 1914, loss: 1.310431718826294, time cost4.131917476654053
epoch: 56, iter: 1915, loss: 0.6480180621147156, time cost3.9023051261901855
epoch: 56, iter: 1916, loss: 1.082659125328064, time cost3.839399814605713
epoch: 56, iter: 1917, loss: 1.0516778230667114, time cost3.833437204360962
epoch: 56, iter: 1918, loss: 0.45211032032966614, time cost3.9265074729919434
epoch: 56, iter: 1919, loss: 1.347764492034912, time cost3.8562755584716797
epoch: 56, iter: 1920, loss: 0.980225145816803, time cost3.9906740188598633
epoch: 56, iter: 1921, loss: 1.2177414894104004, time cost3.8482189178466797
epoch: 56, iter: 1922, loss: 1.4401049613952637, time cost3.945894241333008
epoch: 56, iter: 1923, loss: 0.8947294354438782, time cost3.804893732070923
epoch: 56, iter: 1924, loss: 1.4393973350524902, time cost3.798651933670044
epoch: 56, iter: 1925, loss: 1.0115865468978882, time cost3.8684988021850586
epoch: 56, iter: 1926, loss: 1.2938698530197144, time cost3.778982162475586
epoch: 56, iter: 1927, loss: 0.7956724166870117, time cost3.7831127643585205
epoch: 56, iter: 1928, loss: 1.060547947883606, time cost3.8021621704101562
epoch: 56, iter: 1929, loss: 0.8696590065956116, time cost3.9433751106262207
epoch: 56, iter: 1930, loss: 0.747677206993103, time cost3.9449191093444824
epoch: 56, iter: 1931, loss: 1.4115575551986694, time cost3.820464611053467
epoch: 56, iter: 1932, loss: 0.9502025842666626, time cost3.7179603576660156
epoch: 56, iter: 1933, loss: 0.8814170360565186, time cost3.817464590072632
epoch: 56, iter: 1934, loss: 0.9351558089256287, time cost3.878757953643799
epoch: 56, iter: 1935, loss: 1.245930552482605, time cost3.789539098739624
epoch: 56, iter: 1936, loss: 1.2260677814483643, time cost3.7590138912200928
epoch: 56, iter: 1937, loss: 0.7742570638656616, time cost3.7818973064422607
epoch: 56, iter: 1938, loss: 0.4418008625507355, time cost2.719646692276001
epoch: 57, iter: 1939, loss: 0.7815344333648682, time cost4.084887504577637
epoch: 57, iter: 1940, loss: 0.8351584672927856, time cost3.968378782272339
epoch: 57, iter: 1941, loss: 0.8708456158638, time cost3.7919650077819824
epoch: 57, iter: 1942, loss: 0.6416335105895996, time cost3.898191213607788
epoch: 57, iter: 1943, loss: 0.8195360898971558, time cost3.8406167030334473
epoch: 57, iter: 1944, loss: 1.1565648317337036, time cost3.9063589572906494
epoch: 57, iter: 1945, loss: 0.9793598055839539, time cost3.845176935195923
epoch: 57, iter: 1946, loss: 0.9536406993865967, time cost3.744528293609619
epoch: 57, iter: 1947, loss: 0.7477856278419495, time cost3.84202241897583
epoch: 57, iter: 1948, loss: 0.7178663611412048, time cost3.9625842571258545
epoch: 57, iter: 1949, loss: 0.858744740486145, time cost3.8433291912078857
epoch: 57, iter: 1950, loss: 0.9846903681755066, time cost3.871840238571167
tensor([[263., 242., 247.,  ...,   3.,   3.,   2.],
        [  7.,   9.,   8.,  ...,   9.,   9.,   4.],
        [ 11.,  54.,  25.,  ...,   4.,   4.,   1.],
        ...,
        [147., 151., 102.,  ...,  17.,  17.,  16.],
        [ 38.,  24.,   7.,  ...,   1.,   1.,   1.],
        [114., 159., 227.,  ...,   7.,   7.,  14.]])
Epoch: 57, Iteration: 1950:
TEST A@1: 0.5155555555555555
TEST A@5: 0.8688888888888889
TEST A@10: 0.9466666666666667
TEST M@B: 0.3984455130342927
TEST M@A: 0.9491484432427716
TEST W@MB: 0.21206027333218225
TEST W@MA: 0.5849257404299396
TEST Time: 492.84991431236267
REAL performance: Top1: 0.5422222222222223, Top5: 0.8511111111111112, Top10: 0.9444444444444444, MB: 0.4088912725782207, MA: 0.9496961862455373, WMB: 0.21789938269746806, WMA: 0.5850553450687236
epoch: 57, iter: 1951, loss: 1.0198862552642822, time cost3.9920501708984375
epoch: 57, iter: 1952, loss: 0.7332521677017212, time cost3.8470823764801025
epoch: 57, iter: 1953, loss: 1.2102404832839966, time cost3.963336944580078
epoch: 57, iter: 1954, loss: 1.158836007118225, time cost3.9080562591552734
epoch: 57, iter: 1955, loss: 0.8616456389427185, time cost3.9058258533477783
epoch: 57, iter: 1956, loss: 1.0964518785476685, time cost3.889512300491333
epoch: 57, iter: 1957, loss: 1.3252393007278442, time cost4.040099620819092
epoch: 57, iter: 1958, loss: 0.9966703057289124, time cost3.9224042892456055
epoch: 57, iter: 1959, loss: 1.1259111166000366, time cost4.074936151504517
epoch: 57, iter: 1960, loss: 1.0681318044662476, time cost4.042271137237549
epoch: 57, iter: 1961, loss: 1.4347254037857056, time cost3.9798574447631836
epoch: 57, iter: 1962, loss: 0.8138233423233032, time cost3.9298207759857178
epoch: 57, iter: 1963, loss: 0.8857859969139099, time cost3.962653398513794
epoch: 57, iter: 1964, loss: 0.7473770380020142, time cost3.886582851409912
epoch: 57, iter: 1965, loss: 1.1564902067184448, time cost3.904757022857666
epoch: 57, iter: 1966, loss: 1.180162787437439, time cost3.9877705574035645
epoch: 57, iter: 1967, loss: 0.9488276839256287, time cost3.954360246658325
epoch: 57, iter: 1968, loss: 0.8822845816612244, time cost3.8747825622558594
epoch: 57, iter: 1969, loss: 0.9118098616600037, time cost3.8776602745056152
epoch: 57, iter: 1970, loss: 0.5466746687889099, time cost3.8402419090270996
epoch: 57, iter: 1971, loss: 1.009858250617981, time cost3.9001824855804443
epoch: 57, iter: 1972, loss: 0.7319676876068115, time cost2.7736563682556152
epoch: 58, iter: 1973, loss: 0.7140772938728333, time cost3.9582436084747314
epoch: 58, iter: 1974, loss: 0.9646024107933044, time cost3.950852394104004
epoch: 58, iter: 1975, loss: 0.9605634212493896, time cost3.8388750553131104
epoch: 58, iter: 1976, loss: 0.7457687258720398, time cost4.06981348991394
epoch: 58, iter: 1977, loss: 0.8201031684875488, time cost4.052607536315918
epoch: 58, iter: 1978, loss: 0.8810374140739441, time cost3.9140031337738037
epoch: 58, iter: 1979, loss: 0.7853235006332397, time cost3.8844573497772217
epoch: 58, iter: 1980, loss: 0.6130042672157288, time cost3.9730801582336426
epoch: 58, iter: 1981, loss: 1.324900507926941, time cost3.977447509765625
epoch: 58, iter: 1982, loss: 0.7323296666145325, time cost4.052746534347534
epoch: 58, iter: 1983, loss: 1.2265628576278687, time cost4.097493410110474
epoch: 58, iter: 1984, loss: 0.9701766967773438, time cost3.947861671447754
epoch: 58, iter: 1985, loss: 0.6779561638832092, time cost4.065097332000732
epoch: 58, iter: 1986, loss: 0.8150401711463928, time cost4.007021188735962
epoch: 58, iter: 1987, loss: 0.6628530025482178, time cost4.165216445922852
epoch: 58, iter: 1988, loss: 1.2727272510528564, time cost4.090034008026123
epoch: 58, iter: 1989, loss: 0.8932676911354065, time cost3.8763668537139893
epoch: 58, iter: 1990, loss: 0.7477259039878845, time cost4.009588003158569
epoch: 58, iter: 1991, loss: 0.8241600394248962, time cost4.022916793823242
epoch: 58, iter: 1992, loss: 0.8342702388763428, time cost3.9633090496063232
epoch: 58, iter: 1993, loss: 0.8128742575645447, time cost4.006791353225708
epoch: 58, iter: 1994, loss: 1.7733123302459717, time cost4.018813848495483
epoch: 58, iter: 1995, loss: 0.8301472663879395, time cost3.9383466243743896
epoch: 58, iter: 1996, loss: 1.3882741928100586, time cost3.9131686687469482
epoch: 58, iter: 1997, loss: 1.2682523727416992, time cost3.959075450897217
epoch: 58, iter: 1998, loss: 1.0793297290802002, time cost4.167400360107422
epoch: 58, iter: 1999, loss: 1.7852635383605957, time cost4.139370679855347
epoch: 58, iter: 2000, loss: 1.5314992666244507, time cost3.7689456939697266
tensor([[115., 103., 116.,  ...,   5.,   5.,   5.],
        [ 40.,  26.,  22.,  ...,  14.,  14.,  11.],
        [ 42., 104.,  43.,  ...,   6.,   6.,   2.],
        ...,
        [ 63.,  73.,  34.,  ...,  10.,  10.,  11.],
        [ 24.,  21.,   7.,  ...,   1.,   1.,   1.],
        [168., 189., 268.,  ...,   6.,   6.,  16.]])
Epoch: 58, Iteration: 2000:
TEST A@1: 0.5088888888888888
TEST A@5: 0.8622222222222222
TEST A@10: 0.9444444444444444
TEST M@B: 0.39436993071600507
TEST M@A: 0.9493794328821749
TEST W@MB: 0.20958124463119449
TEST W@MA: 0.5849831370792241
TEST Time: 431.56811451911926
REAL performance: Top1: 0.5422222222222223, Top5: 0.8511111111111112, Top10: 0.9444444444444444, MB: 0.4088912725782207, MA: 0.9496961862455373, WMB: 0.21789938269746806, WMA: 0.5850553450687236
epoch: 58, iter: 2001, loss: 1.102287769317627, time cost4.09986686706543
epoch: 58, iter: 2002, loss: 0.7412115335464478, time cost4.036299705505371
epoch: 58, iter: 2003, loss: 1.524131417274475, time cost4.008962392807007
epoch: 58, iter: 2004, loss: 1.0858157873153687, time cost3.9291417598724365
epoch: 58, iter: 2005, loss: 0.7671261429786682, time cost4.003697872161865
epoch: 58, iter: 2006, loss: 0.7200114727020264, time cost2.836895227432251
epoch: 59, iter: 2007, loss: 0.9492418766021729, time cost3.9943830966949463
epoch: 59, iter: 2008, loss: 1.302213430404663, time cost3.9808506965637207
epoch: 59, iter: 2009, loss: 1.2945234775543213, time cost4.193074941635132
epoch: 59, iter: 2010, loss: 1.166171669960022, time cost4.083678245544434
epoch: 59, iter: 2011, loss: 1.2598371505737305, time cost3.9391863346099854
epoch: 59, iter: 2012, loss: 1.0048973560333252, time cost3.9540674686431885
epoch: 59, iter: 2013, loss: 1.1092036962509155, time cost4.104569673538208
epoch: 59, iter: 2014, loss: 0.9180774092674255, time cost4.013861656188965
epoch: 59, iter: 2015, loss: 0.6488707065582275, time cost4.145281791687012
epoch: 59, iter: 2016, loss: 1.0899927616119385, time cost4.061694860458374
epoch: 59, iter: 2017, loss: 0.7359667420387268, time cost4.158425331115723
epoch: 59, iter: 2018, loss: 1.3076280355453491, time cost4.257193326950073
epoch: 59, iter: 2019, loss: 1.3485963344573975, time cost4.238579273223877
epoch: 59, iter: 2020, loss: 0.8237141966819763, time cost4.299083709716797
epoch: 59, iter: 2021, loss: 0.7723702788352966, time cost4.223509788513184
epoch: 59, iter: 2022, loss: 1.1429904699325562, time cost4.072803258895874
epoch: 59, iter: 2023, loss: 0.8208903074264526, time cost4.203372240066528
epoch: 59, iter: 2024, loss: 1.2429115772247314, time cost4.137733697891235
epoch: 59, iter: 2025, loss: 0.7955478429794312, time cost4.339630603790283
epoch: 59, iter: 2026, loss: 1.01835036277771, time cost4.317143678665161
epoch: 59, iter: 2027, loss: 1.1338038444519043, time cost4.250762224197388
epoch: 59, iter: 2028, loss: 0.8219927549362183, time cost4.009669065475464
epoch: 59, iter: 2029, loss: 0.7678970098495483, time cost4.191249370574951
epoch: 59, iter: 2030, loss: 0.9353494644165039, time cost3.7320146560668945
epoch: 59, iter: 2031, loss: 0.9696839451789856, time cost2.906575918197632
epoch: 59, iter: 2032, loss: 1.2198232412338257, time cost3.823099136352539
epoch: 59, iter: 2033, loss: 1.3570747375488281, time cost3.8457515239715576
epoch: 59, iter: 2034, loss: 0.8234182000160217, time cost3.810631513595581
epoch: 59, iter: 2035, loss: 1.0540062189102173, time cost3.7347381114959717
epoch: 59, iter: 2036, loss: 1.0027735233306885, time cost3.7632458209991455
epoch: 59, iter: 2037, loss: 1.050114631652832, time cost3.864260673522949
epoch: 59, iter: 2038, loss: 1.843381643295288, time cost3.788933753967285
epoch: 59, iter: 2039, loss: 0.7803381085395813, time cost3.7351179122924805
epoch: 59, iter: 2040, loss: 0.43011701107025146, time cost2.7974331378936768
epoch: 60, iter: 2041, loss: 0.6930559277534485, time cost3.885206937789917
epoch: 60, iter: 2042, loss: 1.3728690147399902, time cost3.8484628200531006
epoch: 60, iter: 2043, loss: 1.0905733108520508, time cost4.0599822998046875
epoch: 60, iter: 2044, loss: 1.0868940353393555, time cost3.8740415573120117
epoch: 60, iter: 2045, loss: 0.9621585607528687, time cost3.917487859725952
epoch: 60, iter: 2046, loss: 1.076680064201355, time cost4.1207053661346436
epoch: 60, iter: 2047, loss: 0.9983335137367249, time cost3.9078991413116455
epoch: 60, iter: 2048, loss: 0.6427158713340759, time cost3.929704189300537
epoch: 60, iter: 2049, loss: 0.8972408175468445, time cost3.9421699047088623
epoch: 60, iter: 2050, loss: 0.6354933977127075, time cost3.897804021835327
tensor([[259., 226., 234.,  ...,  11.,  11.,   8.],
        [ 11.,  10.,   9.,  ...,   4.,   4.,   3.],
        [ 26.,  67.,  23.,  ...,   7.,   7.,   3.],
        ...,
        [127., 123.,  70.,  ...,  27.,  27.,  30.],
        [ 15.,   6.,   2.,  ...,   1.,   1.,   1.],
        [158., 167., 234.,  ...,  13.,  13.,  20.]])
Epoch: 60, Iteration: 2050:
TEST A@1: 0.4711111111111111
TEST A@5: 0.8066666666666666
TEST A@10: 0.9177777777777778
TEST M@B: 0.3825193196028671
TEST M@A: 0.9493004568459186
TEST W@MB: 0.20499741495393703
TEST W@MA: 0.5852144568144737
TEST Time: 489.2580671310425
REAL performance: Top1: 0.5422222222222223, Top5: 0.8511111111111112, Top10: 0.9444444444444444, MB: 0.4088912725782207, MA: 0.9496961862455373, WMB: 0.21789938269746806, WMA: 0.5850553450687236
epoch: 60, iter: 2051, loss: 1.4738738536834717, time cost3.9400384426116943
epoch: 60, iter: 2052, loss: 0.7323130965232849, time cost3.905694007873535
epoch: 60, iter: 2053, loss: 1.203973412513733, time cost3.9111979007720947
epoch: 60, iter: 2054, loss: 1.037140965461731, time cost3.915863513946533
epoch: 60, iter: 2055, loss: 1.326441764831543, time cost3.8817784786224365
epoch: 60, iter: 2056, loss: 0.8275761604309082, time cost4.003884792327881
epoch: 60, iter: 2057, loss: 1.2307448387145996, time cost3.947415828704834
epoch: 60, iter: 2058, loss: 1.3926008939743042, time cost3.827246904373169
epoch: 60, iter: 2059, loss: 0.7937645316123962, time cost3.819138765335083
epoch: 60, iter: 2060, loss: 0.8619158267974854, time cost3.9625227451324463
epoch: 60, iter: 2061, loss: 1.7480342388153076, time cost3.7792441844940186
epoch: 60, iter: 2062, loss: 1.3767155408859253, time cost3.8477070331573486
epoch: 60, iter: 2063, loss: 1.0527031421661377, time cost3.7946419715881348
epoch: 60, iter: 2064, loss: 1.322222352027893, time cost3.7527012825012207
epoch: 60, iter: 2065, loss: 1.3577748537063599, time cost3.9129228591918945
epoch: 60, iter: 2066, loss: 1.3155717849731445, time cost3.765772819519043
epoch: 60, iter: 2067, loss: 1.1081197261810303, time cost3.9049835205078125
epoch: 60, iter: 2068, loss: 0.8062288165092468, time cost3.9815030097961426
epoch: 60, iter: 2069, loss: 1.166756510734558, time cost3.946498155593872
epoch: 60, iter: 2070, loss: 1.241415023803711, time cost4.093380451202393
epoch: 60, iter: 2071, loss: 0.8842456936836243, time cost3.744605302810669
epoch: 60, iter: 2072, loss: 0.927656352519989, time cost3.9086320400238037
epoch: 60, iter: 2073, loss: 1.405644178390503, time cost3.935488700866699
epoch: 60, iter: 2074, loss: 0.7029439210891724, time cost2.8595268726348877
epoch: 61, iter: 2075, loss: 1.01846182346344, time cost3.9754798412323
epoch: 61, iter: 2076, loss: 0.7079207301139832, time cost3.9559075832366943
epoch: 61, iter: 2077, loss: 0.9539124369621277, time cost3.9791858196258545
epoch: 61, iter: 2078, loss: 1.181995153427124, time cost3.9956188201904297
epoch: 61, iter: 2079, loss: 1.0565472841262817, time cost4.090166330337524
epoch: 61, iter: 2080, loss: 0.7576566934585571, time cost3.956228256225586
epoch: 61, iter: 2081, loss: 0.7743872404098511, time cost3.960702896118164
epoch: 61, iter: 2082, loss: 0.9150709509849548, time cost3.745807409286499
epoch: 61, iter: 2083, loss: 0.7112290859222412, time cost3.674203872680664
epoch: 61, iter: 2084, loss: 0.9965288639068604, time cost3.8164422512054443
epoch: 61, iter: 2085, loss: 0.717517614364624, time cost3.920680522918701
epoch: 61, iter: 2086, loss: 1.006137728691101, time cost3.96779465675354
epoch: 61, iter: 2087, loss: 1.1930205821990967, time cost4.050694942474365
epoch: 61, iter: 2088, loss: 1.1262792348861694, time cost4.063250541687012
epoch: 61, iter: 2089, loss: 1.132672667503357, time cost4.045014381408691
epoch: 61, iter: 2090, loss: 0.7592878937721252, time cost4.004783391952515
epoch: 61, iter: 2091, loss: 1.0307281017303467, time cost4.031641960144043
epoch: 61, iter: 2092, loss: 1.0706855058670044, time cost4.089215040206909
epoch: 61, iter: 2093, loss: 0.6272879838943481, time cost3.981771945953369
epoch: 61, iter: 2094, loss: 0.5521231889724731, time cost4.010841608047485
epoch: 61, iter: 2095, loss: 1.4363882541656494, time cost3.9703876972198486
epoch: 61, iter: 2096, loss: 1.2054696083068848, time cost3.9072155952453613
epoch: 61, iter: 2097, loss: 0.8037610650062561, time cost3.9367029666900635
epoch: 61, iter: 2098, loss: 1.7376000881195068, time cost3.868321180343628
epoch: 61, iter: 2099, loss: 0.9909180998802185, time cost4.019791841506958
epoch: 61, iter: 2100, loss: 0.6865136623382568, time cost3.9020183086395264
tensor([[ 44.,  32.,  40.,  ...,   8.,   8.,   5.],
        [ 12.,   9.,   9.,  ...,   6.,   6.,   3.],
        [ 34.,  95.,  41.,  ...,   1.,   1.,   1.],
        ...,
        [ 79.,  79.,  58.,  ...,  19.,  19.,  16.],
        [ 42.,  25.,   7.,  ...,   1.,   1.,   1.],
        [147., 140., 198.,  ...,  30.,  30.,  32.]])
Epoch: 61, Iteration: 2100:
TEST A@1: 0.5244444444444445
TEST A@5: 0.8688888888888889
TEST A@10: 0.9422222222222222
TEST M@B: 0.40399443086719183
TEST M@A: 0.9536440067319568
TEST W@MB: 0.2155858904967363
TEST W@MA: 0.5887272645379302
TEST Time: 486.9453954696655
REAL performance: Top1: 0.5422222222222223, Top5: 0.8511111111111112, Top10: 0.9444444444444444, MB: 0.4088912725782207, MA: 0.9496961862455373, WMB: 0.21789938269746806, WMA: 0.5850553450687236
epoch: 61, iter: 2101, loss: 0.7453082799911499, time cost4.000357151031494
epoch: 61, iter: 2102, loss: 1.2374809980392456, time cost3.963212728500366
epoch: 61, iter: 2103, loss: 1.0989251136779785, time cost3.811286687850952
epoch: 61, iter: 2104, loss: 0.9443008303642273, time cost3.9589617252349854
epoch: 61, iter: 2105, loss: 0.9727264046669006, time cost3.7879011631011963
epoch: 61, iter: 2106, loss: 1.5986254215240479, time cost3.837784767150879
epoch: 61, iter: 2107, loss: 0.8853643536567688, time cost3.966566324234009
epoch: 61, iter: 2108, loss: 0.8215911984443665, time cost2.7211952209472656
epoch: 62, iter: 2109, loss: 0.7856093049049377, time cost4.164031028747559
epoch: 62, iter: 2110, loss: 1.2321041822433472, time cost4.099568128585815
epoch: 62, iter: 2111, loss: 0.715448796749115, time cost4.02936053276062
epoch: 62, iter: 2112, loss: 0.89328533411026, time cost4.088923454284668
epoch: 62, iter: 2113, loss: 0.9334527850151062, time cost3.931901693344116
epoch: 62, iter: 2114, loss: 0.8708756566047668, time cost4.219120979309082
epoch: 62, iter: 2115, loss: 0.8452097177505493, time cost3.9896137714385986
epoch: 62, iter: 2116, loss: 1.1406617164611816, time cost3.984125852584839
epoch: 62, iter: 2117, loss: 1.0733224153518677, time cost3.8312251567840576
epoch: 62, iter: 2118, loss: 1.0834946632385254, time cost3.9530506134033203
epoch: 62, iter: 2119, loss: 0.9773608446121216, time cost4.055518865585327
epoch: 62, iter: 2120, loss: 1.5691677331924438, time cost3.9215991497039795
epoch: 62, iter: 2121, loss: 0.798478901386261, time cost4.063807487487793
epoch: 62, iter: 2122, loss: 0.9682626128196716, time cost4.006885051727295
epoch: 62, iter: 2123, loss: 1.021663784980774, time cost4.0362467765808105
epoch: 62, iter: 2124, loss: 0.7572181224822998, time cost3.8523001670837402
epoch: 62, iter: 2125, loss: 0.9885970950126648, time cost3.926649570465088
epoch: 62, iter: 2126, loss: 0.5972458720207214, time cost3.9412310123443604
epoch: 62, iter: 2127, loss: 1.4162334203720093, time cost4.036146402359009
epoch: 62, iter: 2128, loss: 0.8408488035202026, time cost3.9525649547576904
epoch: 62, iter: 2129, loss: 0.9376981854438782, time cost4.032074451446533
epoch: 62, iter: 2130, loss: 0.8034572601318359, time cost3.916560173034668
epoch: 62, iter: 2131, loss: 0.8789545297622681, time cost4.04766321182251
epoch: 62, iter: 2132, loss: 1.136974811553955, time cost3.9514377117156982
epoch: 62, iter: 2133, loss: 0.7065343260765076, time cost3.9781131744384766
epoch: 62, iter: 2134, loss: 0.6858957409858704, time cost3.9536569118499756
epoch: 62, iter: 2135, loss: 0.805497407913208, time cost3.8845834732055664
epoch: 62, iter: 2136, loss: 1.0157564878463745, time cost3.8529248237609863
epoch: 62, iter: 2137, loss: 1.004111886024475, time cost4.190596103668213
epoch: 62, iter: 2138, loss: 1.0063096284866333, time cost3.999980926513672
epoch: 62, iter: 2139, loss: 1.0807723999023438, time cost3.716428279876709
epoch: 62, iter: 2140, loss: 1.082923412322998, time cost3.7092275619506836
epoch: 62, iter: 2141, loss: 1.055694341659546, time cost3.867732286453247
epoch: 62, iter: 2142, loss: 0.5080687403678894, time cost2.8701207637786865
epoch: 63, iter: 2143, loss: 0.49782976508140564, time cost3.8464105129241943
epoch: 63, iter: 2144, loss: 0.7514880299568176, time cost3.902773857116699
epoch: 63, iter: 2145, loss: 0.9397240281105042, time cost3.952695846557617
epoch: 63, iter: 2146, loss: 0.8790944814682007, time cost3.9893107414245605
epoch: 63, iter: 2147, loss: 0.9805408120155334, time cost3.9328041076660156
epoch: 63, iter: 2148, loss: 0.8195385336875916, time cost3.938354253768921
epoch: 63, iter: 2149, loss: 0.5872687101364136, time cost3.893388509750366
epoch: 63, iter: 2150, loss: 1.480149507522583, time cost3.9980244636535645
tensor([[ 24.,  28.,  37.,  ...,   4.,   4.,   2.],
        [  8.,  11.,  11.,  ...,  16.,  16.,   7.],
        [ 27., 151.,  44.,  ...,   3.,   3.,   1.],
        ...,
        [ 55.,  60.,  33.,  ...,  15.,  15.,  13.],
        [ 17.,  11.,  11.,  ...,   1.,   1.,   1.],
        [198., 200., 244.,  ...,  21.,  21.,  22.]])
Epoch: 63, Iteration: 2150:
TEST A@1: 0.5733333333333334
TEST A@5: 0.8688888888888889
TEST A@10: 0.9444444444444444
TEST M@B: 0.41889331955170545
TEST M@A: 0.9550919508909924
TEST W@MB: 0.22395836937023944
TEST W@MA: 0.589896074631377
TEST Time: 483.9098629951477
Model Updated
REAL performance: Top1: 0.5733333333333334, Top5: 0.8688888888888889, Top10: 0.9444444444444444, MB: 0.41889331955170545, MA: 0.9550919508909924, WMB: 0.22395836937023944, WMA: 0.589896074631377
epoch: 63, iter: 2151, loss: 0.855736494064331, time cost3.936332941055298
epoch: 63, iter: 2152, loss: 0.6724254488945007, time cost3.8846747875213623
epoch: 63, iter: 2153, loss: 1.4074281454086304, time cost3.8750603199005127
epoch: 63, iter: 2154, loss: 0.8136738538742065, time cost3.729696750640869
epoch: 63, iter: 2155, loss: 0.8146235346794128, time cost3.812037944793701
epoch: 63, iter: 2156, loss: 0.6186835765838623, time cost3.786494016647339
epoch: 63, iter: 2157, loss: 0.8188489675521851, time cost3.8263227939605713
epoch: 63, iter: 2158, loss: 0.5701156258583069, time cost3.973738193511963
epoch: 63, iter: 2159, loss: 0.8879994750022888, time cost3.938171863555908
epoch: 63, iter: 2160, loss: 0.9796810746192932, time cost3.821685314178467
epoch: 63, iter: 2161, loss: 0.6814095973968506, time cost3.857361078262329
epoch: 63, iter: 2162, loss: 1.018484115600586, time cost3.872511148452759
epoch: 63, iter: 2163, loss: 1.1115044355392456, time cost3.9522688388824463
epoch: 63, iter: 2164, loss: 1.0163568258285522, time cost4.040927886962891
epoch: 63, iter: 2165, loss: 1.1197072267532349, time cost3.956965446472168
epoch: 63, iter: 2166, loss: 0.8336565494537354, time cost3.9021143913269043
epoch: 63, iter: 2167, loss: 0.859947919845581, time cost3.797497034072876
epoch: 63, iter: 2168, loss: 0.5489279627799988, time cost3.7875256538391113
epoch: 63, iter: 2169, loss: 1.4457675218582153, time cost3.828651189804077
epoch: 63, iter: 2170, loss: 0.9091678857803345, time cost3.824446439743042
epoch: 63, iter: 2171, loss: 1.8779232501983643, time cost3.8616783618927
epoch: 63, iter: 2172, loss: 1.1840760707855225, time cost3.944675922393799
epoch: 63, iter: 2173, loss: 0.7731549739837646, time cost3.8149707317352295
epoch: 63, iter: 2174, loss: 1.158994197845459, time cost3.8721132278442383
epoch: 63, iter: 2175, loss: 0.9091362357139587, time cost3.9143800735473633
epoch: 63, iter: 2176, loss: 0.8766369223594666, time cost2.8278982639312744
epoch: 64, iter: 2177, loss: 0.7672133445739746, time cost4.066400051116943
epoch: 64, iter: 2178, loss: 0.6904506683349609, time cost3.832021713256836
epoch: 64, iter: 2179, loss: 1.051708698272705, time cost4.1069111824035645
epoch: 64, iter: 2180, loss: 0.8420717120170593, time cost3.7736432552337646
epoch: 64, iter: 2181, loss: 0.6857978701591492, time cost4.030367612838745
epoch: 64, iter: 2182, loss: 1.0584601163864136, time cost3.8103389739990234
epoch: 64, iter: 2183, loss: 1.5709872245788574, time cost3.956692695617676
epoch: 64, iter: 2184, loss: 0.9550355672836304, time cost4.031980991363525
epoch: 64, iter: 2185, loss: 1.4827502965927124, time cost3.999260187149048
epoch: 64, iter: 2186, loss: 0.577204704284668, time cost3.8880460262298584
epoch: 64, iter: 2187, loss: 0.5782769322395325, time cost3.9547438621520996
epoch: 64, iter: 2188, loss: 1.2214524745941162, time cost3.6825268268585205
epoch: 64, iter: 2189, loss: 0.6419578790664673, time cost3.9966988563537598
epoch: 64, iter: 2190, loss: 0.7179602384567261, time cost3.9695167541503906
epoch: 64, iter: 2191, loss: 0.8196691870689392, time cost3.82649564743042
epoch: 64, iter: 2192, loss: 0.8760859370231628, time cost3.9672868251800537
epoch: 64, iter: 2193, loss: 1.066838026046753, time cost3.979407787322998
epoch: 64, iter: 2194, loss: 1.3032112121582031, time cost3.9099111557006836
epoch: 64, iter: 2195, loss: 0.8903012275695801, time cost3.7968573570251465
epoch: 64, iter: 2196, loss: 0.8671412467956543, time cost4.08551025390625
epoch: 64, iter: 2197, loss: 1.0185407400131226, time cost3.998746633529663
epoch: 64, iter: 2198, loss: 1.081296443939209, time cost4.105272531509399
epoch: 64, iter: 2199, loss: 0.6261618733406067, time cost3.9537370204925537
epoch: 64, iter: 2200, loss: 1.0168265104293823, time cost3.941500186920166
tensor([[ 16.,  14.,  19.,  ...,   1.,   1.,   1.],
        [ 32.,  20.,  20.,  ...,   8.,   8.,   5.],
        [ 46.,  93.,  60.,  ...,   1.,   1.,   1.],
        ...,
        [ 56.,  57.,  42.,  ...,  14.,  14.,  15.],
        [120.,  80.,  59.,  ...,   1.,   1.,   1.],
        [ 91., 128., 182.,  ...,  14.,  14.,  15.]])
Epoch: 64, Iteration: 2200:
TEST A@1: 0.5644444444444444
TEST A@5: 0.8844444444444445
TEST A@10: 0.9511111111111111
TEST M@B: 0.4276979936701354
TEST M@A: 0.951107505573736
TEST W@MB: 0.22730486740086803
TEST W@MA: 0.5861345991495678
TEST Time: 501.881466627121
Model Updated
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 64, iter: 2201, loss: 1.1466147899627686, time cost3.9940433502197266
epoch: 64, iter: 2202, loss: 0.6390741467475891, time cost3.904492139816284
epoch: 64, iter: 2203, loss: 0.9779873490333557, time cost4.010819435119629
epoch: 64, iter: 2204, loss: 1.1992104053497314, time cost3.965456485748291
epoch: 64, iter: 2205, loss: 1.0704957246780396, time cost4.115657091140747
epoch: 64, iter: 2206, loss: 1.225380301475525, time cost4.016502618789673
epoch: 64, iter: 2207, loss: 1.256955623626709, time cost4.080056428909302
epoch: 64, iter: 2208, loss: 0.9718657732009888, time cost4.084357976913452
epoch: 64, iter: 2209, loss: 0.6863071918487549, time cost4.1620001792907715
epoch: 64, iter: 2210, loss: 1.39205801486969, time cost2.775808095932007
epoch: 65, iter: 2211, loss: 1.3660424947738647, time cost4.127440929412842
epoch: 65, iter: 2212, loss: 1.468111276626587, time cost4.171405792236328
epoch: 65, iter: 2213, loss: 0.8438876867294312, time cost4.183935880661011
epoch: 65, iter: 2214, loss: 0.8725258708000183, time cost4.191526889801025
epoch: 65, iter: 2215, loss: 1.2701748609542847, time cost4.0228941440582275
epoch: 65, iter: 2216, loss: 0.6350656151771545, time cost4.089969873428345
epoch: 65, iter: 2217, loss: 0.9944219589233398, time cost4.171048402786255
epoch: 65, iter: 2218, loss: 1.0071723461151123, time cost3.409428119659424
epoch: 65, iter: 2219, loss: 0.6379571557044983, time cost3.759290933609009
epoch: 65, iter: 2220, loss: 0.9458707571029663, time cost3.8791110515594482
epoch: 65, iter: 2221, loss: 1.184618353843689, time cost3.9785385131835938
epoch: 65, iter: 2222, loss: 1.1447402238845825, time cost3.9062981605529785
epoch: 65, iter: 2223, loss: 0.887800395488739, time cost4.059833526611328
epoch: 65, iter: 2224, loss: 1.0865380764007568, time cost3.896017551422119
epoch: 65, iter: 2225, loss: 1.10676109790802, time cost3.9196858406066895
epoch: 65, iter: 2226, loss: 0.9054290056228638, time cost4.01796555519104
epoch: 65, iter: 2227, loss: 1.2038464546203613, time cost4.102628231048584
epoch: 65, iter: 2228, loss: 0.7284363508224487, time cost3.797137498855591
epoch: 65, iter: 2229, loss: 0.9133031368255615, time cost3.9839861392974854
epoch: 65, iter: 2230, loss: 1.3106333017349243, time cost3.9994404315948486
epoch: 65, iter: 2231, loss: 1.0104347467422485, time cost3.8946197032928467
epoch: 65, iter: 2232, loss: 0.8807513117790222, time cost4.147798776626587
epoch: 65, iter: 2233, loss: 0.6891343593597412, time cost3.9737987518310547
epoch: 65, iter: 2234, loss: 0.8439898490905762, time cost3.962614059448242
epoch: 65, iter: 2235, loss: 0.8030208945274353, time cost3.999082326889038
epoch: 65, iter: 2236, loss: 1.3890612125396729, time cost3.9649367332458496
epoch: 65, iter: 2237, loss: 0.9883108735084534, time cost3.8789563179016113
epoch: 65, iter: 2238, loss: 0.8101626038551331, time cost4.0415380001068115
epoch: 65, iter: 2239, loss: 1.0686821937561035, time cost3.7244772911071777
epoch: 65, iter: 2240, loss: 0.8639751672744751, time cost3.918222188949585
epoch: 65, iter: 2241, loss: 0.47624120116233826, time cost3.7633888721466064
epoch: 65, iter: 2242, loss: 1.0943087339401245, time cost3.9243109226226807
epoch: 65, iter: 2243, loss: 1.646370768547058, time cost4.15997314453125
epoch: 65, iter: 2244, loss: 0.5739758014678955, time cost2.9652411937713623
epoch: 66, iter: 2245, loss: 0.5597524046897888, time cost4.1069254875183105
epoch: 66, iter: 2246, loss: 0.6059229373931885, time cost4.009959936141968
epoch: 66, iter: 2247, loss: 0.990378737449646, time cost3.903672695159912
epoch: 66, iter: 2248, loss: 0.7839807271957397, time cost4.01322603225708
epoch: 66, iter: 2249, loss: 0.9568698406219482, time cost4.018113374710083
epoch: 66, iter: 2250, loss: 0.8090484738349915, time cost4.015666246414185
tensor([[154., 132., 144.,  ...,  10.,  10.,  12.],
        [ 16.,  14.,  15.,  ...,  15.,  15.,  12.],
        [ 62.,  91.,  25.,  ...,   1.,   1.,   1.],
        ...,
        [ 51.,  51.,  22.,  ...,   9.,   9.,   3.],
        [ 86.,  64.,  48.,  ...,   7.,   7.,   7.],
        [ 34.,  49.,  72.,  ...,   1.,   1.,   2.]])
Epoch: 66, Iteration: 2250:
TEST A@1: 0.43333333333333335
TEST A@5: 0.8044444444444444
TEST A@10: 0.9022222222222223
TEST M@B: 0.3613756523286798
TEST M@A: 0.9406581123993097
TEST W@MB: 0.19229862038808027
TEST W@MA: 0.5781475022272919
TEST Time: 487.0633158683777
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 66, iter: 2251, loss: 1.7225677967071533, time cost3.8397417068481445
epoch: 66, iter: 2252, loss: 1.159767985343933, time cost3.963984489440918
epoch: 66, iter: 2253, loss: 0.8612828254699707, time cost3.8643834590911865
epoch: 66, iter: 2254, loss: 0.9696162939071655, time cost3.8956565856933594
epoch: 66, iter: 2255, loss: 0.6782059073448181, time cost3.883678674697876
epoch: 66, iter: 2256, loss: 0.9604853391647339, time cost4.091487407684326
epoch: 66, iter: 2257, loss: 1.2283614873886108, time cost3.881042718887329
epoch: 66, iter: 2258, loss: 1.0454751253128052, time cost3.9620676040649414
epoch: 66, iter: 2259, loss: 0.8600262403488159, time cost3.8843231201171875
epoch: 66, iter: 2260, loss: 0.6462615132331848, time cost4.265460014343262
epoch: 66, iter: 2261, loss: 0.7974945306777954, time cost4.194769859313965
epoch: 66, iter: 2262, loss: 1.138534665107727, time cost4.087267160415649
epoch: 66, iter: 2263, loss: 1.5840758085250854, time cost3.8764190673828125
epoch: 66, iter: 2264, loss: 1.2510091066360474, time cost3.99949049949646
epoch: 66, iter: 2265, loss: 0.7810827493667603, time cost3.9609291553497314
epoch: 66, iter: 2266, loss: 1.3899357318878174, time cost3.953068971633911
epoch: 66, iter: 2267, loss: 0.7993926405906677, time cost3.924283027648926
epoch: 66, iter: 2268, loss: 1.1571617126464844, time cost3.871565103530884
epoch: 66, iter: 2269, loss: 1.2043755054473877, time cost3.7993810176849365
epoch: 66, iter: 2270, loss: 0.7875425219535828, time cost3.9296207427978516
epoch: 66, iter: 2271, loss: 0.7692855596542358, time cost3.93601393699646
epoch: 66, iter: 2272, loss: 1.447691798210144, time cost4.00638222694397
epoch: 66, iter: 2273, loss: 0.6925291419029236, time cost4.125010013580322
epoch: 66, iter: 2274, loss: 1.132954716682434, time cost3.886387825012207
epoch: 66, iter: 2275, loss: 0.7269502282142639, time cost3.8505775928497314
epoch: 66, iter: 2276, loss: 1.2360860109329224, time cost3.8152592182159424
epoch: 66, iter: 2277, loss: 1.2567561864852905, time cost4.021701335906982
epoch: 66, iter: 2278, loss: 0.9215178489685059, time cost2.7687857151031494
epoch: 67, iter: 2279, loss: 0.7477285265922546, time cost3.8523006439208984
epoch: 67, iter: 2280, loss: 1.0183022022247314, time cost3.833569288253784
epoch: 67, iter: 2281, loss: 0.9252917170524597, time cost3.9483559131622314
epoch: 67, iter: 2282, loss: 0.6758045554161072, time cost3.798978090286255
epoch: 67, iter: 2283, loss: 1.2471495866775513, time cost3.9215641021728516
epoch: 67, iter: 2284, loss: 0.756458580493927, time cost3.884641170501709
epoch: 67, iter: 2285, loss: 1.1447385549545288, time cost3.9112393856048584
epoch: 67, iter: 2286, loss: 1.2453283071517944, time cost3.804903507232666
epoch: 67, iter: 2287, loss: 0.9915222525596619, time cost3.820002317428589
epoch: 67, iter: 2288, loss: 0.9814501404762268, time cost3.897120952606201
epoch: 67, iter: 2289, loss: 1.2087682485580444, time cost3.8124191761016846
epoch: 67, iter: 2290, loss: 1.2369493246078491, time cost3.8315961360931396
epoch: 67, iter: 2291, loss: 1.0198686122894287, time cost3.808990955352783
epoch: 67, iter: 2292, loss: 1.4938806295394897, time cost4.165960311889648
epoch: 67, iter: 2293, loss: 0.9271255135536194, time cost4.109606027603149
epoch: 67, iter: 2294, loss: 1.5190523862838745, time cost3.994657039642334
epoch: 67, iter: 2295, loss: 0.8078489899635315, time cost3.973818778991699
epoch: 67, iter: 2296, loss: 0.8150018453598022, time cost4.061079502105713
epoch: 67, iter: 2297, loss: 0.5630216598510742, time cost3.9626243114471436
epoch: 67, iter: 2298, loss: 1.2047693729400635, time cost3.7755837440490723
epoch: 67, iter: 2299, loss: 1.0752710103988647, time cost3.887446403503418
epoch: 67, iter: 2300, loss: 1.0746852159500122, time cost3.7985424995422363
tensor([[174., 156., 164.,  ...,   6.,   6.,   7.],
        [103.,  80.,  78.,  ...,  27.,  27.,  19.],
        [ 12.,  71.,  29.,  ...,  12.,  12.,   8.],
        ...,
        [ 29.,  31.,  14.,  ...,   6.,   6.,  10.],
        [215., 160., 116.,  ...,   1.,   1.,   1.],
        [ 79., 106., 151.,  ...,  25.,  25.,  29.]])
Epoch: 67, Iteration: 2300:
TEST A@1: 0.39555555555555555
TEST A@5: 0.7733333333333333
TEST A@10: 0.9
TEST M@B: 0.3349189704090197
TEST M@A: 0.9411687352202597
TEST W@MB: 0.17754197082211343
TEST W@MA: 0.5791475537802899
TEST Time: 358.6387243270874
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 67, iter: 2301, loss: 0.41098639369010925, time cost3.924038887023926
epoch: 67, iter: 2302, loss: 0.8847704529762268, time cost3.949688673019409
epoch: 67, iter: 2303, loss: 0.2991510033607483, time cost3.968315839767456
epoch: 67, iter: 2304, loss: 0.5497018098831177, time cost4.1473307609558105
epoch: 67, iter: 2305, loss: 0.5912187099456787, time cost3.9795899391174316
epoch: 67, iter: 2306, loss: 1.2810660600662231, time cost4.0918426513671875
epoch: 67, iter: 2307, loss: 1.0225447416305542, time cost3.8945682048797607
epoch: 67, iter: 2308, loss: 0.9813083410263062, time cost4.01633620262146
epoch: 67, iter: 2309, loss: 0.8171713352203369, time cost3.991579294204712
epoch: 67, iter: 2310, loss: 1.1406580209732056, time cost4.0469841957092285
epoch: 67, iter: 2311, loss: 0.6603071093559265, time cost3.9296205043792725
epoch: 67, iter: 2312, loss: 0.7922387719154358, time cost2.8715944290161133
epoch: 68, iter: 2313, loss: 1.113415002822876, time cost4.261210203170776
epoch: 68, iter: 2314, loss: 0.6503100991249084, time cost4.0583319664001465
epoch: 68, iter: 2315, loss: 1.2138400077819824, time cost4.315075635910034
epoch: 68, iter: 2316, loss: 1.090753197669983, time cost4.011672496795654
epoch: 68, iter: 2317, loss: 1.0995116233825684, time cost4.0245866775512695
epoch: 68, iter: 2318, loss: 0.7310892343521118, time cost3.9203414916992188
epoch: 68, iter: 2319, loss: 1.387935996055603, time cost4.0940587520599365
epoch: 68, iter: 2320, loss: 0.8499932289123535, time cost4.090528726577759
epoch: 68, iter: 2321, loss: 1.7915962934494019, time cost4.168904066085815
epoch: 68, iter: 2322, loss: 1.0578546524047852, time cost4.1112072467803955
epoch: 68, iter: 2323, loss: 0.7064087390899658, time cost3.974142551422119
epoch: 68, iter: 2324, loss: 1.5260899066925049, time cost4.065436840057373
epoch: 68, iter: 2325, loss: 0.987948477268219, time cost4.120645523071289
epoch: 68, iter: 2326, loss: 0.9239041805267334, time cost3.9832937717437744
epoch: 68, iter: 2327, loss: 1.0764573812484741, time cost3.858234167098999
epoch: 68, iter: 2328, loss: 0.9504345059394836, time cost4.14201283454895
epoch: 68, iter: 2329, loss: 0.48174217343330383, time cost4.096843957901001
epoch: 68, iter: 2330, loss: 0.6408458948135376, time cost4.095564603805542
epoch: 68, iter: 2331, loss: 1.0702121257781982, time cost4.035487174987793
epoch: 68, iter: 2332, loss: 1.0041179656982422, time cost4.021222829818726
epoch: 68, iter: 2333, loss: 1.2803980112075806, time cost4.129195690155029
epoch: 68, iter: 2334, loss: 0.9558072090148926, time cost4.028753280639648
epoch: 68, iter: 2335, loss: 0.9125947952270508, time cost4.142316579818726
epoch: 68, iter: 2336, loss: 1.45209801197052, time cost4.146061658859253
epoch: 68, iter: 2337, loss: 1.0349440574645996, time cost4.013227224349976
epoch: 68, iter: 2338, loss: 0.7733780741691589, time cost4.230349779129028
epoch: 68, iter: 2339, loss: 0.9639908075332642, time cost3.9907567501068115
epoch: 68, iter: 2340, loss: 1.387007236480713, time cost3.8952841758728027
epoch: 68, iter: 2341, loss: 1.2241135835647583, time cost3.9792966842651367
epoch: 68, iter: 2342, loss: 1.0951502323150635, time cost4.054426670074463
epoch: 68, iter: 2343, loss: 1.0227833986282349, time cost3.879511594772339
epoch: 68, iter: 2344, loss: 1.041752576828003, time cost3.8644306659698486
epoch: 68, iter: 2345, loss: 0.95428466796875, time cost3.948463201522827
epoch: 68, iter: 2346, loss: 0.8676916360855103, time cost2.898251533508301
epoch: 69, iter: 2347, loss: 0.6901692152023315, time cost4.182688474655151
epoch: 69, iter: 2348, loss: 0.7704668045043945, time cost4.054566383361816
epoch: 69, iter: 2349, loss: 0.9855801463127136, time cost3.9859488010406494
epoch: 69, iter: 2350, loss: 1.5006500482559204, time cost3.9279842376708984
tensor([[154., 151., 180.,  ...,   3.,   3.,   3.],
        [ 52.,  54.,  52.,  ...,  22.,  22.,  17.],
        [ 54., 141.,  45.,  ...,   5.,   5.,   2.],
        ...,
        [ 76.,  79.,  48.,  ...,  14.,  14.,  13.],
        [ 91.,  57.,  29.,  ...,   1.,   1.,   1.],
        [ 36.,  92., 152.,  ...,  10.,  10.,  19.]])
Epoch: 69, Iteration: 2350:
TEST A@1: 0.49333333333333335
TEST A@5: 0.8177777777777778
TEST A@10: 0.9
TEST M@B: 0.37898876119818464
TEST M@A: 0.9476838132447104
TEST W@MB: 0.20169484375023747
TEST W@MA: 0.5841166352815303
TEST Time: 507.74630880355835
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 69, iter: 2351, loss: 1.0380196571350098, time cost4.058079242706299
epoch: 69, iter: 2352, loss: 0.7645318508148193, time cost3.9904274940490723
epoch: 69, iter: 2353, loss: 0.852817177772522, time cost3.9215409755706787
epoch: 69, iter: 2354, loss: 1.0279089212417603, time cost4.11764669418335
epoch: 69, iter: 2355, loss: 1.3490148782730103, time cost4.085148811340332
epoch: 69, iter: 2356, loss: 0.8515118360519409, time cost3.9868016242980957
epoch: 69, iter: 2357, loss: 1.111931562423706, time cost4.108480930328369
epoch: 69, iter: 2358, loss: 0.9453350901603699, time cost4.003727912902832
epoch: 69, iter: 2359, loss: 0.829551100730896, time cost4.0190041065216064
epoch: 69, iter: 2360, loss: 0.9523242712020874, time cost3.9508118629455566
epoch: 69, iter: 2361, loss: 1.3486684560775757, time cost4.038815498352051
epoch: 69, iter: 2362, loss: 0.48699885606765747, time cost4.015052080154419
epoch: 69, iter: 2363, loss: 0.6557452082633972, time cost4.11614990234375
epoch: 69, iter: 2364, loss: 1.314564824104309, time cost4.079294919967651
epoch: 69, iter: 2365, loss: 1.4102110862731934, time cost4.1370861530303955
epoch: 69, iter: 2366, loss: 1.4102990627288818, time cost3.997258186340332
epoch: 69, iter: 2367, loss: 0.8145170211791992, time cost4.0118491649627686
epoch: 69, iter: 2368, loss: 0.9925081729888916, time cost3.947967052459717
epoch: 69, iter: 2369, loss: 0.7061545252799988, time cost4.120291471481323
epoch: 69, iter: 2370, loss: 0.9518786072731018, time cost4.192914962768555
epoch: 69, iter: 2371, loss: 1.265462875366211, time cost4.133346796035767
epoch: 69, iter: 2372, loss: 0.7486606240272522, time cost3.939756155014038
epoch: 69, iter: 2373, loss: 0.8342865109443665, time cost4.061575889587402
epoch: 69, iter: 2374, loss: 0.9512268900871277, time cost3.937793016433716
epoch: 69, iter: 2375, loss: 1.4736117124557495, time cost3.9918618202209473
epoch: 69, iter: 2376, loss: 0.6416585445404053, time cost3.936340808868408
epoch: 69, iter: 2377, loss: 0.519053041934967, time cost3.897886276245117
epoch: 69, iter: 2378, loss: 1.350066900253296, time cost3.934303045272827
epoch: 69, iter: 2379, loss: 1.7712502479553223, time cost3.8943145275115967
epoch: 69, iter: 2380, loss: 0.6581376791000366, time cost3.0260560512542725
epoch: 70, iter: 2381, loss: 0.9860886931419373, time cost3.9993858337402344
epoch: 70, iter: 2382, loss: 0.9223389625549316, time cost4.043825626373291
epoch: 70, iter: 2383, loss: 1.2036478519439697, time cost3.9541525840759277
epoch: 70, iter: 2384, loss: 1.152020812034607, time cost3.8723604679107666
epoch: 70, iter: 2385, loss: 1.0750370025634766, time cost4.20920467376709
epoch: 70, iter: 2386, loss: 0.7659050226211548, time cost4.097813367843628
epoch: 70, iter: 2387, loss: 0.4455236494541168, time cost4.1100475788116455
epoch: 70, iter: 2388, loss: 0.7853749394416809, time cost4.085767984390259
epoch: 70, iter: 2389, loss: 0.7811689972877502, time cost4.2060627937316895
epoch: 70, iter: 2390, loss: 0.8121026158332825, time cost4.179558753967285
epoch: 70, iter: 2391, loss: 1.1317455768585205, time cost4.057004928588867
epoch: 70, iter: 2392, loss: 0.7808903455734253, time cost4.05072808265686
epoch: 70, iter: 2393, loss: 1.0255343914031982, time cost4.112642288208008
epoch: 70, iter: 2394, loss: 0.8585194945335388, time cost4.045140743255615
epoch: 70, iter: 2395, loss: 0.5663881301879883, time cost3.5694072246551514
epoch: 70, iter: 2396, loss: 0.9179293513298035, time cost3.2854907512664795
epoch: 70, iter: 2397, loss: 1.1105557680130005, time cost3.6572654247283936
epoch: 70, iter: 2398, loss: 0.825054943561554, time cost4.344964265823364
epoch: 70, iter: 2399, loss: 0.848414957523346, time cost4.407912969589233
epoch: 70, iter: 2400, loss: 1.0905057191848755, time cost4.472959756851196
tensor([[148., 125., 135.,  ...,  20.,  20.,  11.],
        [  7.,   7.,   7.,  ...,   7.,   7.,   4.],
        [ 46., 111.,  34.,  ...,  22.,  22.,  14.],
        ...,
        [ 74.,  69.,  52.,  ...,  38.,  38.,  38.],
        [  9.,   6.,   3.,  ...,   1.,   1.,   1.],
        [143., 145., 256.,  ...,  11.,  11.,  12.]])
Epoch: 70, Iteration: 2400:
TEST A@1: 0.46
TEST A@5: 0.8288888888888889
TEST A@10: 0.9222222222222223
TEST M@B: 0.36917175453579854
TEST M@A: 0.9471403833361534
TEST W@MB: 0.1969683215297064
TEST W@MA: 0.5837142919529471
TEST Time: 502.2302477359772
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 70, iter: 2401, loss: 0.8920716047286987, time cost4.067560195922852
epoch: 70, iter: 2402, loss: 0.7200993299484253, time cost4.045532464981079
epoch: 70, iter: 2403, loss: 0.6090193390846252, time cost4.091610670089722
epoch: 70, iter: 2404, loss: 1.0283074378967285, time cost4.124057292938232
epoch: 70, iter: 2405, loss: 0.7499788403511047, time cost4.611883163452148
epoch: 70, iter: 2406, loss: 1.0552667379379272, time cost4.286370754241943
epoch: 70, iter: 2407, loss: 0.522395670413971, time cost4.0479865074157715
epoch: 70, iter: 2408, loss: 0.7949631214141846, time cost4.039414405822754
epoch: 70, iter: 2409, loss: 0.962306022644043, time cost4.19603705406189
epoch: 70, iter: 2410, loss: 0.868690550327301, time cost4.173449277877808
epoch: 70, iter: 2411, loss: 0.3363003432750702, time cost4.253738641738892
epoch: 70, iter: 2412, loss: 0.7087507247924805, time cost4.088541269302368
epoch: 70, iter: 2413, loss: 1.126838207244873, time cost4.182687044143677
epoch: 70, iter: 2414, loss: 0.5393153429031372, time cost2.880720615386963
epoch: 71, iter: 2415, loss: 1.0253877639770508, time cost4.161200046539307
epoch: 71, iter: 2416, loss: 1.293306827545166, time cost4.331206560134888
epoch: 71, iter: 2417, loss: 0.8886371850967407, time cost4.389297246932983
epoch: 71, iter: 2418, loss: 0.7613728046417236, time cost4.223710060119629
epoch: 71, iter: 2419, loss: 0.7689707279205322, time cost4.237552881240845
epoch: 71, iter: 2420, loss: 0.5946886539459229, time cost4.32774806022644
epoch: 71, iter: 2421, loss: 0.48299646377563477, time cost4.202383756637573
epoch: 71, iter: 2422, loss: 1.1513035297393799, time cost4.174341201782227
epoch: 71, iter: 2423, loss: 0.7454886436462402, time cost4.104211330413818
epoch: 71, iter: 2424, loss: 1.2576854228973389, time cost3.0560357570648193
epoch: 71, iter: 2425, loss: 1.8398152589797974, time cost4.12299108505249
epoch: 71, iter: 2426, loss: 1.1208888292312622, time cost4.020737886428833
epoch: 71, iter: 2427, loss: 0.9364349246025085, time cost4.019415616989136
epoch: 71, iter: 2428, loss: 0.7546207904815674, time cost3.9273762702941895
epoch: 71, iter: 2429, loss: 1.2159544229507446, time cost4.0277323722839355
epoch: 71, iter: 2430, loss: 1.090604305267334, time cost4.038383960723877
epoch: 71, iter: 2431, loss: 0.7662124633789062, time cost3.9995779991149902
epoch: 71, iter: 2432, loss: 1.2759966850280762, time cost3.952610969543457
epoch: 71, iter: 2433, loss: 0.5997079014778137, time cost4.05103325843811
epoch: 71, iter: 2434, loss: 1.159092903137207, time cost4.02547287940979
epoch: 71, iter: 2435, loss: 0.8870001435279846, time cost3.9069674015045166
epoch: 71, iter: 2436, loss: 0.9477874040603638, time cost4.039662599563599
epoch: 71, iter: 2437, loss: 0.8477670550346375, time cost3.9969749450683594
epoch: 71, iter: 2438, loss: 0.685693085193634, time cost4.046562194824219
epoch: 71, iter: 2439, loss: 0.8401568531990051, time cost4.005162000656128
epoch: 71, iter: 2440, loss: 1.0223084688186646, time cost4.08791708946228
epoch: 71, iter: 2441, loss: 0.7857072949409485, time cost3.930016040802002
epoch: 71, iter: 2442, loss: 1.1862326860427856, time cost3.9324426651000977
epoch: 71, iter: 2443, loss: 1.2080429792404175, time cost4.130829811096191
epoch: 71, iter: 2444, loss: 1.1066820621490479, time cost3.9606680870056152
epoch: 71, iter: 2445, loss: 0.9212071895599365, time cost4.030554533004761
epoch: 71, iter: 2446, loss: 0.8150739073753357, time cost3.9724836349487305
epoch: 71, iter: 2447, loss: 0.9400864839553833, time cost4.183224439620972
epoch: 71, iter: 2448, loss: 0.26106899976730347, time cost2.9803314208984375
epoch: 72, iter: 2449, loss: 1.1993687152862549, time cost4.137066125869751
epoch: 72, iter: 2450, loss: 0.5969892144203186, time cost4.030324220657349
tensor([[114.,  97., 105.,  ...,   7.,   7.,   6.],
        [ 40.,  26.,  26.,  ...,   7.,   7.,   4.],
        [ 20.,  80.,  42.,  ...,   8.,   8.,   4.],
        ...,
        [ 64.,  61.,  43.,  ...,  17.,  17.,  20.],
        [ 51.,  32.,   6.,  ...,   1.,   1.,   1.],
        [216., 206., 294.,  ...,  33.,  33.,  31.]])
Epoch: 72, Iteration: 2450:
TEST A@1: 0.42
TEST A@5: 0.7688888888888888
TEST A@10: 0.8688888888888889
TEST M@B: 0.34727450126898046
TEST M@A: 0.9470819815919395
TEST W@MB: 0.18573000652302205
TEST W@MA: 0.5841785855723889
TEST Time: 504.60522079467773
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 72, iter: 2451, loss: 0.9080327749252319, time cost4.0944602489471436
epoch: 72, iter: 2452, loss: 1.0051943063735962, time cost3.963547945022583
epoch: 72, iter: 2453, loss: 0.8175716400146484, time cost4.023686647415161
epoch: 72, iter: 2454, loss: 0.6280089020729065, time cost4.0360658168792725
epoch: 72, iter: 2455, loss: 0.813158392906189, time cost3.9532272815704346
epoch: 72, iter: 2456, loss: 0.5647110939025879, time cost3.948561668395996
epoch: 72, iter: 2457, loss: 0.7254670858383179, time cost3.9818615913391113
epoch: 72, iter: 2458, loss: 0.6795079708099365, time cost4.07065486907959
epoch: 72, iter: 2459, loss: 0.9792119860649109, time cost4.0087666511535645
epoch: 72, iter: 2460, loss: 1.6833465099334717, time cost3.3138656616210938
epoch: 72, iter: 2461, loss: 0.358270525932312, time cost3.047362804412842
epoch: 72, iter: 2462, loss: 0.5769509673118591, time cost3.6697795391082764
epoch: 72, iter: 2463, loss: 0.6623400449752808, time cost3.845855951309204
epoch: 72, iter: 2464, loss: 1.199402928352356, time cost3.663815975189209
epoch: 72, iter: 2465, loss: 1.1539515256881714, time cost3.7527575492858887
epoch: 72, iter: 2466, loss: 0.6958088278770447, time cost3.948056221008301
epoch: 72, iter: 2467, loss: 1.059287190437317, time cost3.8893556594848633
epoch: 72, iter: 2468, loss: 0.9248439073562622, time cost4.014012336730957
epoch: 72, iter: 2469, loss: 0.6792610287666321, time cost3.819333791732788
epoch: 72, iter: 2470, loss: 1.3243478536605835, time cost3.8979902267456055
epoch: 72, iter: 2471, loss: 1.1078647375106812, time cost3.7795772552490234
epoch: 72, iter: 2472, loss: 1.0965945720672607, time cost4.0097815990448
epoch: 72, iter: 2473, loss: 0.4376421570777893, time cost3.7474472522735596
epoch: 72, iter: 2474, loss: 1.0428142547607422, time cost3.8706467151641846
epoch: 72, iter: 2475, loss: 1.2031329870224, time cost3.8820388317108154
epoch: 72, iter: 2476, loss: 0.7994976043701172, time cost3.860002040863037
epoch: 72, iter: 2477, loss: 1.028052568435669, time cost3.8246712684631348
epoch: 72, iter: 2478, loss: 1.4476470947265625, time cost3.8236491680145264
epoch: 72, iter: 2479, loss: 1.2912253141403198, time cost3.931131362915039
epoch: 72, iter: 2480, loss: 1.0630247592926025, time cost3.806306838989258
epoch: 72, iter: 2481, loss: 1.0653915405273438, time cost3.86916184425354
epoch: 72, iter: 2482, loss: 1.028843641281128, time cost2.7686543464660645
epoch: 73, iter: 2483, loss: 0.8160874843597412, time cost3.8146908283233643
epoch: 73, iter: 2484, loss: 0.6246359944343567, time cost3.8278539180755615
epoch: 73, iter: 2485, loss: 0.29768824577331543, time cost3.9929497241973877
epoch: 73, iter: 2486, loss: 0.7941062450408936, time cost3.800703763961792
epoch: 73, iter: 2487, loss: 0.5485844612121582, time cost3.7129852771759033
epoch: 73, iter: 2488, loss: 1.0564948320388794, time cost3.950765609741211
epoch: 73, iter: 2489, loss: 1.0670185089111328, time cost3.8349735736846924
epoch: 73, iter: 2490, loss: 1.07538902759552, time cost3.8872194290161133
epoch: 73, iter: 2491, loss: 1.21085524559021, time cost3.784846067428589
epoch: 73, iter: 2492, loss: 0.7086735963821411, time cost4.0635082721710205
epoch: 73, iter: 2493, loss: 1.150171160697937, time cost3.9911088943481445
epoch: 73, iter: 2494, loss: 1.368172287940979, time cost3.8441147804260254
epoch: 73, iter: 2495, loss: 1.0502039194107056, time cost3.895484209060669
epoch: 73, iter: 2496, loss: 1.4510817527770996, time cost3.742300033569336
epoch: 73, iter: 2497, loss: 1.042374849319458, time cost3.8559982776641846
epoch: 73, iter: 2498, loss: 0.7587814927101135, time cost3.810485601425171
epoch: 73, iter: 2499, loss: 0.869274377822876, time cost3.9802749156951904
epoch: 73, iter: 2500, loss: 0.9142158627510071, time cost3.76640248298645
tensor([[152., 105., 114.,  ...,   1.,   1.,   1.],
        [  9.,  12.,  10.,  ...,  13.,  13.,   8.],
        [ 39., 117.,  36.,  ...,   5.,   5.,   2.],
        ...,
        [ 55.,  52.,  29.,  ...,  12.,  12.,  16.],
        [165.,  71.,   6.,  ...,   1.,   1.,   1.],
        [ 76., 123., 202.,  ...,  12.,  12.,   8.]])
Epoch: 73, Iteration: 2500:
TEST A@1: 0.5311111111111111
TEST A@5: 0.8888888888888888
TEST A@10: 0.96
TEST M@B: 0.4176446731336466
TEST M@A: 0.9550461349320849
TEST W@MB: 0.22316320341017007
TEST W@MA: 0.5898021095065005
TEST Time: 488.7952301502228
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 73, iter: 2501, loss: 1.3362752199172974, time cost3.934438467025757
epoch: 73, iter: 2502, loss: 0.961582362651825, time cost3.8620028495788574
epoch: 73, iter: 2503, loss: 0.5013187527656555, time cost3.858412027359009
epoch: 73, iter: 2504, loss: 1.1504396200180054, time cost4.02442479133606
epoch: 73, iter: 2505, loss: 1.0131255388259888, time cost3.8718221187591553
epoch: 73, iter: 2506, loss: 0.8144817352294922, time cost3.913072347640991
epoch: 73, iter: 2507, loss: 0.6018071174621582, time cost3.981025457382202
epoch: 73, iter: 2508, loss: 1.3887819051742554, time cost3.873408079147339
epoch: 73, iter: 2509, loss: 0.9237967729568481, time cost3.841870069503784
epoch: 73, iter: 2510, loss: 1.082021713256836, time cost4.107417345046997
epoch: 73, iter: 2511, loss: 0.9339306950569153, time cost4.027897357940674
epoch: 73, iter: 2512, loss: 0.9288137555122375, time cost3.8192899227142334
epoch: 73, iter: 2513, loss: 0.5883381962776184, time cost3.941284656524658
epoch: 73, iter: 2514, loss: 1.0428872108459473, time cost3.8989169597625732
epoch: 73, iter: 2515, loss: 0.8814444541931152, time cost3.824941873550415
epoch: 73, iter: 2516, loss: 0.6096956729888916, time cost2.7423763275146484
epoch: 74, iter: 2517, loss: 0.9157209396362305, time cost4.081081867218018
epoch: 74, iter: 2518, loss: 1.4420725107192993, time cost3.918351650238037
epoch: 74, iter: 2519, loss: 1.1027454137802124, time cost3.86100697517395
epoch: 74, iter: 2520, loss: 0.8396283388137817, time cost3.849816083908081
epoch: 74, iter: 2521, loss: 1.735589623451233, time cost3.9586105346679688
epoch: 74, iter: 2522, loss: 1.1566648483276367, time cost4.0866100788116455
epoch: 74, iter: 2523, loss: 0.8990887999534607, time cost3.9733731746673584
epoch: 74, iter: 2524, loss: 1.0118027925491333, time cost4.087584733963013
epoch: 74, iter: 2525, loss: 0.6522718667984009, time cost3.9690816402435303
epoch: 74, iter: 2526, loss: 0.7399086356163025, time cost4.031888484954834
epoch: 74, iter: 2527, loss: 0.8094193339347839, time cost3.9035964012145996
epoch: 74, iter: 2528, loss: 1.3846120834350586, time cost3.825838088989258
epoch: 74, iter: 2529, loss: 0.8718645572662354, time cost3.85916805267334
epoch: 74, iter: 2530, loss: 0.9534224271774292, time cost3.9383583068847656
epoch: 74, iter: 2531, loss: 1.370199203491211, time cost4.062768220901489
epoch: 74, iter: 2532, loss: 1.0176713466644287, time cost3.8500192165374756
epoch: 74, iter: 2533, loss: 1.5853310823440552, time cost3.9434456825256348
epoch: 74, iter: 2534, loss: 0.7696232199668884, time cost3.800184726715088
epoch: 74, iter: 2535, loss: 0.8366459608078003, time cost3.9009950160980225
epoch: 74, iter: 2536, loss: 1.2835909128189087, time cost3.9568989276885986
epoch: 74, iter: 2537, loss: 0.9058579206466675, time cost3.9954376220703125
epoch: 74, iter: 2538, loss: 0.9688617587089539, time cost4.0110979080200195
epoch: 74, iter: 2539, loss: 1.0831503868103027, time cost3.758915424346924
epoch: 74, iter: 2540, loss: 0.7748603224754333, time cost3.90509033203125
epoch: 74, iter: 2541, loss: 1.2587084770202637, time cost3.9950926303863525
epoch: 74, iter: 2542, loss: 0.7577342987060547, time cost3.9282820224761963
epoch: 74, iter: 2543, loss: 0.9319190382957458, time cost3.91666316986084
epoch: 74, iter: 2544, loss: 0.8179379105567932, time cost3.949618339538574
epoch: 74, iter: 2545, loss: 0.9553204774856567, time cost3.949601888656616
epoch: 74, iter: 2546, loss: 1.026940107345581, time cost3.7770206928253174
epoch: 74, iter: 2547, loss: 1.2926878929138184, time cost3.8171980381011963
epoch: 74, iter: 2548, loss: 0.913565993309021, time cost3.9814891815185547
epoch: 74, iter: 2549, loss: 0.6309579610824585, time cost3.9227585792541504
epoch: 74, iter: 2550, loss: 0.7568343281745911, time cost2.7438125610351562
tensor([[112.,  85.,  90.,  ...,   7.,   7.,   5.],
        [ 44.,  20.,  20.,  ...,   6.,   6.,   3.],
        [ 16.,  65.,  55.,  ...,   2.,   2.,   1.],
        ...,
        [ 32.,  34.,  15.,  ...,   5.,   5.,  10.],
        [120., 101.,  10.,  ...,   1.,   1.,   1.],
        [ 34.,  43.,  71.,  ...,  15.,  15.,  22.]])
Epoch: 74, Iteration: 2550:
TEST A@1: 0.5066666666666667
TEST A@5: 0.8266666666666667
TEST A@10: 0.9222222222222223
TEST M@B: 0.3821637206309368
TEST M@A: 0.9512348439544587
TEST W@MB: 0.20445901796908364
TEST W@MA: 0.5872109947413793
TEST Time: 484.65133810043335
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 75, iter: 2551, loss: 0.6931885480880737, time cost3.9809839725494385
epoch: 75, iter: 2552, loss: 0.8885288834571838, time cost3.936823606491089
epoch: 75, iter: 2553, loss: 0.7028234004974365, time cost4.007205247879028
epoch: 75, iter: 2554, loss: 0.6161377429962158, time cost3.9090747833251953
epoch: 75, iter: 2555, loss: 1.23319411277771, time cost3.9222216606140137
epoch: 75, iter: 2556, loss: 1.0404188632965088, time cost3.922960042953491
epoch: 75, iter: 2557, loss: 0.9138225317001343, time cost3.8408710956573486
epoch: 75, iter: 2558, loss: 1.0655437707901, time cost4.111752033233643
epoch: 75, iter: 2559, loss: 1.0451114177703857, time cost3.9629852771759033
epoch: 75, iter: 2560, loss: 0.7868711948394775, time cost3.949333906173706
epoch: 75, iter: 2561, loss: 1.0623224973678589, time cost3.839292287826538
epoch: 75, iter: 2562, loss: 0.8337947130203247, time cost3.9334378242492676
epoch: 75, iter: 2563, loss: 0.7887955904006958, time cost3.9511518478393555
epoch: 75, iter: 2564, loss: 0.8369405269622803, time cost3.836066961288452
epoch: 75, iter: 2565, loss: 1.0974565744400024, time cost3.9787440299987793
epoch: 75, iter: 2566, loss: 0.7665048837661743, time cost3.896106481552124
epoch: 75, iter: 2567, loss: 0.8919392824172974, time cost3.9501113891601562
epoch: 75, iter: 2568, loss: 0.7369865775108337, time cost3.9460289478302
epoch: 75, iter: 2569, loss: 1.0856553316116333, time cost3.9186439514160156
epoch: 75, iter: 2570, loss: 0.7743455171585083, time cost3.910370349884033
epoch: 75, iter: 2571, loss: 1.00838303565979, time cost3.977074384689331
epoch: 75, iter: 2572, loss: 0.7330988645553589, time cost3.8871846199035645
epoch: 75, iter: 2573, loss: 0.7792568206787109, time cost3.9187610149383545
epoch: 75, iter: 2574, loss: 0.8767566680908203, time cost3.985623359680176
epoch: 75, iter: 2575, loss: 1.261080265045166, time cost3.756554365158081
epoch: 75, iter: 2576, loss: 0.5692130923271179, time cost3.917349338531494
epoch: 75, iter: 2577, loss: 1.0308337211608887, time cost4.057230234146118
epoch: 75, iter: 2578, loss: 0.9331991672515869, time cost4.000112295150757
epoch: 75, iter: 2579, loss: 0.792274534702301, time cost3.971221923828125
epoch: 75, iter: 2580, loss: 0.8437737822532654, time cost3.8695716857910156
epoch: 75, iter: 2581, loss: 1.0130722522735596, time cost3.946218490600586
epoch: 75, iter: 2582, loss: 0.764707088470459, time cost3.8706278800964355
epoch: 75, iter: 2583, loss: 0.6814473271369934, time cost3.8381459712982178
epoch: 75, iter: 2584, loss: 0.6872639060020447, time cost2.8195042610168457
epoch: 76, iter: 2585, loss: 1.3226879835128784, time cost4.011505603790283
epoch: 76, iter: 2586, loss: 0.6386182904243469, time cost3.9071648120880127
epoch: 76, iter: 2587, loss: 1.0655766725540161, time cost3.8608505725860596
epoch: 76, iter: 2588, loss: 1.257336139678955, time cost4.114670276641846
epoch: 76, iter: 2589, loss: 1.2208037376403809, time cost3.8458092212677
epoch: 76, iter: 2590, loss: 0.821823239326477, time cost3.781221389770508
epoch: 76, iter: 2591, loss: 0.638857364654541, time cost3.961496114730835
epoch: 76, iter: 2592, loss: 0.8618372678756714, time cost3.845533847808838
epoch: 76, iter: 2593, loss: 1.1064865589141846, time cost3.961470603942871
epoch: 76, iter: 2594, loss: 0.9632454514503479, time cost3.9056355953216553
epoch: 76, iter: 2595, loss: 0.8062974810600281, time cost3.8188748359680176
epoch: 76, iter: 2596, loss: 0.9378544092178345, time cost3.8454034328460693
epoch: 76, iter: 2597, loss: 0.8894067406654358, time cost4.036305665969849
epoch: 76, iter: 2598, loss: 0.6503332853317261, time cost3.9751999378204346
epoch: 76, iter: 2599, loss: 0.6164515018463135, time cost3.9634745121002197
epoch: 76, iter: 2600, loss: 1.2176361083984375, time cost3.9064369201660156
tensor([[261., 239., 247.,  ...,   1.,   1.,   1.],
        [ 23.,  15.,  15.,  ...,  10.,  10.,   8.],
        [ 58., 194.,  73.,  ...,   4.,   4.,   1.],
        ...,
        [ 41.,  35.,  20.,  ...,  13.,  13.,  14.],
        [ 26.,  15.,   9.,  ...,   1.,   1.,   1.],
        [124., 171., 234.,  ...,   4.,   4.,   9.]])
Epoch: 76, Iteration: 2600:
TEST A@1: 0.5111111111111111
TEST A@5: 0.8444444444444444
TEST A@10: 0.9222222222222223
TEST M@B: 0.39857497177394724
TEST M@A: 0.9487451485966052
TEST W@MB: 0.21179197124980442
TEST W@MA: 0.5848275676096466
TEST Time: 490.60942244529724
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 76, iter: 2601, loss: 0.6573812961578369, time cost3.894794225692749
epoch: 76, iter: 2602, loss: 0.739538311958313, time cost3.980022430419922
epoch: 76, iter: 2603, loss: 0.9596871733665466, time cost4.060001373291016
epoch: 76, iter: 2604, loss: 1.7254667282104492, time cost4.250909328460693
epoch: 76, iter: 2605, loss: 1.004428744316101, time cost4.103183031082153
epoch: 76, iter: 2606, loss: 1.051507592201233, time cost4.073843002319336
epoch: 76, iter: 2607, loss: 0.8123854994773865, time cost4.090716123580933
epoch: 76, iter: 2608, loss: 0.7427648305892944, time cost4.188133239746094
epoch: 76, iter: 2609, loss: 1.0541609525680542, time cost4.382653474807739
epoch: 76, iter: 2610, loss: 1.2701200246810913, time cost4.042556524276733
epoch: 76, iter: 2611, loss: 1.0937285423278809, time cost4.326561212539673
epoch: 76, iter: 2612, loss: 0.8246813416481018, time cost4.1108410358428955
epoch: 76, iter: 2613, loss: 0.7365405559539795, time cost4.1693267822265625
epoch: 76, iter: 2614, loss: 1.1778154373168945, time cost4.045310735702515
epoch: 76, iter: 2615, loss: 1.6808196306228638, time cost4.099785327911377
epoch: 76, iter: 2616, loss: 1.73880136013031, time cost4.110917806625366
epoch: 76, iter: 2617, loss: 0.8907545804977417, time cost4.153138637542725
epoch: 76, iter: 2618, loss: 0.45669546723365784, time cost3.1565322875976562
epoch: 77, iter: 2619, loss: 0.36390095949172974, time cost4.184332847595215
epoch: 77, iter: 2620, loss: 0.850985050201416, time cost4.338811159133911
epoch: 77, iter: 2621, loss: 0.9908860325813293, time cost4.244585752487183
epoch: 77, iter: 2622, loss: 1.1131795644760132, time cost4.349406719207764
epoch: 77, iter: 2623, loss: 1.1213366985321045, time cost4.307670593261719
epoch: 77, iter: 2624, loss: 0.6768321394920349, time cost4.224218368530273
epoch: 77, iter: 2625, loss: 1.6875579357147217, time cost4.169904947280884
epoch: 77, iter: 2626, loss: 0.5962622761726379, time cost4.29438591003418
epoch: 77, iter: 2627, loss: 0.6150762438774109, time cost3.324152708053589
epoch: 77, iter: 2628, loss: 1.0675697326660156, time cost3.8845553398132324
epoch: 77, iter: 2629, loss: 1.1746370792388916, time cost3.820457696914673
epoch: 77, iter: 2630, loss: 1.1350970268249512, time cost3.802114486694336
epoch: 77, iter: 2631, loss: 0.8249435424804688, time cost3.902127265930176
epoch: 77, iter: 2632, loss: 1.0156737565994263, time cost3.822620391845703
epoch: 77, iter: 2633, loss: 0.7104634046554565, time cost3.9915778636932373
epoch: 77, iter: 2634, loss: 1.2299073934555054, time cost4.037516832351685
epoch: 77, iter: 2635, loss: 0.9307377934455872, time cost4.027871608734131
epoch: 77, iter: 2636, loss: 1.127985954284668, time cost3.879708766937256
epoch: 77, iter: 2637, loss: 1.2546708583831787, time cost3.9243829250335693
epoch: 77, iter: 2638, loss: 0.6930912137031555, time cost4.0392115116119385
epoch: 77, iter: 2639, loss: 1.3605732917785645, time cost4.022185325622559
epoch: 77, iter: 2640, loss: 0.4789036214351654, time cost3.9805643558502197
epoch: 77, iter: 2641, loss: 0.9655753374099731, time cost3.978658676147461
epoch: 77, iter: 2642, loss: 0.9660050868988037, time cost3.976017475128174
epoch: 77, iter: 2643, loss: 0.9069070816040039, time cost3.7732183933258057
epoch: 77, iter: 2644, loss: 0.8002162575721741, time cost3.9119269847869873
epoch: 77, iter: 2645, loss: 0.8343698978424072, time cost3.9609458446502686
epoch: 77, iter: 2646, loss: 1.2415822744369507, time cost3.9521617889404297
epoch: 77, iter: 2647, loss: 0.9259967803955078, time cost3.9183807373046875
epoch: 77, iter: 2648, loss: 1.2559285163879395, time cost3.961198329925537
epoch: 77, iter: 2649, loss: 1.2153551578521729, time cost3.9043288230895996
epoch: 77, iter: 2650, loss: 0.8831043243408203, time cost3.7963783740997314
tensor([[135., 112., 119.,  ...,   8.,   8.,   6.],
        [ 40.,  21.,  20.,  ...,   9.,   9.,   6.],
        [ 22., 120.,  70.,  ...,  13.,  13.,   6.],
        ...,
        [ 11.,  11.,   6.,  ...,  14.,  14.,  16.],
        [ 41.,  34.,   6.,  ...,   1.,   1.,   1.],
        [145., 139., 203.,  ...,  13.,  13.,  15.]])
Epoch: 77, Iteration: 2650:
TEST A@1: 0.4822222222222222
TEST A@5: 0.8311111111111111
TEST A@10: 0.9222222222222223
TEST M@B: 0.37198440934823135
TEST M@A: 0.943815817209478
TEST W@MB: 0.19744019575731037
TEST W@MA: 0.5805814653284953
TEST Time: 487.56185507774353
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 77, iter: 2651, loss: 0.6067498326301575, time cost4.0243871212005615
epoch: 77, iter: 2652, loss: 1.4093737602233887, time cost2.7871181964874268
epoch: 78, iter: 2653, loss: 1.141680359840393, time cost3.9800572395324707
epoch: 78, iter: 2654, loss: 0.6060144305229187, time cost4.111536979675293
epoch: 78, iter: 2655, loss: 0.7379342317581177, time cost3.922287702560425
epoch: 78, iter: 2656, loss: 1.1380646228790283, time cost3.967635154724121
epoch: 78, iter: 2657, loss: 1.3065561056137085, time cost3.781306743621826
epoch: 78, iter: 2658, loss: 0.8056966662406921, time cost4.016636848449707
epoch: 78, iter: 2659, loss: 0.889686107635498, time cost3.886167526245117
epoch: 78, iter: 2660, loss: 1.0426886081695557, time cost3.967593193054199
epoch: 78, iter: 2661, loss: 0.8382680416107178, time cost3.8956873416900635
epoch: 78, iter: 2662, loss: 0.7534828186035156, time cost3.8404128551483154
epoch: 78, iter: 2663, loss: 0.8005568385124207, time cost3.8429129123687744
epoch: 78, iter: 2664, loss: 1.1003700494766235, time cost3.7999749183654785
epoch: 78, iter: 2665, loss: 0.8250664472579956, time cost3.9022598266601562
epoch: 78, iter: 2666, loss: 0.4037843942642212, time cost3.9694554805755615
epoch: 78, iter: 2667, loss: 1.090271234512329, time cost3.8706469535827637
epoch: 78, iter: 2668, loss: 0.7820969820022583, time cost3.8149287700653076
epoch: 78, iter: 2669, loss: 0.8964527249336243, time cost3.8785581588745117
epoch: 78, iter: 2670, loss: 0.45458102226257324, time cost3.816516637802124
epoch: 78, iter: 2671, loss: 0.6720577478408813, time cost3.790466070175171
epoch: 78, iter: 2672, loss: 2.0733540058135986, time cost3.752910614013672
epoch: 78, iter: 2673, loss: 1.1674820184707642, time cost3.8203816413879395
epoch: 78, iter: 2674, loss: 0.6425822377204895, time cost3.8209216594696045
epoch: 78, iter: 2675, loss: 0.8666067123413086, time cost3.76701283454895
epoch: 78, iter: 2676, loss: 1.0160125494003296, time cost3.7974934577941895
epoch: 78, iter: 2677, loss: 1.0085570812225342, time cost3.793409824371338
epoch: 78, iter: 2678, loss: 0.9639468789100647, time cost3.9630725383758545
epoch: 78, iter: 2679, loss: 1.0495225191116333, time cost3.8184731006622314
epoch: 78, iter: 2680, loss: 1.5152546167373657, time cost3.816370725631714
epoch: 78, iter: 2681, loss: 0.5768032670021057, time cost3.8592045307159424
epoch: 78, iter: 2682, loss: 1.103158712387085, time cost3.796262502670288
epoch: 78, iter: 2683, loss: 0.8508777618408203, time cost3.8620946407318115
epoch: 78, iter: 2684, loss: 1.1190932989120483, time cost3.7580602169036865
epoch: 78, iter: 2685, loss: 0.49115708470344543, time cost3.9117393493652344
epoch: 78, iter: 2686, loss: 1.0443168878555298, time cost2.8014910221099854
epoch: 79, iter: 2687, loss: 1.1142040491104126, time cost3.8708226680755615
epoch: 79, iter: 2688, loss: 0.9322916269302368, time cost3.717022657394409
epoch: 79, iter: 2689, loss: 1.2822277545928955, time cost3.9641430377960205
epoch: 79, iter: 2690, loss: 0.43955686688423157, time cost3.9905805587768555
epoch: 79, iter: 2691, loss: 1.3852672576904297, time cost3.7090702056884766
epoch: 79, iter: 2692, loss: 0.8928268551826477, time cost4.084241628646851
epoch: 79, iter: 2693, loss: 0.48621782660484314, time cost3.845966100692749
epoch: 79, iter: 2694, loss: 0.7301112413406372, time cost3.8779890537261963
epoch: 79, iter: 2695, loss: 0.9420876502990723, time cost4.000587224960327
epoch: 79, iter: 2696, loss: 1.2663408517837524, time cost3.9895763397216797
epoch: 79, iter: 2697, loss: 0.8218243718147278, time cost3.875781774520874
epoch: 79, iter: 2698, loss: 1.059708595275879, time cost3.8040311336517334
epoch: 79, iter: 2699, loss: 0.7450100183486938, time cost4.131676912307739
epoch: 79, iter: 2700, loss: 0.6956387758255005, time cost3.9673430919647217
tensor([[ 47.,  36.,  50.,  ...,   5.,   5.,   2.],
        [ 33.,  32.,  27.,  ...,   9.,   9.,   6.],
        [ 43., 168.,  91.,  ...,   7.,   7.,   2.],
        ...,
        [ 22.,  22.,  13.,  ...,   7.,   7.,  10.],
        [ 25.,  24.,   5.,  ...,   1.,   1.,   1.],
        [ 55.,  96., 179.,  ...,   5.,   5.,  11.]])
Epoch: 79, Iteration: 2700:
TEST A@1: 0.5466666666666666
TEST A@5: 0.8711111111111111
TEST A@10: 0.96
TEST M@B: 0.4174930158190895
TEST M@A: 0.9553167890956595
TEST W@MB: 0.22278568516252392
TEST W@MA: 0.5900734015776541
TEST Time: 492.71717619895935
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 79, iter: 2701, loss: 0.9319894313812256, time cost3.861525058746338
epoch: 79, iter: 2702, loss: 0.6994403004646301, time cost3.876406669616699
epoch: 79, iter: 2703, loss: 0.3770383596420288, time cost3.7020492553710938
epoch: 79, iter: 2704, loss: 0.6839655637741089, time cost3.8446974754333496
epoch: 79, iter: 2705, loss: 1.057466983795166, time cost3.843965768814087
epoch: 79, iter: 2706, loss: 0.5849106907844543, time cost3.966704845428467
epoch: 79, iter: 2707, loss: 1.036267638206482, time cost3.8143563270568848
epoch: 79, iter: 2708, loss: 0.8198900818824768, time cost3.782182455062866
epoch: 79, iter: 2709, loss: 1.0832442045211792, time cost3.9513297080993652
epoch: 79, iter: 2710, loss: 0.9659703969955444, time cost3.9050424098968506
epoch: 79, iter: 2711, loss: 0.7646387219429016, time cost4.059686183929443
epoch: 79, iter: 2712, loss: 0.8691827654838562, time cost3.9719316959381104
epoch: 79, iter: 2713, loss: 0.791029155254364, time cost3.859649896621704
epoch: 79, iter: 2714, loss: 0.49576130509376526, time cost3.893538475036621
epoch: 79, iter: 2715, loss: 0.9988088011741638, time cost3.8271853923797607
epoch: 79, iter: 2716, loss: 1.0404701232910156, time cost3.883542776107788
epoch: 79, iter: 2717, loss: 0.7922298908233643, time cost3.800917387008667
epoch: 79, iter: 2718, loss: 0.9297921657562256, time cost3.9828217029571533
epoch: 79, iter: 2719, loss: 0.6221824884414673, time cost3.9818358421325684
epoch: 79, iter: 2720, loss: 0.47654786705970764, time cost2.749641180038452
epoch: 80, iter: 2721, loss: 0.7519702911376953, time cost4.111555099487305
epoch: 80, iter: 2722, loss: 0.8351688385009766, time cost4.006871938705444
epoch: 80, iter: 2723, loss: 1.2952693700790405, time cost3.993535280227661
epoch: 80, iter: 2724, loss: 0.5748342871665955, time cost4.087944269180298
epoch: 80, iter: 2725, loss: 0.4387558698654175, time cost3.8727176189422607
epoch: 80, iter: 2726, loss: 0.7793334126472473, time cost4.0336713790893555
epoch: 80, iter: 2727, loss: 0.9242754578590393, time cost3.904909133911133
epoch: 80, iter: 2728, loss: 1.1180572509765625, time cost3.8916513919830322
epoch: 80, iter: 2729, loss: 0.7040314674377441, time cost4.104458570480347
epoch: 80, iter: 2730, loss: 0.715917706489563, time cost3.930903434753418
epoch: 80, iter: 2731, loss: 1.08791184425354, time cost3.9912781715393066
epoch: 80, iter: 2732, loss: 0.8873397707939148, time cost4.011626958847046
epoch: 80, iter: 2733, loss: 0.8046340942382812, time cost3.9625842571258545
epoch: 80, iter: 2734, loss: 0.7897931933403015, time cost3.8300933837890625
epoch: 80, iter: 2735, loss: 1.5776454210281372, time cost3.9526538848876953
epoch: 80, iter: 2736, loss: 1.009072184562683, time cost3.859645128250122
epoch: 80, iter: 2737, loss: 1.152239441871643, time cost3.7098193168640137
epoch: 80, iter: 2738, loss: 0.9573131203651428, time cost3.8029441833496094
epoch: 80, iter: 2739, loss: 0.5511937141418457, time cost3.9633679389953613
epoch: 80, iter: 2740, loss: 0.7999944090843201, time cost3.9688708782196045
epoch: 80, iter: 2741, loss: 1.2205923795700073, time cost3.9830870628356934
epoch: 80, iter: 2742, loss: 0.5348557829856873, time cost3.8932952880859375
epoch: 80, iter: 2743, loss: 1.199917197227478, time cost3.871936082839966
epoch: 80, iter: 2744, loss: 0.6670747995376587, time cost3.8822474479675293
epoch: 80, iter: 2745, loss: 0.5703484416007996, time cost3.883676052093506
epoch: 80, iter: 2746, loss: 0.8510698676109314, time cost4.061836242675781
epoch: 80, iter: 2747, loss: 1.0279948711395264, time cost3.8945252895355225
epoch: 80, iter: 2748, loss: 0.9850962162017822, time cost3.9292423725128174
epoch: 80, iter: 2749, loss: 0.7885570526123047, time cost3.8361644744873047
epoch: 80, iter: 2750, loss: 0.8168009519577026, time cost3.979996681213379
tensor([[134., 110., 115.,  ...,   2.,   2.,   2.],
        [ 35.,  25.,  25.,  ...,   9.,   9.,   4.],
        [ 69., 203.,  92.,  ...,   7.,   7.,   4.],
        ...,
        [111., 109.,  72.,  ...,   5.,   5.,  11.],
        [ 16.,  14.,   4.,  ...,   1.,   1.,   1.],
        [218., 181., 253.,  ...,   5.,   5.,   7.]])
Epoch: 80, Iteration: 2750:
TEST A@1: 0.48444444444444446
TEST A@5: 0.8488888888888889
TEST A@10: 0.9377777777777778
TEST M@B: 0.3907289671746687
TEST M@A: 0.9499713654879569
TEST W@MB: 0.2087384520043048
TEST W@MA: 0.5857464463582351
TEST Time: 488.4454183578491
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 80, iter: 2751, loss: 1.2535996437072754, time cost4.033490180969238
epoch: 80, iter: 2752, loss: 0.5356593132019043, time cost3.9241325855255127
epoch: 80, iter: 2753, loss: 0.752903401851654, time cost4.00195837020874
epoch: 80, iter: 2754, loss: 0.6864712834358215, time cost2.748170852661133
epoch: 81, iter: 2755, loss: 1.381511926651001, time cost4.0625081062316895
epoch: 81, iter: 2756, loss: 0.7977766990661621, time cost3.9352962970733643
epoch: 81, iter: 2757, loss: 0.6717150211334229, time cost4.005923509597778
epoch: 81, iter: 2758, loss: 0.8257694840431213, time cost3.867276191711426
epoch: 81, iter: 2759, loss: 1.7420965433120728, time cost3.9009575843811035
epoch: 81, iter: 2760, loss: 0.7648383378982544, time cost3.9693968296051025
epoch: 81, iter: 2761, loss: 0.8742607831954956, time cost3.8705031871795654
epoch: 81, iter: 2762, loss: 0.8471744656562805, time cost3.862889289855957
epoch: 81, iter: 2763, loss: 0.5786003470420837, time cost3.9021246433258057
epoch: 81, iter: 2764, loss: 0.46878933906555176, time cost3.817835807800293
epoch: 81, iter: 2765, loss: 0.922592043876648, time cost3.890134811401367
epoch: 81, iter: 2766, loss: 0.7225555181503296, time cost3.8675410747528076
epoch: 81, iter: 2767, loss: 1.1485304832458496, time cost3.8634321689605713
epoch: 81, iter: 2768, loss: 1.3223639726638794, time cost3.984874725341797
epoch: 81, iter: 2769, loss: 0.4353148639202118, time cost3.8437860012054443
epoch: 81, iter: 2770, loss: 1.258595585823059, time cost4.014875888824463
epoch: 81, iter: 2771, loss: 1.0421394109725952, time cost3.798326015472412
epoch: 81, iter: 2772, loss: 0.8139290809631348, time cost3.8401260375976562
epoch: 81, iter: 2773, loss: 1.068172812461853, time cost3.7867274284362793
epoch: 81, iter: 2774, loss: 1.0063872337341309, time cost4.054333209991455
epoch: 81, iter: 2775, loss: 0.8059349060058594, time cost3.815889596939087
epoch: 81, iter: 2776, loss: 0.9586840867996216, time cost4.006259202957153
epoch: 81, iter: 2777, loss: 1.0785876512527466, time cost3.9114558696746826
epoch: 81, iter: 2778, loss: 0.9199231266975403, time cost3.9044690132141113
epoch: 81, iter: 2779, loss: 0.6033732295036316, time cost4.030130863189697
epoch: 81, iter: 2780, loss: 0.684165894985199, time cost3.9795007705688477
epoch: 81, iter: 2781, loss: 1.672583818435669, time cost3.8428711891174316
epoch: 81, iter: 2782, loss: 0.7220911979675293, time cost3.8732759952545166
epoch: 81, iter: 2783, loss: 0.7662011384963989, time cost3.976710081100464
epoch: 81, iter: 2784, loss: 0.7780256867408752, time cost3.8404088020324707
epoch: 81, iter: 2785, loss: 1.0870164632797241, time cost3.8408455848693848
epoch: 81, iter: 2786, loss: 1.015489935874939, time cost3.849640130996704
epoch: 81, iter: 2787, loss: 0.8901284337043762, time cost3.915675401687622
epoch: 81, iter: 2788, loss: 0.9169672727584839, time cost2.91561222076416
epoch: 82, iter: 2789, loss: 0.6303455829620361, time cost4.1415486335754395
epoch: 82, iter: 2790, loss: 0.46137192845344543, time cost3.9437599182128906
epoch: 82, iter: 2791, loss: 0.9460180401802063, time cost3.899386167526245
epoch: 82, iter: 2792, loss: 0.7010612487792969, time cost3.784630537033081
epoch: 82, iter: 2793, loss: 1.091647982597351, time cost4.023696660995483
epoch: 82, iter: 2794, loss: 1.2791064977645874, time cost3.7715516090393066
epoch: 82, iter: 2795, loss: 1.0297802686691284, time cost3.893909454345703
epoch: 82, iter: 2796, loss: 1.8165819644927979, time cost3.8934972286224365
epoch: 82, iter: 2797, loss: 1.1332013607025146, time cost3.9183528423309326
epoch: 82, iter: 2798, loss: 1.5113602876663208, time cost3.9055421352386475
epoch: 82, iter: 2799, loss: 0.7633993029594421, time cost4.092973947525024
epoch: 82, iter: 2800, loss: 1.0672316551208496, time cost4.182570457458496
tensor([[347., 300., 309.,  ...,   2.,   2.,   2.],
        [  8.,   8.,   8.,  ...,  12.,  12.,   5.],
        [ 72., 158., 106.,  ...,  16.,  16.,   9.],
        ...,
        [ 53.,  53.,  28.,  ...,   6.,   6.,   8.],
        [ 35.,  31.,   4.,  ...,   1.,   1.,   1.],
        [ 94., 156., 260.,  ...,   3.,   3.,   6.]])
Epoch: 82, Iteration: 2800:
TEST A@1: 0.4222222222222222
TEST A@5: 0.8222222222222222
TEST A@10: 0.92
TEST M@B: 0.35572642100231466
TEST M@A: 0.9503084109186062
TEST W@MB: 0.19047638880316697
TEST W@MA: 0.5861781307764199
TEST Time: 426.82211422920227
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 82, iter: 2801, loss: 0.8271480798721313, time cost4.066023111343384
epoch: 82, iter: 2802, loss: 1.182492971420288, time cost3.879563331604004
epoch: 82, iter: 2803, loss: 0.632331907749176, time cost4.017122745513916
epoch: 82, iter: 2804, loss: 1.0972925424575806, time cost3.983497142791748
epoch: 82, iter: 2805, loss: 1.06694495677948, time cost3.979015588760376
epoch: 82, iter: 2806, loss: 1.02170991897583, time cost3.9055542945861816
epoch: 82, iter: 2807, loss: 0.7824552059173584, time cost3.9788966178894043
epoch: 82, iter: 2808, loss: 1.1818522214889526, time cost4.007152795791626
epoch: 82, iter: 2809, loss: 0.966389000415802, time cost3.9667112827301025
epoch: 82, iter: 2810, loss: 1.4227070808410645, time cost4.114403486251831
epoch: 82, iter: 2811, loss: 0.915573000907898, time cost3.961334705352783
epoch: 82, iter: 2812, loss: 0.3935501277446747, time cost3.9139771461486816
epoch: 82, iter: 2813, loss: 1.2276287078857422, time cost3.916271209716797
epoch: 82, iter: 2814, loss: 1.2340589761734009, time cost3.9474446773529053
epoch: 82, iter: 2815, loss: 0.6853618621826172, time cost3.9728293418884277
epoch: 82, iter: 2816, loss: 0.9442725777626038, time cost3.8988754749298096
epoch: 82, iter: 2817, loss: 0.43096885085105896, time cost3.7907516956329346
epoch: 82, iter: 2818, loss: 1.224676251411438, time cost3.9870662689208984
epoch: 82, iter: 2819, loss: 1.2805969715118408, time cost3.770453691482544
epoch: 82, iter: 2820, loss: 0.8533908128738403, time cost3.867051601409912
epoch: 82, iter: 2821, loss: 0.6390893459320068, time cost3.8791234493255615
epoch: 82, iter: 2822, loss: 0.9702211618423462, time cost2.985405445098877
epoch: 83, iter: 2823, loss: 0.7741687893867493, time cost3.9383745193481445
epoch: 83, iter: 2824, loss: 1.014127492904663, time cost4.168595552444458
epoch: 83, iter: 2825, loss: 1.1613481044769287, time cost4.049351930618286
epoch: 83, iter: 2826, loss: 1.0580276250839233, time cost3.991260290145874
epoch: 83, iter: 2827, loss: 0.9111028909683228, time cost4.010153532028198
epoch: 83, iter: 2828, loss: 0.798519492149353, time cost4.257269859313965
epoch: 83, iter: 2829, loss: 0.863632321357727, time cost4.160200357437134
epoch: 83, iter: 2830, loss: 0.9048485159873962, time cost4.264999628067017
epoch: 83, iter: 2831, loss: 0.8267037868499756, time cost4.115123987197876
epoch: 83, iter: 2832, loss: 0.9053751230239868, time cost4.065222501754761
epoch: 83, iter: 2833, loss: 0.7883524894714355, time cost3.9450228214263916
epoch: 83, iter: 2834, loss: 1.0885974168777466, time cost4.095788955688477
epoch: 83, iter: 2835, loss: 0.7719898819923401, time cost4.153066158294678
epoch: 83, iter: 2836, loss: 1.5216898918151855, time cost3.6184868812561035
epoch: 83, iter: 2837, loss: 0.807239830493927, time cost3.5681257247924805
epoch: 83, iter: 2838, loss: 0.8929367065429688, time cost3.9686970710754395
epoch: 83, iter: 2839, loss: 1.2495808601379395, time cost3.9186370372772217
epoch: 83, iter: 2840, loss: 0.9763680696487427, time cost3.825355052947998
epoch: 83, iter: 2841, loss: 1.1188358068466187, time cost4.244304180145264
epoch: 83, iter: 2842, loss: 1.8757869005203247, time cost3.943189859390259
epoch: 83, iter: 2843, loss: 1.2631992101669312, time cost3.810028553009033
epoch: 83, iter: 2844, loss: 0.9316879510879517, time cost3.949838876724243
epoch: 83, iter: 2845, loss: 0.46790215373039246, time cost3.9670767784118652
epoch: 83, iter: 2846, loss: 0.7967166304588318, time cost3.8431389331817627
epoch: 83, iter: 2847, loss: 0.9978424310684204, time cost3.737423896789551
epoch: 83, iter: 2848, loss: 0.7444021105766296, time cost3.859306573867798
epoch: 83, iter: 2849, loss: 0.9845216274261475, time cost3.9332776069641113
epoch: 83, iter: 2850, loss: 0.6290415525436401, time cost3.781965970993042
tensor([[355., 326., 329.,  ...,   1.,   1.,   1.],
        [ 19.,  11.,  11.,  ...,   6.,   6.,   2.],
        [ 61., 149.,  89.,  ...,   9.,   9.,   5.],
        ...,
        [191., 203., 130.,  ...,   6.,   6.,   7.],
        [135.,  80.,  43.,  ...,   1.,   1.,   1.],
        [158., 207., 256.,  ...,   1.,   1.,   4.]])
Epoch: 83, Iteration: 2850:
TEST A@1: 0.4666666666666667
TEST A@5: 0.8377777777777777
TEST A@10: 0.9311111111111111
TEST M@B: 0.38681715830372126
TEST M@A: 0.9459631638330895
TEST W@MB: 0.20606186756078923
TEST W@MA: 0.582324919483008
TEST Time: 489.7794632911682
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 83, iter: 2851, loss: 0.6984695196151733, time cost3.8016998767852783
epoch: 83, iter: 2852, loss: 1.2267956733703613, time cost3.878787040710449
epoch: 83, iter: 2853, loss: 0.8972261548042297, time cost4.108685731887817
epoch: 83, iter: 2854, loss: 1.707350730895996, time cost3.9094676971435547
epoch: 83, iter: 2855, loss: 0.8895832896232605, time cost3.9785985946655273
epoch: 83, iter: 2856, loss: 1.1574664115905762, time cost2.831480026245117
epoch: 84, iter: 2857, loss: 0.9876449108123779, time cost4.156300067901611
epoch: 84, iter: 2858, loss: 1.0947736501693726, time cost3.882096529006958
epoch: 84, iter: 2859, loss: 0.7630174160003662, time cost3.9774527549743652
epoch: 84, iter: 2860, loss: 1.065266489982605, time cost3.955446243286133
epoch: 84, iter: 2861, loss: 1.1477967500686646, time cost3.7599964141845703
epoch: 84, iter: 2862, loss: 1.161515235900879, time cost4.063337087631226
epoch: 84, iter: 2863, loss: 1.2165486812591553, time cost3.961362361907959
epoch: 84, iter: 2864, loss: 0.9497610330581665, time cost3.7281103134155273
epoch: 84, iter: 2865, loss: 1.074053168296814, time cost3.9389116764068604
epoch: 84, iter: 2866, loss: 1.2363361120224, time cost3.8973898887634277
epoch: 84, iter: 2867, loss: 1.3570435047149658, time cost3.919823169708252
epoch: 84, iter: 2868, loss: 1.4064054489135742, time cost3.8329477310180664
epoch: 84, iter: 2869, loss: 1.0380860567092896, time cost3.9356677532196045
epoch: 84, iter: 2870, loss: 0.8012216687202454, time cost3.9818007946014404
epoch: 84, iter: 2871, loss: 0.8058964014053345, time cost3.7280094623565674
epoch: 84, iter: 2872, loss: 0.7348710894584656, time cost4.06262731552124
epoch: 84, iter: 2873, loss: 0.6233203411102295, time cost4.0176215171813965
epoch: 84, iter: 2874, loss: 0.7590842843055725, time cost3.7210700511932373
epoch: 84, iter: 2875, loss: 0.8597187995910645, time cost3.8403403759002686
epoch: 84, iter: 2876, loss: 0.6940397024154663, time cost3.8816399574279785
epoch: 84, iter: 2877, loss: 0.7616969347000122, time cost4.068848609924316
epoch: 84, iter: 2878, loss: 0.6860625743865967, time cost3.983661413192749
epoch: 84, iter: 2879, loss: 0.7912957072257996, time cost3.9758083820343018
epoch: 84, iter: 2880, loss: 0.9904605746269226, time cost3.7542357444763184
epoch: 84, iter: 2881, loss: 0.973122775554657, time cost3.824672222137451
epoch: 84, iter: 2882, loss: 1.082618236541748, time cost4.0694193840026855
epoch: 84, iter: 2883, loss: 0.6422958374023438, time cost3.9871251583099365
epoch: 84, iter: 2884, loss: 0.9493421316146851, time cost3.715656042098999
epoch: 84, iter: 2885, loss: 1.1725653409957886, time cost3.844855308532715
epoch: 84, iter: 2886, loss: 0.9121883511543274, time cost3.9179065227508545
epoch: 84, iter: 2887, loss: 0.8991401791572571, time cost4.035696506500244
epoch: 84, iter: 2888, loss: 1.3042426109313965, time cost3.879883050918579
epoch: 84, iter: 2889, loss: 0.7142977118492126, time cost3.7486133575439453
epoch: 84, iter: 2890, loss: 0.4516211748123169, time cost2.7634332180023193
epoch: 85, iter: 2891, loss: 1.3367536067962646, time cost3.8865575790405273
epoch: 85, iter: 2892, loss: 0.6059159636497498, time cost4.031971454620361
epoch: 85, iter: 2893, loss: 0.8582790493965149, time cost3.9968948364257812
epoch: 85, iter: 2894, loss: 0.9821401238441467, time cost3.886549949645996
epoch: 85, iter: 2895, loss: 0.6134254336357117, time cost4.009265661239624
epoch: 85, iter: 2896, loss: 1.054046869277954, time cost4.232774496078491
epoch: 85, iter: 2897, loss: 0.9853743314743042, time cost3.7760581970214844
epoch: 85, iter: 2898, loss: 0.9715512990951538, time cost3.877307176589966
epoch: 85, iter: 2899, loss: 0.67166668176651, time cost3.9865329265594482
epoch: 85, iter: 2900, loss: 1.0596665143966675, time cost4.033116817474365
tensor([[149., 131., 140.,  ...,   7.,   7.,   4.],
        [  6.,   4.,   4.,  ...,  12.,  12.,   7.],
        [ 20.,  86.,  29.,  ...,   5.,   5.,   2.],
        ...,
        [126., 125., 100.,  ...,  20.,  20.,  21.],
        [212., 175., 111.,  ...,   1.,   1.,   1.],
        [ 35.,  94.,  78.,  ...,   9.,   9.,  10.]])
Epoch: 85, Iteration: 2900:
TEST A@1: 0.4866666666666667
TEST A@5: 0.8555555555555555
TEST A@10: 0.94
TEST M@B: 0.3909701179266322
TEST M@A: 0.9474063003670632
TEST W@MB: 0.20807431662194703
TEST W@MA: 0.583446951132407
TEST Time: 493.71470069885254
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 85, iter: 2901, loss: 0.9054460525512695, time cost3.9727272987365723
epoch: 85, iter: 2902, loss: 0.8747627139091492, time cost3.8683583736419678
epoch: 85, iter: 2903, loss: 0.8638814687728882, time cost3.8136157989501953
epoch: 85, iter: 2904, loss: 1.0617560148239136, time cost3.986300468444824
epoch: 85, iter: 2905, loss: 0.7909479737281799, time cost3.8472442626953125
epoch: 85, iter: 2906, loss: 0.7095766067504883, time cost3.833839178085327
epoch: 85, iter: 2907, loss: 1.2055824995040894, time cost3.9814577102661133
epoch: 85, iter: 2908, loss: 1.0133048295974731, time cost3.9787726402282715
epoch: 85, iter: 2909, loss: 0.5502071976661682, time cost3.9066214561462402
epoch: 85, iter: 2910, loss: 0.5058352947235107, time cost3.9745872020721436
epoch: 85, iter: 2911, loss: 0.6994485855102539, time cost3.898914098739624
epoch: 85, iter: 2912, loss: 0.931039571762085, time cost3.76595401763916
epoch: 85, iter: 2913, loss: 0.868939220905304, time cost3.9265120029449463
epoch: 85, iter: 2914, loss: 0.6603796482086182, time cost3.9777462482452393
epoch: 85, iter: 2915, loss: 1.1019030809402466, time cost4.034029245376587
epoch: 85, iter: 2916, loss: 0.7723122835159302, time cost4.093784809112549
epoch: 85, iter: 2917, loss: 0.8431022763252258, time cost3.952000617980957
epoch: 85, iter: 2918, loss: 1.1863069534301758, time cost3.75435471534729
epoch: 85, iter: 2919, loss: 0.9668279886245728, time cost3.789053440093994
epoch: 85, iter: 2920, loss: 0.841720461845398, time cost3.886836528778076
epoch: 85, iter: 2921, loss: 0.7720460295677185, time cost3.7981488704681396
epoch: 85, iter: 2922, loss: 1.128893256187439, time cost3.725539207458496
epoch: 85, iter: 2923, loss: 1.4562089443206787, time cost3.9376511573791504
epoch: 85, iter: 2924, loss: 0.6537275314331055, time cost2.7320218086242676
epoch: 86, iter: 2925, loss: 0.9489396810531616, time cost4.126337766647339
epoch: 86, iter: 2926, loss: 0.6705634593963623, time cost4.003059148788452
epoch: 86, iter: 2927, loss: 0.9105725288391113, time cost4.016825914382935
epoch: 86, iter: 2928, loss: 0.6483727693557739, time cost4.021901607513428
epoch: 86, iter: 2929, loss: 1.7391107082366943, time cost3.8989508152008057
epoch: 86, iter: 2930, loss: 0.7755929827690125, time cost3.9293599128723145
epoch: 86, iter: 2931, loss: 0.9025417566299438, time cost3.9587960243225098
epoch: 86, iter: 2932, loss: 0.9343043565750122, time cost3.865633010864258
epoch: 86, iter: 2933, loss: 0.37320056557655334, time cost3.996727705001831
epoch: 86, iter: 2934, loss: 0.778945803642273, time cost4.0218212604522705
epoch: 86, iter: 2935, loss: 1.3420358896255493, time cost4.0071001052856445
epoch: 86, iter: 2936, loss: 0.6076276302337646, time cost3.958538293838501
epoch: 86, iter: 2937, loss: 0.4575965702533722, time cost3.8696348667144775
epoch: 86, iter: 2938, loss: 0.810733437538147, time cost4.0081963539123535
epoch: 86, iter: 2939, loss: 0.9759600758552551, time cost3.831902265548706
epoch: 86, iter: 2940, loss: 0.9035552740097046, time cost3.8345093727111816
epoch: 86, iter: 2941, loss: 0.44573742151260376, time cost3.964357614517212
epoch: 86, iter: 2942, loss: 0.9969302415847778, time cost3.992837429046631
epoch: 86, iter: 2943, loss: 0.776774525642395, time cost3.8859102725982666
epoch: 86, iter: 2944, loss: 1.01503324508667, time cost3.7296881675720215
epoch: 86, iter: 2945, loss: 0.9095991849899292, time cost3.8610527515411377
epoch: 86, iter: 2946, loss: 1.0960266590118408, time cost3.7496094703674316
epoch: 86, iter: 2947, loss: 0.7077291011810303, time cost3.8034889698028564
epoch: 86, iter: 2948, loss: 0.8127882480621338, time cost3.837782382965088
epoch: 86, iter: 2949, loss: 0.6251605153083801, time cost3.913181781768799
epoch: 86, iter: 2950, loss: 1.0219568014144897, time cost3.6963891983032227
tensor([[115.,  85.,  91.,  ...,   5.,   5.,   5.],
        [ 13.,   9.,   8.,  ...,  10.,  10.,   3.],
        [ 54., 163.,  87.,  ...,   7.,   7.,   4.],
        ...,
        [ 83.,  77.,  53.,  ...,  17.,  17.,  18.],
        [105.,  59.,   9.,  ...,   1.,   1.,   1.],
        [ 29.,  99., 125.,  ...,   4.,   4.,   8.]])
Epoch: 86, Iteration: 2950:
TEST A@1: 0.5044444444444445
TEST A@5: 0.8422222222222222
TEST A@10: 0.92
TEST M@B: 0.3908478500447937
TEST M@A: 0.9490065408821647
TEST W@MB: 0.20728818024854162
TEST W@MA: 0.5848888153809179
TEST Time: 487.28529238700867
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 86, iter: 2951, loss: 0.6606786847114563, time cost3.841902732849121
epoch: 86, iter: 2952, loss: 0.8048527240753174, time cost3.8324437141418457
epoch: 86, iter: 2953, loss: 1.1012063026428223, time cost3.8276283740997314
epoch: 86, iter: 2954, loss: 0.9551994204521179, time cost3.7092530727386475
epoch: 86, iter: 2955, loss: 0.4837968647480011, time cost3.7909016609191895
epoch: 86, iter: 2956, loss: 0.9588408470153809, time cost3.9325015544891357
epoch: 86, iter: 2957, loss: 1.3391135931015015, time cost3.7122437953948975
epoch: 86, iter: 2958, loss: 0.42129603028297424, time cost2.7552971839904785
epoch: 87, iter: 2959, loss: 0.8107335567474365, time cost3.924537181854248
epoch: 87, iter: 2960, loss: 0.7692239284515381, time cost4.011991739273071
epoch: 87, iter: 2961, loss: 0.9614421129226685, time cost4.055060148239136
epoch: 87, iter: 2962, loss: 0.3603473901748657, time cost3.934100866317749
epoch: 87, iter: 2963, loss: 0.6246851086616516, time cost3.9539694786071777
epoch: 87, iter: 2964, loss: 0.6266334056854248, time cost3.8213391304016113
epoch: 87, iter: 2965, loss: 1.0872858762741089, time cost3.8752329349517822
epoch: 87, iter: 2966, loss: 0.9210771322250366, time cost4.067543029785156
epoch: 87, iter: 2967, loss: 1.2067043781280518, time cost3.8698267936706543
epoch: 87, iter: 2968, loss: 0.4733862578868866, time cost3.839921236038208
epoch: 87, iter: 2969, loss: 1.1228686571121216, time cost3.947842836380005
epoch: 87, iter: 2970, loss: 0.9408959150314331, time cost3.849836826324463
epoch: 87, iter: 2971, loss: 0.8641429543495178, time cost3.853639602661133
epoch: 87, iter: 2972, loss: 0.7574945688247681, time cost3.872542142868042
epoch: 87, iter: 2973, loss: 0.736240565776825, time cost3.9739227294921875
epoch: 87, iter: 2974, loss: 1.2536481618881226, time cost4.019727468490601
epoch: 87, iter: 2975, loss: 0.6615579724311829, time cost3.9786698818206787
epoch: 87, iter: 2976, loss: 0.8772921562194824, time cost3.729905843734741
epoch: 87, iter: 2977, loss: 0.692807674407959, time cost3.804899215698242
epoch: 87, iter: 2978, loss: 0.6913535594940186, time cost3.9139397144317627
epoch: 87, iter: 2979, loss: 0.7505404949188232, time cost3.821126699447632
epoch: 87, iter: 2980, loss: 0.9491072297096252, time cost3.9037973880767822
epoch: 87, iter: 2981, loss: 0.7233702540397644, time cost3.9904861450195312
epoch: 87, iter: 2982, loss: 1.158528447151184, time cost4.372576951980591
epoch: 87, iter: 2983, loss: 0.911131739616394, time cost3.7004668712615967
epoch: 87, iter: 2984, loss: 0.5497316718101501, time cost3.6905996799468994
epoch: 87, iter: 2985, loss: 0.9824448823928833, time cost3.8635642528533936
epoch: 87, iter: 2986, loss: 1.1471893787384033, time cost3.9192452430725098
epoch: 87, iter: 2987, loss: 1.0707799196243286, time cost3.801388740539551
epoch: 87, iter: 2988, loss: 1.1023534536361694, time cost3.734039783477783
epoch: 87, iter: 2989, loss: 0.9652140736579895, time cost3.858485221862793
epoch: 87, iter: 2990, loss: 1.2680511474609375, time cost3.839668035507202
epoch: 87, iter: 2991, loss: 0.5757033824920654, time cost3.7979328632354736
epoch: 87, iter: 2992, loss: 0.3519594371318817, time cost2.8950774669647217
epoch: 88, iter: 2993, loss: 0.5354019999504089, time cost4.105380535125732
epoch: 88, iter: 2994, loss: 1.0316965579986572, time cost4.143011808395386
epoch: 88, iter: 2995, loss: 0.890841007232666, time cost3.9468038082122803
epoch: 88, iter: 2996, loss: 0.7118736505508423, time cost3.940920829772949
epoch: 88, iter: 2997, loss: 0.8122168183326721, time cost3.8638598918914795
epoch: 88, iter: 2998, loss: 1.0626769065856934, time cost3.9647510051727295
epoch: 88, iter: 2999, loss: 0.6239781379699707, time cost3.963547945022583
epoch: 88, iter: 3000, loss: 0.9357482194900513, time cost4.000860929489136
tensor([[ 67.,  51.,  63.,  ...,   3.,   3.,   1.],
        [ 47.,  20.,  21.,  ...,  12.,  12.,   4.],
        [ 40., 148.,  44.,  ...,   7.,   7.,   1.],
        ...,
        [ 75.,  79.,  50.,  ...,  19.,  19.,  22.],
        [ 59.,  45.,   6.,  ...,   1.,   1.,   1.],
        [122., 201., 234.,  ...,  11.,  11.,  13.]])
Epoch: 88, Iteration: 3000:
TEST A@1: 0.5444444444444444
TEST A@5: 0.8888888888888888
TEST A@10: 0.9377777777777778
TEST M@B: 0.4196559001129861
TEST M@A: 0.9518369572222795
TEST W@MB: 0.22322936906709404
TEST W@MA: 0.5870635335868681
TEST Time: 426.237423658371
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 88, iter: 3001, loss: 0.5730846524238586, time cost3.779881000518799
epoch: 88, iter: 3002, loss: 0.5240984559059143, time cost3.9168543815612793
epoch: 88, iter: 3003, loss: 1.3906279802322388, time cost3.9879417419433594
epoch: 88, iter: 3004, loss: 0.8690692186355591, time cost4.038356304168701
epoch: 88, iter: 3005, loss: 0.7072023153305054, time cost4.176384210586548
epoch: 88, iter: 3006, loss: 0.516169011592865, time cost4.038229942321777
epoch: 88, iter: 3007, loss: 1.6847578287124634, time cost4.191962480545044
epoch: 88, iter: 3008, loss: 0.9401894807815552, time cost4.0338335037231445
epoch: 88, iter: 3009, loss: 1.0735433101654053, time cost3.8514115810394287
epoch: 88, iter: 3010, loss: 0.5655936598777771, time cost4.245222568511963
epoch: 88, iter: 3011, loss: 0.8339839577674866, time cost3.963247537612915
epoch: 88, iter: 3012, loss: 1.2199379205703735, time cost3.843294858932495
epoch: 88, iter: 3013, loss: 0.7988643050193787, time cost4.045803070068359
epoch: 88, iter: 3014, loss: 1.3864060640335083, time cost4.064915657043457
epoch: 88, iter: 3015, loss: 0.7071563601493835, time cost4.21547532081604
epoch: 88, iter: 3016, loss: 0.8897150158882141, time cost3.8299384117126465
epoch: 88, iter: 3017, loss: 0.9862578511238098, time cost3.8853516578674316
epoch: 88, iter: 3018, loss: 0.6938802599906921, time cost4.179302453994751
epoch: 88, iter: 3019, loss: 1.0547863245010376, time cost3.936575174331665
epoch: 88, iter: 3020, loss: 1.1136022806167603, time cost4.160247325897217
epoch: 88, iter: 3021, loss: 0.9929461479187012, time cost3.7611968517303467
epoch: 88, iter: 3022, loss: 1.3524237871170044, time cost3.826188087463379
epoch: 88, iter: 3023, loss: 1.2570827007293701, time cost4.190410375595093
epoch: 88, iter: 3024, loss: 0.640256404876709, time cost3.6318821907043457
epoch: 88, iter: 3025, loss: 0.5323471426963806, time cost3.8637495040893555
epoch: 88, iter: 3026, loss: 0.57859867811203, time cost2.8513994216918945
epoch: 89, iter: 3027, loss: 1.9220629930496216, time cost4.0523223876953125
epoch: 89, iter: 3028, loss: 1.018201231956482, time cost3.867053747177124
epoch: 89, iter: 3029, loss: 0.2927267849445343, time cost3.993478536605835
epoch: 89, iter: 3030, loss: 0.8387372493743896, time cost4.207636117935181
epoch: 89, iter: 3031, loss: 1.18418288230896, time cost4.244497299194336
epoch: 89, iter: 3032, loss: 1.1100268363952637, time cost4.051125764846802
epoch: 89, iter: 3033, loss: 0.7409941554069519, time cost4.283731698989868
epoch: 89, iter: 3034, loss: 0.8532171845436096, time cost3.9852592945098877
epoch: 89, iter: 3035, loss: 0.814363956451416, time cost4.000194787979126
epoch: 89, iter: 3036, loss: 0.46477797627449036, time cost4.045880317687988
epoch: 89, iter: 3037, loss: 0.6985000967979431, time cost4.203677654266357
epoch: 89, iter: 3038, loss: 0.5697652101516724, time cost4.102330923080444
epoch: 89, iter: 3039, loss: 1.380488395690918, time cost4.062199592590332
epoch: 89, iter: 3040, loss: 0.5284126400947571, time cost4.16606330871582
epoch: 89, iter: 3041, loss: 0.4963039457798004, time cost3.5484707355499268
epoch: 89, iter: 3042, loss: 0.6545863151550293, time cost3.9420504570007324
epoch: 89, iter: 3043, loss: 0.6114324331283569, time cost3.9029555320739746
epoch: 89, iter: 3044, loss: 1.228402018547058, time cost3.7950053215026855
epoch: 89, iter: 3045, loss: 1.219668984413147, time cost4.185218811035156
epoch: 89, iter: 3046, loss: 0.44491487741470337, time cost3.997960090637207
epoch: 89, iter: 3047, loss: 0.7143734097480774, time cost3.816765069961548
epoch: 89, iter: 3048, loss: 1.4821431636810303, time cost4.0395119190216064
epoch: 89, iter: 3049, loss: 0.9325034618377686, time cost4.0735509395599365
epoch: 89, iter: 3050, loss: 0.531395673751831, time cost3.919177532196045
tensor([[ 31.,  29.,  37.,  ...,   2.,   2.,   1.],
        [ 29.,  26.,  24.,  ...,   8.,   8.,   7.],
        [ 43., 177.,  62.,  ...,  10.,  10.,   3.],
        ...,
        [ 78.,  72.,  50.,  ...,  19.,  19.,  20.],
        [ 73.,  47.,   7.,  ...,   1.,   1.,   1.],
        [ 50., 160., 202.,  ...,   3.,   3.,   3.]])
Epoch: 89, Iteration: 3050:
TEST A@1: 0.5555555555555556
TEST A@5: 0.9022222222222223
TEST A@10: 0.9533333333333334
TEST M@B: 0.42443186993838933
TEST M@A: 0.9570609118447654
TEST W@MB: 0.22648803029836082
TEST W@MA: 0.5915446097247018
TEST Time: 491.96860432624817
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 89, iter: 3051, loss: 0.8789113759994507, time cost3.89540696144104
epoch: 89, iter: 3052, loss: 1.1565239429473877, time cost3.962120532989502
epoch: 89, iter: 3053, loss: 1.0058857202529907, time cost3.778850555419922
epoch: 89, iter: 3054, loss: 1.122199296951294, time cost3.8855254650115967
epoch: 89, iter: 3055, loss: 1.154753565788269, time cost3.941746473312378
epoch: 89, iter: 3056, loss: 0.9175274968147278, time cost3.9180705547332764
epoch: 89, iter: 3057, loss: 0.7995148301124573, time cost3.970539093017578
epoch: 89, iter: 3058, loss: 0.6172047853469849, time cost4.069716453552246
epoch: 89, iter: 3059, loss: 1.2225359678268433, time cost3.7600858211517334
epoch: 89, iter: 3060, loss: 0.5709763765335083, time cost2.941950798034668
epoch: 90, iter: 3061, loss: 0.9419244527816772, time cost3.8317742347717285
epoch: 90, iter: 3062, loss: 0.7808289527893066, time cost3.980233669281006
epoch: 90, iter: 3063, loss: 0.7077223062515259, time cost3.9682512283325195
epoch: 90, iter: 3064, loss: 0.6311235427856445, time cost3.9044229984283447
epoch: 90, iter: 3065, loss: 0.815290093421936, time cost3.932699203491211
epoch: 90, iter: 3066, loss: 0.5546467900276184, time cost3.8773674964904785
epoch: 90, iter: 3067, loss: 0.7464624047279358, time cost3.934990406036377
epoch: 90, iter: 3068, loss: 0.9282471537590027, time cost3.9049489498138428
epoch: 90, iter: 3069, loss: 0.8100748062133789, time cost4.044961214065552
epoch: 90, iter: 3070, loss: 0.4926154613494873, time cost3.890549898147583
epoch: 90, iter: 3071, loss: 0.5830894112586975, time cost3.9432740211486816
epoch: 90, iter: 3072, loss: 0.9535333514213562, time cost3.8303325176239014
epoch: 90, iter: 3073, loss: 0.549091637134552, time cost3.9661595821380615
epoch: 90, iter: 3074, loss: 0.5358082056045532, time cost3.7669174671173096
epoch: 90, iter: 3075, loss: 0.6869670748710632, time cost3.9168684482574463
epoch: 90, iter: 3076, loss: 0.8652567267417908, time cost4.034540891647339
epoch: 90, iter: 3077, loss: 0.5213942527770996, time cost3.832881212234497
epoch: 90, iter: 3078, loss: 0.4119412899017334, time cost3.9567677974700928
epoch: 90, iter: 3079, loss: 0.8579874634742737, time cost3.836731195449829
epoch: 90, iter: 3080, loss: 0.9839006066322327, time cost4.016857862472534
epoch: 90, iter: 3081, loss: 0.9883177280426025, time cost3.8806543350219727
epoch: 90, iter: 3082, loss: 1.0124051570892334, time cost3.772662878036499
epoch: 90, iter: 3083, loss: 0.938172459602356, time cost3.8649511337280273
epoch: 90, iter: 3084, loss: 0.9284236431121826, time cost3.877882719039917
epoch: 90, iter: 3085, loss: 0.8667032718658447, time cost3.8876352310180664
epoch: 90, iter: 3086, loss: 0.9200676083564758, time cost3.9900872707366943
epoch: 90, iter: 3087, loss: 1.4361580610275269, time cost3.8119187355041504
epoch: 90, iter: 3088, loss: 0.43665584921836853, time cost3.6822962760925293
epoch: 90, iter: 3089, loss: 0.7879905700683594, time cost3.7838082313537598
epoch: 90, iter: 3090, loss: 0.6443354487419128, time cost3.840759038925171
epoch: 90, iter: 3091, loss: 0.7971214056015015, time cost3.9256837368011475
epoch: 90, iter: 3092, loss: 0.38262104988098145, time cost3.704450845718384
epoch: 90, iter: 3093, loss: 1.0799546241760254, time cost3.8054487705230713
epoch: 90, iter: 3094, loss: 1.098993182182312, time cost2.7590339183807373
epoch: 91, iter: 3095, loss: 1.029617190361023, time cost3.9520673751831055
epoch: 91, iter: 3096, loss: 0.639320433139801, time cost3.833225727081299
epoch: 91, iter: 3097, loss: 0.5503256916999817, time cost3.763596773147583
epoch: 91, iter: 3098, loss: 1.5792155265808105, time cost3.8286614418029785
epoch: 91, iter: 3099, loss: 1.1099848747253418, time cost3.9602179527282715
epoch: 91, iter: 3100, loss: 0.8019905686378479, time cost3.939149856567383
tensor([[123.,  95., 104.,  ...,   1.,   1.,   1.],
        [ 18.,  17.,  17.,  ...,  13.,  13.,   7.],
        [ 35.,  89.,  33.,  ...,   2.,   2.,   1.],
        ...,
        [ 75.,  71.,  43.,  ...,   7.,   7.,   6.],
        [  9.,   8.,   3.,  ...,   1.,   1.,   1.],
        [ 54., 151., 186.,  ...,   1.,   1.,   4.]])
Epoch: 91, Iteration: 3100:
TEST A@1: 0.5511111111111111
TEST A@5: 0.8644444444444445
TEST A@10: 0.9355555555555556
TEST M@B: 0.42206784936580616
TEST M@A: 0.9566230434067325
TEST W@MB: 0.22661911148294955
TEST W@MA: 0.5910419149584292
TEST Time: 484.23579263687134
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 91, iter: 3101, loss: 0.9127799272537231, time cost3.832157611846924
epoch: 91, iter: 3102, loss: 0.8977497816085815, time cost3.9018373489379883
epoch: 91, iter: 3103, loss: 1.0237199068069458, time cost3.7600693702697754
epoch: 91, iter: 3104, loss: 1.1662338972091675, time cost3.864323377609253
epoch: 91, iter: 3105, loss: 0.8950361013412476, time cost3.737224817276001
epoch: 91, iter: 3106, loss: 0.5965610146522522, time cost3.8380050659179688
epoch: 91, iter: 3107, loss: 0.9362142086029053, time cost3.96658992767334
epoch: 91, iter: 3108, loss: 1.0703316926956177, time cost3.880565881729126
epoch: 91, iter: 3109, loss: 0.5898475646972656, time cost3.837968349456787
epoch: 91, iter: 3110, loss: 0.6737115979194641, time cost3.904924154281616
epoch: 91, iter: 3111, loss: 1.5068446397781372, time cost4.042801141738892
epoch: 91, iter: 3112, loss: 0.4892730116844177, time cost3.9770820140838623
epoch: 91, iter: 3113, loss: 1.0936663150787354, time cost4.0641770362854
epoch: 91, iter: 3114, loss: 0.715264081954956, time cost3.928740978240967
epoch: 91, iter: 3115, loss: 0.39197540283203125, time cost3.9098081588745117
epoch: 91, iter: 3116, loss: 0.5733298659324646, time cost3.9665465354919434
epoch: 91, iter: 3117, loss: 0.9639127850532532, time cost3.8516180515289307
epoch: 91, iter: 3118, loss: 0.8147809505462646, time cost3.7712864875793457
epoch: 91, iter: 3119, loss: 1.0082128047943115, time cost3.8831028938293457
epoch: 91, iter: 3120, loss: 0.9712520241737366, time cost3.9871790409088135
epoch: 91, iter: 3121, loss: 1.0147595405578613, time cost3.8478901386260986
epoch: 91, iter: 3122, loss: 1.1830668449401855, time cost3.8664324283599854
epoch: 91, iter: 3123, loss: 0.6025918126106262, time cost3.8779356479644775
epoch: 91, iter: 3124, loss: 0.47469639778137207, time cost3.9210727214813232
epoch: 91, iter: 3125, loss: 1.3096460103988647, time cost3.8766720294952393
epoch: 91, iter: 3126, loss: 1.0254303216934204, time cost4.093194961547852
epoch: 91, iter: 3127, loss: 0.8981643915176392, time cost3.9983277320861816
epoch: 91, iter: 3128, loss: 0.45596495270729065, time cost2.7567503452301025
epoch: 92, iter: 3129, loss: 1.1652307510375977, time cost4.024083137512207
epoch: 92, iter: 3130, loss: 0.6980026364326477, time cost3.996246337890625
epoch: 92, iter: 3131, loss: 1.0126827955245972, time cost3.858150005340576
epoch: 92, iter: 3132, loss: 0.676279604434967, time cost3.969331741333008
epoch: 92, iter: 3133, loss: 1.6133137941360474, time cost4.073188304901123
epoch: 92, iter: 3134, loss: 0.898967444896698, time cost4.018166542053223
epoch: 92, iter: 3135, loss: 1.22160005569458, time cost3.9404356479644775
epoch: 92, iter: 3136, loss: 0.6523371338844299, time cost4.005961656570435
epoch: 92, iter: 3137, loss: 1.1166051626205444, time cost3.9954006671905518
epoch: 92, iter: 3138, loss: 1.035654902458191, time cost4.049637317657471
epoch: 92, iter: 3139, loss: 1.1871238946914673, time cost3.9802708625793457
epoch: 92, iter: 3140, loss: 0.7073647975921631, time cost3.887225866317749
epoch: 92, iter: 3141, loss: 0.7992985248565674, time cost3.845144271850586
epoch: 92, iter: 3142, loss: 0.9611864686012268, time cost3.81042218208313
epoch: 92, iter: 3143, loss: 1.2149485349655151, time cost3.7946064472198486
epoch: 92, iter: 3144, loss: 0.7501065135002136, time cost3.99745512008667
epoch: 92, iter: 3145, loss: 0.8881263732910156, time cost4.096608400344849
epoch: 92, iter: 3146, loss: 0.9398272037506104, time cost3.9313294887542725
epoch: 92, iter: 3147, loss: 0.6897011399269104, time cost3.806459665298462
epoch: 92, iter: 3148, loss: 0.8847497701644897, time cost3.8313827514648438
epoch: 92, iter: 3149, loss: 1.4430177211761475, time cost3.732797145843506
epoch: 92, iter: 3150, loss: 0.5567309856414795, time cost3.9460067749023438
tensor([[133.,  96., 110.,  ...,   2.,   2.,   1.],
        [  9.,   9.,   7.,  ...,  11.,  11.,   5.],
        [128., 242., 118.,  ...,   2.,   2.,   1.],
        ...,
        [ 51.,  63.,  30.,  ...,  11.,  11.,   9.],
        [ 34.,  24.,  11.,  ...,   2.,   2.,   2.],
        [ 40.,  60., 119.,  ...,   2.,   2.,   2.]])
Epoch: 92, Iteration: 3150:
TEST A@1: 0.45555555555555555
TEST A@5: 0.8555555555555555
TEST A@10: 0.9355555555555556
TEST M@B: 0.3859961715793648
TEST M@A: 0.9540912088605589
TEST W@MB: 0.20729454929822358
TEST W@MA: 0.5890640680568215
TEST Time: 481.2031235694885
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 92, iter: 3151, loss: 0.9609065651893616, time cost4.064817667007446
epoch: 92, iter: 3152, loss: 0.8670253157615662, time cost3.9304118156433105
epoch: 92, iter: 3153, loss: 0.9537897706031799, time cost4.121710538864136
epoch: 92, iter: 3154, loss: 0.7393048405647278, time cost3.9893462657928467
epoch: 92, iter: 3155, loss: 0.4844699203968048, time cost3.7738354206085205
epoch: 92, iter: 3156, loss: 0.9137588739395142, time cost3.7968015670776367
epoch: 92, iter: 3157, loss: 1.1479480266571045, time cost3.9596118927001953
epoch: 92, iter: 3158, loss: 0.8697364330291748, time cost3.8660895824432373
epoch: 92, iter: 3159, loss: 0.7308715581893921, time cost3.866992473602295
epoch: 92, iter: 3160, loss: 0.7289775609970093, time cost3.8853771686553955
epoch: 92, iter: 3161, loss: 0.40661266446113586, time cost3.933772087097168
epoch: 92, iter: 3162, loss: 0.38330674171447754, time cost2.914466142654419
epoch: 93, iter: 3163, loss: 0.9444193840026855, time cost3.928133010864258
epoch: 93, iter: 3164, loss: 0.9243414402008057, time cost4.08078145980835
epoch: 93, iter: 3165, loss: 0.931279718875885, time cost3.876380205154419
epoch: 93, iter: 3166, loss: 0.851881742477417, time cost3.948303699493408
epoch: 93, iter: 3167, loss: 1.3844597339630127, time cost3.9969024658203125
epoch: 93, iter: 3168, loss: 0.6916314959526062, time cost4.037413597106934
epoch: 93, iter: 3169, loss: 0.8226270079612732, time cost4.010066747665405
epoch: 93, iter: 3170, loss: 0.638635516166687, time cost3.956496477127075
epoch: 93, iter: 3171, loss: 0.6551948189735413, time cost4.1425487995147705
epoch: 93, iter: 3172, loss: 1.1922940015792847, time cost3.931386947631836
epoch: 93, iter: 3173, loss: 0.986242413520813, time cost3.9177534580230713
epoch: 93, iter: 3174, loss: 0.5620714426040649, time cost3.8261706829071045
epoch: 93, iter: 3175, loss: 0.5353657603263855, time cost3.947164535522461
epoch: 93, iter: 3176, loss: 0.6042952537536621, time cost3.951982021331787
epoch: 93, iter: 3177, loss: 1.1067625284194946, time cost3.7737741470336914
epoch: 93, iter: 3178, loss: 0.8737232089042664, time cost3.9430277347564697
epoch: 93, iter: 3179, loss: 1.054848074913025, time cost3.852565050125122
epoch: 93, iter: 3180, loss: 0.602128803730011, time cost3.7587356567382812
epoch: 93, iter: 3181, loss: 0.6124184727668762, time cost3.92850399017334
epoch: 93, iter: 3182, loss: 1.038125991821289, time cost3.7994799613952637
epoch: 93, iter: 3183, loss: 0.5434302091598511, time cost3.9642508029937744
epoch: 93, iter: 3184, loss: 0.9188330769538879, time cost3.8194823265075684
epoch: 93, iter: 3185, loss: 0.5600461959838867, time cost3.8472273349761963
epoch: 93, iter: 3186, loss: 0.5874813795089722, time cost4.011981964111328
epoch: 93, iter: 3187, loss: 0.5228670835494995, time cost3.923881769180298
epoch: 93, iter: 3188, loss: 0.8187177777290344, time cost3.9686741828918457
epoch: 93, iter: 3189, loss: 0.5123568773269653, time cost3.8470358848571777
epoch: 93, iter: 3190, loss: 0.6426230669021606, time cost3.7865781784057617
epoch: 93, iter: 3191, loss: 0.6493203639984131, time cost3.9447367191314697
epoch: 93, iter: 3192, loss: 0.4931493401527405, time cost3.9387130737304688
epoch: 93, iter: 3193, loss: 0.810703456401825, time cost3.9898111820220947
epoch: 93, iter: 3194, loss: 0.7953752279281616, time cost4.161540746688843
epoch: 93, iter: 3195, loss: 0.9070645570755005, time cost4.0203351974487305
epoch: 93, iter: 3196, loss: 0.6375962495803833, time cost2.8470139503479004
epoch: 94, iter: 3197, loss: 0.9508808255195618, time cost3.869654893875122
epoch: 94, iter: 3198, loss: 0.38622504472732544, time cost3.932169198989868
epoch: 94, iter: 3199, loss: 0.858704149723053, time cost3.883024215698242
epoch: 94, iter: 3200, loss: 0.4277544617652893, time cost3.8248095512390137
tensor([[116.,  98., 112.,  ...,  24.,  24.,  18.],
        [  6.,  10.,  10.,  ...,  10.,  10.,   8.],
        [ 39., 138.,  56.,  ...,   7.,   7.,   3.],
        ...,
        [ 55.,  56.,  28.,  ...,  21.,  21.,  12.],
        [ 59.,  52.,  12.,  ...,   4.,   4.,   3.],
        [ 28.,  55., 104.,  ...,   1.,   1.,   4.]])
Epoch: 94, Iteration: 3200:
TEST A@1: 0.40444444444444444
TEST A@5: 0.7688888888888888
TEST A@10: 0.8866666666666667
TEST M@B: 0.3489662548630214
TEST M@A: 0.9494289965892195
TEST W@MB: 0.18757264894462644
TEST W@MA: 0.5858861028944221
TEST Time: 482.99584317207336
REAL performance: Top1: 0.5644444444444444, Top5: 0.8844444444444445, Top10: 0.9511111111111111, MB: 0.4276979936701354, MA: 0.951107505573736, WMB: 0.22730486740086803, WMA: 0.5861345991495678
epoch: 94, iter: 3201, loss: 0.6675646901130676, time cost3.804642677307129
epoch: 94, iter: 3202, loss: 0.7152998447418213, time cost3.909966230392456
epoch: 94, iter: 3203, loss: 0.7733951210975647, time cost4.003049850463867
epoch: 94, iter: 3204, loss: 0.7500014901161194, time cost3.316349744796753
epoch: 94, iter: 3205, loss: 1.1643540859222412, time cost3.004692316055298
epoch: 94, iter: 3206, loss: 0.7400399446487427, time cost4.067700386047363
epoch: 94, iter: 3207, loss: 0.8961036801338196, time cost4.142776012420654
epoch: 94, iter: 3208, loss: 1.039354681968689, time cost4.352767705917358
epoch: 94, iter: 3209, loss: 1.0054221153259277, time cost3.9160594940185547
epoch: 94, iter: 3210, loss: 1.0204601287841797, time cost4.192700386047363
epoch: 94, iter: 3211, loss: 0.8615848422050476, time cost4.162609577178955
epoch: 94, iter: 3212, loss: 0.6245421171188354, time cost4.227374076843262
epoch: 94, iter: 3213, loss: 0.6632487773895264, time cost3.8805994987487793
epoch: 94, iter: 3214, loss: 0.8250614404678345, time cost3.936114549636841
epoch: 94, iter: 3215, loss: 1.3862380981445312, time cost4.079281568527222
epoch: 94, iter: 3216, loss: 1.1504138708114624, time cost3.9209396839141846
epoch: 94, iter: 3217, loss: 0.911306619644165, time cost4.14339017868042
epoch: 94, iter: 3218, loss: 1.175467610359192, time cost4.1409828662872314
epoch: 94, iter: 3219, loss: 1.282806396484375, time cost4.224765300750732
epoch: 94, iter: 3220, loss: 0.42229709029197693, time cost4.22823429107666
epoch: 94, iter: 3221, loss: 0.9860774874687195, time cost3.992213249206543
epoch: 94, iter: 3222, loss: 1.1945736408233643, time cost3.978454351425171
epoch: 94, iter: 3223, loss: 1.099059820175171, time cost4.15652060508728
epoch: 94, iter: 3224, loss: 0.9442313313484192, time cost3.931030511856079
epoch: 94, iter: 3225, loss: 1.044750690460205, time cost4.1575047969818115
epoch: 94, iter: 3226, loss: 0.7481036186218262, time cost3.894840955734253
epoch: 94, iter: 3227, loss: 0.9770007729530334, time cost4.307163953781128
epoch: 94, iter: 3228, loss: 1.3189637660980225, time cost4.064967393875122
epoch: 94, iter: 3229, loss: 0.8714257478713989, time cost4.1415746212005615
epoch: 94, iter: 3230, loss: 0.7326780557632446, time cost2.986666202545166
epoch: 95, iter: 3231, loss: 0.8163076639175415, time cost4.4655938148498535
epoch: 95, iter: 3232, loss: 1.0693398714065552, time cost4.247781753540039
epoch: 95, iter: 3233, loss: 1.1172758340835571, time cost4.250954627990723
epoch: 95, iter: 3234, loss: 1.0245405435562134, time cost3.422492504119873
epoch: 95, iter: 3235, loss: 0.6925067901611328, time cost3.6930739879608154
epoch: 95, iter: 3236, loss: 1.257041096687317, time cost3.9985592365264893
epoch: 95, iter: 3237, loss: 1.281082034111023, time cost3.9394400119781494
epoch: 95, iter: 3238, loss: 0.8412352800369263, time cost4.207695484161377
epoch: 95, iter: 3239, loss: 1.2742952108383179, time cost3.9211673736572266
epoch: 95, iter: 3240, loss: 0.8888038396835327, time cost4.005057096481323
epoch: 95, iter: 3241, loss: 0.6963001489639282, time cost3.9960837364196777
epoch: 95, iter: 3242, loss: 0.6078917980194092, time cost3.932525157928467
epoch: 95, iter: 3243, loss: 0.851859450340271, time cost3.944850206375122
epoch: 95, iter: 3244, loss: 1.2057183980941772, time cost3.9635040760040283
epoch: 95, iter: 3245, loss: 1.0738195180892944, time cost4.170998573303223
epoch: 95, iter: 3246, loss: 0.7306904196739197, time cost4.023848295211792
epoch: 95, iter: 3247, loss: 0.5326346158981323, time cost3.9743382930755615
epoch: 95, iter: 3248, loss: 1.201187014579773, time cost3.9535937309265137
epoch: 95, iter: 3249, loss: 1.4550364017486572, time cost3.9698832035064697
epoch: 95, iter: 3250, loss: 0.7571095824241638, time cost4.0622169971466064
tensor([[130., 108., 120.,  ...,   2.,   2.,   1.],
        [ 12.,   7.,   6.,  ...,   6.,   6.,   2.],
        [ 24.,  79.,  44.,  ...,   4.,   4.,   1.],
        ...,
        [ 42.,  43.,  16.,  ...,  15.,  15.,   8.],
        [ 50.,  39.,   4.,  ...,   1.,   1.,   1.],
        [128., 125., 184.,  ...,   1.,   1.,   6.]])
Epoch: 95, Iteration: 3250:
TEST A@1: 0.58
TEST A@5: 0.8911111111111111
TEST A@10: 0.9444444444444444
TEST M@B: 0.42934739079043527
TEST M@A: 0.9556317751664845
TEST W@MB: 0.22928976502037554
TEST W@MA: 0.5902112898665206
TEST Time: 488.0868968963623
Model Updated
REAL performance: Top1: 0.58, Top5: 0.8911111111111111, Top10: 0.9444444444444444, MB: 0.42934739079043527, MA: 0.9556317751664845, WMB: 0.22928976502037554, WMA: 0.5902112898665206
epoch: 95, iter: 3251, loss: 0.971570611000061, time cost3.932588577270508
epoch: 95, iter: 3252, loss: 0.9068809151649475, time cost3.9116737842559814
epoch: 95, iter: 3253, loss: 1.1647465229034424, time cost4.030719995498657
epoch: 95, iter: 3254, loss: 1.0016213655471802, time cost3.9320313930511475
epoch: 95, iter: 3255, loss: 0.6468607187271118, time cost4.0522379875183105
epoch: 95, iter: 3256, loss: 1.0970287322998047, time cost3.930938959121704
epoch: 95, iter: 3257, loss: 0.7341685891151428, time cost4.054196357727051
epoch: 95, iter: 3258, loss: 0.8250131607055664, time cost3.8047220706939697
epoch: 95, iter: 3259, loss: 1.1064730882644653, time cost3.829552173614502
epoch: 95, iter: 3260, loss: 0.842108964920044, time cost4.068519353866577
epoch: 95, iter: 3261, loss: 1.1664444208145142, time cost3.789530038833618
epoch: 95, iter: 3262, loss: 1.3843529224395752, time cost3.7688796520233154
epoch: 95, iter: 3263, loss: 0.8418481349945068, time cost3.888542413711548
epoch: 95, iter: 3264, loss: 0.8649889826774597, time cost2.774364948272705
epoch: 96, iter: 3265, loss: 0.9341966509819031, time cost4.1291422843933105
epoch: 96, iter: 3266, loss: 0.6573994159698486, time cost4.068647861480713
epoch: 96, iter: 3267, loss: 0.9218273162841797, time cost4.039125680923462
epoch: 96, iter: 3268, loss: 1.446777582168579, time cost3.8285751342773438
epoch: 96, iter: 3269, loss: 0.8265565633773804, time cost3.8801989555358887
epoch: 96, iter: 3270, loss: 1.0034929513931274, time cost3.7951385974884033
epoch: 96, iter: 3271, loss: 0.8405518531799316, time cost3.889355421066284
epoch: 96, iter: 3272, loss: 0.5152555704116821, time cost4.015763759613037
epoch: 96, iter: 3273, loss: 1.0542672872543335, time cost3.855456829071045
epoch: 96, iter: 3274, loss: 0.9073701500892639, time cost3.9073805809020996
epoch: 96, iter: 3275, loss: 0.8445248603820801, time cost4.02849555015564
epoch: 96, iter: 3276, loss: 0.6761860251426697, time cost4.016668081283569
epoch: 96, iter: 3277, loss: 1.1295725107192993, time cost3.950005531311035
epoch: 96, iter: 3278, loss: 0.5176485180854797, time cost3.9890573024749756
epoch: 96, iter: 3279, loss: 0.6968868374824524, time cost4.153012752532959
epoch: 96, iter: 3280, loss: 1.1855993270874023, time cost4.002038478851318
epoch: 96, iter: 3281, loss: 0.7755244374275208, time cost4.07351541519165
epoch: 96, iter: 3282, loss: 0.7148756384849548, time cost3.910611391067505
epoch: 96, iter: 3283, loss: 1.0423160791397095, time cost3.971287250518799
epoch: 96, iter: 3284, loss: 1.0279158353805542, time cost3.915513515472412
epoch: 96, iter: 3285, loss: 0.7166803479194641, time cost3.9832589626312256
epoch: 96, iter: 3286, loss: 1.0265363454818726, time cost3.9130921363830566
epoch: 96, iter: 3287, loss: 0.9362837672233582, time cost3.8592753410339355
epoch: 96, iter: 3288, loss: 0.5257730484008789, time cost3.9663002490997314
epoch: 96, iter: 3289, loss: 0.9676088690757751, time cost3.8956246376037598
epoch: 96, iter: 3290, loss: 0.5606999397277832, time cost3.7351489067077637
epoch: 96, iter: 3291, loss: 1.4172190427780151, time cost3.8085086345672607
epoch: 96, iter: 3292, loss: 0.9945666193962097, time cost3.696563959121704
epoch: 96, iter: 3293, loss: 0.7498425841331482, time cost4.002138137817383
epoch: 96, iter: 3294, loss: 1.054441213607788, time cost3.8014655113220215
epoch: 96, iter: 3295, loss: 1.009769320487976, time cost3.6964075565338135
epoch: 96, iter: 3296, loss: 0.5492578744888306, time cost3.7622363567352295
epoch: 96, iter: 3297, loss: 0.5263069868087769, time cost3.8252618312835693
epoch: 96, iter: 3298, loss: 0.6600855588912964, time cost2.834261894226074
epoch: 97, iter: 3299, loss: 0.7491583824157715, time cost3.9508891105651855
epoch: 97, iter: 3300, loss: 0.4024809002876282, time cost3.841672897338867
tensor([[166., 141., 151.,  ...,   1.,   1.,   1.],
        [ 10.,  13.,  11.,  ...,   9.,   9.,   3.],
        [165., 287., 261.,  ...,  11.,  11.,   7.],
        ...,
        [136., 132.,  93.,  ...,  11.,  11.,  12.],
        [ 19.,  16.,  10.,  ...,   1.,   1.,   1.],
        [ 56., 129., 169.,  ...,   3.,   3.,   5.]])
Epoch: 97, Iteration: 3300:
TEST A@1: 0.4666666666666667
TEST A@5: 0.8311111111111111
TEST A@10: 0.9333333333333333
TEST M@B: 0.3840425471882844
TEST M@A: 0.9514859128409464
TEST W@MB: 0.20527786809192472
TEST W@MA: 0.5868725370157628
TEST Time: 487.6139967441559
REAL performance: Top1: 0.58, Top5: 0.8911111111111111, Top10: 0.9444444444444444, MB: 0.42934739079043527, MA: 0.9556317751664845, WMB: 0.22928976502037554, WMA: 0.5902112898665206
epoch: 97, iter: 3301, loss: 0.8964537382125854, time cost3.851740837097168
epoch: 97, iter: 3302, loss: 1.0922722816467285, time cost3.840319871902466
epoch: 97, iter: 3303, loss: 0.7160362005233765, time cost3.839045763015747
epoch: 97, iter: 3304, loss: 0.9406043887138367, time cost4.104862451553345
epoch: 97, iter: 3305, loss: 1.060214638710022, time cost3.913639783859253
epoch: 97, iter: 3306, loss: 0.6839137077331543, time cost3.8419830799102783
epoch: 97, iter: 3307, loss: 0.4195108711719513, time cost3.9121322631835938
epoch: 97, iter: 3308, loss: 0.7362880706787109, time cost3.881955623626709
epoch: 97, iter: 3309, loss: 0.8205920457839966, time cost3.857908248901367
epoch: 97, iter: 3310, loss: 0.9977433681488037, time cost3.8514819145202637
epoch: 97, iter: 3311, loss: 0.962725818157196, time cost3.91609787940979
epoch: 97, iter: 3312, loss: 0.7505902647972107, time cost4.0324273109436035
epoch: 97, iter: 3313, loss: 0.7899662852287292, time cost3.8798694610595703
epoch: 97, iter: 3314, loss: 1.0138977766036987, time cost3.9214701652526855
epoch: 97, iter: 3315, loss: 1.0695654153823853, time cost3.969830274581909
epoch: 97, iter: 3316, loss: 0.9506528377532959, time cost3.9301345348358154
epoch: 97, iter: 3317, loss: 1.1466286182403564, time cost4.0593812465667725
epoch: 97, iter: 3318, loss: 0.989350438117981, time cost3.9346165657043457
epoch: 97, iter: 3319, loss: 0.6839591860771179, time cost3.8650643825531006
epoch: 97, iter: 3320, loss: 0.9205803275108337, time cost4.0448668003082275
epoch: 97, iter: 3321, loss: 0.568466305732727, time cost3.9970319271087646
epoch: 97, iter: 3322, loss: 1.2602099180221558, time cost3.934803009033203
epoch: 97, iter: 3323, loss: 0.9536026120185852, time cost4.022048473358154
epoch: 97, iter: 3324, loss: 0.7813438177108765, time cost4.162556171417236
epoch: 97, iter: 3325, loss: 0.7559664249420166, time cost3.9523403644561768
epoch: 97, iter: 3326, loss: 0.7665200233459473, time cost3.8704161643981934
epoch: 97, iter: 3327, loss: 1.2824556827545166, time cost3.843705654144287
epoch: 97, iter: 3328, loss: 0.672134518623352, time cost3.8323051929473877
epoch: 97, iter: 3329, loss: 1.4491856098175049, time cost3.829470634460449
epoch: 97, iter: 3330, loss: 0.8111181259155273, time cost3.940340518951416
epoch: 97, iter: 3331, loss: 0.33907172083854675, time cost3.8685524463653564
epoch: 97, iter: 3332, loss: 0.6904418468475342, time cost2.792553424835205
epoch: 98, iter: 3333, loss: 0.5112313628196716, time cost4.146701335906982
epoch: 98, iter: 3334, loss: 1.1340103149414062, time cost4.218745946884155
epoch: 98, iter: 3335, loss: 0.7762120366096497, time cost4.036022901535034
epoch: 98, iter: 3336, loss: 1.2088416814804077, time cost4.120581865310669
epoch: 98, iter: 3337, loss: 0.7070825099945068, time cost3.9904944896698
epoch: 98, iter: 3338, loss: 0.883914053440094, time cost3.9603097438812256
epoch: 98, iter: 3339, loss: 0.882887601852417, time cost3.954310655593872
epoch: 98, iter: 3340, loss: 0.8413233757019043, time cost3.888409376144409
epoch: 98, iter: 3341, loss: 1.099268913269043, time cost4.02577018737793
epoch: 98, iter: 3342, loss: 0.9967455863952637, time cost4.0556557178497314
epoch: 98, iter: 3343, loss: 0.6604487895965576, time cost3.9534549713134766
epoch: 98, iter: 3344, loss: 0.8729066848754883, time cost3.8580799102783203
epoch: 98, iter: 3345, loss: 0.8529545068740845, time cost4.007024049758911
epoch: 98, iter: 3346, loss: 0.8874115943908691, time cost3.9109578132629395
epoch: 98, iter: 3347, loss: 0.8738242387771606, time cost3.85265851020813
epoch: 98, iter: 3348, loss: 1.139960765838623, time cost3.863494396209717
epoch: 98, iter: 3349, loss: 0.9590018391609192, time cost4.001790523529053
epoch: 98, iter: 3350, loss: 1.039690375328064, time cost4.010823965072632
tensor([[331., 291., 296.,  ...,   1.,   1.,   1.],
        [ 12.,  15.,  14.,  ...,  20.,  20.,  15.],
        [115., 225., 109.,  ...,  33.,  33.,  14.],
        ...,
        [170., 182., 117.,  ...,  13.,  13.,  13.],
        [ 11.,   6.,   3.,  ...,   1.,   1.,   1.],
        [256., 228., 301.,  ...,   1.,   1.,   2.]])
Epoch: 98, Iteration: 3350:
TEST A@1: 0.45111111111111113
TEST A@5: 0.8177777777777778
TEST A@10: 0.9288888888888889
TEST M@B: 0.37685731871497685
TEST M@A: 0.9495928170809316
TEST W@MB: 0.20181924604618495
TEST W@MA: 0.5854898390094824
TEST Time: 474.82562804222107
REAL performance: Top1: 0.58, Top5: 0.8911111111111111, Top10: 0.9444444444444444, MB: 0.42934739079043527, MA: 0.9556317751664845, WMB: 0.22928976502037554, WMA: 0.5902112898665206
epoch: 98, iter: 3351, loss: 1.2709033489227295, time cost3.965301036834717
epoch: 98, iter: 3352, loss: 0.8299496173858643, time cost4.073812484741211
epoch: 98, iter: 3353, loss: 0.6930959224700928, time cost3.975984573364258
epoch: 98, iter: 3354, loss: 0.46872323751449585, time cost4.0365777015686035
epoch: 98, iter: 3355, loss: 0.8193749785423279, time cost4.092758417129517
epoch: 98, iter: 3356, loss: 0.9608931541442871, time cost3.850259304046631
epoch: 98, iter: 3357, loss: 0.6120867729187012, time cost3.986335039138794
epoch: 98, iter: 3358, loss: 1.3555415868759155, time cost4.003505706787109
epoch: 98, iter: 3359, loss: 0.9665268063545227, time cost4.108494758605957
epoch: 98, iter: 3360, loss: 0.44352471828460693, time cost3.986865758895874
epoch: 98, iter: 3361, loss: 0.6709065437316895, time cost4.079086542129517
epoch: 98, iter: 3362, loss: 0.632253110408783, time cost4.151681900024414
epoch: 98, iter: 3363, loss: 0.6855668425559998, time cost4.020766735076904
epoch: 98, iter: 3364, loss: 0.7885067462921143, time cost4.068572521209717
epoch: 98, iter: 3365, loss: 0.693091630935669, time cost4.11969518661499
epoch: 98, iter: 3366, loss: 0.9133288860321045, time cost2.8226239681243896
epoch: 99, iter: 3367, loss: 0.9341536164283752, time cost3.832087755203247
epoch: 99, iter: 3368, loss: 1.2317241430282593, time cost3.961857318878174
epoch: 99, iter: 3369, loss: 1.233655333518982, time cost3.88181734085083
epoch: 99, iter: 3370, loss: 1.1521668434143066, time cost3.98972225189209
epoch: 99, iter: 3371, loss: 1.064503788948059, time cost4.360416889190674
epoch: 99, iter: 3372, loss: 0.665381669998169, time cost4.307216167449951
epoch: 99, iter: 3373, loss: 0.647984504699707, time cost3.8934824466705322
epoch: 99, iter: 3374, loss: 1.0382071733474731, time cost4.184508323669434
epoch: 99, iter: 3375, loss: 1.2493938207626343, time cost4.0468668937683105
epoch: 99, iter: 3376, loss: 1.7307294607162476, time cost4.138624668121338
epoch: 99, iter: 3377, loss: 1.1185991764068604, time cost4.135833740234375
epoch: 99, iter: 3378, loss: 0.3318706452846527, time cost4.131592035293579
epoch: 99, iter: 3379, loss: 0.4317319691181183, time cost4.200296878814697
epoch: 99, iter: 3380, loss: 0.8606410026550293, time cost3.999896287918091
epoch: 99, iter: 3381, loss: 0.5860400199890137, time cost4.053124904632568
epoch: 99, iter: 3382, loss: 1.274850606918335, time cost4.2049360275268555
epoch: 99, iter: 3383, loss: 0.5171398520469666, time cost4.017475128173828
epoch: 99, iter: 3384, loss: 0.8877906203269958, time cost4.139492750167847
epoch: 99, iter: 3385, loss: 1.4992755651474, time cost4.075586795806885
epoch: 99, iter: 3386, loss: 0.5582518577575684, time cost4.094171047210693
epoch: 99, iter: 3387, loss: 0.7817200422286987, time cost3.8548977375030518
epoch: 99, iter: 3388, loss: 0.9512585997581482, time cost4.030872106552124
epoch: 99, iter: 3389, loss: 0.9150665998458862, time cost4.175354480743408
epoch: 99, iter: 3390, loss: 0.7851591110229492, time cost4.012485504150391
epoch: 99, iter: 3391, loss: 1.0112394094467163, time cost4.082410573959351
epoch: 99, iter: 3392, loss: 0.8699174523353577, time cost3.7944045066833496
epoch: 99, iter: 3393, loss: 0.7718629240989685, time cost3.8277525901794434
epoch: 99, iter: 3394, loss: 0.6140521764755249, time cost4.107789754867554
epoch: 99, iter: 3395, loss: 1.078739881515503, time cost3.8657302856445312
epoch: 99, iter: 3396, loss: 0.6492220759391785, time cost3.939161539077759
epoch: 99, iter: 3397, loss: 1.219090461730957, time cost4.053319931030273
epoch: 99, iter: 3398, loss: 1.2724807262420654, time cost4.023590326309204
epoch: 99, iter: 3399, loss: 1.3873264789581299, time cost4.007652282714844
epoch: 99, iter: 3400, loss: 0.4814552664756775, time cost2.7036969661712646
tensor([[ 61.,  59.,  72.,  ...,   1.,   1.,   2.],
        [  5.,   7.,   7.,  ...,   9.,   9.,   3.],
        [ 49., 152.,  48.,  ...,  12.,  12.,   7.],
        ...,
        [ 82.,  82.,  59.,  ...,  15.,  15.,  11.],
        [ 14.,  14.,   3.,  ...,   1.,   1.,   1.],
        [ 61., 159., 194.,  ...,   2.,   2.,   6.]])
Epoch: 99, Iteration: 3400:
TEST A@1: 0.5311111111111111
TEST A@5: 0.88
TEST A@10: 0.9511111111111111
TEST M@B: 0.41531805895011714
TEST M@A: 0.9545017860754289
TEST W@MB: 0.22211124647507047
TEST W@MA: 0.5893655663506779
TEST Time: 444.0362422466278
REAL performance: Top1: 0.58, Top5: 0.8911111111111111, Top10: 0.9444444444444444, MB: 0.42934739079043527, MA: 0.9556317751664845, WMB: 0.22928976502037554, WMA: 0.5902112898665206
epoch: 100, iter: 3401, loss: 0.949860692024231, time cost4.243335247039795
epoch: 100, iter: 3402, loss: 0.8268647789955139, time cost4.24130916595459
epoch: 100, iter: 3403, loss: 0.5003634095191956, time cost4.203468084335327
epoch: 100, iter: 3404, loss: 0.7382708191871643, time cost4.043306827545166
epoch: 100, iter: 3405, loss: 0.7798378467559814, time cost4.050154685974121
epoch: 100, iter: 3406, loss: 0.89528489112854, time cost3.919241428375244
epoch: 100, iter: 3407, loss: 0.8436618447303772, time cost4.142144441604614
epoch: 100, iter: 3408, loss: 0.8256806135177612, time cost4.1227147579193115
epoch: 100, iter: 3409, loss: 0.7072800993919373, time cost4.019919395446777
epoch: 100, iter: 3410, loss: 0.6401301622390747, time cost4.293969631195068
epoch: 100, iter: 3411, loss: 1.2264968156814575, time cost4.085783243179321
epoch: 100, iter: 3412, loss: 0.6245909929275513, time cost4.008124113082886
epoch: 100, iter: 3413, loss: 1.2814298868179321, time cost4.174761772155762
epoch: 100, iter: 3414, loss: 0.7378994822502136, time cost4.077408790588379
epoch: 100, iter: 3415, loss: 0.7147322297096252, time cost4.139512777328491
epoch: 100, iter: 3416, loss: 0.6616794466972351, time cost4.1709864139556885
epoch: 100, iter: 3417, loss: 0.9048650860786438, time cost4.281617164611816
epoch: 100, iter: 3418, loss: 0.8819328546524048, time cost4.199974298477173
epoch: 100, iter: 3419, loss: 0.4914809763431549, time cost4.164432764053345
epoch: 100, iter: 3420, loss: 1.1442761421203613, time cost4.110421419143677
epoch: 100, iter: 3421, loss: 0.6613551378250122, time cost4.021117210388184
epoch: 100, iter: 3422, loss: 0.6927095651626587, time cost4.06134295463562
epoch: 100, iter: 3423, loss: 0.5720852613449097, time cost4.411666393280029
epoch: 100, iter: 3424, loss: 0.4940911829471588, time cost4.085021257400513
epoch: 100, iter: 3425, loss: 0.9078118801116943, time cost4.316287517547607
epoch: 100, iter: 3426, loss: 1.1226136684417725, time cost4.126147031784058
epoch: 100, iter: 3427, loss: 1.2413654327392578, time cost4.2163872718811035
epoch: 100, iter: 3428, loss: 0.9155654311180115, time cost4.089877367019653
epoch: 100, iter: 3429, loss: 0.700188398361206, time cost3.9960720539093018
epoch: 100, iter: 3430, loss: 0.888418972492218, time cost4.411919593811035
epoch: 100, iter: 3431, loss: 1.0989658832550049, time cost4.212453603744507
epoch: 100, iter: 3432, loss: 0.6994040012359619, time cost4.122784376144409
epoch: 100, iter: 3433, loss: 1.0907812118530273, time cost3.991184711456299
epoch: 100, iter: 3434, loss: 0.572806715965271, time cost3.011265754699707
epoch: 101, iter: 3435, loss: 0.8190975785255432, time cost4.025214195251465
epoch: 101, iter: 3436, loss: 1.0186028480529785, time cost4.0273590087890625
epoch: 101, iter: 3437, loss: 0.4785250425338745, time cost4.063546657562256
epoch: 101, iter: 3438, loss: 1.0172767639160156, time cost4.0198974609375
epoch: 101, iter: 3439, loss: 0.7813169956207275, time cost4.068148374557495
epoch: 101, iter: 3440, loss: 0.689506471157074, time cost3.9076435565948486
epoch: 101, iter: 3441, loss: 0.5585808753967285, time cost4.095009088516235
epoch: 101, iter: 3442, loss: 0.7390661835670471, time cost4.336883544921875
epoch: 101, iter: 3443, loss: 0.9122000336647034, time cost4.259665250778198
epoch: 101, iter: 3444, loss: 0.7119181752204895, time cost3.9848241806030273
epoch: 101, iter: 3445, loss: 0.651231050491333, time cost3.946007490158081
epoch: 101, iter: 3446, loss: 0.7889604568481445, time cost4.156440496444702
epoch: 101, iter: 3447, loss: 0.73200923204422, time cost3.982180595397949
epoch: 101, iter: 3448, loss: 0.9569234251976013, time cost3.9941534996032715
epoch: 101, iter: 3449, loss: 0.6757001280784607, time cost3.890076160430908
epoch: 101, iter: 3450, loss: 1.0252989530563354, time cost4.110441207885742
tensor([[214., 202., 215.,  ...,  20.,  20.,  13.],
        [ 39.,  30.,  28.,  ...,  17.,  17.,   8.],
        [ 88., 185., 100.,  ...,  15.,  15.,   9.],
        ...,
        [100., 110.,  96.,  ...,  49.,  49.,  41.],
        [ 37.,  25.,   4.,  ...,   1.,   1.,   1.],
        [ 81., 115., 119.,  ...,  16.,  16.,  13.]])
Epoch: 101, Iteration: 3450:
TEST A@1: 0.47555555555555556
TEST A@5: 0.7911111111111111
TEST A@10: 0.8933333333333333
TEST M@B: 0.37493532582302563
TEST M@A: 0.9450880622743807
TEST W@MB: 0.1994858476202503
TEST W@MA: 0.582312966655712
TEST Time: 508.14077639579773
REAL performance: Top1: 0.58, Top5: 0.8911111111111111, Top10: 0.9444444444444444, MB: 0.42934739079043527, MA: 0.9556317751664845, WMB: 0.22928976502037554, WMA: 0.5902112898665206
epoch: 101, iter: 3451, loss: 0.47703349590301514, time cost3.9111554622650146
epoch: 101, iter: 3452, loss: 0.9653358459472656, time cost3.9468472003936768
epoch: 101, iter: 3453, loss: 0.594165563583374, time cost3.877885103225708
epoch: 101, iter: 3454, loss: 1.169347882270813, time cost3.930152177810669
epoch: 101, iter: 3455, loss: 0.646379292011261, time cost4.011435270309448
epoch: 101, iter: 3456, loss: 1.0545101165771484, time cost3.8835806846618652
epoch: 101, iter: 3457, loss: 0.5825223326683044, time cost3.9608240127563477
epoch: 101, iter: 3458, loss: 0.707295835018158, time cost4.053987264633179
epoch: 101, iter: 3459, loss: 0.9034962058067322, time cost4.08702278137207
epoch: 101, iter: 3460, loss: 0.743156909942627, time cost4.125191926956177
epoch: 101, iter: 3461, loss: 1.2083008289337158, time cost4.123073101043701
epoch: 101, iter: 3462, loss: 1.0629583597183228, time cost3.8697569370269775
epoch: 101, iter: 3463, loss: 0.9242575168609619, time cost4.008857727050781
epoch: 101, iter: 3464, loss: 1.0912641286849976, time cost4.001789093017578
epoch: 101, iter: 3465, loss: 0.39946991205215454, time cost3.979295492172241
epoch: 101, iter: 3466, loss: 1.0050996541976929, time cost4.02668023109436
epoch: 101, iter: 3467, loss: 0.6358688473701477, time cost3.8251068592071533
epoch: 101, iter: 3468, loss: 0.8624574542045593, time cost2.8833582401275635
epoch: 102, iter: 3469, loss: 1.0176060199737549, time cost4.206111192703247
epoch: 102, iter: 3470, loss: 0.8954368233680725, time cost3.9941415786743164
epoch: 102, iter: 3471, loss: 1.028443694114685, time cost4.160721778869629
epoch: 102, iter: 3472, loss: 0.7110803723335266, time cost4.003118991851807
epoch: 102, iter: 3473, loss: 1.0324182510375977, time cost3.9693081378936768
epoch: 102, iter: 3474, loss: 0.7189810872077942, time cost3.970750093460083
epoch: 102, iter: 3475, loss: 0.9282534718513489, time cost3.9753644466400146
epoch: 102, iter: 3476, loss: 1.122605323791504, time cost4.000024080276489
epoch: 102, iter: 3477, loss: 1.146889567375183, time cost3.9676246643066406
epoch: 102, iter: 3478, loss: 0.7637352347373962, time cost4.034255266189575
epoch: 102, iter: 3479, loss: 0.5656425952911377, time cost4.040472030639648
epoch: 102, iter: 3480, loss: 0.8270535469055176, time cost4.063770532608032
epoch: 102, iter: 3481, loss: 0.5387911796569824, time cost3.997926712036133
epoch: 102, iter: 3482, loss: 1.1646559238433838, time cost4.07358193397522
epoch: 102, iter: 3483, loss: 0.7238637208938599, time cost3.931992530822754
epoch: 102, iter: 3484, loss: 0.46306756138801575, time cost4.0572896003723145
epoch: 102, iter: 3485, loss: 1.0112061500549316, time cost3.9431135654449463
epoch: 102, iter: 3486, loss: 0.7986124157905579, time cost3.829706907272339
epoch: 102, iter: 3487, loss: 0.6925604939460754, time cost3.86989164352417
epoch: 102, iter: 3488, loss: 0.7717993259429932, time cost3.915163040161133
epoch: 102, iter: 3489, loss: 0.4589904844760895, time cost4.011461496353149
epoch: 102, iter: 3490, loss: 0.8110619187355042, time cost3.8971993923187256
epoch: 102, iter: 3491, loss: 0.470294326543808, time cost4.042433738708496
epoch: 102, iter: 3492, loss: 1.1417129039764404, time cost3.834784984588623
epoch: 102, iter: 3493, loss: 0.952830970287323, time cost4.059804201126099
epoch: 102, iter: 3494, loss: 1.0297753810882568, time cost3.905834436416626
epoch: 102, iter: 3495, loss: 0.595906674861908, time cost4.0147013664245605
epoch: 102, iter: 3496, loss: 1.2667522430419922, time cost3.823629379272461
epoch: 102, iter: 3497, loss: 0.645937979221344, time cost3.822532892227173
epoch: 102, iter: 3498, loss: 0.6687453985214233, time cost3.8345465660095215
epoch: 102, iter: 3499, loss: 0.9328412413597107, time cost4.062554597854614
epoch: 102, iter: 3500, loss: 0.5754228830337524, time cost3.74807071685791
tensor([[ 60.,  62.,  72.,  ...,   6.,   6.,   7.],
        [ 21.,  13.,  14.,  ...,  15.,  15.,   6.],
        [ 41., 156.,  39.,  ...,   5.,   5.,   2.],
        ...,
        [ 21.,  22.,  14.,  ...,  10.,  10.,  10.],
        [112.,  60.,  24.,  ...,   1.,   1.,   1.],
        [ 33., 118., 138.,  ...,   8.,   8.,  21.]])
Epoch: 102, Iteration: 3500:
TEST A@1: 0.5155555555555555
TEST A@5: 0.8355555555555556
TEST A@10: 0.94
TEST M@B: 0.40860672646727947
TEST M@A: 0.953126384050127
TEST W@MB: 0.21840285531118994
TEST W@MA: 0.5885366256957528
TEST Time: 503.90922379493713
REAL performance: Top1: 0.58, Top5: 0.8911111111111111, Top10: 0.9444444444444444, MB: 0.42934739079043527, MA: 0.9556317751664845, WMB: 0.22928976502037554, WMA: 0.5902112898665206
epoch: 102, iter: 3501, loss: 0.8150644302368164, time cost4.046740293502808
epoch: 102, iter: 3502, loss: 0.7794233560562134, time cost2.9872426986694336
epoch: 103, iter: 3503, loss: 0.39243587851524353, time cost3.995460271835327
epoch: 103, iter: 3504, loss: 0.830967903137207, time cost4.025922775268555
epoch: 103, iter: 3505, loss: 0.8884606957435608, time cost4.003113269805908
epoch: 103, iter: 3506, loss: 0.9191301465034485, time cost3.9877092838287354
epoch: 103, iter: 3507, loss: 0.46871626377105713, time cost4.038334846496582
epoch: 103, iter: 3508, loss: 0.8148158192634583, time cost4.086086988449097
epoch: 103, iter: 3509, loss: 0.7463449835777283, time cost4.104156017303467
epoch: 103, iter: 3510, loss: 0.9219374060630798, time cost4.022822141647339
epoch: 103, iter: 3511, loss: 0.6606820821762085, time cost3.9290268421173096
epoch: 103, iter: 3512, loss: 1.2349516153335571, time cost4.111308336257935
epoch: 103, iter: 3513, loss: 0.5781423449516296, time cost4.046579122543335
epoch: 103, iter: 3514, loss: 0.578151285648346, time cost4.006769180297852
epoch: 103, iter: 3515, loss: 0.6985687613487244, time cost4.109323024749756
epoch: 103, iter: 3516, loss: 0.6702741980552673, time cost3.9505302906036377
epoch: 103, iter: 3517, loss: 0.69151371717453, time cost3.958026885986328
epoch: 103, iter: 3518, loss: 0.7776875495910645, time cost3.9856276512145996
epoch: 103, iter: 3519, loss: 1.5204342603683472, time cost4.097074508666992
epoch: 103, iter: 3520, loss: 1.1200566291809082, time cost3.889634847640991
epoch: 103, iter: 3521, loss: 1.2265245914459229, time cost3.829993486404419
epoch: 103, iter: 3522, loss: 0.8668938875198364, time cost4.100548505783081
epoch: 103, iter: 3523, loss: 0.7793617844581604, time cost3.918255567550659
epoch: 103, iter: 3524, loss: 0.9595229029655457, time cost3.995694637298584
epoch: 103, iter: 3525, loss: 0.6294563412666321, time cost3.965886354446411
epoch: 103, iter: 3526, loss: 0.8542659282684326, time cost3.9482533931732178
epoch: 103, iter: 3527, loss: 0.8730542659759521, time cost4.123878479003906
epoch: 103, iter: 3528, loss: 1.4319474697113037, time cost4.011268615722656
epoch: 103, iter: 3529, loss: 1.1916248798370361, time cost3.9017746448516846
epoch: 103, iter: 3530, loss: 0.6997308135032654, time cost3.8465983867645264
epoch: 103, iter: 3531, loss: 0.9261009693145752, time cost4.051031589508057
epoch: 103, iter: 3532, loss: 1.1644192934036255, time cost3.841610908508301
epoch: 103, iter: 3533, loss: 0.2758948504924774, time cost3.875962495803833
epoch: 103, iter: 3534, loss: 1.246108055114746, time cost3.9304816722869873
epoch: 103, iter: 3535, loss: 0.49070554971694946, time cost3.959808349609375
epoch: 103, iter: 3536, loss: 0.8470203876495361, time cost2.944974899291992
epoch: 104, iter: 3537, loss: 0.7292237877845764, time cost4.157446622848511
epoch: 104, iter: 3538, loss: 0.9180963635444641, time cost4.092726469039917
epoch: 104, iter: 3539, loss: 0.7558588981628418, time cost3.960843801498413
epoch: 104, iter: 3540, loss: 1.035278558731079, time cost3.982112407684326
epoch: 104, iter: 3541, loss: 0.8071187734603882, time cost4.016027450561523
epoch: 104, iter: 3542, loss: 0.8526214957237244, time cost4.006065845489502
epoch: 104, iter: 3543, loss: 0.6506153345108032, time cost3.9126572608947754
epoch: 104, iter: 3544, loss: 0.6903316974639893, time cost3.96408748626709
epoch: 104, iter: 3545, loss: 0.8952100276947021, time cost3.8714349269866943
epoch: 104, iter: 3546, loss: 0.8446001410484314, time cost4.1827592849731445
epoch: 104, iter: 3547, loss: 1.167473554611206, time cost4.11509370803833
epoch: 104, iter: 3548, loss: 0.9262959957122803, time cost4.143643379211426
epoch: 104, iter: 3549, loss: 0.6034325957298279, time cost4.07532811164856
epoch: 104, iter: 3550, loss: 1.078584909439087, time cost4.097698211669922
tensor([[106.,  88.,  99.,  ...,   7.,   7.,   7.],
        [ 11.,   7.,   7.,  ...,   5.,   5.,   5.],
        [177., 280., 165.,  ...,  17.,  17.,  11.],
        ...,
        [118., 117.,  97.,  ...,  58.,  58.,  47.],
        [  7.,   6.,   3.,  ...,   1.,   1.,   1.],
        [ 67., 142., 181.,  ...,  12.,  12.,  13.]])
Epoch: 104, Iteration: 3550:
TEST A@1: 0.4533333333333333
TEST A@5: 0.7933333333333333
TEST A@10: 0.9
TEST M@B: 0.3651301862008721
TEST M@A: 0.9473565959518938
TEST W@MB: 0.1951609020904033
TEST W@MA: 0.5844116555682922
TEST Time: 454.6781876087189
REAL performance: Top1: 0.58, Top5: 0.8911111111111111, Top10: 0.9444444444444444, MB: 0.42934739079043527, MA: 0.9556317751664845, WMB: 0.22928976502037554, WMA: 0.5902112898665206
epoch: 104, iter: 3551, loss: 0.8783881068229675, time cost3.778799057006836
epoch: 104, iter: 3552, loss: 1.2043676376342773, time cost3.7854907512664795
epoch: 104, iter: 3553, loss: 1.3309414386749268, time cost3.7321584224700928
epoch: 104, iter: 3554, loss: 0.6141313910484314, time cost3.8950419425964355
epoch: 104, iter: 3555, loss: 1.0584869384765625, time cost3.8547589778900146
epoch: 104, iter: 3556, loss: 0.7979804277420044, time cost3.685840129852295
epoch: 104, iter: 3557, loss: 0.6951040029525757, time cost3.7531096935272217
epoch: 104, iter: 3558, loss: 0.6393043398857117, time cost3.8388588428497314
epoch: 104, iter: 3559, loss: 1.038184642791748, time cost3.833843946456909
epoch: 104, iter: 3560, loss: 0.7688277959823608, time cost3.744405746459961
epoch: 104, iter: 3561, loss: 0.725273072719574, time cost3.9775710105895996
epoch: 104, iter: 3562, loss: 0.6283285021781921, time cost3.6980044841766357
epoch: 104, iter: 3563, loss: 1.3424181938171387, time cost3.7679803371429443
epoch: 104, iter: 3564, loss: 0.9952972531318665, time cost3.931511640548706
epoch: 104, iter: 3565, loss: 1.2662160396575928, time cost3.66762375831604
epoch: 104, iter: 3566, loss: 0.8437026143074036, time cost3.923771619796753
epoch: 104, iter: 3567, loss: 1.0237410068511963, time cost3.812953472137451
epoch: 104, iter: 3568, loss: 1.9391826391220093, time cost3.8523662090301514
epoch: 104, iter: 3569, loss: 0.8891409039497375, time cost3.693514585494995
epoch: 104, iter: 3570, loss: 0.5304327011108398, time cost2.812779664993286
epoch: 105, iter: 3571, loss: 0.6592288017272949, time cost4.072489976882935
epoch: 105, iter: 3572, loss: 0.8233629465103149, time cost3.852273464202881
epoch: 105, iter: 3573, loss: 1.263808250427246, time cost3.964617967605591
epoch: 105, iter: 3574, loss: 1.0796195268630981, time cost3.725653648376465
epoch: 105, iter: 3575, loss: 1.0799238681793213, time cost3.889547109603882
epoch: 105, iter: 3576, loss: 0.9257246255874634, time cost3.9015684127807617
epoch: 105, iter: 3577, loss: 0.5693682432174683, time cost3.891772508621216
epoch: 105, iter: 3578, loss: 0.723503053188324, time cost3.987959861755371
epoch: 105, iter: 3579, loss: 1.043015480041504, time cost3.7896580696105957
epoch: 105, iter: 3580, loss: 1.3025380373001099, time cost4.052446603775024
epoch: 105, iter: 3581, loss: 0.9387683272361755, time cost3.932147741317749
epoch: 105, iter: 3582, loss: 1.0335880517959595, time cost3.9739596843719482
epoch: 105, iter: 3583, loss: 0.5608250498771667, time cost3.8728787899017334
epoch: 105, iter: 3584, loss: 0.5422289967536926, time cost3.87271785736084
epoch: 105, iter: 3585, loss: 0.7220587730407715, time cost3.8134548664093018
epoch: 105, iter: 3586, loss: 0.7298422455787659, time cost4.1431565284729
epoch: 105, iter: 3587, loss: 0.8548989295959473, time cost3.98803973197937
epoch: 105, iter: 3588, loss: 0.9807779788970947, time cost3.8850865364074707
epoch: 105, iter: 3589, loss: 0.8850536942481995, time cost4.124226331710815
epoch: 105, iter: 3590, loss: 0.804521918296814, time cost4.064244270324707
epoch: 105, iter: 3591, loss: 0.8537178039550781, time cost3.927779197692871
epoch: 105, iter: 3592, loss: 1.0777033567428589, time cost3.9009084701538086
epoch: 105, iter: 3593, loss: 0.5032451152801514, time cost3.9483492374420166
epoch: 105, iter: 3594, loss: 0.5635519623756409, time cost4.057894468307495
epoch: 105, iter: 3595, loss: 1.219663143157959, time cost3.939375400543213
epoch: 105, iter: 3596, loss: 1.138244867324829, time cost3.9091708660125732
epoch: 105, iter: 3597, loss: 1.045897126197815, time cost3.7961819171905518
epoch: 105, iter: 3598, loss: 0.6423999071121216, time cost3.701965570449829
epoch: 105, iter: 3599, loss: 0.7086372971534729, time cost3.8343753814697266
epoch: 105, iter: 3600, loss: 0.8715347051620483, time cost3.875019073486328
tensor([[ 22.,  20.,  21.,  ...,   5.,   5.,   5.],
        [ 23.,  21.,  20.,  ...,  11.,  11.,   9.],
        [191., 389., 311.,  ...,  15.,  15.,  11.],
        ...,
        [ 58.,  52.,  37.,  ...,  23.,  23.,  19.],
        [ 30.,  19.,  14.,  ...,   1.,   1.,   1.],
        [ 33.,  64.,  97.,  ...,   5.,   5.,   5.]])
Epoch: 105, Iteration: 3600:
TEST A@1: 0.4311111111111111
TEST A@5: 0.7911111111111111
TEST A@10: 0.9044444444444445
TEST M@B: 0.35829224199191784
TEST M@A: 0.9486422747911383
TEST W@MB: 0.19228316135170423
TEST W@MA: 0.5850248698855285
TEST Time: 413.2075033187866
REAL performance: Top1: 0.58, Top5: 0.8911111111111111, Top10: 0.9444444444444444, MB: 0.42934739079043527, MA: 0.9556317751664845, WMB: 0.22928976502037554, WMA: 0.5902112898665206
epoch: 105, iter: 3601, loss: 0.7625859975814819, time cost3.8870620727539062
epoch: 105, iter: 3602, loss: 0.4809592366218567, time cost4.032780885696411
epoch: 105, iter: 3603, loss: 0.9117370843887329, time cost3.9532275199890137
epoch: 105, iter: 3604, loss: 0.32578426599502563, time cost3.0462446212768555
epoch: 106, iter: 3605, loss: 0.8740063309669495, time cost4.22391414642334
epoch: 106, iter: 3606, loss: 0.9543449282646179, time cost4.2783989906311035
epoch: 106, iter: 3607, loss: 0.7272341847419739, time cost4.380664110183716
epoch: 106, iter: 3608, loss: 0.6637583374977112, time cost4.332643032073975
epoch: 106, iter: 3609, loss: 0.587185800075531, time cost4.209720849990845
epoch: 106, iter: 3610, loss: 0.8254255652427673, time cost4.241333723068237
epoch: 106, iter: 3611, loss: 0.8908507823944092, time cost4.456156969070435
epoch: 106, iter: 3612, loss: 0.5971152186393738, time cost4.24977445602417
epoch: 106, iter: 3613, loss: 1.0062015056610107, time cost4.384944438934326
epoch: 106, iter: 3614, loss: 0.6579425930976868, time cost4.334328889846802
epoch: 106, iter: 3615, loss: 0.6374559998512268, time cost4.242034912109375
epoch: 106, iter: 3616, loss: 0.9454832077026367, time cost4.284800052642822
epoch: 106, iter: 3617, loss: 0.6039716005325317, time cost4.21602988243103
epoch: 106, iter: 3618, loss: 0.9631293416023254, time cost4.603215932846069
epoch: 106, iter: 3619, loss: 0.6265638470649719, time cost4.341035842895508
epoch: 106, iter: 3620, loss: 0.5967184901237488, time cost4.275313138961792
epoch: 106, iter: 3621, loss: 0.9363451600074768, time cost4.399071455001831
epoch: 106, iter: 3622, loss: 0.5880714654922485, time cost4.518113613128662
epoch: 106, iter: 3623, loss: 0.5353291034698486, time cost4.3965983390808105
epoch: 106, iter: 3624, loss: 0.6467887163162231, time cost4.345698595046997
epoch: 106, iter: 3625, loss: 0.7948532700538635, time cost4.316378831863403
epoch: 106, iter: 3626, loss: 0.641085147857666, time cost3.096787452697754
epoch: 106, iter: 3627, loss: 0.8637959361076355, time cost3.9794394969940186
epoch: 106, iter: 3628, loss: 0.9231467247009277, time cost4.006415367126465
epoch: 106, iter: 3629, loss: 0.9912582635879517, time cost3.9264259338378906
epoch: 106, iter: 3630, loss: 1.1613870859146118, time cost3.834388494491577
epoch: 106, iter: 3631, loss: 0.7536417245864868, time cost3.755295515060425
epoch: 106, iter: 3632, loss: 0.9757897257804871, time cost3.8145246505737305
epoch: 106, iter: 3633, loss: 1.015055537223816, time cost4.003197908401489
epoch: 106, iter: 3634, loss: 1.4681464433670044, time cost3.8454456329345703
epoch: 106, iter: 3635, loss: 0.8593106269836426, time cost3.8338654041290283
epoch: 106, iter: 3636, loss: 1.4138075113296509, time cost3.9046738147735596
epoch: 106, iter: 3637, loss: 0.577825129032135, time cost3.8922996520996094
epoch: 106, iter: 3638, loss: 0.5988545417785645, time cost2.882983922958374
epoch: 107, iter: 3639, loss: 0.6059666275978088, time cost3.9206020832061768
epoch: 107, iter: 3640, loss: 1.2064350843429565, time cost3.9710004329681396
epoch: 107, iter: 3641, loss: 0.6695924997329712, time cost4.075006723403931
epoch: 107, iter: 3642, loss: 0.6438934206962585, time cost3.812406063079834
epoch: 107, iter: 3643, loss: 0.9511829018592834, time cost3.9983129501342773
epoch: 107, iter: 3644, loss: 0.8951329588890076, time cost3.97141695022583
epoch: 107, iter: 3645, loss: 0.9711742401123047, time cost4.079068183898926
epoch: 107, iter: 3646, loss: 0.9140605330467224, time cost3.956244468688965
epoch: 107, iter: 3647, loss: 0.8917886018753052, time cost3.927421808242798
epoch: 107, iter: 3648, loss: 0.5348308682441711, time cost4.01032829284668
epoch: 107, iter: 3649, loss: 0.8216831088066101, time cost4.101164102554321
epoch: 107, iter: 3650, loss: 0.9316646456718445, time cost3.957749843597412
tensor([[147., 129., 149.,  ...,  22.,  22.,  20.],
        [ 18.,   8.,   8.,  ...,   2.,   2.,   2.],
        [105., 224., 110.,  ...,  14.,  14.,   4.],
        ...,
        [ 42.,  45.,  28.,  ...,  19.,  19.,  13.],
        [ 36.,  22.,   5.,  ...,   1.,   1.,   1.],
        [118., 147., 239.,  ...,   4.,   4.,   7.]])
Epoch: 107, Iteration: 3650:
TEST A@1: 0.44
TEST A@5: 0.7844444444444445
TEST A@10: 0.8844444444444445
TEST M@B: 0.35358972862079746
TEST M@A: 0.944302825633599
TEST W@MB: 0.1879974436396425
TEST W@MA: 0.5819708513836944
TEST Time: 484.3141522407532
REAL performance: Top1: 0.58, Top5: 0.8911111111111111, Top10: 0.9444444444444444, MB: 0.42934739079043527, MA: 0.9556317751664845, WMB: 0.22928976502037554, WMA: 0.5902112898665206
epoch: 107, iter: 3651, loss: 0.5197863578796387, time cost3.7645604610443115
epoch: 107, iter: 3652, loss: 0.6729894876480103, time cost3.9694652557373047
epoch: 107, iter: 3653, loss: 0.7526750564575195, time cost3.8854334354400635
epoch: 107, iter: 3654, loss: 1.1434723138809204, time cost3.8071932792663574
epoch: 107, iter: 3655, loss: 0.9513676762580872, time cost3.8301732540130615
epoch: 107, iter: 3656, loss: 0.5659250617027283, time cost4.068945646286011
epoch: 107, iter: 3657, loss: 1.2458256483078003, time cost3.8844845294952393
epoch: 107, iter: 3658, loss: 0.7474744915962219, time cost3.7580525875091553
epoch: 107, iter: 3659, loss: 1.0620759725570679, time cost3.802534341812134
epoch: 107, iter: 3660, loss: 0.8755853176116943, time cost4.1123785972595215
epoch: 107, iter: 3661, loss: 0.99354487657547, time cost3.6787047386169434
epoch: 107, iter: 3662, loss: 1.0214325189590454, time cost3.818798542022705
epoch: 107, iter: 3663, loss: 1.566258192062378, time cost3.9431416988372803
epoch: 107, iter: 3664, loss: 1.0764249563217163, time cost3.6883599758148193
epoch: 107, iter: 3665, loss: 1.094372034072876, time cost3.743321657180786
epoch: 107, iter: 3666, loss: 0.8277142643928528, time cost3.839822769165039
epoch: 107, iter: 3667, loss: 0.7294167876243591, time cost3.8033924102783203
epoch: 107, iter: 3668, loss: 1.411117672920227, time cost3.704624891281128
epoch: 107, iter: 3669, loss: 0.8324607014656067, time cost3.7183473110198975
epoch: 107, iter: 3670, loss: 0.8758490085601807, time cost3.754964828491211
epoch: 107, iter: 3671, loss: 0.5421774387359619, time cost3.7062034606933594
epoch: 107, iter: 3672, loss: 0.5471161007881165, time cost2.7011449337005615
epoch: 108, iter: 3673, loss: 1.2047914266586304, time cost3.946436882019043
epoch: 108, iter: 3674, loss: 0.31475159525871277, time cost3.7331979274749756
epoch: 108, iter: 3675, loss: 0.7168158292770386, time cost3.9165432453155518
epoch: 108, iter: 3676, loss: 1.1635165214538574, time cost3.9600107669830322
epoch: 108, iter: 3677, loss: 0.7054219245910645, time cost3.96313214302063
epoch: 108, iter: 3678, loss: 0.7858767509460449, time cost3.8685173988342285
epoch: 108, iter: 3679, loss: 0.7734214067459106, time cost3.958362340927124
epoch: 108, iter: 3680, loss: 0.7042427659034729, time cost3.7391412258148193
epoch: 108, iter: 3681, loss: 0.9685798287391663, time cost3.8299546241760254
epoch: 108, iter: 3682, loss: 0.5633097290992737, time cost4.005483865737915
epoch: 108, iter: 3683, loss: 0.8852041959762573, time cost3.956254243850708
epoch: 108, iter: 3684, loss: 1.0423234701156616, time cost3.873661756515503
epoch: 108, iter: 3685, loss: 0.5465206503868103, time cost3.9547479152679443
epoch: 108, iter: 3686, loss: 0.8547934293746948, time cost4.040940523147583
epoch: 108, iter: 3687, loss: 0.9074936509132385, time cost3.8559813499450684
epoch: 108, iter: 3688, loss: 0.8493384718894958, time cost4.014419794082642
epoch: 108, iter: 3689, loss: 0.525332510471344, time cost3.84365177154541
epoch: 108, iter: 3690, loss: 0.6736577749252319, time cost3.945030450820923
epoch: 108, iter: 3691, loss: 0.8413209319114685, time cost3.959467649459839
epoch: 108, iter: 3692, loss: 0.9904642701148987, time cost3.873844623565674
epoch: 108, iter: 3693, loss: 0.759922206401825, time cost3.8001246452331543
epoch: 108, iter: 3694, loss: 0.8544766902923584, time cost3.9575400352478027
epoch: 108, iter: 3695, loss: 0.898395836353302, time cost3.7542169094085693
epoch: 108, iter: 3696, loss: 0.7249747514724731, time cost3.648909330368042
epoch: 108, iter: 3697, loss: 0.7921208739280701, time cost3.786698341369629
epoch: 108, iter: 3698, loss: 1.4307583570480347, time cost3.786447286605835
epoch: 108, iter: 3699, loss: 0.6319221258163452, time cost3.745067834854126
epoch: 108, iter: 3700, loss: 0.952337920665741, time cost4.025231122970581
tensor([[ 25.,  26.,  32.,  ...,   4.,   4.,   2.],
        [ 15.,  19.,  17.,  ...,  11.,  11.,   7.],
        [102., 232.,  68.,  ...,   6.,   6.,   3.],
        ...,
        [113., 110.,  86.,  ...,  35.,  35.,  23.],
        [115.,  91.,  15.,  ...,   1.,   1.,   1.],
        [  8.,  61.,  56.,  ...,   7.,   7.,   8.]])
Epoch: 108, Iteration: 3700:
TEST A@1: 0.4955555555555556
TEST A@5: 0.8577777777777778
TEST A@10: 0.9377777777777778
TEST M@B: 0.3928690046171936
TEST M@A: 0.9478127767640935
TEST W@MB: 0.21040872159805246
TEST W@MA: 0.5837757574638188
TEST Time: 490.7134153842926
REAL performance: Top1: 0.58, Top5: 0.8911111111111111, Top10: 0.9444444444444444, MB: 0.42934739079043527, MA: 0.9556317751664845, WMB: 0.22928976502037554, WMA: 0.5902112898665206
epoch: 108, iter: 3701, loss: 0.6202327013015747, time cost3.8655240535736084
epoch: 108, iter: 3702, loss: 0.7548919320106506, time cost3.8155922889709473
epoch: 108, iter: 3703, loss: 0.8229268193244934, time cost3.8425545692443848
epoch: 108, iter: 3704, loss: 1.102428913116455, time cost3.808152675628662
epoch: 108, iter: 3705, loss: 0.9822386503219604, time cost3.8566253185272217
epoch: 108, iter: 3706, loss: 0.5873743295669556, time cost2.947571039199829
epoch: 109, iter: 3707, loss: 0.46575114130973816, time cost4.106708765029907
epoch: 109, iter: 3708, loss: 0.7477076053619385, time cost4.065253496170044
epoch: 109, iter: 3709, loss: 1.3640559911727905, time cost3.8651654720306396
epoch: 109, iter: 3710, loss: 0.7895001769065857, time cost3.78779935836792
epoch: 109, iter: 3711, loss: 0.7141201496124268, time cost3.9030282497406006
epoch: 109, iter: 3712, loss: 1.0645710229873657, time cost3.8243744373321533
epoch: 109, iter: 3713, loss: 0.9423552751541138, time cost4.021593809127808
epoch: 109, iter: 3714, loss: 1.075612187385559, time cost3.930156946182251
epoch: 109, iter: 3715, loss: 0.8989757299423218, time cost4.02297043800354
epoch: 109, iter: 3716, loss: 0.7756572961807251, time cost3.7608773708343506
epoch: 109, iter: 3717, loss: 0.5821684002876282, time cost3.8586013317108154
epoch: 109, iter: 3718, loss: 0.7343497276306152, time cost3.7743613719940186
epoch: 109, iter: 3719, loss: 0.5542662739753723, time cost3.785066843032837
epoch: 109, iter: 3720, loss: 0.5644071102142334, time cost3.898693084716797
epoch: 109, iter: 3721, loss: 0.7686837911605835, time cost3.9260025024414062
epoch: 109, iter: 3722, loss: 0.4747362434864044, time cost3.8713581562042236
epoch: 109, iter: 3723, loss: 0.677979052066803, time cost3.854522705078125
epoch: 109, iter: 3724, loss: 0.5139666199684143, time cost3.907042980194092
epoch: 109, iter: 3725, loss: 0.6636918187141418, time cost3.9252841472625732
epoch: 109, iter: 3726, loss: 1.1637507677078247, time cost3.902130126953125
epoch: 109, iter: 3727, loss: 0.44108468294143677, time cost3.843372344970703
epoch: 109, iter: 3728, loss: 1.0971477031707764, time cost4.061513900756836
epoch: 109, iter: 3729, loss: 0.696593165397644, time cost3.829185962677002
epoch: 109, iter: 3730, loss: 0.8846988677978516, time cost3.9458107948303223
epoch: 109, iter: 3731, loss: 1.158159852027893, time cost3.8109309673309326
epoch: 109, iter: 3732, loss: 0.9981461763381958, time cost3.9447457790374756
epoch: 109, iter: 3733, loss: 0.8646032810211182, time cost3.853088855743408
epoch: 109, iter: 3734, loss: 0.4298105239868164, time cost3.7770297527313232
epoch: 109, iter: 3735, loss: 0.8636786937713623, time cost3.8051915168762207
epoch: 109, iter: 3736, loss: 0.8175462484359741, time cost3.9158811569213867
epoch: 109, iter: 3737, loss: 0.825433611869812, time cost4.146774053573608
epoch: 109, iter: 3738, loss: 0.3664626181125641, time cost4.084152698516846
epoch: 109, iter: 3739, loss: 0.7335141897201538, time cost4.169356346130371
epoch: 109, iter: 3740, loss: 0.40881025791168213, time cost2.8163607120513916
epoch: 110, iter: 3741, loss: 0.8797392845153809, time cost3.883517265319824
epoch: 110, iter: 3742, loss: 1.306854486465454, time cost3.874807357788086
epoch: 110, iter: 3743, loss: 1.2781039476394653, time cost4.032725811004639
epoch: 110, iter: 3744, loss: 0.799294650554657, time cost3.9929301738739014
epoch: 110, iter: 3745, loss: 0.5194153189659119, time cost4.053173542022705
epoch: 110, iter: 3746, loss: 0.952727198600769, time cost4.099324464797974
epoch: 110, iter: 3747, loss: 1.6338764429092407, time cost3.9602746963500977
epoch: 110, iter: 3748, loss: 0.6604027152061462, time cost3.9006998538970947
epoch: 110, iter: 3749, loss: 0.9256749749183655, time cost3.7857096195220947
epoch: 110, iter: 3750, loss: 0.7729527354240417, time cost3.8894765377044678
tensor([[ 35.,  38.,  40.,  ...,  10.,  10.,   8.],
        [  7.,   8.,   8.,  ...,  10.,  10.,   8.],
        [ 55., 142.,  76.,  ...,   6.,   6.,   2.],
        ...,
        [ 67.,  65.,  49.,  ...,   9.,   9.,   8.],
        [ 60.,  41.,   6.,  ...,   1.,   1.,   1.],
        [ 38.,  70.,  93.,  ...,   4.,   4.,   6.]])
Epoch: 110, Iteration: 3750:
TEST A@1: 0.5644444444444444
TEST A@5: 0.8888888888888888
TEST A@10: 0.9622222222222222
TEST M@B: 0.43198339974073197
TEST M@A: 0.9579495887547023
TEST W@MB: 0.23192154835215115
TEST W@MA: 0.5922370009626536
TEST Time: 488.0687766075134
Model Updated
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 110, iter: 3751, loss: 0.6214665770530701, time cost3.851724624633789
epoch: 110, iter: 3752, loss: 0.5750239491462708, time cost3.8679358959198
epoch: 110, iter: 3753, loss: 0.9783158898353577, time cost4.023210763931274
epoch: 110, iter: 3754, loss: 0.7299439907073975, time cost4.001026630401611
epoch: 110, iter: 3755, loss: 0.7689723968505859, time cost3.889780044555664
epoch: 110, iter: 3756, loss: 0.4830135703086853, time cost3.9877851009368896
epoch: 110, iter: 3757, loss: 0.8132995367050171, time cost3.88836407661438
epoch: 110, iter: 3758, loss: 0.7193461060523987, time cost3.9909629821777344
epoch: 110, iter: 3759, loss: 1.1666309833526611, time cost4.004960060119629
epoch: 110, iter: 3760, loss: 0.6690099239349365, time cost4.0177977085113525
epoch: 110, iter: 3761, loss: 1.4311085939407349, time cost3.8363869190216064
epoch: 110, iter: 3762, loss: 1.1721312999725342, time cost3.8952395915985107
epoch: 110, iter: 3763, loss: 0.6889137029647827, time cost3.8187756538391113
epoch: 110, iter: 3764, loss: 1.6930599212646484, time cost3.836418628692627
epoch: 110, iter: 3765, loss: 1.322727084159851, time cost4.126341342926025
epoch: 110, iter: 3766, loss: 1.0125864744186401, time cost3.919720411300659
epoch: 110, iter: 3767, loss: 0.83870929479599, time cost3.719817876815796
epoch: 110, iter: 3768, loss: 1.0347058773040771, time cost3.8146309852600098
epoch: 110, iter: 3769, loss: 0.8654682636260986, time cost3.9464797973632812
epoch: 110, iter: 3770, loss: 1.175276517868042, time cost3.849299430847168
epoch: 110, iter: 3771, loss: 0.9779503345489502, time cost3.643569231033325
epoch: 110, iter: 3772, loss: 1.1747395992279053, time cost3.8217835426330566
epoch: 110, iter: 3773, loss: 1.3982213735580444, time cost3.919628620147705
epoch: 110, iter: 3774, loss: 0.3169814646244049, time cost2.7223477363586426
epoch: 111, iter: 3775, loss: 0.7368873357772827, time cost3.835034132003784
epoch: 111, iter: 3776, loss: 0.7205239534378052, time cost3.960073232650757
epoch: 111, iter: 3777, loss: 1.067190408706665, time cost3.808513641357422
epoch: 111, iter: 3778, loss: 0.7308107018470764, time cost4.019921541213989
epoch: 111, iter: 3779, loss: 1.0644437074661255, time cost3.930393934249878
epoch: 111, iter: 3780, loss: 0.5798251032829285, time cost3.8469722270965576
epoch: 111, iter: 3781, loss: 0.9053526520729065, time cost3.845799446105957
epoch: 111, iter: 3782, loss: 0.6966792941093445, time cost3.8854455947875977
epoch: 111, iter: 3783, loss: 1.1527764797210693, time cost3.8872268199920654
epoch: 111, iter: 3784, loss: 0.7631680369377136, time cost3.9073917865753174
epoch: 111, iter: 3785, loss: 0.6181063055992126, time cost3.796489715576172
epoch: 111, iter: 3786, loss: 1.0765291452407837, time cost3.837712049484253
epoch: 111, iter: 3787, loss: 0.7305415272712708, time cost3.952887773513794
epoch: 111, iter: 3788, loss: 1.0247392654418945, time cost3.956028938293457
epoch: 111, iter: 3789, loss: 0.9719938039779663, time cost4.000814199447632
epoch: 111, iter: 3790, loss: 0.7288210988044739, time cost3.931952476501465
epoch: 111, iter: 3791, loss: 1.1061240434646606, time cost3.854918956756592
epoch: 111, iter: 3792, loss: 0.953641414642334, time cost3.871460199356079
epoch: 111, iter: 3793, loss: 0.59166419506073, time cost3.7986838817596436
epoch: 111, iter: 3794, loss: 1.0087952613830566, time cost4.046017408370972
epoch: 111, iter: 3795, loss: 1.1659940481185913, time cost3.8764355182647705
epoch: 111, iter: 3796, loss: 0.735449492931366, time cost3.7623543739318848
epoch: 111, iter: 3797, loss: 0.6389212012290955, time cost3.888686180114746
epoch: 111, iter: 3798, loss: 0.7132610082626343, time cost3.939199447631836
epoch: 111, iter: 3799, loss: 1.0403083562850952, time cost3.8623359203338623
epoch: 111, iter: 3800, loss: 0.8204219937324524, time cost3.9671382904052734
tensor([[132., 117., 125.,  ...,  22.,  22.,  13.],
        [105.,  63.,  60.,  ...,  11.,  11.,   6.],
        [ 59., 107.,  49.,  ...,  15.,  15.,  11.],
        ...,
        [ 51.,  51.,  41.,  ...,  19.,  19.,  13.],
        [ 23.,  14.,   4.,  ...,   1.,   1.,   1.],
        [ 29.,  56.,  67.,  ...,   2.,   2.,   7.]])
Epoch: 111, Iteration: 3800:
TEST A@1: 0.48
TEST A@5: 0.8244444444444444
TEST A@10: 0.9244444444444444
TEST M@B: 0.37820835833476735
TEST M@A: 0.9466989791119796
TEST W@MB: 0.20124476316248294
TEST W@MA: 0.5831494671717309
TEST Time: 437.20516896247864
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 111, iter: 3801, loss: 0.8521142601966858, time cost3.9885990619659424
epoch: 111, iter: 3802, loss: 1.062978982925415, time cost3.964097499847412
epoch: 111, iter: 3803, loss: 0.4012962281703949, time cost4.0825135707855225
epoch: 111, iter: 3804, loss: 0.6873608827590942, time cost3.8702831268310547
epoch: 111, iter: 3805, loss: 0.64395672082901, time cost3.9205102920532227
epoch: 111, iter: 3806, loss: 0.6964190602302551, time cost3.8841793537139893
epoch: 111, iter: 3807, loss: 0.6725382208824158, time cost4.021103382110596
epoch: 111, iter: 3808, loss: 0.8250570893287659, time cost2.831233501434326
epoch: 112, iter: 3809, loss: 0.6538601517677307, time cost4.090843200683594
epoch: 112, iter: 3810, loss: 0.6231570839881897, time cost3.965895414352417
epoch: 112, iter: 3811, loss: 0.5605720281600952, time cost3.9058549404144287
epoch: 112, iter: 3812, loss: 0.6505751013755798, time cost3.880009174346924
epoch: 112, iter: 3813, loss: 0.6738983392715454, time cost4.1842663288116455
epoch: 112, iter: 3814, loss: 0.45678550004959106, time cost3.960843086242676
epoch: 112, iter: 3815, loss: 0.8853129744529724, time cost3.888934850692749
epoch: 112, iter: 3816, loss: 1.1446062326431274, time cost3.886357307434082
epoch: 112, iter: 3817, loss: 1.0493850708007812, time cost4.100386142730713
epoch: 112, iter: 3818, loss: 1.1901835203170776, time cost4.033772230148315
epoch: 112, iter: 3819, loss: 0.7609363794326782, time cost3.9867660999298096
epoch: 112, iter: 3820, loss: 0.838323712348938, time cost4.079289674758911
epoch: 112, iter: 3821, loss: 1.7128210067749023, time cost4.012219190597534
epoch: 112, iter: 3822, loss: 1.710547924041748, time cost4.077139616012573
epoch: 112, iter: 3823, loss: 0.8694548010826111, time cost3.9172186851501465
epoch: 112, iter: 3824, loss: 0.9671699404716492, time cost4.0672407150268555
epoch: 112, iter: 3825, loss: 0.5351278185844421, time cost4.024934530258179
epoch: 112, iter: 3826, loss: 1.012608528137207, time cost3.9048712253570557
epoch: 112, iter: 3827, loss: 1.4991765022277832, time cost3.9523613452911377
epoch: 112, iter: 3828, loss: 0.8988816738128662, time cost3.9600658416748047
epoch: 112, iter: 3829, loss: 0.47528162598609924, time cost3.8240532875061035
epoch: 112, iter: 3830, loss: 0.7897306680679321, time cost4.001174211502075
epoch: 112, iter: 3831, loss: 1.3891870975494385, time cost3.880345344543457
epoch: 112, iter: 3832, loss: 0.6381385326385498, time cost4.0134124755859375
epoch: 112, iter: 3833, loss: 1.3381885290145874, time cost4.017551422119141
epoch: 112, iter: 3834, loss: 0.9449852705001831, time cost3.9683725833892822
epoch: 112, iter: 3835, loss: 0.5207334756851196, time cost3.8992514610290527
epoch: 112, iter: 3836, loss: 0.3566928505897522, time cost3.969391345977783
epoch: 112, iter: 3837, loss: 0.9575239419937134, time cost3.6301517486572266
epoch: 112, iter: 3838, loss: 1.0716290473937988, time cost3.565701961517334
epoch: 112, iter: 3839, loss: 0.6777874827384949, time cost3.6312742233276367
epoch: 112, iter: 3840, loss: 0.5387935638427734, time cost3.706315279006958
epoch: 112, iter: 3841, loss: 0.9562474489212036, time cost3.8746280670166016
epoch: 112, iter: 3842, loss: 0.7108249664306641, time cost2.8317923545837402
epoch: 113, iter: 3843, loss: 0.5118712186813354, time cost3.2341060638427734
epoch: 113, iter: 3844, loss: 1.3208647966384888, time cost3.6307952404022217
epoch: 113, iter: 3845, loss: 0.6548641324043274, time cost3.911470651626587
epoch: 113, iter: 3846, loss: 0.5585227012634277, time cost3.951235294342041
epoch: 113, iter: 3847, loss: 0.6185295581817627, time cost3.986135244369507
epoch: 113, iter: 3848, loss: 0.8653810024261475, time cost4.081871271133423
epoch: 113, iter: 3849, loss: 0.4594373106956482, time cost3.9708144664764404
epoch: 113, iter: 3850, loss: 1.0670673847198486, time cost3.9637866020202637
tensor([[ 83.,  76.,  90.,  ...,  17.,  17.,  11.],
        [ 14.,  10.,   9.,  ...,   8.,   8.,   8.],
        [ 21., 107.,  45.,  ...,   2.,   2.,   1.],
        ...,
        [ 53.,  50.,  41.,  ...,  21.,  21.,  11.],
        [ 40.,  17.,   7.,  ...,   1.,   1.,   1.],
        [ 14.,  60.,  70.,  ...,   2.,   2.,   3.]])
Epoch: 113, Iteration: 3850:
TEST A@1: 0.5333333333333333
TEST A@5: 0.8488888888888889
TEST A@10: 0.9422222222222222
TEST M@B: 0.39600917171180566
TEST M@A: 0.954300633520361
TEST W@MB: 0.21253245086366626
TEST W@MA: 0.58956579073562
TEST Time: 509.1040642261505
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 113, iter: 3851, loss: 0.9137996435165405, time cost3.98862624168396
epoch: 113, iter: 3852, loss: 0.8143562078475952, time cost3.9225575923919678
epoch: 113, iter: 3853, loss: 1.5101159811019897, time cost4.1627607345581055
epoch: 113, iter: 3854, loss: 0.45773664116859436, time cost4.166162729263306
epoch: 113, iter: 3855, loss: 0.5969753265380859, time cost4.081948757171631
epoch: 113, iter: 3856, loss: 0.8580524921417236, time cost4.084807872772217
epoch: 113, iter: 3857, loss: 0.5129615068435669, time cost4.240769386291504
epoch: 113, iter: 3858, loss: 0.6355389356613159, time cost4.058509111404419
epoch: 113, iter: 3859, loss: 0.4430365264415741, time cost4.008063316345215
epoch: 113, iter: 3860, loss: 1.0290924310684204, time cost3.858001470565796
epoch: 113, iter: 3861, loss: 1.200049638748169, time cost4.006668567657471
epoch: 113, iter: 3862, loss: 0.7826766967773438, time cost3.88041353225708
epoch: 113, iter: 3863, loss: 0.5493724942207336, time cost4.033469915390015
epoch: 113, iter: 3864, loss: 0.624754786491394, time cost3.953118085861206
epoch: 113, iter: 3865, loss: 0.9311299920082092, time cost4.136850595474243
epoch: 113, iter: 3866, loss: 0.6773391366004944, time cost3.9668734073638916
epoch: 113, iter: 3867, loss: 0.45087099075317383, time cost3.9629499912261963
epoch: 113, iter: 3868, loss: 0.6944563388824463, time cost4.049105405807495
epoch: 113, iter: 3869, loss: 0.45069605112075806, time cost4.013772010803223
epoch: 113, iter: 3870, loss: 0.42143315076828003, time cost3.860210418701172
epoch: 113, iter: 3871, loss: 0.5470271110534668, time cost4.05778431892395
epoch: 113, iter: 3872, loss: 0.8470311164855957, time cost4.020166397094727
epoch: 113, iter: 3873, loss: 0.5111856460571289, time cost3.924591064453125
epoch: 113, iter: 3874, loss: 0.3418929874897003, time cost3.9865500926971436
epoch: 113, iter: 3875, loss: 0.4700198173522949, time cost3.963191032409668
epoch: 113, iter: 3876, loss: 0.44476842880249023, time cost2.8045873641967773
epoch: 114, iter: 3877, loss: 0.7620014548301697, time cost4.040513277053833
epoch: 114, iter: 3878, loss: 0.8765042424201965, time cost4.081011056900024
epoch: 114, iter: 3879, loss: 0.716194748878479, time cost4.0965588092803955
epoch: 114, iter: 3880, loss: 0.7202369570732117, time cost3.90543270111084
epoch: 114, iter: 3881, loss: 0.49596425890922546, time cost4.146770715713501
epoch: 114, iter: 3882, loss: 0.2896874248981476, time cost4.062863111495972
epoch: 114, iter: 3883, loss: 0.9122152328491211, time cost3.8532097339630127
epoch: 114, iter: 3884, loss: 0.9815596342086792, time cost4.019324541091919
epoch: 114, iter: 3885, loss: 0.7020323276519775, time cost3.8838706016540527
epoch: 114, iter: 3886, loss: 0.7458077669143677, time cost4.016193628311157
epoch: 114, iter: 3887, loss: 0.8155721426010132, time cost3.9536564350128174
epoch: 114, iter: 3888, loss: 0.7628406882286072, time cost4.067888975143433
epoch: 114, iter: 3889, loss: 0.8912713527679443, time cost4.166269302368164
epoch: 114, iter: 3890, loss: 0.523110032081604, time cost4.10575532913208
epoch: 114, iter: 3891, loss: 0.545050859451294, time cost4.277165651321411
epoch: 114, iter: 3892, loss: 0.8098510503768921, time cost3.842564344406128
epoch: 114, iter: 3893, loss: 0.9841296076774597, time cost3.9704596996307373
epoch: 114, iter: 3894, loss: 0.7803760766983032, time cost3.8851921558380127
epoch: 114, iter: 3895, loss: 0.5848501920700073, time cost4.145370721817017
epoch: 114, iter: 3896, loss: 0.720313310623169, time cost4.127629518508911
epoch: 114, iter: 3897, loss: 1.0146855115890503, time cost3.9710350036621094
epoch: 114, iter: 3898, loss: 1.008763074874878, time cost3.9574060440063477
epoch: 114, iter: 3899, loss: 1.0843302011489868, time cost4.029363393783569
epoch: 114, iter: 3900, loss: 0.9005489349365234, time cost4.037672996520996
tensor([[306., 234., 245.,  ...,   1.,   1.,   1.],
        [ 10.,  11.,   9.,  ...,  11.,  11.,   5.],
        [ 55., 141.,  60.,  ...,  26.,  26.,  19.],
        ...,
        [ 59.,  59.,  35.,  ...,  14.,  14.,  14.],
        [ 62.,  48.,   8.,  ...,   1.,   1.,   1.],
        [205., 209., 306.,  ...,   1.,   1.,   1.]])
Epoch: 114, Iteration: 3900:
TEST A@1: 0.5177777777777778
TEST A@5: 0.8666666666666667
TEST A@10: 0.9444444444444444
TEST M@B: 0.41583172790041795
TEST M@A: 0.9529091815012434
TEST W@MB: 0.22233126297124567
TEST W@MA: 0.5880616761237104
TEST Time: 502.50651121139526
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 114, iter: 3901, loss: 1.0432244539260864, time cost4.029211044311523
epoch: 114, iter: 3902, loss: 1.5841697454452515, time cost3.9203224182128906
epoch: 114, iter: 3903, loss: 0.8798151612281799, time cost3.906540632247925
epoch: 114, iter: 3904, loss: 0.7680469751358032, time cost3.9640862941741943
epoch: 114, iter: 3905, loss: 0.5569481253623962, time cost3.8912901878356934
epoch: 114, iter: 3906, loss: 1.5903823375701904, time cost3.828503370285034
epoch: 114, iter: 3907, loss: 0.7957419157028198, time cost4.026745080947876
epoch: 114, iter: 3908, loss: 0.8377352356910706, time cost4.0234081745147705
epoch: 114, iter: 3909, loss: 1.5796349048614502, time cost3.981154441833496
epoch: 114, iter: 3910, loss: 0.20243163406848907, time cost2.9120142459869385
epoch: 115, iter: 3911, loss: 0.6482509970664978, time cost4.109739065170288
epoch: 115, iter: 3912, loss: 0.6389706134796143, time cost3.7562408447265625
epoch: 115, iter: 3913, loss: 1.0851352214813232, time cost3.782043933868408
epoch: 115, iter: 3914, loss: 0.8483312726020813, time cost4.138510227203369
epoch: 115, iter: 3915, loss: 1.2141597270965576, time cost3.680026054382324
epoch: 115, iter: 3916, loss: 0.9059005379676819, time cost3.979586362838745
epoch: 115, iter: 3917, loss: 0.6223040223121643, time cost4.096032381057739
epoch: 115, iter: 3918, loss: 0.8762274980545044, time cost3.9802849292755127
epoch: 115, iter: 3919, loss: 0.7551209330558777, time cost3.9837019443511963
epoch: 115, iter: 3920, loss: 0.5963236689567566, time cost4.019475936889648
epoch: 115, iter: 3921, loss: 1.52665376663208, time cost3.9049344062805176
epoch: 115, iter: 3922, loss: 0.8999391198158264, time cost3.99045991897583
epoch: 115, iter: 3923, loss: 0.9669328331947327, time cost3.9318552017211914
epoch: 115, iter: 3924, loss: 1.0149019956588745, time cost3.911874294281006
epoch: 115, iter: 3925, loss: 0.7313317060470581, time cost4.015643358230591
epoch: 115, iter: 3926, loss: 0.6103817820549011, time cost4.222627639770508
epoch: 115, iter: 3927, loss: 0.4703877568244934, time cost4.023573160171509
epoch: 115, iter: 3928, loss: 0.9245560169219971, time cost4.102851629257202
epoch: 115, iter: 3929, loss: 0.5886343717575073, time cost3.939493179321289
epoch: 115, iter: 3930, loss: 0.6527099609375, time cost3.940396308898926
epoch: 115, iter: 3931, loss: 0.7950689792633057, time cost4.096194505691528
epoch: 115, iter: 3932, loss: 0.8543674945831299, time cost3.9604570865631104
epoch: 115, iter: 3933, loss: 0.7002492547035217, time cost3.8786072731018066
epoch: 115, iter: 3934, loss: 0.673346757888794, time cost3.9914634227752686
epoch: 115, iter: 3935, loss: 0.8491891026496887, time cost3.9230425357818604
epoch: 115, iter: 3936, loss: 0.54730623960495, time cost3.9619436264038086
epoch: 115, iter: 3937, loss: 0.9360141754150391, time cost3.9755871295928955
epoch: 115, iter: 3938, loss: 0.850947916507721, time cost3.7681798934936523
epoch: 115, iter: 3939, loss: 0.6568828821182251, time cost4.01949405670166
epoch: 115, iter: 3940, loss: 0.6138999462127686, time cost3.8618223667144775
epoch: 115, iter: 3941, loss: 0.9904170036315918, time cost4.037665128707886
epoch: 115, iter: 3942, loss: 0.5196981430053711, time cost3.963576555252075
epoch: 115, iter: 3943, loss: 1.1085772514343262, time cost3.986269235610962
epoch: 115, iter: 3944, loss: 0.3241223692893982, time cost2.8280255794525146
epoch: 116, iter: 3945, loss: 0.45394304394721985, time cost4.1483540534973145
epoch: 116, iter: 3946, loss: 0.6567643284797668, time cost4.003667593002319
epoch: 116, iter: 3947, loss: 0.793368399143219, time cost3.9173998832702637
epoch: 116, iter: 3948, loss: 0.814326286315918, time cost4.065484523773193
epoch: 116, iter: 3949, loss: 0.7828013896942139, time cost4.191751480102539
epoch: 116, iter: 3950, loss: 0.5120459794998169, time cost4.075869083404541
tensor([[ 27.,  27.,  35.,  ...,   5.,   5.,   1.],
        [  9.,   7.,   7.,  ...,   7.,   7.,   5.],
        [ 61., 142.,  76.,  ...,   2.,   2.,   1.],
        ...,
        [ 39.,  40.,  30.,  ...,   8.,   8.,   7.],
        [ 35.,  31.,  10.,  ...,   1.,   1.,   1.],
        [ 60., 152., 169.,  ...,  10.,  10.,  12.]])
Epoch: 116, Iteration: 3950:
TEST A@1: 0.5244444444444445
TEST A@5: 0.8866666666666667
TEST A@10: 0.9488888888888889
TEST M@B: 0.41727669454658517
TEST M@A: 0.9560629975857243
TEST W@MB: 0.22372291446076636
TEST W@MA: 0.5907093484747346
TEST Time: 504.429584980011
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 116, iter: 3951, loss: 0.7430835962295532, time cost3.990078926086426
epoch: 116, iter: 3952, loss: 0.7855448126792908, time cost3.855595350265503
epoch: 116, iter: 3953, loss: 0.7170075178146362, time cost4.0820722579956055
epoch: 116, iter: 3954, loss: 0.7688567042350769, time cost3.8725852966308594
epoch: 116, iter: 3955, loss: 0.6556411385536194, time cost3.838669776916504
epoch: 116, iter: 3956, loss: 0.8576779365539551, time cost3.807762861251831
epoch: 116, iter: 3957, loss: 0.8155375719070435, time cost4.129392147064209
epoch: 116, iter: 3958, loss: 0.6647759079933167, time cost3.973024368286133
epoch: 116, iter: 3959, loss: 1.2840909957885742, time cost3.85392689704895
epoch: 116, iter: 3960, loss: 0.7627710103988647, time cost3.9518613815307617
epoch: 116, iter: 3961, loss: 0.9816409349441528, time cost3.9744553565979004
epoch: 116, iter: 3962, loss: 0.8465076684951782, time cost3.669067621231079
epoch: 116, iter: 3963, loss: 0.8205398917198181, time cost3.8448007106781006
epoch: 116, iter: 3964, loss: 0.7785621881484985, time cost3.9752466678619385
epoch: 116, iter: 3965, loss: 0.830976665019989, time cost3.9605040550231934
epoch: 116, iter: 3966, loss: 0.9210688471794128, time cost4.045743703842163
epoch: 116, iter: 3967, loss: 1.4368373155593872, time cost3.902383327484131
epoch: 116, iter: 3968, loss: 1.0385236740112305, time cost4.072240829467773
epoch: 116, iter: 3969, loss: 0.8318788409233093, time cost3.9295387268066406
epoch: 116, iter: 3970, loss: 0.8029464483261108, time cost4.190824508666992
epoch: 116, iter: 3971, loss: 0.700171172618866, time cost3.8230137825012207
epoch: 116, iter: 3972, loss: 0.9539611339569092, time cost3.7981488704681396
epoch: 116, iter: 3973, loss: 0.9246711730957031, time cost4.077485084533691
epoch: 116, iter: 3974, loss: 0.7681810259819031, time cost4.060676574707031
epoch: 116, iter: 3975, loss: 0.6568231582641602, time cost4.164164066314697
epoch: 116, iter: 3976, loss: 1.4375150203704834, time cost4.028013467788696
epoch: 116, iter: 3977, loss: 0.29895585775375366, time cost3.829219341278076
epoch: 116, iter: 3978, loss: 0.5223734974861145, time cost2.756946086883545
epoch: 117, iter: 3979, loss: 1.208182692527771, time cost3.9277849197387695
epoch: 117, iter: 3980, loss: 0.8455512523651123, time cost3.830456256866455
epoch: 117, iter: 3981, loss: 0.5503414273262024, time cost3.904035806655884
epoch: 117, iter: 3982, loss: 0.5798608660697937, time cost3.9541215896606445
epoch: 117, iter: 3983, loss: 1.250425934791565, time cost4.1558473110198975
epoch: 117, iter: 3984, loss: 1.7767646312713623, time cost3.869197130203247
epoch: 117, iter: 3985, loss: 0.9078527688980103, time cost4.108952045440674
epoch: 117, iter: 3986, loss: 0.6890429854393005, time cost3.9733920097351074
epoch: 117, iter: 3987, loss: 0.4413476884365082, time cost4.031103610992432
epoch: 117, iter: 3988, loss: 0.7240545153617859, time cost4.1318488121032715
epoch: 117, iter: 3989, loss: 1.524261236190796, time cost4.1834306716918945
epoch: 117, iter: 3990, loss: 0.8091568350791931, time cost4.088242769241333
epoch: 117, iter: 3991, loss: 1.2276465892791748, time cost4.048108100891113
epoch: 117, iter: 3992, loss: 0.41510751843452454, time cost4.0446617603302
epoch: 117, iter: 3993, loss: 1.4957668781280518, time cost4.076864004135132
epoch: 117, iter: 3994, loss: 0.6877763271331787, time cost4.076183557510376
epoch: 117, iter: 3995, loss: 0.758703887462616, time cost4.136878252029419
epoch: 117, iter: 3996, loss: 0.9785628914833069, time cost4.142365217208862
epoch: 117, iter: 3997, loss: 0.5887394547462463, time cost3.971245527267456
epoch: 117, iter: 3998, loss: 0.5143923163414001, time cost4.258845090866089
epoch: 117, iter: 3999, loss: 0.8738158941268921, time cost3.9118595123291016
epoch: 117, iter: 4000, loss: 0.709804117679596, time cost3.964463949203491
tensor([[106.,  85.,  92.,  ...,   3.,   3.,   2.],
        [ 79.,  70.,  63.,  ...,  12.,  12.,   8.],
        [128., 224., 129.,  ...,  24.,  24.,  11.],
        ...,
        [ 54.,  60.,  35.,  ...,  15.,  15.,  14.],
        [ 51.,  41.,   8.,  ...,   1.,   1.,   1.],
        [ 99., 215., 247.,  ...,   4.,   4.,  12.]])
Epoch: 117, Iteration: 4000:
TEST A@1: 0.5155555555555555
TEST A@5: 0.8822222222222222
TEST A@10: 0.9422222222222222
TEST M@B: 0.4078711565298728
TEST M@A: 0.9528168425672348
TEST W@MB: 0.21760241521664378
TEST W@MA: 0.5881579973401181
TEST Time: 493.4265546798706
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 117, iter: 4001, loss: 0.5311191082000732, time cost3.8834376335144043
epoch: 117, iter: 4002, loss: 0.8649413585662842, time cost3.9940569400787354
epoch: 117, iter: 4003, loss: 0.5782365798950195, time cost3.9331538677215576
epoch: 117, iter: 4004, loss: 1.3679425716400146, time cost3.960853338241577
epoch: 117, iter: 4005, loss: 1.2472342252731323, time cost3.9270501136779785
epoch: 117, iter: 4006, loss: 0.8422561287879944, time cost3.8394129276275635
epoch: 117, iter: 4007, loss: 0.4455220103263855, time cost3.9081242084503174
epoch: 117, iter: 4008, loss: 0.7476393580436707, time cost3.9249982833862305
epoch: 117, iter: 4009, loss: 0.6975171566009521, time cost3.862520217895508
epoch: 117, iter: 4010, loss: 0.8154047131538391, time cost3.9381515979766846
epoch: 117, iter: 4011, loss: 1.4890742301940918, time cost3.92734694480896
epoch: 117, iter: 4012, loss: 0.3129645884037018, time cost2.981189727783203
epoch: 118, iter: 4013, loss: 0.8613898754119873, time cost4.007405042648315
epoch: 118, iter: 4014, loss: 0.6140053868293762, time cost3.874309778213501
epoch: 118, iter: 4015, loss: 0.3284422755241394, time cost3.791832685470581
epoch: 118, iter: 4016, loss: 0.5796173214912415, time cost4.0090131759643555
epoch: 118, iter: 4017, loss: 1.057310700416565, time cost4.026286840438843
epoch: 118, iter: 4018, loss: 0.9027644395828247, time cost4.097027778625488
epoch: 118, iter: 4019, loss: 1.0952990055084229, time cost4.0515522956848145
epoch: 118, iter: 4020, loss: 0.6505952477455139, time cost3.8546035289764404
epoch: 118, iter: 4021, loss: 0.8542319536209106, time cost3.880077600479126
epoch: 118, iter: 4022, loss: 0.6824538111686707, time cost4.167924880981445
epoch: 118, iter: 4023, loss: 0.7215222716331482, time cost3.9607245922088623
epoch: 118, iter: 4024, loss: 0.9013817310333252, time cost4.061206579208374
epoch: 118, iter: 4025, loss: 1.0450862646102905, time cost3.826508045196533
epoch: 118, iter: 4026, loss: 0.4942159950733185, time cost3.9000701904296875
epoch: 118, iter: 4027, loss: 0.7002546191215515, time cost3.9519643783569336
epoch: 118, iter: 4028, loss: 0.5040202140808105, time cost3.910266876220703
epoch: 118, iter: 4029, loss: 0.7916068434715271, time cost3.8301517963409424
epoch: 118, iter: 4030, loss: 1.044618844985962, time cost3.7436509132385254
epoch: 118, iter: 4031, loss: 0.991503119468689, time cost3.8775124549865723
epoch: 118, iter: 4032, loss: 1.0833499431610107, time cost4.001643896102905
epoch: 118, iter: 4033, loss: 0.7843495011329651, time cost4.033002853393555
epoch: 118, iter: 4034, loss: 0.6079509258270264, time cost3.866593599319458
epoch: 118, iter: 4035, loss: 0.5548444390296936, time cost3.928154945373535
epoch: 118, iter: 4036, loss: 1.0962427854537964, time cost3.988475799560547
epoch: 118, iter: 4037, loss: 0.9464596509933472, time cost4.033052206039429
epoch: 118, iter: 4038, loss: 1.1046006679534912, time cost3.880316972732544
epoch: 118, iter: 4039, loss: 0.49574601650238037, time cost3.970895528793335
epoch: 118, iter: 4040, loss: 0.5160387754440308, time cost3.9249532222747803
epoch: 118, iter: 4041, loss: 0.6358044743537903, time cost3.863196611404419
epoch: 118, iter: 4042, loss: 0.5980587601661682, time cost4.187999248504639
epoch: 118, iter: 4043, loss: 0.7803466320037842, time cost4.069915771484375
epoch: 118, iter: 4044, loss: 0.5713894963264465, time cost4.152395009994507
epoch: 118, iter: 4045, loss: 1.2127587795257568, time cost3.858671188354492
epoch: 118, iter: 4046, loss: 0.2477782815694809, time cost2.9169955253601074
epoch: 119, iter: 4047, loss: 1.2941559553146362, time cost4.043318510055542
epoch: 119, iter: 4048, loss: 0.8995375037193298, time cost4.079599380493164
epoch: 119, iter: 4049, loss: 0.6664690375328064, time cost4.016277313232422
epoch: 119, iter: 4050, loss: 1.005874752998352, time cost4.208043098449707
tensor([[ 80.,  61.,  75.,  ...,   2.,   2.,   1.],
        [ 13.,  12.,   8.,  ...,   9.,   9.,   7.],
        [ 88., 189.,  81.,  ...,  11.,  11.,   2.],
        ...,
        [ 69.,  66.,  49.,  ...,  13.,  13.,  13.],
        [ 22.,  19.,   5.,  ...,   1.,   1.,   1.],
        [190., 219., 285.,  ...,   4.,   4.,   3.]])
Epoch: 119, Iteration: 4050:
TEST A@1: 0.5266666666666666
TEST A@5: 0.8733333333333333
TEST A@10: 0.9533333333333334
TEST M@B: 0.4201184291630606
TEST M@A: 0.9578366747373744
TEST W@MB: 0.22639895305407245
TEST W@MA: 0.5922614977194285
TEST Time: 496.0683844089508
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 119, iter: 4051, loss: 0.44561174511909485, time cost3.816343069076538
epoch: 119, iter: 4052, loss: 0.7061483263969421, time cost4.116369009017944
epoch: 119, iter: 4053, loss: 0.604357123374939, time cost4.145216226577759
epoch: 119, iter: 4054, loss: 0.6916081309318542, time cost4.252277612686157
epoch: 119, iter: 4055, loss: 0.7177640795707703, time cost3.9863715171813965
epoch: 119, iter: 4056, loss: 0.7763680815696716, time cost3.914776086807251
epoch: 119, iter: 4057, loss: 0.9408984184265137, time cost4.038224458694458
epoch: 119, iter: 4058, loss: 0.6307897567749023, time cost3.9447360038757324
epoch: 119, iter: 4059, loss: 0.8336659073829651, time cost4.115436315536499
epoch: 119, iter: 4060, loss: 0.9859796762466431, time cost3.999143362045288
epoch: 119, iter: 4061, loss: 0.7087523341178894, time cost4.044487953186035
epoch: 119, iter: 4062, loss: 0.5284382700920105, time cost3.897059202194214
epoch: 119, iter: 4063, loss: 0.4942869246006012, time cost4.063081979751587
epoch: 119, iter: 4064, loss: 0.628136157989502, time cost3.877087354660034
epoch: 119, iter: 4065, loss: 0.491472452878952, time cost3.733119487762451
epoch: 119, iter: 4066, loss: 0.7057950496673584, time cost3.869006633758545
epoch: 119, iter: 4067, loss: 0.9711049795150757, time cost3.7666373252868652
epoch: 119, iter: 4068, loss: 0.6988372802734375, time cost3.802263021469116
epoch: 119, iter: 4069, loss: 0.7828840613365173, time cost4.095695734024048
epoch: 119, iter: 4070, loss: 1.5388554334640503, time cost3.9420251846313477
epoch: 119, iter: 4071, loss: 0.567498505115509, time cost3.9169936180114746
epoch: 119, iter: 4072, loss: 0.8923178911209106, time cost3.919015884399414
epoch: 119, iter: 4073, loss: 0.7811447978019714, time cost3.8820149898529053
epoch: 119, iter: 4074, loss: 0.7148733139038086, time cost3.9241690635681152
epoch: 119, iter: 4075, loss: 0.7480922341346741, time cost3.802452325820923
epoch: 119, iter: 4076, loss: 0.9367238879203796, time cost3.856795072555542
epoch: 119, iter: 4077, loss: 0.9314642548561096, time cost4.028696537017822
epoch: 119, iter: 4078, loss: 1.319824457168579, time cost3.819206953048706
epoch: 119, iter: 4079, loss: 0.47981101274490356, time cost3.931227684020996
epoch: 119, iter: 4080, loss: 0.3426278829574585, time cost3.003157138824463
epoch: 120, iter: 4081, loss: 0.7705494165420532, time cost4.1797168254852295
epoch: 120, iter: 4082, loss: 0.8974194526672363, time cost4.25430965423584
epoch: 120, iter: 4083, loss: 0.8488199710845947, time cost4.089703321456909
epoch: 120, iter: 4084, loss: 0.4208100140094757, time cost4.090811729431152
epoch: 120, iter: 4085, loss: 0.47914785146713257, time cost4.088161945343018
epoch: 120, iter: 4086, loss: 0.7753231525421143, time cost4.016263484954834
epoch: 120, iter: 4087, loss: 1.4228277206420898, time cost4.081468343734741
epoch: 120, iter: 4088, loss: 1.0235124826431274, time cost3.9717488288879395
epoch: 120, iter: 4089, loss: 1.4462976455688477, time cost3.930370569229126
epoch: 120, iter: 4090, loss: 0.49300211668014526, time cost4.018744707107544
epoch: 120, iter: 4091, loss: 0.9094364643096924, time cost3.85312557220459
epoch: 120, iter: 4092, loss: 1.223878264427185, time cost3.9474430084228516
epoch: 120, iter: 4093, loss: 0.8049359321594238, time cost3.908468246459961
epoch: 120, iter: 4094, loss: 0.7311362028121948, time cost3.85284423828125
epoch: 120, iter: 4095, loss: 0.8809378147125244, time cost3.965447425842285
epoch: 120, iter: 4096, loss: 0.9756495356559753, time cost3.9221954345703125
epoch: 120, iter: 4097, loss: 0.5733880400657654, time cost4.191705226898193
epoch: 120, iter: 4098, loss: 0.7131071090698242, time cost3.93567156791687
epoch: 120, iter: 4099, loss: 1.2610329389572144, time cost4.092126846313477
epoch: 120, iter: 4100, loss: 0.8725603818893433, time cost4.074019908905029
tensor([[355., 302., 308.,  ...,   1.,   1.,   1.],
        [ 20.,  19.,  17.,  ...,  10.,  10.,   5.],
        [ 93., 176.,  98.,  ...,  26.,  26.,  17.],
        ...,
        [ 61.,  58.,  26.,  ...,  14.,  14.,   7.],
        [  4.,   4.,   5.,  ...,   1.,   1.,   1.],
        [339., 308., 407.,  ...,   4.,   4.,   6.]])
Epoch: 120, Iteration: 4100:
TEST A@1: 0.49777777777777776
TEST A@5: 0.8288888888888889
TEST A@10: 0.9244444444444444
TEST M@B: 0.3935667108957686
TEST M@A: 0.9501686292669869
TEST W@MB: 0.21061361141593082
TEST W@MA: 0.5860438553185262
TEST Time: 502.5273582935333
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 120, iter: 4101, loss: 0.9899243116378784, time cost3.9906766414642334
epoch: 120, iter: 4102, loss: 0.9088647365570068, time cost4.052739381790161
epoch: 120, iter: 4103, loss: 0.6264842748641968, time cost4.048712253570557
epoch: 120, iter: 4104, loss: 0.5516984462738037, time cost4.110978603363037
epoch: 120, iter: 4105, loss: 0.7259385585784912, time cost3.9613595008850098
epoch: 120, iter: 4106, loss: 0.800638735294342, time cost3.9866511821746826
epoch: 120, iter: 4107, loss: 0.9054954051971436, time cost3.8575379848480225
epoch: 120, iter: 4108, loss: 0.39368879795074463, time cost3.9181387424468994
epoch: 120, iter: 4109, loss: 1.427386999130249, time cost3.7541086673736572
epoch: 120, iter: 4110, loss: 1.1766507625579834, time cost4.006139755249023
epoch: 120, iter: 4111, loss: 0.6822303533554077, time cost3.8252415657043457
epoch: 120, iter: 4112, loss: 0.763939380645752, time cost3.8235230445861816
epoch: 120, iter: 4113, loss: 0.7071520686149597, time cost3.818392515182495
epoch: 120, iter: 4114, loss: 0.26200899481773376, time cost2.8737118244171143
epoch: 121, iter: 4115, loss: 1.1893779039382935, time cost4.1246726512908936
epoch: 121, iter: 4116, loss: 0.6437320709228516, time cost3.895850658416748
epoch: 121, iter: 4117, loss: 1.0740976333618164, time cost3.8899686336517334
epoch: 121, iter: 4118, loss: 0.6019466519355774, time cost3.891263723373413
epoch: 121, iter: 4119, loss: 1.0271425247192383, time cost3.9473259449005127
epoch: 121, iter: 4120, loss: 0.7132938504219055, time cost3.832690715789795
epoch: 121, iter: 4121, loss: 0.7435527443885803, time cost3.8533806800842285
epoch: 121, iter: 4122, loss: 1.1733473539352417, time cost3.901998996734619
epoch: 121, iter: 4123, loss: 0.47461867332458496, time cost3.782193899154663
epoch: 121, iter: 4124, loss: 0.889500081539154, time cost3.9704768657684326
epoch: 121, iter: 4125, loss: 0.6145150661468506, time cost3.967766046524048
epoch: 121, iter: 4126, loss: 1.367580533027649, time cost3.963822841644287
epoch: 121, iter: 4127, loss: 1.4424101114273071, time cost3.9533073902130127
epoch: 121, iter: 4128, loss: 0.9167278409004211, time cost3.8683078289031982
epoch: 121, iter: 4129, loss: 0.7592455148696899, time cost3.947449207305908
epoch: 121, iter: 4130, loss: 0.41879802942276, time cost3.949279546737671
epoch: 121, iter: 4131, loss: 0.5196294188499451, time cost3.9118590354919434
epoch: 121, iter: 4132, loss: 0.7053720951080322, time cost3.9266040325164795
epoch: 121, iter: 4133, loss: 0.376236230134964, time cost3.9599993228912354
epoch: 121, iter: 4134, loss: 0.4935188591480255, time cost3.913350820541382
epoch: 121, iter: 4135, loss: 0.5236246585845947, time cost3.8584375381469727
epoch: 121, iter: 4136, loss: 0.6231101751327515, time cost4.064295291900635
epoch: 121, iter: 4137, loss: 0.8935126662254333, time cost4.205425262451172
epoch: 121, iter: 4138, loss: 0.5494071245193481, time cost4.007113218307495
epoch: 121, iter: 4139, loss: 1.2268829345703125, time cost3.9667444229125977
epoch: 121, iter: 4140, loss: 1.600574254989624, time cost3.888582706451416
epoch: 121, iter: 4141, loss: 0.47959262132644653, time cost3.9350504875183105
epoch: 121, iter: 4142, loss: 0.6877844929695129, time cost3.988036632537842
epoch: 121, iter: 4143, loss: 0.8840330839157104, time cost3.9656429290771484
epoch: 121, iter: 4144, loss: 0.9697978496551514, time cost3.909839391708374
epoch: 121, iter: 4145, loss: 0.8938809633255005, time cost4.028838634490967
epoch: 121, iter: 4146, loss: 1.483558177947998, time cost3.8996706008911133
epoch: 121, iter: 4147, loss: 1.264308214187622, time cost3.893894672393799
epoch: 121, iter: 4148, loss: 0.4269198477268219, time cost2.784801721572876
epoch: 122, iter: 4149, loss: 0.4355410933494568, time cost4.042365312576294
epoch: 122, iter: 4150, loss: 0.911167562007904, time cost4.137110233306885
tensor([[129., 102., 107.,  ...,   5.,   5.,   1.],
        [ 18.,  25.,  24.,  ...,  21.,  21.,  14.],
        [ 34., 105.,  43.,  ...,   6.,   6.,   2.],
        ...,
        [ 64.,  59.,  48.,  ...,  13.,  13.,  11.],
        [177., 176., 128.,  ...,   1.,   1.,   1.],
        [ 47., 104.,  89.,  ...,  11.,  11.,  16.]])
Epoch: 122, Iteration: 4150:
TEST A@1: 0.5088888888888888
TEST A@5: 0.8466666666666667
TEST A@10: 0.9266666666666666
TEST M@B: 0.40780392291661227
TEST M@A: 0.9525782873241734
TEST W@MB: 0.2187956745207493
TEST W@MA: 0.5879493229966738
TEST Time: 505.5031039714813
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 122, iter: 4151, loss: 0.7248143553733826, time cost4.04629373550415
epoch: 122, iter: 4152, loss: 0.9055275321006775, time cost3.9269189834594727
epoch: 122, iter: 4153, loss: 0.6539621353149414, time cost3.910759449005127
epoch: 122, iter: 4154, loss: 0.8422725200653076, time cost4.030008792877197
epoch: 122, iter: 4155, loss: 1.1143577098846436, time cost3.9636452198028564
epoch: 122, iter: 4156, loss: 0.5154352188110352, time cost3.9049251079559326
epoch: 122, iter: 4157, loss: 1.229748010635376, time cost3.8820688724517822
epoch: 122, iter: 4158, loss: 0.5047409534454346, time cost3.880368709564209
epoch: 122, iter: 4159, loss: 0.5313259363174438, time cost3.7843177318573
epoch: 122, iter: 4160, loss: 0.999398946762085, time cost3.9355316162109375
epoch: 122, iter: 4161, loss: 0.8489172458648682, time cost3.9653875827789307
epoch: 122, iter: 4162, loss: 1.2815696001052856, time cost3.679652690887451
epoch: 122, iter: 4163, loss: 0.8739473819732666, time cost4.02450156211853
epoch: 122, iter: 4164, loss: 1.2705953121185303, time cost4.034596681594849
epoch: 122, iter: 4165, loss: 0.9133764505386353, time cost4.257899045944214
epoch: 122, iter: 4166, loss: 0.5719857215881348, time cost3.9306650161743164
epoch: 122, iter: 4167, loss: 0.7103805541992188, time cost3.8525097370147705
epoch: 122, iter: 4168, loss: 1.0918279886245728, time cost3.9488019943237305
epoch: 122, iter: 4169, loss: 1.0975507497787476, time cost3.8058483600616455
epoch: 122, iter: 4170, loss: 1.3881915807724, time cost3.9069154262542725
epoch: 122, iter: 4171, loss: 1.3521859645843506, time cost3.9655168056488037
epoch: 122, iter: 4172, loss: 0.8813202977180481, time cost3.9626126289367676
epoch: 122, iter: 4173, loss: 1.0856002569198608, time cost3.9119343757629395
epoch: 122, iter: 4174, loss: 0.8896195888519287, time cost4.030194520950317
epoch: 122, iter: 4175, loss: 1.300839900970459, time cost4.008047342300415
epoch: 122, iter: 4176, loss: 1.7381964921951294, time cost3.8699591159820557
epoch: 122, iter: 4177, loss: 1.5323271751403809, time cost3.7499630451202393
epoch: 122, iter: 4178, loss: 1.1626132726669312, time cost3.8155956268310547
epoch: 122, iter: 4179, loss: 0.9009220600128174, time cost3.871706247329712
epoch: 122, iter: 4180, loss: 0.9762307405471802, time cost3.927643060684204
epoch: 122, iter: 4181, loss: 1.0100411176681519, time cost3.8937761783599854
epoch: 122, iter: 4182, loss: 0.7384479641914368, time cost2.703562021255493
epoch: 123, iter: 4183, loss: 1.165616512298584, time cost3.843085289001465
epoch: 123, iter: 4184, loss: 0.5282777547836304, time cost3.9246578216552734
epoch: 123, iter: 4185, loss: 1.4010571241378784, time cost4.0778961181640625
epoch: 123, iter: 4186, loss: 0.47199851274490356, time cost3.8680078983306885
epoch: 123, iter: 4187, loss: 0.7536646723747253, time cost3.976288318634033
epoch: 123, iter: 4188, loss: 1.045804500579834, time cost4.118993043899536
epoch: 123, iter: 4189, loss: 0.9008426666259766, time cost4.045699834823608
epoch: 123, iter: 4190, loss: 0.8191268444061279, time cost3.90665602684021
epoch: 123, iter: 4191, loss: 0.546964168548584, time cost3.9041731357574463
epoch: 123, iter: 4192, loss: 1.256681203842163, time cost3.827587127685547
epoch: 123, iter: 4193, loss: 0.702202558517456, time cost4.007042646408081
epoch: 123, iter: 4194, loss: 0.7736751437187195, time cost3.956871509552002
epoch: 123, iter: 4195, loss: 0.8580372333526611, time cost4.015384674072266
epoch: 123, iter: 4196, loss: 0.6811070442199707, time cost3.983415126800537
epoch: 123, iter: 4197, loss: 1.2983094453811646, time cost3.921874523162842
epoch: 123, iter: 4198, loss: 0.679973840713501, time cost4.020726680755615
epoch: 123, iter: 4199, loss: 1.0081406831741333, time cost3.8581149578094482
epoch: 123, iter: 4200, loss: 0.9917784929275513, time cost3.845226764678955
tensor([[ 74.,  76.,  88.,  ...,   4.,   4.,   3.],
        [ 35.,  29.,  29.,  ...,  16.,  16.,  13.],
        [ 92., 169.,  68.,  ...,   6.,   6.,   1.],
        ...,
        [ 30.,  40.,  16.,  ...,  19.,  19.,  10.],
        [146., 142.,  81.,  ...,   2.,   2.,   2.],
        [124., 155., 166.,  ...,  18.,  18.,  28.]])
Epoch: 123, Iteration: 4200:
TEST A@1: 0.45555555555555555
TEST A@5: 0.8288888888888889
TEST A@10: 0.9044444444444445
TEST M@B: 0.36457137953067653
TEST M@A: 0.949939619490123
TEST W@MB: 0.1952775700255117
TEST W@MA: 0.5864076142302795
TEST Time: 499.97139263153076
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 123, iter: 4201, loss: 0.6455382108688354, time cost3.9218809604644775
epoch: 123, iter: 4202, loss: 0.540401041507721, time cost3.8650503158569336
epoch: 123, iter: 4203, loss: 1.1290489435195923, time cost3.7980170249938965
epoch: 123, iter: 4204, loss: 0.7091780304908752, time cost3.8997642993927
epoch: 123, iter: 4205, loss: 0.7270070910453796, time cost3.8593504428863525
epoch: 123, iter: 4206, loss: 1.2337689399719238, time cost3.958146095275879
epoch: 123, iter: 4207, loss: 0.6010918021202087, time cost3.986060380935669
epoch: 123, iter: 4208, loss: 0.5943416357040405, time cost3.9377365112304688
epoch: 123, iter: 4209, loss: 0.693511426448822, time cost3.974808692932129
epoch: 123, iter: 4210, loss: 0.7479559779167175, time cost3.8805432319641113
epoch: 123, iter: 4211, loss: 0.8101357817649841, time cost3.815890312194824
epoch: 123, iter: 4212, loss: 0.818733274936676, time cost3.946648120880127
epoch: 123, iter: 4213, loss: 1.029004454612732, time cost4.149214744567871
epoch: 123, iter: 4214, loss: 1.1016526222229004, time cost4.179877758026123
epoch: 123, iter: 4215, loss: 0.33751216530799866, time cost3.922487258911133
epoch: 123, iter: 4216, loss: 0.7631688117980957, time cost2.6427924633026123
epoch: 124, iter: 4217, loss: 0.81326824426651, time cost3.9579930305480957
epoch: 124, iter: 4218, loss: 0.3890460431575775, time cost3.962298631668091
epoch: 124, iter: 4219, loss: 0.8185414671897888, time cost4.009458541870117
epoch: 124, iter: 4220, loss: 1.1131601333618164, time cost3.95759916305542
epoch: 124, iter: 4221, loss: 0.7116240859031677, time cost4.083491325378418
epoch: 124, iter: 4222, loss: 0.49485859274864197, time cost3.9710803031921387
epoch: 124, iter: 4223, loss: 0.6646221280097961, time cost4.095619201660156
epoch: 124, iter: 4224, loss: 0.6269992589950562, time cost3.8779680728912354
epoch: 124, iter: 4225, loss: 0.6283901333808899, time cost3.982923746109009
epoch: 124, iter: 4226, loss: 0.9303739070892334, time cost4.037667751312256
epoch: 124, iter: 4227, loss: 0.6976110339164734, time cost4.016282558441162
epoch: 124, iter: 4228, loss: 1.0224746465682983, time cost3.813509225845337
epoch: 124, iter: 4229, loss: 0.9076187610626221, time cost4.197537183761597
epoch: 124, iter: 4230, loss: 0.43214136362075806, time cost3.9186034202575684
epoch: 124, iter: 4231, loss: 0.5454924702644348, time cost3.936161756515503
epoch: 124, iter: 4232, loss: 0.9166377186775208, time cost3.9816551208496094
epoch: 124, iter: 4233, loss: 0.715887188911438, time cost3.958709716796875
epoch: 124, iter: 4234, loss: 1.202080488204956, time cost4.074480056762695
epoch: 124, iter: 4235, loss: 0.7845874428749084, time cost4.164605617523193
epoch: 124, iter: 4236, loss: 0.5467512011528015, time cost4.019496440887451
epoch: 124, iter: 4237, loss: 0.5781413912773132, time cost4.103342771530151
epoch: 124, iter: 4238, loss: 0.5979480147361755, time cost4.011207580566406
epoch: 124, iter: 4239, loss: 1.090628743171692, time cost4.069737672805786
epoch: 124, iter: 4240, loss: 0.6793751120567322, time cost3.928463935852051
epoch: 124, iter: 4241, loss: 0.6697782874107361, time cost3.9557785987854004
epoch: 124, iter: 4242, loss: 0.5640518069267273, time cost3.9542009830474854
epoch: 124, iter: 4243, loss: 0.7397866249084473, time cost3.887303590774536
epoch: 124, iter: 4244, loss: 0.9752801060676575, time cost3.8513989448547363
epoch: 124, iter: 4245, loss: 1.229232668876648, time cost4.038231611251831
epoch: 124, iter: 4246, loss: 0.6972511410713196, time cost4.096227169036865
epoch: 124, iter: 4247, loss: 1.299440860748291, time cost3.891235113143921
epoch: 124, iter: 4248, loss: 1.1376162767410278, time cost4.182571172714233
epoch: 124, iter: 4249, loss: 0.6845013499259949, time cost3.9869954586029053
epoch: 124, iter: 4250, loss: 0.40943148732185364, time cost2.7214395999908447
tensor([[113.,  76.,  84.,  ...,   2.,   2.,   1.],
        [ 27.,  31.,  28.,  ...,  10.,  10.,   6.],
        [ 97., 222., 123.,  ...,   7.,   7.,   3.],
        ...,
        [ 41.,  37.,  17.,  ...,  14.,  14.,  12.],
        [125.,  90.,  28.,  ...,   1.,   1.,   1.],
        [ 66., 167., 222.,  ...,   4.,   4.,   8.]])
Epoch: 124, Iteration: 4250:
TEST A@1: 0.5133333333333333
TEST A@5: 0.8444444444444444
TEST A@10: 0.9355555555555556
TEST M@B: 0.400043971493938
TEST M@A: 0.9549844102006523
TEST W@MB: 0.21438786682490607
TEST W@MA: 0.589951699841785
TEST Time: 500.2877781391144
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 125, iter: 4251, loss: 0.9273286461830139, time cost4.192734479904175
epoch: 125, iter: 4252, loss: 0.6204230785369873, time cost4.2257208824157715
epoch: 125, iter: 4253, loss: 0.5574911236763, time cost4.047481298446655
epoch: 125, iter: 4254, loss: 0.6273261308670044, time cost4.166001796722412
epoch: 125, iter: 4255, loss: 0.8415284752845764, time cost4.260665416717529
epoch: 125, iter: 4256, loss: 0.7140619158744812, time cost4.159341096878052
epoch: 125, iter: 4257, loss: 0.6747058629989624, time cost4.035336494445801
epoch: 125, iter: 4258, loss: 0.5308136940002441, time cost4.027706623077393
epoch: 125, iter: 4259, loss: 0.49959489703178406, time cost3.9843199253082275
epoch: 125, iter: 4260, loss: 1.3435193300247192, time cost4.049187660217285
epoch: 125, iter: 4261, loss: 1.036807656288147, time cost3.8693811893463135
epoch: 125, iter: 4262, loss: 1.8147830963134766, time cost3.8956990242004395
epoch: 125, iter: 4263, loss: 0.6872518658638, time cost3.85990047454834
epoch: 125, iter: 4264, loss: 1.1305731534957886, time cost3.823444366455078
epoch: 125, iter: 4265, loss: 0.9040259718894958, time cost3.986227512359619
epoch: 125, iter: 4266, loss: 0.7246872186660767, time cost4.013479709625244
epoch: 125, iter: 4267, loss: 0.5903605222702026, time cost4.225940942764282
epoch: 125, iter: 4268, loss: 1.2564187049865723, time cost4.012744665145874
epoch: 125, iter: 4269, loss: 0.7525950074195862, time cost3.8922202587127686
epoch: 125, iter: 4270, loss: 1.1077030897140503, time cost3.9098808765411377
epoch: 125, iter: 4271, loss: 0.912000298500061, time cost3.9398467540740967
epoch: 125, iter: 4272, loss: 1.7494337558746338, time cost3.9267287254333496
epoch: 125, iter: 4273, loss: 1.0861636400222778, time cost3.979013442993164
epoch: 125, iter: 4274, loss: 0.46938613057136536, time cost3.948668956756592
epoch: 125, iter: 4275, loss: 0.6850875616073608, time cost3.8469855785369873
epoch: 125, iter: 4276, loss: 0.6397019624710083, time cost3.8860528469085693
epoch: 125, iter: 4277, loss: 0.6562095284461975, time cost3.9494857788085938
epoch: 125, iter: 4278, loss: 0.6955691576004028, time cost3.9471616744995117
epoch: 125, iter: 4279, loss: 0.9849720001220703, time cost3.8688745498657227
epoch: 125, iter: 4280, loss: 0.9740013480186462, time cost3.92142391204834
epoch: 125, iter: 4281, loss: 0.8436033725738525, time cost4.083653450012207
epoch: 125, iter: 4282, loss: 1.4926652908325195, time cost4.2284276485443115
epoch: 125, iter: 4283, loss: 0.8680984973907471, time cost3.9209468364715576
epoch: 125, iter: 4284, loss: 0.4817114472389221, time cost2.7376177310943604
epoch: 126, iter: 4285, loss: 0.502746045589447, time cost3.836996555328369
epoch: 126, iter: 4286, loss: 0.8852390050888062, time cost3.9755427837371826
epoch: 126, iter: 4287, loss: 0.6865658760070801, time cost3.8814244270324707
epoch: 126, iter: 4288, loss: 1.2225027084350586, time cost4.166515350341797
epoch: 126, iter: 4289, loss: 1.3755532503128052, time cost4.058138370513916
epoch: 126, iter: 4290, loss: 0.5369260907173157, time cost4.002560615539551
epoch: 126, iter: 4291, loss: 0.49999532103538513, time cost4.0247886180877686
epoch: 126, iter: 4292, loss: 1.2723071575164795, time cost4.056604623794556
epoch: 126, iter: 4293, loss: 1.4094337224960327, time cost4.11077880859375
epoch: 126, iter: 4294, loss: 0.8867260217666626, time cost4.050210952758789
epoch: 126, iter: 4295, loss: 0.8162662386894226, time cost4.037935972213745
epoch: 126, iter: 4296, loss: 0.6176190376281738, time cost3.8825411796569824
epoch: 126, iter: 4297, loss: 1.4047951698303223, time cost3.828774929046631
epoch: 126, iter: 4298, loss: 0.6195074319839478, time cost3.8257739543914795
epoch: 126, iter: 4299, loss: 0.2043585479259491, time cost3.9536654949188232
epoch: 126, iter: 4300, loss: 0.9970822930335999, time cost3.9457404613494873
tensor([[ 55.,  51.,  52.,  ...,   8.,   8.,   6.],
        [  8.,  10.,   9.,  ...,  10.,  10.,   5.],
        [ 47., 139.,  49.,  ...,   9.,   9.,   1.],
        ...,
        [ 57.,  54.,  36.,  ...,  17.,  17.,  11.],
        [ 69.,  58.,   7.,  ...,   1.,   1.,   1.],
        [ 76., 129., 150.,  ...,   8.,   8.,  15.]])
Epoch: 126, Iteration: 4300:
TEST A@1: 0.5044444444444445
TEST A@5: 0.8577777777777778
TEST A@10: 0.9422222222222222
TEST M@B: 0.3953464493168205
TEST M@A: 0.9536331185680992
TEST W@MB: 0.2114520119443684
TEST W@MA: 0.5888429891800777
TEST Time: 496.27120566368103
REAL performance: Top1: 0.5644444444444444, Top5: 0.8888888888888888, Top10: 0.9622222222222222, MB: 0.43198339974073197, MA: 0.9579495887547023, WMB: 0.23192154835215115, WMA: 0.5922370009626536
epoch: 126, iter: 4301, loss: 0.5381541848182678, time cost4.207708835601807
epoch: 126, iter: 4302, loss: 1.3653483390808105, time cost3.9271535873413086
epoch: 126, iter: 4303, loss: 0.9486581087112427, time cost3.929395914077759
epoch: 126, iter: 4304, loss: 0.4474044144153595, time cost3.8680155277252197
epoch: 126, iter: 4305, loss: 0.6314716935157776, time cost4.0756776332855225
epoch: 126, iter: 4306, loss: 0.8168716430664062, time cost3.982853651046753
epoch: 126, iter: 4307, loss: 0.5421866178512573, time cost3.934579610824585
epoch: 126, iter: 4308, loss: 0.6375763416290283, time cost3.9030802249908447
epoch: 126, iter: 4309, loss: 0.8007996678352356, time cost4.137837171554565
epoch: 126, iter: 4310, loss: 0.9955433011054993, time cost3.951537847518921
epoch: 126, iter: 4311, loss: 0.9909130334854126, time cost3.7546772956848145
epoch: 126, iter: 4312, loss: 1.0325915813446045, time cost4.018769264221191
epoch: 126, iter: 4313, loss: 0.600655734539032, time cost3.838778495788574
epoch: 126, iter: 4314, loss: 0.5716218948364258, time cost3.825840473175049
epoch: 126, iter: 4315, loss: 1.0190999507904053, time cost3.86982798576355
epoch: 126, iter: 4316, loss: 0.7938421964645386, time cost3.788581371307373
epoch: 126, iter: 4317, loss: 1.177520990371704, time cost3.9965429306030273
epoch: 126, iter: 4318, loss: 0.17783361673355103, time cost2.8651137351989746
epoch: 127, iter: 4319, loss: 1.2525790929794312, time cost4.013865947723389
epoch: 127, iter: 4320, loss: 0.8305333256721497, time cost3.7350549697875977
epoch: 127, iter: 4321, loss: 0.568967878818512, time cost3.9327034950256348
epoch: 127, iter: 4322, loss: 0.7883152961730957, time cost4.2893500328063965
epoch: 127, iter: 4323, loss: 0.7877901196479797, time cost4.056274890899658
epoch: 127, iter: 4324, loss: 0.8185263276100159, time cost4.178513526916504
epoch: 127, iter: 4325, loss: 0.6678053140640259, time cost4.316248655319214
epoch: 127, iter: 4326, loss: 0.8354839086532593, time cost4.050318241119385
epoch: 127, iter: 4327, loss: 0.4242095649242401, time cost4.28826117515564
epoch: 127, iter: 4328, loss: 0.17307983338832855, time cost4.1103246212005615
epoch: 127, iter: 4329, loss: 0.8651691675186157, time cost4.1173622608184814
epoch: 127, iter: 4330, loss: 0.5456443428993225, time cost4.103106260299683
epoch: 127, iter: 4331, loss: 0.7308863997459412, time cost4.01877760887146
epoch: 127, iter: 4332, loss: 0.7103578448295593, time cost4.070604562759399
epoch: 127, iter: 4333, loss: 1.442108154296875, time cost3.844024896621704
epoch: 127, iter: 4334, loss: 0.6465548276901245, time cost4.041765928268433
epoch: 127, iter: 4335, loss: 0.5604565739631653, time cost4.308600425720215
epoch: 127, iter: 4336, loss: 0.7136121392250061, time cost3.940178155899048
epoch: 127, iter: 4337, loss: 0.6785808801651001, time cost4.126125335693359
epoch: 127, iter: 4338, loss: 0.581471860408783, time cost4.304334402084351
epoch: 127, iter: 4339, loss: 0.40023136138916016, time cost4.053721189498901
epoch: 127, iter: 4340, loss: 0.5778077244758606, time cost4.122092962265015
epoch: 127, iter: 4341, loss: 0.9611003398895264, time cost3.9807398319244385
epoch: 127, iter: 4342, loss: 0.525426983833313, time cost4.3166632652282715
epoch: 127, iter: 4343, loss: 0.9680574536323547, time cost4.108663558959961
epoch: 127, iter: 4344, loss: 1.0286617279052734, time cost4.040383338928223
epoch: 127, iter: 4345, loss: 0.8994617462158203, time cost4.023263454437256
epoch: 127, iter: 4346, loss: 0.8752307295799255, time cost4.204049587249756
epoch: 127, iter: 4347, loss: 0.5530389547348022, time cost4.039506435394287
epoch: 127, iter: 4348, loss: 0.7936878800392151, time cost3.9982733726501465
epoch: 127, iter: 4349, loss: 1.151366114616394, time cost4.047870635986328
epoch: 127, iter: 4350, loss: 1.001069188117981, time cost4.117873907089233
tensor([[ 61.,  43.,  51.,  ...,   2.,   2.,   1.],
        [ 17.,  23.,  18.,  ...,  11.,  11.,   7.],
        [ 56., 147.,  59.,  ...,   7.,   7.,   2.],
        ...,
        [ 37.,  35.,  18.,  ...,  15.,  15.,   9.],
        [165., 147.,  96.,  ...,   1.,   1.,   1.],
        [ 18.,  64.,  73.,  ...,   3.,   3.,   8.]])
Epoch: 127, Iteration: 4350:
TEST A@1: 0.5688888888888889
TEST A@5: 0.8933333333333333
TEST A@10: 0.9533333333333334
TEST M@B: 0.43783030635406034
TEST M@A: 0.9562582815808969
TEST W@MB: 0.2339932066988706
TEST W@MA: 0.5906805103165506
TEST Time: 501.3546447753906
Model Updated
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 127, iter: 4351, loss: 0.8575184345245361, time cost3.8914146423339844
epoch: 127, iter: 4352, loss: 0.37193042039871216, time cost2.9005863666534424
epoch: 128, iter: 4353, loss: 0.575628936290741, time cost4.102006912231445
epoch: 128, iter: 4354, loss: 1.167588233947754, time cost4.117224931716919
epoch: 128, iter: 4355, loss: 0.9666404724121094, time cost4.086377382278442
epoch: 128, iter: 4356, loss: 1.308490514755249, time cost4.023815870285034
epoch: 128, iter: 4357, loss: 0.545353889465332, time cost4.154022932052612
epoch: 128, iter: 4358, loss: 0.7914274334907532, time cost3.914222240447998
epoch: 128, iter: 4359, loss: 0.7275997400283813, time cost4.0408759117126465
epoch: 128, iter: 4360, loss: 1.4337241649627686, time cost3.848346471786499
epoch: 128, iter: 4361, loss: 0.9757084846496582, time cost3.9339349269866943
epoch: 128, iter: 4362, loss: 0.5707922577857971, time cost3.9051430225372314
epoch: 128, iter: 4363, loss: 1.2020213603973389, time cost3.8459036350250244
epoch: 128, iter: 4364, loss: 0.791000485420227, time cost3.8525285720825195
epoch: 128, iter: 4365, loss: 1.0157225131988525, time cost4.114076137542725
epoch: 128, iter: 4366, loss: 0.7153815627098083, time cost3.9291484355926514
epoch: 128, iter: 4367, loss: 0.3628433346748352, time cost3.7425191402435303
epoch: 128, iter: 4368, loss: 0.6328532099723816, time cost3.9491026401519775
epoch: 128, iter: 4369, loss: 1.6027079820632935, time cost3.723940134048462
epoch: 128, iter: 4370, loss: 0.4855293035507202, time cost3.9920432567596436
epoch: 128, iter: 4371, loss: 0.4323451519012451, time cost4.0034050941467285
epoch: 128, iter: 4372, loss: 0.6403985619544983, time cost4.067237854003906
epoch: 128, iter: 4373, loss: 0.5029386281967163, time cost3.90148663520813
epoch: 128, iter: 4374, loss: 0.5713762640953064, time cost3.991241455078125
epoch: 128, iter: 4375, loss: 0.4516247510910034, time cost4.026951789855957
epoch: 128, iter: 4376, loss: 0.839659571647644, time cost3.8158416748046875
epoch: 128, iter: 4377, loss: 0.6581594347953796, time cost3.9877779483795166
epoch: 128, iter: 4378, loss: 0.5836724638938904, time cost4.0053627490997314
epoch: 128, iter: 4379, loss: 0.8632116913795471, time cost4.179003715515137
epoch: 128, iter: 4380, loss: 0.45662158727645874, time cost3.8359808921813965
epoch: 128, iter: 4381, loss: 0.6768429279327393, time cost3.821499824523926
epoch: 128, iter: 4382, loss: 0.6668870449066162, time cost4.049817800521851
epoch: 128, iter: 4383, loss: 1.016777515411377, time cost3.828946590423584
epoch: 128, iter: 4384, loss: 0.6280246376991272, time cost3.965705633163452
epoch: 128, iter: 4385, loss: 0.6519955396652222, time cost3.8935046195983887
epoch: 128, iter: 4386, loss: 0.6742370128631592, time cost2.8760640621185303
epoch: 129, iter: 4387, loss: 0.727433443069458, time cost3.77485728263855
epoch: 129, iter: 4388, loss: 1.0738974809646606, time cost3.927860975265503
epoch: 129, iter: 4389, loss: 0.658064603805542, time cost3.85264253616333
epoch: 129, iter: 4390, loss: 0.6624599099159241, time cost4.14411187171936
epoch: 129, iter: 4391, loss: 0.5346909165382385, time cost3.854888677597046
epoch: 129, iter: 4392, loss: 0.691355288028717, time cost4.174403429031372
epoch: 129, iter: 4393, loss: 1.1662921905517578, time cost3.8666768074035645
epoch: 129, iter: 4394, loss: 1.028427004814148, time cost4.000421762466431
epoch: 129, iter: 4395, loss: 0.7348363399505615, time cost3.973813772201538
epoch: 129, iter: 4396, loss: 0.8140350580215454, time cost3.8032896518707275
epoch: 129, iter: 4397, loss: 0.6653940081596375, time cost3.8034441471099854
epoch: 129, iter: 4398, loss: 0.7112188935279846, time cost3.9269614219665527
epoch: 129, iter: 4399, loss: 0.45774009823799133, time cost3.990467071533203
epoch: 129, iter: 4400, loss: 1.1902824640274048, time cost3.4984347820281982
tensor([[ 74.,  62.,  70.,  ...,   1.,   1.,   1.],
        [ 11.,  13.,  12.,  ...,   9.,   9.,   2.],
        [ 45., 153.,  54.,  ...,   2.,   2.,   1.],
        ...,
        [ 90.,  79.,  51.,  ...,  18.,  18.,  12.],
        [  3.,   5.,   7.,  ...,   1.,   1.,   1.],
        [ 71., 190., 231.,  ...,  13.,  13.,  16.]])
Epoch: 129, Iteration: 4400:
TEST A@1: 0.56
TEST A@5: 0.8955555555555555
TEST A@10: 0.9488888888888889
TEST M@B: 0.4344889853133596
TEST M@A: 0.9548559412602334
TEST W@MB: 0.23243577132138246
TEST W@MA: 0.5893219633532107
TEST Time: 501.14427280426025
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 129, iter: 4401, loss: 0.9926179051399231, time cost4.139390468597412
epoch: 129, iter: 4402, loss: 1.015151023864746, time cost4.254746198654175
epoch: 129, iter: 4403, loss: 0.7740004062652588, time cost4.214457035064697
epoch: 129, iter: 4404, loss: 0.5578215718269348, time cost4.105996370315552
epoch: 129, iter: 4405, loss: 0.9293644428253174, time cost4.180023670196533
epoch: 129, iter: 4406, loss: 0.5980069041252136, time cost4.07446551322937
epoch: 129, iter: 4407, loss: 0.7183477878570557, time cost4.459134817123413
epoch: 129, iter: 4408, loss: 0.6699203848838806, time cost4.519717216491699
epoch: 129, iter: 4409, loss: 0.9918862581253052, time cost4.442043304443359
epoch: 129, iter: 4410, loss: 1.0824049711227417, time cost4.277602910995483
epoch: 129, iter: 4411, loss: 0.6988653540611267, time cost4.261529445648193
epoch: 129, iter: 4412, loss: 0.7386269569396973, time cost4.373365163803101
epoch: 129, iter: 4413, loss: 0.6321581602096558, time cost4.265151500701904
epoch: 129, iter: 4414, loss: 0.8292006254196167, time cost4.181326150894165
epoch: 129, iter: 4415, loss: 0.9623677134513855, time cost4.395867109298706
epoch: 129, iter: 4416, loss: 0.6476215124130249, time cost4.104018688201904
epoch: 129, iter: 4417, loss: 1.218205213546753, time cost4.136912107467651
epoch: 129, iter: 4418, loss: 0.7793589234352112, time cost3.9853549003601074
epoch: 129, iter: 4419, loss: 0.8456808924674988, time cost4.248172760009766
epoch: 129, iter: 4420, loss: 0.3788301646709442, time cost3.0564768314361572
epoch: 130, iter: 4421, loss: 0.4844686686992645, time cost2.957080364227295
epoch: 130, iter: 4422, loss: 0.6433560848236084, time cost3.074003219604492
epoch: 130, iter: 4423, loss: 0.5211918354034424, time cost3.476109266281128
epoch: 130, iter: 4424, loss: 0.8922153115272522, time cost3.2648844718933105
epoch: 130, iter: 4425, loss: 0.5246577858924866, time cost3.093040704727173
epoch: 130, iter: 4426, loss: 0.5371899604797363, time cost3.911738157272339
epoch: 130, iter: 4427, loss: 1.1924238204956055, time cost4.136524200439453
epoch: 130, iter: 4428, loss: 0.9833765625953674, time cost4.060844659805298
epoch: 130, iter: 4429, loss: 0.4060056507587433, time cost4.036023855209351
epoch: 130, iter: 4430, loss: 0.5926385521888733, time cost3.9915528297424316
epoch: 130, iter: 4431, loss: 0.7290669083595276, time cost3.905319929122925
epoch: 130, iter: 4432, loss: 0.8204023241996765, time cost3.732407808303833
epoch: 130, iter: 4433, loss: 0.8896692991256714, time cost4.154752254486084
epoch: 130, iter: 4434, loss: 0.8162097930908203, time cost4.094212055206299
epoch: 130, iter: 4435, loss: 1.1680703163146973, time cost4.132933616638184
epoch: 130, iter: 4436, loss: 0.8246570229530334, time cost4.197997570037842
epoch: 130, iter: 4437, loss: 1.6643980741500854, time cost4.121345281600952
epoch: 130, iter: 4438, loss: 0.6264886856079102, time cost3.9564590454101562
epoch: 130, iter: 4439, loss: 0.6606906056404114, time cost4.2078893184661865
epoch: 130, iter: 4440, loss: 0.7943148016929626, time cost4.00536584854126
epoch: 130, iter: 4441, loss: 1.3454891443252563, time cost4.045766830444336
epoch: 130, iter: 4442, loss: 1.1843671798706055, time cost4.090210437774658
epoch: 130, iter: 4443, loss: 0.8327124118804932, time cost3.962728500366211
epoch: 130, iter: 4444, loss: 0.5713220238685608, time cost4.010028123855591
epoch: 130, iter: 4445, loss: 0.8511597514152527, time cost4.159201383590698
epoch: 130, iter: 4446, loss: 1.0036187171936035, time cost3.9934542179107666
epoch: 130, iter: 4447, loss: 0.25107771158218384, time cost3.9217939376831055
epoch: 130, iter: 4448, loss: 1.4140923023223877, time cost3.9622411727905273
epoch: 130, iter: 4449, loss: 1.0081815719604492, time cost3.9214603900909424
epoch: 130, iter: 4450, loss: 1.3298289775848389, time cost4.07849645614624
tensor([[ 55.,  52.,  61.,  ...,   5.,   5.,   3.],
        [ 10.,   9.,   8.,  ...,  16.,  16.,  10.],
        [ 91., 239., 118.,  ...,   1.,   1.,   1.],
        ...,
        [ 28.,  25.,  15.,  ...,   4.,   4.,   6.],
        [110.,  97.,  23.,  ...,   1.,   1.,   1.],
        [ 18.,  61.,  62.,  ...,   2.,   2.,  10.]])
Epoch: 130, Iteration: 4450:
TEST A@1: 0.5266666666666666
TEST A@5: 0.8466666666666667
TEST A@10: 0.9333333333333333
TEST M@B: 0.40411197392072695
TEST M@A: 0.949203663198307
TEST W@MB: 0.21605865453584067
TEST W@MA: 0.5850014712178822
TEST Time: 505.74352622032166
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 130, iter: 4451, loss: 1.0358738899230957, time cost3.873913288116455
epoch: 130, iter: 4452, loss: 1.0497641563415527, time cost4.077829599380493
epoch: 130, iter: 4453, loss: 0.8630415797233582, time cost4.1723034381866455
epoch: 130, iter: 4454, loss: 0.7009834051132202, time cost2.786815881729126
epoch: 131, iter: 4455, loss: 1.0799970626831055, time cost4.007652759552002
epoch: 131, iter: 4456, loss: 0.4959627389907837, time cost4.008295297622681
epoch: 131, iter: 4457, loss: 0.7304751873016357, time cost4.021892547607422
epoch: 131, iter: 4458, loss: 0.8146752715110779, time cost4.262473106384277
epoch: 131, iter: 4459, loss: 0.5969540476799011, time cost3.775038957595825
epoch: 131, iter: 4460, loss: 1.1251407861709595, time cost3.911891460418701
epoch: 131, iter: 4461, loss: 0.8072969913482666, time cost3.84249210357666
epoch: 131, iter: 4462, loss: 0.9977402687072754, time cost4.027369260787964
epoch: 131, iter: 4463, loss: 0.4874016046524048, time cost4.068506717681885
epoch: 131, iter: 4464, loss: 0.6817203760147095, time cost3.994220495223999
epoch: 131, iter: 4465, loss: 0.7867460250854492, time cost4.137571573257446
epoch: 131, iter: 4466, loss: 1.2716389894485474, time cost4.1731743812561035
epoch: 131, iter: 4467, loss: 1.0947741270065308, time cost4.043798208236694
epoch: 131, iter: 4468, loss: 2.120058536529541, time cost4.512113809585571
epoch: 131, iter: 4469, loss: 0.6175137758255005, time cost4.113852500915527
epoch: 131, iter: 4470, loss: 1.1406036615371704, time cost4.065720558166504
epoch: 131, iter: 4471, loss: 0.5757537484169006, time cost4.0638158321380615
epoch: 131, iter: 4472, loss: 1.2863924503326416, time cost3.867034912109375
epoch: 131, iter: 4473, loss: 0.743430495262146, time cost4.186182975769043
epoch: 131, iter: 4474, loss: 0.8362868428230286, time cost4.127159595489502
epoch: 131, iter: 4475, loss: 1.3309059143066406, time cost3.927456855773926
epoch: 131, iter: 4476, loss: 1.0833381414413452, time cost4.218755006790161
epoch: 131, iter: 4477, loss: 0.9158041477203369, time cost4.030258655548096
epoch: 131, iter: 4478, loss: 0.6565911173820496, time cost3.947735548019409
epoch: 131, iter: 4479, loss: 0.7462286949157715, time cost4.143441677093506
epoch: 131, iter: 4480, loss: 0.7616742849349976, time cost4.039661884307861
epoch: 131, iter: 4481, loss: 0.9149335622787476, time cost3.9715805053710938
epoch: 131, iter: 4482, loss: 0.5337275266647339, time cost3.891572952270508
epoch: 131, iter: 4483, loss: 0.6609736680984497, time cost3.9276621341705322
epoch: 131, iter: 4484, loss: 0.9534276723861694, time cost3.9112563133239746
epoch: 131, iter: 4485, loss: 1.0320216417312622, time cost3.8341100215911865
epoch: 131, iter: 4486, loss: 1.3192799091339111, time cost4.0712950229644775
epoch: 131, iter: 4487, loss: 0.302146315574646, time cost3.852120876312256
epoch: 131, iter: 4488, loss: 1.0459649562835693, time cost2.9439620971679688
epoch: 132, iter: 4489, loss: 0.6845842599868774, time cost4.163446664810181
epoch: 132, iter: 4490, loss: 0.5933793187141418, time cost4.4153125286102295
epoch: 132, iter: 4491, loss: 0.5867435336112976, time cost4.539867639541626
epoch: 132, iter: 4492, loss: 1.071873664855957, time cost3.881071090698242
epoch: 132, iter: 4493, loss: 0.6519495844841003, time cost3.8834192752838135
epoch: 132, iter: 4494, loss: 0.9684072136878967, time cost4.075376987457275
epoch: 132, iter: 4495, loss: 0.7057809233665466, time cost4.1425886154174805
epoch: 132, iter: 4496, loss: 0.5863043069839478, time cost4.0773303508758545
epoch: 132, iter: 4497, loss: 0.5846773386001587, time cost4.104485988616943
epoch: 132, iter: 4498, loss: 0.43968358635902405, time cost4.11366868019104
epoch: 132, iter: 4499, loss: 0.7597935795783997, time cost4.036798000335693
epoch: 132, iter: 4500, loss: 0.6044561862945557, time cost4.007906913757324
tensor([[ 24.,  24.,  25.,  ...,   7.,   7.,   5.],
        [ 27.,  18.,  18.,  ...,   7.,   7.,   3.],
        [111., 219., 130.,  ...,   2.,   2.,   1.],
        ...,
        [ 62.,  58.,  36.,  ...,  17.,  17.,  12.],
        [ 19.,  18.,  22.,  ...,   1.,   1.,   1.],
        [ 63., 137., 167.,  ...,   3.,   3.,   3.]])
Epoch: 132, Iteration: 4500:
TEST A@1: 0.5044444444444445
TEST A@5: 0.8533333333333334
TEST A@10: 0.9311111111111111
TEST M@B: 0.39675430863661604
TEST M@A: 0.954000778588688
TEST W@MB: 0.21221958549909942
TEST W@MA: 0.5891603202655991
TEST Time: 514.6947498321533
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 132, iter: 4501, loss: 0.8186962008476257, time cost3.8082194328308105
epoch: 132, iter: 4502, loss: 0.9160146713256836, time cost3.972120761871338
epoch: 132, iter: 4503, loss: 0.8697453737258911, time cost3.9229207038879395
epoch: 132, iter: 4504, loss: 0.33027392625808716, time cost4.068894386291504
epoch: 132, iter: 4505, loss: 1.2747873067855835, time cost4.143875598907471
epoch: 132, iter: 4506, loss: 0.8733002543449402, time cost4.022406578063965
epoch: 132, iter: 4507, loss: 0.6089989542961121, time cost3.947838306427002
epoch: 132, iter: 4508, loss: 0.760688304901123, time cost4.01941180229187
epoch: 132, iter: 4509, loss: 0.8891595602035522, time cost4.0842978954315186
epoch: 132, iter: 4510, loss: 0.6488851308822632, time cost4.076680421829224
epoch: 132, iter: 4511, loss: 0.6336007714271545, time cost4.091871023178101
epoch: 132, iter: 4512, loss: 0.4726504385471344, time cost3.919755458831787
epoch: 132, iter: 4513, loss: 0.7954131364822388, time cost4.0553810596466064
epoch: 132, iter: 4514, loss: 0.632510244846344, time cost3.9965572357177734
epoch: 132, iter: 4515, loss: 0.6195892691612244, time cost3.940702199935913
epoch: 132, iter: 4516, loss: 0.8061364889144897, time cost3.8702383041381836
epoch: 132, iter: 4517, loss: 0.8191975355148315, time cost3.893378496170044
epoch: 132, iter: 4518, loss: 1.1149605512619019, time cost3.9443976879119873
epoch: 132, iter: 4519, loss: 0.4115142226219177, time cost3.992198944091797
epoch: 132, iter: 4520, loss: 0.9552040100097656, time cost3.924978494644165
epoch: 132, iter: 4521, loss: 0.3499210476875305, time cost4.063589334487915
epoch: 132, iter: 4522, loss: 1.048338770866394, time cost2.9412102699279785
epoch: 133, iter: 4523, loss: 1.4988335371017456, time cost4.005109071731567
epoch: 133, iter: 4524, loss: 0.5260230302810669, time cost3.7528557777404785
epoch: 133, iter: 4525, loss: 0.44733551144599915, time cost3.8771462440490723
epoch: 133, iter: 4526, loss: 0.6297258138656616, time cost3.7410738468170166
epoch: 133, iter: 4527, loss: 0.7669630646705627, time cost3.8485679626464844
epoch: 133, iter: 4528, loss: 0.6196210980415344, time cost3.8521158695220947
epoch: 133, iter: 4529, loss: 0.8743419647216797, time cost4.063708782196045
epoch: 133, iter: 4530, loss: 0.9527925252914429, time cost4.011296987533569
epoch: 133, iter: 4531, loss: 0.9825504422187805, time cost4.052652597427368
epoch: 133, iter: 4532, loss: 0.6352565884590149, time cost4.040535926818848
epoch: 133, iter: 4533, loss: 0.33881333470344543, time cost4.022388935089111
epoch: 133, iter: 4534, loss: 0.9349877238273621, time cost4.223330020904541
epoch: 133, iter: 4535, loss: 0.8586685061454773, time cost4.120925426483154
epoch: 133, iter: 4536, loss: 0.6886635422706604, time cost3.83144474029541
epoch: 133, iter: 4537, loss: 0.778904378414154, time cost3.8724215030670166
epoch: 133, iter: 4538, loss: 0.7104185819625854, time cost3.8875842094421387
epoch: 133, iter: 4539, loss: 1.1823198795318604, time cost3.8737123012542725
epoch: 133, iter: 4540, loss: 0.9077100157737732, time cost3.879878282546997
epoch: 133, iter: 4541, loss: 0.4243158996105194, time cost4.013153791427612
epoch: 133, iter: 4542, loss: 0.5423257946968079, time cost3.8372533321380615
epoch: 133, iter: 4543, loss: 0.5653834939002991, time cost3.987281084060669
epoch: 133, iter: 4544, loss: 0.768603503704071, time cost3.9535467624664307
epoch: 133, iter: 4545, loss: 1.1317142248153687, time cost3.7492167949676514
epoch: 133, iter: 4546, loss: 0.6068450212478638, time cost3.717550277709961
epoch: 133, iter: 4547, loss: 0.5371566414833069, time cost4.100331544876099
epoch: 133, iter: 4548, loss: 0.8128146529197693, time cost3.794104814529419
epoch: 133, iter: 4549, loss: 0.6083647012710571, time cost3.8702585697174072
epoch: 133, iter: 4550, loss: 1.1355427503585815, time cost4.001499652862549
tensor([[191., 160., 172.,  ...,   2.,   2.,   1.],
        [ 40.,  28.,  28.,  ...,  17.,  17.,   9.],
        [109., 211.,  91.,  ...,   7.,   7.,   2.],
        ...,
        [ 87.,  85.,  52.,  ...,   9.,   9.,   8.],
        [ 19.,  19.,   3.,  ...,   1.,   1.,   1.],
        [243., 268., 312.,  ...,   5.,   5.,   7.]])
Epoch: 133, Iteration: 4550:
TEST A@1: 0.48444444444444446
TEST A@5: 0.8533333333333334
TEST A@10: 0.94
TEST M@B: 0.4034505686684258
TEST M@A: 0.953352636294018
TEST W@MB: 0.216976917710967
TEST W@MA: 0.5883175358012049
TEST Time: 518.9265642166138
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 133, iter: 4551, loss: 1.121638298034668, time cost3.90078067779541
epoch: 133, iter: 4552, loss: 0.6138536930084229, time cost3.904404878616333
epoch: 133, iter: 4553, loss: 1.2260632514953613, time cost3.9359512329101562
epoch: 133, iter: 4554, loss: 1.2641658782958984, time cost3.9778990745544434
epoch: 133, iter: 4555, loss: 0.5602673888206482, time cost3.9970035552978516
epoch: 133, iter: 4556, loss: 0.7397088408470154, time cost2.8383612632751465
epoch: 134, iter: 4557, loss: 1.0358554124832153, time cost4.115365266799927
epoch: 134, iter: 4558, loss: 0.7306801676750183, time cost4.077214241027832
epoch: 134, iter: 4559, loss: 0.6965689659118652, time cost3.8813300132751465
epoch: 134, iter: 4560, loss: 0.5843015313148499, time cost3.9362282752990723
epoch: 134, iter: 4561, loss: 0.8391701579093933, time cost3.9598100185394287
epoch: 134, iter: 4562, loss: 0.5690588355064392, time cost3.9589874744415283
epoch: 134, iter: 4563, loss: 0.47496289014816284, time cost4.00973916053772
epoch: 134, iter: 4564, loss: 0.997075080871582, time cost4.11938214302063
epoch: 134, iter: 4565, loss: 0.6678791046142578, time cost3.9166066646575928
epoch: 134, iter: 4566, loss: 0.9049856662750244, time cost4.1208696365356445
epoch: 134, iter: 4567, loss: 1.0054622888565063, time cost4.000747203826904
epoch: 134, iter: 4568, loss: 1.0906168222427368, time cost4.003246784210205
epoch: 134, iter: 4569, loss: 1.2990052700042725, time cost4.0338850021362305
epoch: 134, iter: 4570, loss: 0.3891857862472534, time cost3.9754421710968018
epoch: 134, iter: 4571, loss: 1.1365535259246826, time cost3.867530584335327
epoch: 134, iter: 4572, loss: 0.6521174311637878, time cost4.028439283370972
epoch: 134, iter: 4573, loss: 0.9121647477149963, time cost4.054625511169434
epoch: 134, iter: 4574, loss: 1.0426427125930786, time cost3.99965763092041
epoch: 134, iter: 4575, loss: 0.8383356332778931, time cost3.9077398777008057
epoch: 134, iter: 4576, loss: 0.3160150945186615, time cost3.8764710426330566
epoch: 134, iter: 4577, loss: 0.7288311719894409, time cost3.939314603805542
epoch: 134, iter: 4578, loss: 1.1336297988891602, time cost4.182880163192749
epoch: 134, iter: 4579, loss: 0.5181853175163269, time cost4.081426620483398
epoch: 134, iter: 4580, loss: 0.6097903847694397, time cost3.934628486633301
epoch: 134, iter: 4581, loss: 0.9519180059432983, time cost3.950671434402466
epoch: 134, iter: 4582, loss: 0.47649049758911133, time cost4.028701066970825
epoch: 134, iter: 4583, loss: 0.8997330069541931, time cost3.707207679748535
epoch: 134, iter: 4584, loss: 0.945685625076294, time cost3.84222674369812
epoch: 134, iter: 4585, loss: 0.6288261413574219, time cost3.770059585571289
epoch: 134, iter: 4586, loss: 0.7812771797180176, time cost3.888444662094116
epoch: 134, iter: 4587, loss: 0.7438026070594788, time cost3.7631783485412598
epoch: 134, iter: 4588, loss: 0.4621526300907135, time cost3.8196380138397217
epoch: 134, iter: 4589, loss: 1.256756067276001, time cost4.042364120483398
epoch: 134, iter: 4590, loss: 0.4526774287223816, time cost2.842298984527588
epoch: 135, iter: 4591, loss: 0.9025401473045349, time cost4.114471435546875
epoch: 135, iter: 4592, loss: 0.5895490050315857, time cost3.9009346961975098
epoch: 135, iter: 4593, loss: 1.1692413091659546, time cost4.003533363342285
epoch: 135, iter: 4594, loss: 0.7527168989181519, time cost3.980696201324463
epoch: 135, iter: 4595, loss: 0.8304102420806885, time cost4.0702385902404785
epoch: 135, iter: 4596, loss: 0.7308362722396851, time cost4.0291242599487305
epoch: 135, iter: 4597, loss: 0.6696704626083374, time cost4.123903036117554
epoch: 135, iter: 4598, loss: 0.8546087145805359, time cost4.009160757064819
epoch: 135, iter: 4599, loss: 1.0142643451690674, time cost3.967604398727417
epoch: 135, iter: 4600, loss: 0.8504060506820679, time cost4.067654132843018
tensor([[ 39.,  28.,  30.,  ...,   1.,   1.,   1.],
        [ 75.,  63.,  58.,  ...,  18.,  18.,  15.],
        [112., 237., 173.,  ...,  11.,  11.,   4.],
        ...,
        [ 35.,  33.,  17.,  ...,   6.,   6.,   5.],
        [ 30.,  31.,   7.,  ...,   1.,   1.,   1.],
        [113., 181., 220.,  ...,   6.,   6.,   6.]])
Epoch: 135, Iteration: 4600:
TEST A@1: 0.5488888888888889
TEST A@5: 0.8733333333333333
TEST A@10: 0.94
TEST M@B: 0.4111928766477399
TEST M@A: 0.9521120664994971
TEST W@MB: 0.21844432982138234
TEST W@MA: 0.5872510403932092
TEST Time: 519.260410785675
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 135, iter: 4601, loss: 0.668168306350708, time cost4.078190803527832
epoch: 135, iter: 4602, loss: 0.8363654017448425, time cost3.699300765991211
epoch: 135, iter: 4603, loss: 0.637255072593689, time cost3.9542109966278076
epoch: 135, iter: 4604, loss: 0.8942961096763611, time cost4.033523321151733
epoch: 135, iter: 4605, loss: 0.5924636721611023, time cost4.265329122543335
epoch: 135, iter: 4606, loss: 0.8423201441764832, time cost4.324281215667725
epoch: 135, iter: 4607, loss: 0.9359763264656067, time cost4.3957414627075195
epoch: 135, iter: 4608, loss: 0.9554232954978943, time cost4.376504898071289
epoch: 135, iter: 4609, loss: 1.0538806915283203, time cost4.262485980987549
epoch: 135, iter: 4610, loss: 0.5226721167564392, time cost4.385252475738525
epoch: 135, iter: 4611, loss: 0.9745775461196899, time cost4.297716856002808
epoch: 135, iter: 4612, loss: 0.936924934387207, time cost4.405267715454102
epoch: 135, iter: 4613, loss: 1.1558127403259277, time cost4.1886491775512695
epoch: 135, iter: 4614, loss: 1.0442352294921875, time cost4.3746747970581055
epoch: 135, iter: 4615, loss: 0.8758742809295654, time cost4.4276487827301025
epoch: 135, iter: 4616, loss: 1.1432030200958252, time cost4.293319940567017
epoch: 135, iter: 4617, loss: 0.846047043800354, time cost4.352581739425659
epoch: 135, iter: 4618, loss: 0.8641483783721924, time cost4.115985155105591
epoch: 135, iter: 4619, loss: 0.9766561985015869, time cost4.3653881549835205
epoch: 135, iter: 4620, loss: 0.6506088972091675, time cost4.2258219718933105
epoch: 135, iter: 4621, loss: 0.8863352537155151, time cost4.230964183807373
epoch: 135, iter: 4622, loss: 1.103330135345459, time cost4.124435901641846
epoch: 135, iter: 4623, loss: 0.9338417649269104, time cost4.266941070556641
epoch: 135, iter: 4624, loss: 0.43696358799934387, time cost2.9220130443573
epoch: 136, iter: 4625, loss: 0.6310788989067078, time cost4.666569232940674
epoch: 136, iter: 4626, loss: 1.2399182319641113, time cost4.397592544555664
epoch: 136, iter: 4627, loss: 0.8902981281280518, time cost4.5167396068573
epoch: 136, iter: 4628, loss: 1.2039977312088013, time cost3.5799601078033447
epoch: 136, iter: 4629, loss: 0.8772895932197571, time cost3.543804168701172
epoch: 136, iter: 4630, loss: 0.6744043827056885, time cost3.4239516258239746
epoch: 136, iter: 4631, loss: 0.7339410185813904, time cost3.29418683052063
epoch: 136, iter: 4632, loss: 0.8717755079269409, time cost3.215998888015747
epoch: 136, iter: 4633, loss: 1.290718913078308, time cost3.886798858642578
epoch: 136, iter: 4634, loss: 0.9711801409721375, time cost4.121574401855469
epoch: 136, iter: 4635, loss: 0.9877970814704895, time cost3.8653690814971924
epoch: 136, iter: 4636, loss: 0.7110691666603088, time cost3.9000046253204346
epoch: 136, iter: 4637, loss: 0.8340670466423035, time cost3.949533224105835
epoch: 136, iter: 4638, loss: 0.8273033499717712, time cost3.9302852153778076
epoch: 136, iter: 4639, loss: 0.854144811630249, time cost3.735804796218872
epoch: 136, iter: 4640, loss: 0.636762797832489, time cost3.9953722953796387
epoch: 136, iter: 4641, loss: 0.7129900455474854, time cost3.9048023223876953
epoch: 136, iter: 4642, loss: 0.8923912644386292, time cost3.9233040809631348
epoch: 136, iter: 4643, loss: 0.9474295377731323, time cost3.957815408706665
epoch: 136, iter: 4644, loss: 1.2092868089675903, time cost3.9127538204193115
epoch: 136, iter: 4645, loss: 0.5183810591697693, time cost3.932311773300171
epoch: 136, iter: 4646, loss: 1.356452465057373, time cost4.024373292922974
epoch: 136, iter: 4647, loss: 0.9150012731552124, time cost3.852823495864868
epoch: 136, iter: 4648, loss: 0.8302156329154968, time cost3.716148853302002
epoch: 136, iter: 4649, loss: 0.5896667838096619, time cost3.7788376808166504
epoch: 136, iter: 4650, loss: 1.1658363342285156, time cost3.9469501972198486
tensor([[ 68.,  57.,  70.,  ...,   2.,   2.,   1.],
        [ 32.,  36.,  31.,  ...,   8.,   8.,   6.],
        [ 31., 153.,  40.,  ...,   3.,   3.,   1.],
        ...,
        [199., 201., 143.,  ...,  17.,  17.,  15.],
        [ 11.,   8.,   3.,  ...,   1.,   1.,   1.],
        [175., 286., 320.,  ...,   9.,   9.,   7.]])
Epoch: 136, Iteration: 4650:
TEST A@1: 0.4666666666666667
TEST A@5: 0.8355555555555556
TEST A@10: 0.9244444444444444
TEST M@B: 0.37469343322132115
TEST M@A: 0.9476075942851382
TEST W@MB: 0.20034024004616516
TEST W@MA: 0.5836776124559727
TEST Time: 498.33827805519104
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 136, iter: 4651, loss: 0.7120963335037231, time cost3.8461294174194336
epoch: 136, iter: 4652, loss: 0.6428873538970947, time cost3.8679237365722656
epoch: 136, iter: 4653, loss: 1.3400211334228516, time cost4.063289403915405
epoch: 136, iter: 4654, loss: 1.0297181606292725, time cost3.9817955493927
epoch: 136, iter: 4655, loss: 0.7653226852416992, time cost3.907475471496582
epoch: 136, iter: 4656, loss: 1.0693398714065552, time cost3.978415012359619
epoch: 136, iter: 4657, loss: 1.3051865100860596, time cost3.676913022994995
epoch: 136, iter: 4658, loss: 0.2997439205646515, time cost2.804664373397827
epoch: 137, iter: 4659, loss: 0.701204776763916, time cost3.906317949295044
epoch: 137, iter: 4660, loss: 1.3096723556518555, time cost4.056349515914917
epoch: 137, iter: 4661, loss: 0.9883965849876404, time cost3.988548517227173
epoch: 137, iter: 4662, loss: 0.8072885274887085, time cost4.02689003944397
epoch: 137, iter: 4663, loss: 0.48931601643562317, time cost3.9016337394714355
epoch: 137, iter: 4664, loss: 1.232318639755249, time cost3.9211843013763428
epoch: 137, iter: 4665, loss: 0.6750279068946838, time cost3.8694546222686768
epoch: 137, iter: 4666, loss: 0.6594277620315552, time cost4.113774299621582
epoch: 137, iter: 4667, loss: 0.6414558291435242, time cost4.0606701374053955
epoch: 137, iter: 4668, loss: 0.7988084554672241, time cost3.930950880050659
epoch: 137, iter: 4669, loss: 0.727011501789093, time cost4.044636011123657
epoch: 137, iter: 4670, loss: 0.8183969259262085, time cost4.010504245758057
epoch: 137, iter: 4671, loss: 0.9574127197265625, time cost3.951749801635742
epoch: 137, iter: 4672, loss: 1.0333019495010376, time cost3.9805519580841064
epoch: 137, iter: 4673, loss: 0.9144656658172607, time cost3.9618451595306396
epoch: 137, iter: 4674, loss: 0.40017169713974, time cost3.9147443771362305
epoch: 137, iter: 4675, loss: 0.5131096839904785, time cost4.069367170333862
epoch: 137, iter: 4676, loss: 1.361875295639038, time cost3.865072011947632
epoch: 137, iter: 4677, loss: 0.8970889449119568, time cost3.7580604553222656
epoch: 137, iter: 4678, loss: 0.7112787961959839, time cost3.8464157581329346
epoch: 137, iter: 4679, loss: 0.8705169558525085, time cost3.9836368560791016
epoch: 137, iter: 4680, loss: 0.9424545764923096, time cost4.137279748916626
epoch: 137, iter: 4681, loss: 0.7853002548217773, time cost3.821505069732666
epoch: 137, iter: 4682, loss: 1.1222764253616333, time cost3.858858823776245
epoch: 137, iter: 4683, loss: 0.7383232712745667, time cost3.749436378479004
epoch: 137, iter: 4684, loss: 1.0599514245986938, time cost3.910050630569458
epoch: 137, iter: 4685, loss: 0.9323933720588684, time cost3.8750925064086914
epoch: 137, iter: 4686, loss: 0.5478869080543518, time cost3.777543544769287
epoch: 137, iter: 4687, loss: 0.9667878150939941, time cost4.041744232177734
epoch: 137, iter: 4688, loss: 1.1298989057540894, time cost3.86576509475708
epoch: 137, iter: 4689, loss: 0.6055567860603333, time cost3.8680479526519775
epoch: 137, iter: 4690, loss: 0.9051479697227478, time cost3.9267208576202393
epoch: 137, iter: 4691, loss: 0.4394545257091522, time cost3.847182512283325
epoch: 137, iter: 4692, loss: 0.596462070941925, time cost2.60569429397583
epoch: 138, iter: 4693, loss: 1.3764917850494385, time cost3.8161346912384033
epoch: 138, iter: 4694, loss: 1.058742880821228, time cost3.986651659011841
epoch: 138, iter: 4695, loss: 0.8212785720825195, time cost3.9753880500793457
epoch: 138, iter: 4696, loss: 1.1667094230651855, time cost3.9703967571258545
epoch: 138, iter: 4697, loss: 0.7132833003997803, time cost3.972602605819702
epoch: 138, iter: 4698, loss: 1.3259531259536743, time cost3.9247915744781494
epoch: 138, iter: 4699, loss: 0.5837170481681824, time cost3.9744644165039062
epoch: 138, iter: 4700, loss: 0.680249810218811, time cost4.18740701675415
tensor([[ 95.,  75.,  88.,  ...,   1.,   1.,   1.],
        [ 15.,   8.,   9.,  ...,   9.,   9.,   5.],
        [ 92., 208.,  70.,  ...,   8.,   8.,   4.],
        ...,
        [120., 119.,  93.,  ...,  21.,  21.,  16.],
        [  8.,   8.,   4.,  ...,   1.,   1.,   1.],
        [ 69., 168., 221.,  ...,  13.,  13.,  11.]])
Epoch: 138, Iteration: 4700:
TEST A@1: 0.48444444444444446
TEST A@5: 0.8622222222222222
TEST A@10: 0.9377777777777778
TEST M@B: 0.396449227327529
TEST M@A: 0.953214480770811
TEST W@MB: 0.21212444600712316
TEST W@MA: 0.588162753762561
TEST Time: 544.5374939441681
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 138, iter: 4701, loss: 0.5342201590538025, time cost3.974020481109619
epoch: 138, iter: 4702, loss: 0.9391496181488037, time cost4.155435085296631
epoch: 138, iter: 4703, loss: 0.9388588666915894, time cost4.057419776916504
epoch: 138, iter: 4704, loss: 0.7774338722229004, time cost4.101591110229492
epoch: 138, iter: 4705, loss: 1.005562663078308, time cost4.104700326919556
epoch: 138, iter: 4706, loss: 0.6212153434753418, time cost4.087485313415527
epoch: 138, iter: 4707, loss: 0.3832809031009674, time cost3.947174549102783
epoch: 138, iter: 4708, loss: 0.6601030230522156, time cost4.028581142425537
epoch: 138, iter: 4709, loss: 0.7392807006835938, time cost4.146619081497192
epoch: 138, iter: 4710, loss: 1.1380615234375, time cost4.0977466106414795
epoch: 138, iter: 4711, loss: 0.8203215003013611, time cost4.020322799682617
epoch: 138, iter: 4712, loss: 1.116969108581543, time cost3.991696834564209
epoch: 138, iter: 4713, loss: 0.610591471195221, time cost4.068447828292847
epoch: 138, iter: 4714, loss: 0.8103007674217224, time cost4.057913780212402
epoch: 138, iter: 4715, loss: 0.6767655611038208, time cost3.9868521690368652
epoch: 138, iter: 4716, loss: 1.0612579584121704, time cost3.989339828491211
epoch: 138, iter: 4717, loss: 0.7005109786987305, time cost4.068047761917114
epoch: 138, iter: 4718, loss: 0.8482468128204346, time cost4.011321783065796
epoch: 138, iter: 4719, loss: 0.5513473153114319, time cost4.151873826980591
epoch: 138, iter: 4720, loss: 0.9406633973121643, time cost3.9728879928588867
epoch: 138, iter: 4721, loss: 0.6611106395721436, time cost3.9605371952056885
epoch: 138, iter: 4722, loss: 0.601692795753479, time cost3.9216835498809814
epoch: 138, iter: 4723, loss: 1.3307121992111206, time cost3.919546365737915
epoch: 138, iter: 4724, loss: 0.7371575832366943, time cost4.030588626861572
epoch: 138, iter: 4725, loss: 0.6132065653800964, time cost4.19245457649231
epoch: 138, iter: 4726, loss: 0.8782386779785156, time cost2.89705753326416
epoch: 139, iter: 4727, loss: 0.9129845499992371, time cost4.030325889587402
epoch: 139, iter: 4728, loss: 1.08319091796875, time cost4.128225326538086
epoch: 139, iter: 4729, loss: 0.9948504567146301, time cost3.9650919437408447
epoch: 139, iter: 4730, loss: 0.5868488550186157, time cost4.272618293762207
epoch: 139, iter: 4731, loss: 0.7773575186729431, time cost4.187668085098267
epoch: 139, iter: 4732, loss: 0.9843627214431763, time cost4.182676315307617
epoch: 139, iter: 4733, loss: 0.7208587527275085, time cost4.157890796661377
epoch: 139, iter: 4734, loss: 1.257401704788208, time cost4.035512685775757
epoch: 139, iter: 4735, loss: 1.1310253143310547, time cost4.112834930419922
epoch: 139, iter: 4736, loss: 0.7080129384994507, time cost4.169736623764038
epoch: 139, iter: 4737, loss: 0.5772973895072937, time cost4.114450216293335
epoch: 139, iter: 4738, loss: 0.5886868834495544, time cost3.8686017990112305
epoch: 139, iter: 4739, loss: 0.9713726043701172, time cost4.004612922668457
epoch: 139, iter: 4740, loss: 0.5302640795707703, time cost4.1252076625823975
epoch: 139, iter: 4741, loss: 1.5367754697799683, time cost4.050288915634155
epoch: 139, iter: 4742, loss: 0.5714722275733948, time cost4.191561222076416
epoch: 139, iter: 4743, loss: 1.0943944454193115, time cost4.088138103485107
epoch: 139, iter: 4744, loss: 0.9323253631591797, time cost4.004015922546387
epoch: 139, iter: 4745, loss: 0.7303250432014465, time cost4.135409355163574
epoch: 139, iter: 4746, loss: 0.7291117310523987, time cost4.073520660400391
epoch: 139, iter: 4747, loss: 0.940142810344696, time cost4.084839105606079
epoch: 139, iter: 4748, loss: 0.5283348560333252, time cost3.9738192558288574
epoch: 139, iter: 4749, loss: 0.7705658674240112, time cost4.036032199859619
epoch: 139, iter: 4750, loss: 0.8285167813301086, time cost4.011948585510254
tensor([[ 68.,  56.,  66.,  ...,   1.,   1.,   1.],
        [ 10.,  14.,  13.,  ...,   9.,   9.,   3.],
        [ 15.,  99.,  26.,  ...,   5.,   5.,   2.],
        ...,
        [128., 121.,  96.,  ...,  19.,  19.,  13.],
        [ 57.,  54.,   6.,  ...,   1.,   1.,   1.],
        [104., 192., 210.,  ...,  13.,  13.,  14.]])
Epoch: 139, Iteration: 4750:
TEST A@1: 0.5311111111111111
TEST A@5: 0.8688888888888889
TEST A@10: 0.94
TEST M@B: 0.41183189266781123
TEST M@A: 0.9538793096835799
TEST W@MB: 0.21987988387510402
TEST W@MA: 0.5889042149197204
TEST Time: 540.508303642273
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 139, iter: 4751, loss: 1.023824691772461, time cost4.061375141143799
epoch: 139, iter: 4752, loss: 1.2079719305038452, time cost4.003164291381836
epoch: 139, iter: 4753, loss: 0.45086920261383057, time cost3.805678129196167
epoch: 139, iter: 4754, loss: 0.6957268714904785, time cost3.848313808441162
epoch: 139, iter: 4755, loss: 1.1275193691253662, time cost3.9879932403564453
epoch: 139, iter: 4756, loss: 1.0331363677978516, time cost4.024540662765503
epoch: 139, iter: 4757, loss: 0.5031007528305054, time cost4.0341432094573975
epoch: 139, iter: 4758, loss: 0.7277287244796753, time cost4.033523082733154
epoch: 139, iter: 4759, loss: 1.2097476720809937, time cost3.9414095878601074
epoch: 139, iter: 4760, loss: 0.9124897122383118, time cost2.9156606197357178
epoch: 140, iter: 4761, loss: 0.5275993347167969, time cost4.153374671936035
epoch: 140, iter: 4762, loss: 1.004144310951233, time cost4.150198221206665
epoch: 140, iter: 4763, loss: 1.2094664573669434, time cost4.195780992507935
epoch: 140, iter: 4764, loss: 1.0521080493927002, time cost4.142995595932007
epoch: 140, iter: 4765, loss: 0.8753777742385864, time cost4.040525674819946
epoch: 140, iter: 4766, loss: 0.7917900085449219, time cost3.910418748855591
epoch: 140, iter: 4767, loss: 0.5229513049125671, time cost4.161830902099609
epoch: 140, iter: 4768, loss: 0.8553768992424011, time cost3.9901156425476074
epoch: 140, iter: 4769, loss: 1.228822112083435, time cost4.084559917449951
epoch: 140, iter: 4770, loss: 1.0591737031936646, time cost4.02168083190918
epoch: 140, iter: 4771, loss: 0.8196054697036743, time cost4.021870136260986
epoch: 140, iter: 4772, loss: 0.7187836766242981, time cost4.090997934341431
epoch: 140, iter: 4773, loss: 0.754872739315033, time cost4.048888206481934
epoch: 140, iter: 4774, loss: 0.8895373940467834, time cost3.9562625885009766
epoch: 140, iter: 4775, loss: 0.6135344505310059, time cost4.122987985610962
epoch: 140, iter: 4776, loss: 0.2904019355773926, time cost4.037660121917725
epoch: 140, iter: 4777, loss: 0.5383961796760559, time cost4.174447536468506
epoch: 140, iter: 4778, loss: 1.1754363775253296, time cost4.000284194946289
epoch: 140, iter: 4779, loss: 0.9274929165840149, time cost4.071327209472656
epoch: 140, iter: 4780, loss: 0.35786768794059753, time cost4.164330959320068
epoch: 140, iter: 4781, loss: 0.6856486797332764, time cost4.229089975357056
epoch: 140, iter: 4782, loss: 0.49636587500572205, time cost4.047769546508789
epoch: 140, iter: 4783, loss: 0.5199396014213562, time cost4.346475124359131
epoch: 140, iter: 4784, loss: 1.0369757413864136, time cost3.9722673892974854
epoch: 140, iter: 4785, loss: 1.1267412900924683, time cost4.1159374713897705
epoch: 140, iter: 4786, loss: 0.5015000700950623, time cost3.9464712142944336
epoch: 140, iter: 4787, loss: 0.7494880557060242, time cost4.096526145935059
epoch: 140, iter: 4788, loss: 0.8729981184005737, time cost4.090780973434448
epoch: 140, iter: 4789, loss: 0.7643322944641113, time cost4.054028749465942
epoch: 140, iter: 4790, loss: 0.5433030724525452, time cost4.001044511795044
epoch: 140, iter: 4791, loss: 0.703334629535675, time cost3.8211071491241455
epoch: 140, iter: 4792, loss: 1.2810615301132202, time cost4.0040953159332275
epoch: 140, iter: 4793, loss: 1.297078013420105, time cost3.9873204231262207
epoch: 140, iter: 4794, loss: 0.3684898018836975, time cost2.867713689804077
epoch: 141, iter: 4795, loss: 0.5347859859466553, time cost3.998345375061035
epoch: 141, iter: 4796, loss: 0.6420949697494507, time cost4.207294702529907
epoch: 141, iter: 4797, loss: 0.7824016809463501, time cost4.069880962371826
epoch: 141, iter: 4798, loss: 1.1716879606246948, time cost4.03287410736084
epoch: 141, iter: 4799, loss: 0.583866536617279, time cost4.208660840988159
epoch: 141, iter: 4800, loss: 0.6925432682037354, time cost3.9860634803771973
tensor([[ 30.,  24.,  32.,  ...,   1.,   1.,   1.],
        [ 18.,  17.,  16.,  ...,  12.,  12.,   6.],
        [102., 230., 106.,  ...,   6.,   6.,   4.],
        ...,
        [ 48.,  54.,  27.,  ...,   8.,   8.,   8.],
        [  3.,   2.,   4.,  ...,   1.,   1.,   1.],
        [203., 241., 285.,  ...,  13.,  13.,  15.]])
Epoch: 141, Iteration: 4800:
TEST A@1: 0.5066666666666667
TEST A@5: 0.8355555555555556
TEST A@10: 0.9377777777777778
TEST M@B: 0.40070096115351767
TEST M@A: 0.9561269143475664
TEST W@MB: 0.21485019404077416
TEST W@MA: 0.5909394303508063
TEST Time: 492.3295214176178
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 141, iter: 4801, loss: 0.6362046599388123, time cost3.959151029586792
epoch: 141, iter: 4802, loss: 0.7732285857200623, time cost4.037242889404297
epoch: 141, iter: 4803, loss: 0.4853067100048065, time cost4.204996347427368
epoch: 141, iter: 4804, loss: 0.6206919550895691, time cost4.248739957809448
epoch: 141, iter: 4805, loss: 0.7447709441184998, time cost3.946620464324951
epoch: 141, iter: 4806, loss: 0.4388220012187958, time cost3.958339214324951
epoch: 141, iter: 4807, loss: 0.6797373294830322, time cost4.220455169677734
epoch: 141, iter: 4808, loss: 0.8547519445419312, time cost4.128925323486328
epoch: 141, iter: 4809, loss: 0.5138588547706604, time cost4.063707590103149
epoch: 141, iter: 4810, loss: 0.7731873989105225, time cost4.154820442199707
epoch: 141, iter: 4811, loss: 0.9344956874847412, time cost4.2178215980529785
epoch: 141, iter: 4812, loss: 0.9109249711036682, time cost4.187209129333496
epoch: 141, iter: 4813, loss: 0.6536924242973328, time cost4.007502317428589
epoch: 141, iter: 4814, loss: 0.7615585923194885, time cost4.146780967712402
epoch: 141, iter: 4815, loss: 0.5260422825813293, time cost4.072568416595459
epoch: 141, iter: 4816, loss: 0.6345162987709045, time cost3.9918930530548096
epoch: 141, iter: 4817, loss: 0.818325936794281, time cost4.0616614818573
epoch: 141, iter: 4818, loss: 0.4928179383277893, time cost4.083008050918579
epoch: 141, iter: 4819, loss: 1.1995728015899658, time cost4.201228141784668
epoch: 141, iter: 4820, loss: 1.1612550020217896, time cost3.94814395904541
epoch: 141, iter: 4821, loss: 0.7147405743598938, time cost4.085194826126099
epoch: 141, iter: 4822, loss: 0.7098018527030945, time cost4.011288404464722
epoch: 141, iter: 4823, loss: 0.6294621825218201, time cost3.972738265991211
epoch: 141, iter: 4824, loss: 0.7478240728378296, time cost4.131664514541626
epoch: 141, iter: 4825, loss: 0.8251307606697083, time cost3.9573826789855957
epoch: 141, iter: 4826, loss: 0.48672693967819214, time cost4.118499755859375
epoch: 141, iter: 4827, loss: 0.6347605586051941, time cost3.999484062194824
epoch: 141, iter: 4828, loss: 0.5326269865036011, time cost3.019108772277832
epoch: 142, iter: 4829, loss: 0.6813849210739136, time cost4.198794603347778
epoch: 142, iter: 4830, loss: 1.0780515670776367, time cost4.1422200202941895
epoch: 142, iter: 4831, loss: 0.7669332027435303, time cost4.008995532989502
epoch: 142, iter: 4832, loss: 1.028663158416748, time cost4.102914571762085
epoch: 142, iter: 4833, loss: 0.3528241813182831, time cost3.992147922515869
epoch: 142, iter: 4834, loss: 0.7105257511138916, time cost4.094828128814697
epoch: 142, iter: 4835, loss: 0.5062509775161743, time cost4.2545106410980225
epoch: 142, iter: 4836, loss: 0.9894943833351135, time cost4.082581520080566
epoch: 142, iter: 4837, loss: 0.9181786775588989, time cost4.097876310348511
epoch: 142, iter: 4838, loss: 0.639766275882721, time cost4.0957465171813965
epoch: 142, iter: 4839, loss: 1.341385006904602, time cost4.259694576263428
epoch: 142, iter: 4840, loss: 0.5600113868713379, time cost4.1904520988464355
epoch: 142, iter: 4841, loss: 0.44971901178359985, time cost4.056889057159424
epoch: 142, iter: 4842, loss: 0.678157389163971, time cost4.134678840637207
epoch: 142, iter: 4843, loss: 1.126016616821289, time cost4.040589332580566
epoch: 142, iter: 4844, loss: 0.50860995054245, time cost4.052122354507446
epoch: 142, iter: 4845, loss: 0.6906527280807495, time cost4.068444013595581
epoch: 142, iter: 4846, loss: 0.5584562420845032, time cost4.254289150238037
epoch: 142, iter: 4847, loss: 0.872324526309967, time cost4.253514766693115
epoch: 142, iter: 4848, loss: 0.5435892939567566, time cost4.303186893463135
epoch: 142, iter: 4849, loss: 0.5844904780387878, time cost4.2023606300354
epoch: 142, iter: 4850, loss: 0.9497829675674438, time cost4.256211757659912
tensor([[ 43.,  31.,  42.,  ...,   3.,   3.,   1.],
        [ 52.,  42.,  39.,  ...,  10.,  10.,   5.],
        [ 74., 190.,  75.,  ...,   3.,   3.,   3.],
        ...,
        [ 50.,  49.,  27.,  ...,  16.,  16.,  14.],
        [  5.,   6.,   2.,  ...,   1.,   1.,   1.],
        [ 22.,  81.,  78.,  ...,   4.,   4.,   3.]])
Epoch: 142, Iteration: 4850:
TEST A@1: 0.52
TEST A@5: 0.8711111111111111
TEST A@10: 0.9377777777777778
TEST M@B: 0.4156754946984197
TEST M@A: 0.9552468630867227
TEST W@MB: 0.22308463408105791
TEST W@MA: 0.5901545385782091
TEST Time: 551.3640794754028
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 142, iter: 4851, loss: 1.5061460733413696, time cost4.010411262512207
epoch: 142, iter: 4852, loss: 0.6968758702278137, time cost3.94524884223938
epoch: 142, iter: 4853, loss: 0.6618368029594421, time cost4.031094551086426
epoch: 142, iter: 4854, loss: 0.5872491598129272, time cost4.214547395706177
epoch: 142, iter: 4855, loss: 0.8405386209487915, time cost4.016780138015747
epoch: 142, iter: 4856, loss: 1.107036828994751, time cost3.957228660583496
epoch: 142, iter: 4857, loss: 0.5258156657218933, time cost3.852426290512085
epoch: 142, iter: 4858, loss: 0.873592734336853, time cost3.919609308242798
epoch: 142, iter: 4859, loss: 0.9038747549057007, time cost3.867988348007202
epoch: 142, iter: 4860, loss: 0.855219304561615, time cost3.9086380004882812
epoch: 142, iter: 4861, loss: 0.6242349147796631, time cost3.808202028274536
epoch: 142, iter: 4862, loss: 0.6583247780799866, time cost2.692131280899048
epoch: 143, iter: 4863, loss: 1.1437263488769531, time cost4.087300539016724
epoch: 143, iter: 4864, loss: 0.5428729057312012, time cost3.945220947265625
epoch: 143, iter: 4865, loss: 0.5480179786682129, time cost3.9837050437927246
epoch: 143, iter: 4866, loss: 0.7255281209945679, time cost3.925341844558716
epoch: 143, iter: 4867, loss: 0.5893393754959106, time cost3.9861769676208496
epoch: 143, iter: 4868, loss: 0.4894666075706482, time cost4.111672878265381
epoch: 143, iter: 4869, loss: 0.5877726078033447, time cost3.9596669673919678
epoch: 143, iter: 4870, loss: 0.8668362498283386, time cost3.9643959999084473
epoch: 143, iter: 4871, loss: 1.1664149761199951, time cost4.061500549316406
epoch: 143, iter: 4872, loss: 1.2076337337493896, time cost3.9937362670898438
epoch: 143, iter: 4873, loss: 0.6114597320556641, time cost3.928882360458374
epoch: 143, iter: 4874, loss: 0.9072607755661011, time cost4.042663335800171
epoch: 143, iter: 4875, loss: 0.6437216997146606, time cost4.089969873428345
epoch: 143, iter: 4876, loss: 0.7291040420532227, time cost4.111166000366211
epoch: 143, iter: 4877, loss: 0.6338135004043579, time cost4.071581840515137
epoch: 143, iter: 4878, loss: 0.7656348943710327, time cost4.01788854598999
epoch: 143, iter: 4879, loss: 0.7985926866531372, time cost4.0058722496032715
epoch: 143, iter: 4880, loss: 0.6809958219528198, time cost3.9080262184143066
epoch: 143, iter: 4881, loss: 0.9189820289611816, time cost4.140178203582764
epoch: 143, iter: 4882, loss: 1.0162867307662964, time cost3.9297831058502197
epoch: 143, iter: 4883, loss: 0.5605884790420532, time cost3.9187114238739014
epoch: 143, iter: 4884, loss: 0.6494801640510559, time cost3.916867256164551
epoch: 143, iter: 4885, loss: 0.7012548446655273, time cost4.046680927276611
epoch: 143, iter: 4886, loss: 0.7181550860404968, time cost3.9496705532073975
epoch: 143, iter: 4887, loss: 0.3573429584503174, time cost4.195701837539673
epoch: 143, iter: 4888, loss: 0.6605915427207947, time cost4.049906492233276
epoch: 143, iter: 4889, loss: 0.5517444014549255, time cost4.025044679641724
epoch: 143, iter: 4890, loss: 0.8059517741203308, time cost3.9287185668945312
epoch: 143, iter: 4891, loss: 0.3847925364971161, time cost3.812526226043701
epoch: 143, iter: 4892, loss: 1.0513617992401123, time cost3.946228504180908
epoch: 143, iter: 4893, loss: 0.6171901822090149, time cost4.0378098487854
epoch: 143, iter: 4894, loss: 0.7789544463157654, time cost4.0130579471588135
epoch: 143, iter: 4895, loss: 0.7296516299247742, time cost3.978851556777954
epoch: 143, iter: 4896, loss: 0.45134782791137695, time cost2.904468297958374
epoch: 144, iter: 4897, loss: 0.8802089095115662, time cost4.035494327545166
epoch: 144, iter: 4898, loss: 1.0086255073547363, time cost4.165245771408081
epoch: 144, iter: 4899, loss: 0.6946220397949219, time cost4.178013563156128
epoch: 144, iter: 4900, loss: 1.3883945941925049, time cost3.97316312789917
tensor([[ 53.,  41.,  51.,  ...,   5.,   5.,   3.],
        [ 35.,  29.,  27.,  ...,   7.,   7.,   6.],
        [ 46., 143.,  42.,  ...,   3.,   3.,   2.],
        ...,
        [121., 113.,  78.,  ...,  15.,  15.,  13.],
        [  5.,   8.,   5.,  ...,   2.,   2.,   2.],
        [115., 209., 232.,  ...,   4.,   4.,   5.]])
Epoch: 144, Iteration: 4900:
TEST A@1: 0.44666666666666666
TEST A@5: 0.8022222222222222
TEST A@10: 0.8955555555555555
TEST M@B: 0.3531269169652328
TEST M@A: 0.9500588972551511
TEST W@MB: 0.1882344430016568
TEST W@MA: 0.5862008230415502
TEST Time: 550.2802455425262
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 144, iter: 4901, loss: 0.36725014448165894, time cost3.9242241382598877
epoch: 144, iter: 4902, loss: 0.8131988048553467, time cost4.025717258453369
epoch: 144, iter: 4903, loss: 1.166939377784729, time cost4.000519752502441
epoch: 144, iter: 4904, loss: 0.5245147347450256, time cost4.235534906387329
epoch: 144, iter: 4905, loss: 0.5682516098022461, time cost4.111853122711182
epoch: 144, iter: 4906, loss: 1.1109898090362549, time cost4.294162273406982
epoch: 144, iter: 4907, loss: 0.7756373882293701, time cost4.175637483596802
epoch: 144, iter: 4908, loss: 0.9857900142669678, time cost4.0625059604644775
epoch: 144, iter: 4909, loss: 0.7191166877746582, time cost4.023693561553955
epoch: 144, iter: 4910, loss: 0.8844491839408875, time cost4.0109288692474365
epoch: 144, iter: 4911, loss: 0.6567743420600891, time cost3.987293004989624
epoch: 144, iter: 4912, loss: 0.7335399389266968, time cost4.015993356704712
epoch: 144, iter: 4913, loss: 0.8170384168624878, time cost4.087845325469971
epoch: 144, iter: 4914, loss: 0.7343941330909729, time cost3.9672303199768066
epoch: 144, iter: 4915, loss: 0.8645197153091431, time cost3.922675132751465
epoch: 144, iter: 4916, loss: 0.7531019449234009, time cost4.096243143081665
epoch: 144, iter: 4917, loss: 0.6574689745903015, time cost4.055020570755005
epoch: 144, iter: 4918, loss: 1.0381066799163818, time cost3.982994318008423
epoch: 144, iter: 4919, loss: 0.9430559873580933, time cost3.8735227584838867
epoch: 144, iter: 4920, loss: 0.9149172902107239, time cost4.0061891078948975
epoch: 144, iter: 4921, loss: 0.9113273024559021, time cost4.057195425033569
epoch: 144, iter: 4922, loss: 0.6403769850730896, time cost4.263433218002319
epoch: 144, iter: 4923, loss: 0.8197616338729858, time cost4.037236452102661
epoch: 144, iter: 4924, loss: 0.6034157276153564, time cost3.9301774501800537
epoch: 144, iter: 4925, loss: 1.9200736284255981, time cost3.8530499935150146
epoch: 144, iter: 4926, loss: 0.39653176069259644, time cost4.118034839630127
epoch: 144, iter: 4927, loss: 0.9859280586242676, time cost4.168846845626831
epoch: 144, iter: 4928, loss: 1.5587867498397827, time cost4.055185317993164
epoch: 144, iter: 4929, loss: 0.7224648594856262, time cost3.8848719596862793
epoch: 144, iter: 4930, loss: 0.5818465352058411, time cost2.910208225250244
epoch: 145, iter: 4931, loss: 0.8814032673835754, time cost4.1777637004852295
epoch: 145, iter: 4932, loss: 1.2756415605545044, time cost4.076135635375977
epoch: 145, iter: 4933, loss: 0.5393314957618713, time cost4.050238847732544
epoch: 145, iter: 4934, loss: 0.4143963158130646, time cost4.149229288101196
epoch: 145, iter: 4935, loss: 0.8532595038414001, time cost4.124759197235107
epoch: 145, iter: 4936, loss: 0.5630916357040405, time cost4.0871076583862305
epoch: 145, iter: 4937, loss: 0.6774213910102844, time cost4.152853965759277
epoch: 145, iter: 4938, loss: 0.7566877603530884, time cost4.067721843719482
epoch: 145, iter: 4939, loss: 0.5344298481941223, time cost4.1129374504089355
epoch: 145, iter: 4940, loss: 0.7406350374221802, time cost4.14340615272522
epoch: 145, iter: 4941, loss: 0.6730033159255981, time cost4.1403398513793945
epoch: 145, iter: 4942, loss: 0.5753605961799622, time cost4.0173499584198
epoch: 145, iter: 4943, loss: 0.5369205474853516, time cost4.06602144241333
epoch: 145, iter: 4944, loss: 1.397904634475708, time cost4.0797529220581055
epoch: 145, iter: 4945, loss: 0.7401050329208374, time cost4.247330904006958
epoch: 145, iter: 4946, loss: 0.8846148252487183, time cost4.113672256469727
epoch: 145, iter: 4947, loss: 0.5579501986503601, time cost3.986226797103882
epoch: 145, iter: 4948, loss: 0.5830111503601074, time cost4.134578466415405
epoch: 145, iter: 4949, loss: 0.4654957950115204, time cost3.9612693786621094
epoch: 145, iter: 4950, loss: 1.1006035804748535, time cost4.155184030532837
tensor([[ 92.,  78.,  94.,  ...,   5.,   5.,   4.],
        [ 17.,  19.,  19.,  ...,  12.,  12.,   9.],
        [ 70., 178.,  51.,  ...,   2.,   2.,   1.],
        ...,
        [ 67.,  62.,  45.,  ...,   7.,   7.,   7.],
        [ 16.,  17.,   4.,  ...,   1.,   1.,   1.],
        [ 99., 190., 198.,  ...,  12.,  12.,  17.]])
Epoch: 145, Iteration: 4950:
TEST A@1: 0.5088888888888888
TEST A@5: 0.8288888888888889
TEST A@10: 0.9177777777777778
TEST M@B: 0.40192069967754235
TEST M@A: 0.9540251007140984
TEST W@MB: 0.21648608513946677
TEST W@MA: 0.5894858361850288
TEST Time: 552.6394748687744
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 145, iter: 4951, loss: 1.0080503225326538, time cost4.107326030731201
epoch: 145, iter: 4952, loss: 1.3152207136154175, time cost3.9886674880981445
epoch: 145, iter: 4953, loss: 1.241037368774414, time cost4.028771162033081
epoch: 145, iter: 4954, loss: 1.5088119506835938, time cost3.9361555576324463
epoch: 145, iter: 4955, loss: 0.8000169992446899, time cost3.9040565490722656
epoch: 145, iter: 4956, loss: 0.5974702835083008, time cost3.997152805328369
epoch: 145, iter: 4957, loss: 0.7087360620498657, time cost3.938538074493408
epoch: 145, iter: 4958, loss: 1.010680079460144, time cost3.778210163116455
epoch: 145, iter: 4959, loss: 1.0851837396621704, time cost3.9527740478515625
epoch: 145, iter: 4960, loss: 1.0164457559585571, time cost3.9142966270446777
epoch: 145, iter: 4961, loss: 1.280576467514038, time cost3.9376344680786133
epoch: 145, iter: 4962, loss: 0.6936705708503723, time cost3.8279783725738525
epoch: 145, iter: 4963, loss: 0.7631924152374268, time cost3.8950600624084473
epoch: 145, iter: 4964, loss: 0.4969347417354584, time cost2.8550326824188232
epoch: 146, iter: 4965, loss: 0.6218216419219971, time cost3.9779229164123535
epoch: 146, iter: 4966, loss: 0.31445157527923584, time cost3.917325735092163
epoch: 146, iter: 4967, loss: 0.7876015901565552, time cost3.9034602642059326
epoch: 146, iter: 4968, loss: 0.7548692226409912, time cost4.164602279663086
epoch: 146, iter: 4969, loss: 0.39796534180641174, time cost4.004823207855225
epoch: 146, iter: 4970, loss: 0.8637354373931885, time cost3.952873468399048
epoch: 146, iter: 4971, loss: 1.1193856000900269, time cost4.032888412475586
epoch: 146, iter: 4972, loss: 0.8936154842376709, time cost4.0045788288116455
epoch: 146, iter: 4973, loss: 0.622011661529541, time cost3.921685218811035
epoch: 146, iter: 4974, loss: 0.9315658807754517, time cost4.103629112243652
epoch: 146, iter: 4975, loss: 0.38622286915779114, time cost3.9893434047698975
epoch: 146, iter: 4976, loss: 0.7903504967689514, time cost3.996406316757202
epoch: 146, iter: 4977, loss: 0.7566673755645752, time cost4.015945672988892
epoch: 146, iter: 4978, loss: 0.4196503758430481, time cost3.9893596172332764
epoch: 146, iter: 4979, loss: 0.6928135752677917, time cost3.958021640777588
epoch: 146, iter: 4980, loss: 0.9219284653663635, time cost4.155733585357666
epoch: 146, iter: 4981, loss: 0.5290015935897827, time cost4.000614643096924
epoch: 146, iter: 4982, loss: 0.6558317542076111, time cost3.924463987350464
epoch: 146, iter: 4983, loss: 0.5955064296722412, time cost3.9645748138427734
epoch: 146, iter: 4984, loss: 0.7455142736434937, time cost3.971740961074829
epoch: 146, iter: 4985, loss: 0.5040522813796997, time cost4.0722575187683105
epoch: 146, iter: 4986, loss: 1.1976430416107178, time cost4.305553436279297
epoch: 146, iter: 4987, loss: 0.7649409770965576, time cost4.052688360214233
epoch: 146, iter: 4988, loss: 0.57953280210495, time cost3.960277795791626
epoch: 146, iter: 4989, loss: 0.6525682806968689, time cost3.9279325008392334
epoch: 146, iter: 4990, loss: 1.062923789024353, time cost3.875408887863159
epoch: 146, iter: 4991, loss: 1.058308482170105, time cost4.04866099357605
epoch: 146, iter: 4992, loss: 0.7778849005699158, time cost4.037272930145264
epoch: 146, iter: 4993, loss: 0.43526899814605713, time cost3.858729839324951
epoch: 146, iter: 4994, loss: 0.5978239178657532, time cost3.9917566776275635
epoch: 146, iter: 4995, loss: 0.6755003929138184, time cost4.0233213901519775
epoch: 146, iter: 4996, loss: 0.5151360630989075, time cost3.8694651126861572
epoch: 146, iter: 4997, loss: 0.7772928476333618, time cost3.9955334663391113
epoch: 146, iter: 4998, loss: 0.6390923261642456, time cost2.965188503265381
epoch: 147, iter: 4999, loss: 0.8548619747161865, time cost3.9775304794311523
epoch: 147, iter: 5000, loss: 1.0883876085281372, time cost4.139039993286133
tensor([[115.,  91.,  99.,  ...,   1.,   1.,   1.],
        [ 13.,   8.,   6.,  ...,   3.,   3.,   3.],
        [ 32., 180.,  36.,  ...,   2.,   2.,   1.],
        ...,
        [ 80.,  69.,  48.,  ...,  14.,  14.,   9.],
        [ 28.,  28.,   6.,  ...,   2.,   2.,   1.],
        [151., 219., 272.,  ...,   1.,   1.,   1.]])
Epoch: 147, Iteration: 5000:
TEST A@1: 0.5333333333333333
TEST A@5: 0.8711111111111111
TEST A@10: 0.9466666666666667
TEST M@B: 0.4233926324873031
TEST M@A: 0.9561279039625818
TEST W@MB: 0.22688912341053732
TEST W@MA: 0.5907195668909228
TEST Time: 552.7422082424164
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 147, iter: 5001, loss: 0.7460901737213135, time cost3.996270179748535
epoch: 147, iter: 5002, loss: 0.5012121796607971, time cost4.243494987487793
epoch: 147, iter: 5003, loss: 0.5392540097236633, time cost4.153971433639526
epoch: 147, iter: 5004, loss: 0.7194995284080505, time cost4.00030517578125
epoch: 147, iter: 5005, loss: 0.8346115350723267, time cost3.7983803749084473
epoch: 147, iter: 5006, loss: 0.5411978960037231, time cost3.966609001159668
epoch: 147, iter: 5007, loss: 1.128126859664917, time cost4.055545091629028
epoch: 147, iter: 5008, loss: 0.6697520613670349, time cost3.9252967834472656
epoch: 147, iter: 5009, loss: 0.9511456489562988, time cost4.02258563041687
epoch: 147, iter: 5010, loss: 1.0097274780273438, time cost4.016921758651733
epoch: 147, iter: 5011, loss: 0.8334835767745972, time cost3.844517707824707
epoch: 147, iter: 5012, loss: 0.8326662182807922, time cost3.826246976852417
epoch: 147, iter: 5013, loss: 0.8814346194267273, time cost3.8406107425689697
epoch: 147, iter: 5014, loss: 0.9530783295631409, time cost3.967308521270752
epoch: 147, iter: 5015, loss: 0.8770052194595337, time cost4.1774001121521
epoch: 147, iter: 5016, loss: 0.34637436270713806, time cost4.158077239990234
epoch: 147, iter: 5017, loss: 0.8471028208732605, time cost3.9549384117126465
epoch: 147, iter: 5018, loss: 0.773038923740387, time cost3.9644179344177246
epoch: 147, iter: 5019, loss: 0.5375472903251648, time cost3.944523811340332
epoch: 147, iter: 5020, loss: 0.3476708233356476, time cost3.8968894481658936
epoch: 147, iter: 5021, loss: 1.1833720207214355, time cost3.9519612789154053
epoch: 147, iter: 5022, loss: 1.5025215148925781, time cost3.9302785396575928
epoch: 147, iter: 5023, loss: 0.7496834993362427, time cost4.036703586578369
epoch: 147, iter: 5024, loss: 0.7363978624343872, time cost4.0134077072143555
epoch: 147, iter: 5025, loss: 0.6564695835113525, time cost3.985987424850464
epoch: 147, iter: 5026, loss: 0.9853333234786987, time cost3.9726369380950928
epoch: 147, iter: 5027, loss: 0.5202777981758118, time cost3.958181619644165
epoch: 147, iter: 5028, loss: 0.9129898548126221, time cost3.8796422481536865
epoch: 147, iter: 5029, loss: 0.6956431269645691, time cost3.8525376319885254
epoch: 147, iter: 5030, loss: 0.5057061314582825, time cost3.9658877849578857
epoch: 147, iter: 5031, loss: 0.4792941212654114, time cost3.9296653270721436
epoch: 147, iter: 5032, loss: 0.3146381974220276, time cost2.8482248783111572
epoch: 148, iter: 5033, loss: 0.663887083530426, time cost4.0033416748046875
epoch: 148, iter: 5034, loss: 0.4004051089286804, time cost3.996633529663086
epoch: 148, iter: 5035, loss: 0.5597652196884155, time cost3.9556097984313965
epoch: 148, iter: 5036, loss: 0.8143054842948914, time cost4.099754333496094
epoch: 148, iter: 5037, loss: 0.4433937072753906, time cost3.943819761276245
epoch: 148, iter: 5038, loss: 0.6437580585479736, time cost4.089942932128906
epoch: 148, iter: 5039, loss: 0.4145595133304596, time cost4.18534255027771
epoch: 148, iter: 5040, loss: 0.5209240913391113, time cost3.9714322090148926
epoch: 148, iter: 5041, loss: 0.9313416481018066, time cost4.029844284057617
epoch: 148, iter: 5042, loss: 0.5917173624038696, time cost4.011176347732544
epoch: 148, iter: 5043, loss: 0.8055292963981628, time cost3.9583470821380615
epoch: 148, iter: 5044, loss: 0.4665517807006836, time cost4.0916428565979
epoch: 148, iter: 5045, loss: 1.1236560344696045, time cost4.112468004226685
epoch: 148, iter: 5046, loss: 0.7284430861473083, time cost4.111099481582642
epoch: 148, iter: 5047, loss: 1.2332512140274048, time cost4.079334497451782
epoch: 148, iter: 5048, loss: 0.7230169177055359, time cost4.017233371734619
epoch: 148, iter: 5049, loss: 0.4258040189743042, time cost4.067053556442261
epoch: 148, iter: 5050, loss: 0.7800521850585938, time cost4.122765302658081
tensor([[ 56.,  35.,  46.,  ...,   1.,   1.,   1.],
        [ 22.,  18.,  16.,  ...,  10.,  10.,   8.],
        [117., 266., 118.,  ...,   2.,   2.,   1.],
        ...,
        [ 77.,  75.,  48.,  ...,  17.,  17.,  13.],
        [ 13.,  10.,   3.,  ...,   1.,   1.,   1.],
        [ 68., 218., 250.,  ...,   3.,   3.,   8.]])
Epoch: 148, Iteration: 5050:
TEST A@1: 0.5311111111111111
TEST A@5: 0.86
TEST A@10: 0.9488888888888889
TEST M@B: 0.41770170222060704
TEST M@A: 0.9561841134162369
TEST W@MB: 0.22396772038503773
TEST W@MA: 0.5907256944551461
TEST Time: 554.4149398803711
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 148, iter: 5051, loss: 0.8330178260803223, time cost4.183678865432739
epoch: 148, iter: 5052, loss: 0.4521235525608063, time cost4.477895021438599
epoch: 148, iter: 5053, loss: 0.701985239982605, time cost4.274579048156738
epoch: 148, iter: 5054, loss: 0.622253954410553, time cost4.139055252075195
epoch: 148, iter: 5055, loss: 0.7698934674263, time cost4.365384817123413
epoch: 148, iter: 5056, loss: 0.7682944536209106, time cost4.253559827804565
epoch: 148, iter: 5057, loss: 0.45059454441070557, time cost4.346366882324219
epoch: 148, iter: 5058, loss: 0.81540447473526, time cost4.452905178070068
epoch: 148, iter: 5059, loss: 0.38233181834220886, time cost4.222290754318237
epoch: 148, iter: 5060, loss: 1.197532057762146, time cost4.282464981079102
epoch: 148, iter: 5061, loss: 0.5358169674873352, time cost4.15442419052124
epoch: 148, iter: 5062, loss: 0.5217820405960083, time cost4.129680871963501
epoch: 148, iter: 5063, loss: 0.5900342464447021, time cost4.210770130157471
epoch: 148, iter: 5064, loss: 0.8453562259674072, time cost4.290971755981445
epoch: 148, iter: 5065, loss: 0.7414135336875916, time cost4.310178518295288
epoch: 148, iter: 5066, loss: 0.49090775847435, time cost3.0540072917938232
epoch: 149, iter: 5067, loss: 0.7188593745231628, time cost4.308384418487549
epoch: 149, iter: 5068, loss: 0.7212238311767578, time cost4.326797723770142
epoch: 149, iter: 5069, loss: 0.7843608260154724, time cost4.392714500427246
epoch: 149, iter: 5070, loss: 0.7003998756408691, time cost4.207359552383423
epoch: 149, iter: 5071, loss: 0.41513416171073914, time cost4.200457811355591
epoch: 149, iter: 5072, loss: 1.0849995613098145, time cost4.301466464996338
epoch: 149, iter: 5073, loss: 0.676468014717102, time cost4.343044757843018
epoch: 149, iter: 5074, loss: 0.7327992916107178, time cost4.423985481262207
epoch: 149, iter: 5075, loss: 0.5030525922775269, time cost4.317185640335083
epoch: 149, iter: 5076, loss: 0.5677217841148376, time cost4.289429664611816
epoch: 149, iter: 5077, loss: 0.7052430510520935, time cost4.2744762897491455
epoch: 149, iter: 5078, loss: 0.9715781211853027, time cost4.244334936141968
epoch: 149, iter: 5079, loss: 0.46681347489356995, time cost3.944584369659424
epoch: 149, iter: 5080, loss: 0.4620371162891388, time cost3.4603447914123535
epoch: 149, iter: 5081, loss: 0.8368403315544128, time cost3.9745852947235107
epoch: 149, iter: 5082, loss: 0.6436430811882019, time cost4.004599094390869
epoch: 149, iter: 5083, loss: 0.8320218324661255, time cost3.966585874557495
epoch: 149, iter: 5084, loss: 0.815594494342804, time cost4.074460744857788
epoch: 149, iter: 5085, loss: 0.5826179385185242, time cost4.175191402435303
epoch: 149, iter: 5086, loss: 0.6793988347053528, time cost4.104363918304443
epoch: 149, iter: 5087, loss: 0.7851573824882507, time cost4.158819675445557
epoch: 149, iter: 5088, loss: 0.7771590352058411, time cost3.962862491607666
epoch: 149, iter: 5089, loss: 0.8722108602523804, time cost4.025293350219727
epoch: 149, iter: 5090, loss: 0.4380989968776703, time cost4.056724786758423
epoch: 149, iter: 5091, loss: 0.5754832029342651, time cost3.9862468242645264
epoch: 149, iter: 5092, loss: 0.6402371525764465, time cost4.006944417953491
epoch: 149, iter: 5093, loss: 0.908566415309906, time cost4.022737741470337
epoch: 149, iter: 5094, loss: 0.5961767435073853, time cost4.011220216751099
epoch: 149, iter: 5095, loss: 0.649760901927948, time cost3.9083781242370605
epoch: 149, iter: 5096, loss: 1.2369474172592163, time cost4.013213872909546
epoch: 149, iter: 5097, loss: 0.6757227182388306, time cost3.9770448207855225
epoch: 149, iter: 5098, loss: 0.7435492873191833, time cost3.9023337364196777
epoch: 149, iter: 5099, loss: 0.7369919419288635, time cost3.836977481842041
epoch: 149, iter: 5100, loss: 0.5309104323387146, time cost2.8298752307891846
tensor([[ 25.,  23.,  24.,  ...,   5.,   5.,   3.],
        [ 13.,  10.,  10.,  ...,  13.,  13.,  10.],
        [ 92., 245., 115.,  ...,   3.,   3.,   1.],
        ...,
        [ 90.,  83.,  70.,  ...,  20.,  20.,  10.],
        [ 23.,  13.,   6.,  ...,   1.,   1.,   1.],
        [148., 237., 240.,  ...,  13.,  13.,  16.]])
Epoch: 149, Iteration: 5100:
TEST A@1: 0.4822222222222222
TEST A@5: 0.82
TEST A@10: 0.9266666666666666
TEST M@B: 0.38684761717916444
TEST M@A: 0.9511434235310419
TEST W@MB: 0.2077554067716521
TEST W@MA: 0.5870373928741887
TEST Time: 560.0930075645447
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 150, iter: 5101, loss: 0.6667612791061401, time cost3.985957384109497
epoch: 150, iter: 5102, loss: 0.5592071413993835, time cost3.9957799911499023
epoch: 150, iter: 5103, loss: 0.9278161525726318, time cost3.9948277473449707
epoch: 150, iter: 5104, loss: 0.915058970451355, time cost4.017320394515991
epoch: 150, iter: 5105, loss: 1.4302425384521484, time cost3.982029676437378
epoch: 150, iter: 5106, loss: 1.283738136291504, time cost4.048844814300537
epoch: 150, iter: 5107, loss: 0.7588362693786621, time cost4.310256004333496
epoch: 150, iter: 5108, loss: 0.49704498052597046, time cost3.959719181060791
epoch: 150, iter: 5109, loss: 0.7519586086273193, time cost4.160478591918945
epoch: 150, iter: 5110, loss: 0.8734129071235657, time cost4.138023376464844
epoch: 150, iter: 5111, loss: 0.8285293579101562, time cost3.999596118927002
epoch: 150, iter: 5112, loss: 0.5673819184303284, time cost4.0854105949401855
epoch: 150, iter: 5113, loss: 0.7994158864021301, time cost4.063117027282715
epoch: 150, iter: 5114, loss: 1.0621111392974854, time cost4.13582444190979
epoch: 150, iter: 5115, loss: 0.6413397789001465, time cost4.151113748550415
epoch: 150, iter: 5116, loss: 0.7253525853157043, time cost4.155443906784058
epoch: 150, iter: 5117, loss: 0.6877049207687378, time cost4.098582983016968
epoch: 150, iter: 5118, loss: 1.0452066659927368, time cost4.128432273864746
epoch: 150, iter: 5119, loss: 0.8977788686752319, time cost4.023778438568115
epoch: 150, iter: 5120, loss: 0.417113333940506, time cost4.04534912109375
epoch: 150, iter: 5121, loss: 0.8833868503570557, time cost4.070860385894775
epoch: 150, iter: 5122, loss: 0.6737284660339355, time cost3.921043872833252
epoch: 150, iter: 5123, loss: 1.1202086210250854, time cost3.9498608112335205
epoch: 150, iter: 5124, loss: 1.2678828239440918, time cost4.070289134979248
epoch: 150, iter: 5125, loss: 0.8597654104232788, time cost4.121865749359131
epoch: 150, iter: 5126, loss: 0.6622604131698608, time cost4.116034507751465
epoch: 150, iter: 5127, loss: 0.9258290529251099, time cost4.017698526382446
epoch: 150, iter: 5128, loss: 0.6142832040786743, time cost3.9139015674591064
epoch: 150, iter: 5129, loss: 0.6334130167961121, time cost3.9614057540893555
epoch: 150, iter: 5130, loss: 0.8664069175720215, time cost4.121233224868774
epoch: 150, iter: 5131, loss: 0.8713976740837097, time cost4.053233861923218
epoch: 150, iter: 5132, loss: 0.7816055417060852, time cost3.8915274143218994
epoch: 150, iter: 5133, loss: 0.46925386786460876, time cost3.986213207244873
epoch: 150, iter: 5134, loss: 0.6306165456771851, time cost2.9257450103759766
epoch: 151, iter: 5135, loss: 0.7801938056945801, time cost4.125653266906738
epoch: 151, iter: 5136, loss: 0.43342217803001404, time cost4.18426251411438
epoch: 151, iter: 5137, loss: 0.5740253329277039, time cost4.268725633621216
epoch: 151, iter: 5138, loss: 0.8637857437133789, time cost4.0975377559661865
epoch: 151, iter: 5139, loss: 0.6307125687599182, time cost4.244792699813843
epoch: 151, iter: 5140, loss: 0.5456317663192749, time cost4.243437767028809
epoch: 151, iter: 5141, loss: 0.6182472705841064, time cost4.158534288406372
epoch: 151, iter: 5142, loss: 0.31268632411956787, time cost4.240975856781006
epoch: 151, iter: 5143, loss: 0.8836169838905334, time cost4.059074640274048
epoch: 151, iter: 5144, loss: 0.8924881219863892, time cost4.239934921264648
epoch: 151, iter: 5145, loss: 1.1569987535476685, time cost4.168845176696777
epoch: 151, iter: 5146, loss: 0.8545098900794983, time cost4.019581317901611
epoch: 151, iter: 5147, loss: 0.9290696382522583, time cost4.147251129150391
epoch: 151, iter: 5148, loss: 0.6699342131614685, time cost3.97928524017334
epoch: 151, iter: 5149, loss: 0.4731544554233551, time cost4.193832635879517
epoch: 151, iter: 5150, loss: 0.6607202887535095, time cost3.8512825965881348
tensor([[201., 153., 166.,  ...,   1.,   1.,   1.],
        [ 44.,  30.,  28.,  ...,   3.,   3.,   3.],
        [ 67., 192.,  54.,  ...,   3.,   3.,   2.],
        ...,
        [ 79.,  82.,  60.,  ...,  28.,  28.,  17.],
        [ 88.,  68.,   3.,  ...,   1.,   1.,   1.],
        [127., 195., 235.,  ...,   7.,   7.,  11.]])
Epoch: 151, Iteration: 5150:
TEST A@1: 0.4533333333333333
TEST A@5: 0.8266666666666667
TEST A@10: 0.92
TEST M@B: 0.385272640010839
TEST M@A: 0.9525063112286911
TEST W@MB: 0.20696232718372112
TEST W@MA: 0.588112550897793
TEST Time: 560.5677056312561
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 151, iter: 5151, loss: 0.7367104291915894, time cost4.026794910430908
epoch: 151, iter: 5152, loss: 0.5114037990570068, time cost3.9554812908172607
epoch: 151, iter: 5153, loss: 0.9514905214309692, time cost3.9846484661102295
epoch: 151, iter: 5154, loss: 0.4430842995643616, time cost4.043769836425781
epoch: 151, iter: 5155, loss: 0.6458413600921631, time cost3.997359275817871
epoch: 151, iter: 5156, loss: 0.5306003093719482, time cost3.9306838512420654
epoch: 151, iter: 5157, loss: 0.9083603024482727, time cost4.1363935470581055
epoch: 151, iter: 5158, loss: 1.1325949430465698, time cost4.084964036941528
epoch: 151, iter: 5159, loss: 0.7759665846824646, time cost4.0236217975616455
epoch: 151, iter: 5160, loss: 0.5558188557624817, time cost3.8439559936523438
epoch: 151, iter: 5161, loss: 0.3882196247577667, time cost3.971898317337036
epoch: 151, iter: 5162, loss: 0.7376754283905029, time cost4.09175443649292
epoch: 151, iter: 5163, loss: 1.0031912326812744, time cost4.016237020492554
epoch: 151, iter: 5164, loss: 1.058875560760498, time cost4.030525207519531
epoch: 151, iter: 5165, loss: 0.8772709369659424, time cost4.021665573120117
epoch: 151, iter: 5166, loss: 0.6443102955818176, time cost3.9230453968048096
epoch: 151, iter: 5167, loss: 0.7762750387191772, time cost3.9006690979003906
epoch: 151, iter: 5168, loss: 0.8382524251937866, time cost2.8373405933380127
epoch: 152, iter: 5169, loss: 0.7790984511375427, time cost4.077582597732544
epoch: 152, iter: 5170, loss: 0.9275920987129211, time cost4.017090082168579
epoch: 152, iter: 5171, loss: 0.6248511075973511, time cost4.038264989852905
epoch: 152, iter: 5172, loss: 0.47635817527770996, time cost4.033101797103882
epoch: 152, iter: 5173, loss: 1.3513283729553223, time cost4.332510471343994
epoch: 152, iter: 5174, loss: 0.26929694414138794, time cost4.10383415222168
epoch: 152, iter: 5175, loss: 1.2163395881652832, time cost3.9630305767059326
epoch: 152, iter: 5176, loss: 0.8349685072898865, time cost3.912534475326538
epoch: 152, iter: 5177, loss: 1.0954153537750244, time cost3.9529011249542236
epoch: 152, iter: 5178, loss: 0.5307417511940002, time cost4.197458267211914
epoch: 152, iter: 5179, loss: 0.5879002809524536, time cost4.129870653152466
epoch: 152, iter: 5180, loss: 0.5709050893783569, time cost4.014418363571167
epoch: 152, iter: 5181, loss: 0.752346396446228, time cost4.022768259048462
epoch: 152, iter: 5182, loss: 0.9644334316253662, time cost4.038511514663696
epoch: 152, iter: 5183, loss: 0.7992827296257019, time cost4.144798755645752
epoch: 152, iter: 5184, loss: 0.6558349132537842, time cost4.136470556259155
epoch: 152, iter: 5185, loss: 0.6081255078315735, time cost4.049577713012695
epoch: 152, iter: 5186, loss: 0.37197068333625793, time cost4.0163702964782715
epoch: 152, iter: 5187, loss: 0.5162373781204224, time cost3.9478182792663574
epoch: 152, iter: 5188, loss: 0.8993203639984131, time cost4.04828143119812
epoch: 152, iter: 5189, loss: 0.8753480315208435, time cost4.156931638717651
epoch: 152, iter: 5190, loss: 0.8403547406196594, time cost4.044320344924927
epoch: 152, iter: 5191, loss: 0.6482054591178894, time cost4.009278774261475
epoch: 152, iter: 5192, loss: 0.42622601985931396, time cost4.061790227890015
epoch: 152, iter: 5193, loss: 0.3594489097595215, time cost3.893665075302124
epoch: 152, iter: 5194, loss: 0.7133727073669434, time cost4.000734567642212
epoch: 152, iter: 5195, loss: 0.7886979579925537, time cost4.016268253326416
epoch: 152, iter: 5196, loss: 0.6403866410255432, time cost4.129570245742798
epoch: 152, iter: 5197, loss: 0.40161362290382385, time cost4.067696809768677
epoch: 152, iter: 5198, loss: 0.6431031823158264, time cost3.8894784450531006
epoch: 152, iter: 5199, loss: 0.7568798065185547, time cost4.003665924072266
epoch: 152, iter: 5200, loss: 0.5488283038139343, time cost3.9374406337738037
tensor([[197., 138., 141.,  ...,   6.,   6.,   2.],
        [ 84.,  59.,  55.,  ...,   7.,   7.,   6.],
        [113., 221., 142.,  ...,   9.,   9.,   4.],
        ...,
        [ 30.,  30.,  13.,  ...,  12.,  12.,  10.],
        [ 37.,  42.,   3.,  ...,   1.,   1.,   1.],
        [ 45.,  81.,  95.,  ...,   1.,   1.,   3.]])
Epoch: 152, Iteration: 5200:
TEST A@1: 0.5422222222222223
TEST A@5: 0.88
TEST A@10: 0.9311111111111111
TEST M@B: 0.4072959119287325
TEST M@A: 0.9520706339134495
TEST W@MB: 0.21711514924205852
TEST W@MA: 0.5873863751918639
TEST Time: 561.6505887508392
REAL performance: Top1: 0.5688888888888889, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.43783030635406034, MA: 0.9562582815808969, WMB: 0.2339932066988706, WMA: 0.5906805103165506
epoch: 152, iter: 5201, loss: 0.6433586478233337, time cost4.009782075881958
epoch: 152, iter: 5202, loss: 0.5026853084564209, time cost2.845390796661377
epoch: 153, iter: 5203, loss: 0.4886046350002289, time cost4.083573579788208
epoch: 153, iter: 5204, loss: 0.7152474522590637, time cost4.043699026107788
epoch: 153, iter: 5205, loss: 0.5159119963645935, time cost3.911200523376465
epoch: 153, iter: 5206, loss: 0.7265941500663757, time cost4.122050523757935
epoch: 153, iter: 5207, loss: 0.6697297096252441, time cost4.029521942138672
epoch: 153, iter: 5208, loss: 1.6376172304153442, time cost3.914545774459839
epoch: 153, iter: 5209, loss: 0.7022210359573364, time cost3.8891165256500244
epoch: 153, iter: 5210, loss: 0.6094846725463867, time cost3.9754638671875
epoch: 153, iter: 5211, loss: 0.6509042978286743, time cost4.0061354637146
epoch: 153, iter: 5212, loss: 1.1297589540481567, time cost4.037038803100586
epoch: 153, iter: 5213, loss: 0.6672704815864563, time cost4.027352809906006
epoch: 153, iter: 5214, loss: 0.8165634870529175, time cost3.9692163467407227
epoch: 153, iter: 5215, loss: 1.1767151355743408, time cost4.056971549987793
epoch: 153, iter: 5216, loss: 0.7140935659408569, time cost4.039033651351929
epoch: 153, iter: 5217, loss: 0.747799277305603, time cost3.9431240558624268
epoch: 153, iter: 5218, loss: 0.6015740036964417, time cost3.956592559814453
epoch: 153, iter: 5219, loss: 0.8253694772720337, time cost4.030089378356934
epoch: 153, iter: 5220, loss: 0.6251968741416931, time cost3.8859262466430664
epoch: 153, iter: 5221, loss: 0.5080750584602356, time cost3.9771931171417236
epoch: 153, iter: 5222, loss: 1.2741055488586426, time cost3.8778769969940186
epoch: 153, iter: 5223, loss: 0.6021611094474792, time cost4.051174640655518
epoch: 153, iter: 5224, loss: 0.9939925670623779, time cost3.9187262058258057
epoch: 153, iter: 5225, loss: 0.691137433052063, time cost4.073038578033447
epoch: 153, iter: 5226, loss: 0.4401254951953888, time cost4.146524906158447
epoch: 153, iter: 5227, loss: 1.284589409828186, time cost3.9488558769226074
epoch: 153, iter: 5228, loss: 0.6614716053009033, time cost3.989619493484497
epoch: 153, iter: 5229, loss: 0.7746511697769165, time cost3.9342777729034424
epoch: 153, iter: 5230, loss: 0.5537433624267578, time cost3.98667573928833
epoch: 153, iter: 5231, loss: 0.4331437647342682, time cost3.9271554946899414
epoch: 153, iter: 5232, loss: 0.5395228266716003, time cost3.963536262512207
epoch: 153, iter: 5233, loss: 0.7172338962554932, time cost3.8996870517730713
epoch: 153, iter: 5234, loss: 1.077910304069519, time cost4.084105014801025
epoch: 153, iter: 5235, loss: 0.8185891509056091, time cost3.9587860107421875
epoch: 153, iter: 5236, loss: 0.8231860995292664, time cost2.815120220184326
epoch: 154, iter: 5237, loss: 0.6635541915893555, time cost4.073853015899658
epoch: 154, iter: 5238, loss: 0.8380165100097656, time cost4.107820987701416
epoch: 154, iter: 5239, loss: 0.5122913718223572, time cost4.071474313735962
epoch: 154, iter: 5240, loss: 0.8474531769752502, time cost4.0321409702301025
epoch: 154, iter: 5241, loss: 0.7937510013580322, time cost4.07925820350647
epoch: 154, iter: 5242, loss: 0.7030367255210876, time cost4.0220046043396
epoch: 154, iter: 5243, loss: 0.8406781554222107, time cost3.965453863143921
epoch: 154, iter: 5244, loss: 0.6404513716697693, time cost4.091510057449341
epoch: 154, iter: 5245, loss: 0.5826261043548584, time cost4.043968200683594
epoch: 154, iter: 5246, loss: 1.352932333946228, time cost3.980832099914551
epoch: 154, iter: 5247, loss: 0.340922087430954, time cost3.98885440826416
epoch: 154, iter: 5248, loss: 0.7014428377151489, time cost4.029537677764893
epoch: 154, iter: 5249, loss: 0.7283914685249329, time cost4.017021179199219
epoch: 154, iter: 5250, loss: 0.8299066424369812, time cost4.081085681915283
tensor([[ 18.,  14.,  17.,  ...,   2.,   2.,   1.],
        [ 15.,  16.,  14.,  ...,  10.,  10.,   8.],
        [ 77., 184.,  89.,  ...,   1.,   1.,   1.],
        ...,
        [ 26.,  29.,  14.,  ...,   8.,   8.,   6.],
        [ 31.,  33.,  12.,  ...,   1.,   1.,   1.],
        [ 33.,  95., 103.,  ...,   5.,   5.,   7.]])
Epoch: 154, Iteration: 5250:
TEST A@1: 0.5533333333333333
TEST A@5: 0.8933333333333333
TEST A@10: 0.9533333333333334
TEST M@B: 0.4397689329167464
TEST M@A: 0.9601156014365011
TEST W@MB: 0.23669329359899205
TEST W@MA: 0.5939621694253282
TEST Time: 560.3641664981842
Model Updated
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 154, iter: 5251, loss: 0.5838230848312378, time cost4.027380704879761
epoch: 154, iter: 5252, loss: 1.1120935678482056, time cost4.03121280670166
epoch: 154, iter: 5253, loss: 0.9361311793327332, time cost3.8560502529144287
epoch: 154, iter: 5254, loss: 0.6333473324775696, time cost4.097420692443848
epoch: 154, iter: 5255, loss: 0.6293590068817139, time cost3.9429776668548584
epoch: 154, iter: 5256, loss: 0.31253671646118164, time cost4.0487284660339355
epoch: 154, iter: 5257, loss: 1.0733816623687744, time cost4.0826873779296875
epoch: 154, iter: 5258, loss: 0.3496110737323761, time cost3.9155681133270264
epoch: 154, iter: 5259, loss: 0.7738969326019287, time cost4.220660209655762
epoch: 154, iter: 5260, loss: 1.2835956811904907, time cost4.007532358169556
epoch: 154, iter: 5261, loss: 0.7466257214546204, time cost4.083917140960693
epoch: 154, iter: 5262, loss: 1.011894702911377, time cost4.014429569244385
epoch: 154, iter: 5263, loss: 0.5589852333068848, time cost4.045516490936279
epoch: 154, iter: 5264, loss: 0.7045016288757324, time cost4.018015623092651
epoch: 154, iter: 5265, loss: 0.5087833404541016, time cost4.066039562225342
epoch: 154, iter: 5266, loss: 0.7481226921081543, time cost3.9476161003112793
epoch: 154, iter: 5267, loss: 0.5002750158309937, time cost3.7797932624816895
epoch: 154, iter: 5268, loss: 1.065886378288269, time cost4.132292032241821
epoch: 154, iter: 5269, loss: 0.40494871139526367, time cost4.105105400085449
epoch: 154, iter: 5270, loss: 0.5555064082145691, time cost3.113811731338501
epoch: 155, iter: 5271, loss: 0.5354739427566528, time cost3.97511625289917
epoch: 155, iter: 5272, loss: 0.3646541237831116, time cost4.0395355224609375
epoch: 155, iter: 5273, loss: 1.1620311737060547, time cost3.970261335372925
epoch: 155, iter: 5274, loss: 0.903660237789154, time cost3.934770345687866
epoch: 155, iter: 5275, loss: 0.6071419715881348, time cost4.086122274398804
epoch: 155, iter: 5276, loss: 1.0565202236175537, time cost4.020704984664917
epoch: 155, iter: 5277, loss: 0.47249364852905273, time cost4.094583988189697
epoch: 155, iter: 5278, loss: 0.6061229705810547, time cost4.022672176361084
epoch: 155, iter: 5279, loss: 0.5748519897460938, time cost4.246352910995483
epoch: 155, iter: 5280, loss: 1.0910474061965942, time cost3.9651901721954346
epoch: 155, iter: 5281, loss: 1.1158097982406616, time cost4.0699989795684814
epoch: 155, iter: 5282, loss: 0.5228477716445923, time cost4.013618469238281
epoch: 155, iter: 5283, loss: 0.8976210951805115, time cost4.100934743881226
epoch: 155, iter: 5284, loss: 0.6290072202682495, time cost3.9073033332824707
epoch: 155, iter: 5285, loss: 0.6522729396820068, time cost4.0705976486206055
epoch: 155, iter: 5286, loss: 1.1344990730285645, time cost3.89595365524292
epoch: 155, iter: 5287, loss: 0.3510280251502991, time cost3.9742071628570557
epoch: 155, iter: 5288, loss: 1.1986900568008423, time cost3.9321627616882324
epoch: 155, iter: 5289, loss: 0.9929207563400269, time cost4.0468995571136475
epoch: 155, iter: 5290, loss: 0.5310919880867004, time cost3.8691935539245605
epoch: 155, iter: 5291, loss: 0.5229707956314087, time cost3.9974822998046875
epoch: 155, iter: 5292, loss: 0.6062033176422119, time cost3.989804744720459
epoch: 155, iter: 5293, loss: 0.4339182674884796, time cost3.9722611904144287
epoch: 155, iter: 5294, loss: 1.0804692506790161, time cost4.01009202003479
epoch: 155, iter: 5295, loss: 1.0566502809524536, time cost4.081176280975342
epoch: 155, iter: 5296, loss: 0.5378543734550476, time cost3.9517509937286377
epoch: 155, iter: 5297, loss: 0.37882980704307556, time cost3.878589391708374
epoch: 155, iter: 5298, loss: 0.6736632585525513, time cost3.8990323543548584
epoch: 155, iter: 5299, loss: 0.7723398208618164, time cost3.535161256790161
epoch: 155, iter: 5300, loss: 0.6072047352790833, time cost3.394887924194336
tensor([[ 60.,  51.,  66.,  ...,   1.,   1.,   1.],
        [ 36.,  26.,  29.,  ...,  11.,  11.,   9.],
        [ 48., 182.,  70.,  ...,   1.,   1.,   1.],
        ...,
        [ 82.,  79.,  55.,  ...,  14.,  14.,   8.],
        [ 41.,  43.,   8.,  ...,   1.,   1.,   1.],
        [ 37.,  93., 105.,  ...,   1.,   1.,   2.]])
Epoch: 155, Iteration: 5300:
TEST A@1: 0.54
TEST A@5: 0.8955555555555555
TEST A@10: 0.96
TEST M@B: 0.4271576021560053
TEST M@A: 0.9582877654699637
TEST W@MB: 0.2290102545540007
TEST W@MA: 0.5925011391070567
TEST Time: 568.0876498222351
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 155, iter: 5301, loss: 0.42066681385040283, time cost4.191673755645752
epoch: 155, iter: 5302, loss: 0.5744753479957581, time cost4.324474573135376
epoch: 155, iter: 5303, loss: 1.1576911211013794, time cost4.388117074966431
epoch: 155, iter: 5304, loss: 0.6256128549575806, time cost3.1784768104553223
epoch: 156, iter: 5305, loss: 0.3809264600276947, time cost4.467120885848999
epoch: 156, iter: 5306, loss: 1.5196430683135986, time cost4.456633806228638
epoch: 156, iter: 5307, loss: 0.7787191271781921, time cost4.428265571594238
epoch: 156, iter: 5308, loss: 1.0008383989334106, time cost4.4347381591796875
epoch: 156, iter: 5309, loss: 0.5856741666793823, time cost4.3661229610443115
epoch: 156, iter: 5310, loss: 0.9718475341796875, time cost4.495612144470215
epoch: 156, iter: 5311, loss: 0.5568839311599731, time cost4.008595705032349
epoch: 156, iter: 5312, loss: 0.7356157898902893, time cost3.3574330806732178
epoch: 156, iter: 5313, loss: 0.6298419237136841, time cost4.159408807754517
epoch: 156, iter: 5314, loss: 0.7844309210777283, time cost4.0931596755981445
epoch: 156, iter: 5315, loss: 0.4166799783706665, time cost4.2088751792907715
epoch: 156, iter: 5316, loss: 0.8993956446647644, time cost3.999803304672241
epoch: 156, iter: 5317, loss: 0.5756155252456665, time cost3.9529926776885986
epoch: 156, iter: 5318, loss: 0.8357224464416504, time cost4.189731597900391
epoch: 156, iter: 5319, loss: 1.2235546112060547, time cost4.167365789413452
epoch: 156, iter: 5320, loss: 0.6351926326751709, time cost4.19962215423584
epoch: 156, iter: 5321, loss: 0.644676685333252, time cost4.09335732460022
epoch: 156, iter: 5322, loss: 0.5962671637535095, time cost4.066815614700317
epoch: 156, iter: 5323, loss: 0.7472335696220398, time cost4.005699396133423
epoch: 156, iter: 5324, loss: 0.6001346707344055, time cost4.062886476516724
epoch: 156, iter: 5325, loss: 0.5338086485862732, time cost4.197811841964722
epoch: 156, iter: 5326, loss: 1.1415475606918335, time cost4.041800260543823
epoch: 156, iter: 5327, loss: 0.5386577844619751, time cost4.1633241176605225
epoch: 156, iter: 5328, loss: 0.6671523451805115, time cost4.00090765953064
epoch: 156, iter: 5329, loss: 1.2392113208770752, time cost4.15580940246582
epoch: 156, iter: 5330, loss: 0.5654922723770142, time cost4.04024076461792
epoch: 156, iter: 5331, loss: 1.4829603433609009, time cost4.084582567214966
epoch: 156, iter: 5332, loss: 0.8636601567268372, time cost4.079753398895264
epoch: 156, iter: 5333, loss: 1.070986032485962, time cost3.994556188583374
epoch: 156, iter: 5334, loss: 0.6105440855026245, time cost3.9548022747039795
epoch: 156, iter: 5335, loss: 0.9280662536621094, time cost4.03868556022644
epoch: 156, iter: 5336, loss: 0.5332213640213013, time cost4.040143013000488
epoch: 156, iter: 5337, loss: 1.006460428237915, time cost3.933223247528076
epoch: 156, iter: 5338, loss: 0.6342275142669678, time cost2.7444891929626465
epoch: 157, iter: 5339, loss: 0.7522132396697998, time cost4.101479530334473
epoch: 157, iter: 5340, loss: 0.6130967140197754, time cost4.079070806503296
epoch: 157, iter: 5341, loss: 1.119957685470581, time cost4.133348703384399
epoch: 157, iter: 5342, loss: 0.5547567009925842, time cost4.12394905090332
epoch: 157, iter: 5343, loss: 0.4997515380382538, time cost4.075291633605957
epoch: 157, iter: 5344, loss: 0.763014554977417, time cost3.99668025970459
epoch: 157, iter: 5345, loss: 0.6145106554031372, time cost4.168515205383301
epoch: 157, iter: 5346, loss: 0.5629444718360901, time cost3.995126962661743
epoch: 157, iter: 5347, loss: 0.8029622435569763, time cost3.935692071914673
epoch: 157, iter: 5348, loss: 0.7544693946838379, time cost4.169813871383667
epoch: 157, iter: 5349, loss: 1.4239542484283447, time cost4.0144407749176025
epoch: 157, iter: 5350, loss: 0.9272377490997314, time cost4.005757093429565
tensor([[ 92.,  70.,  69.,  ...,   2.,   2.,   2.],
        [ 41.,  26.,  28.,  ...,  13.,  13.,   8.],
        [ 51., 155.,  84.,  ...,   1.,   1.,   1.],
        ...,
        [ 67.,  66.,  43.,  ...,   6.,   6.,   2.],
        [ 60.,  45.,   8.,  ...,   1.,   1.,   1.],
        [ 27.,  98.,  88.,  ...,   2.,   2.,   3.]])
Epoch: 157, Iteration: 5350:
TEST A@1: 0.49777777777777776
TEST A@5: 0.8733333333333333
TEST A@10: 0.9511111111111111
TEST M@B: 0.39806308656435685
TEST M@A: 0.9545107654386998
TEST W@MB: 0.21324372204115286
TEST W@MA: 0.5893969678932596
TEST Time: 554.2070269584656
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 157, iter: 5351, loss: 0.6917468905448914, time cost3.9634580612182617
epoch: 157, iter: 5352, loss: 0.7785021662712097, time cost3.9764461517333984
epoch: 157, iter: 5353, loss: 0.36286792159080505, time cost3.8425376415252686
epoch: 157, iter: 5354, loss: 0.49974197149276733, time cost4.067856311798096
epoch: 157, iter: 5355, loss: 0.6329779028892517, time cost4.209184408187866
epoch: 157, iter: 5356, loss: 0.6592086553573608, time cost4.1651835441589355
epoch: 157, iter: 5357, loss: 0.6685038805007935, time cost4.055856227874756
epoch: 157, iter: 5358, loss: 0.5588820576667786, time cost3.9630725383758545
epoch: 157, iter: 5359, loss: 1.059973120689392, time cost3.8932082653045654
epoch: 157, iter: 5360, loss: 1.0372374057769775, time cost3.9843623638153076
epoch: 157, iter: 5361, loss: 0.5601980686187744, time cost4.018555164337158
epoch: 157, iter: 5362, loss: 0.8235637545585632, time cost4.125717878341675
epoch: 157, iter: 5363, loss: 0.9215961694717407, time cost4.1181066036224365
epoch: 157, iter: 5364, loss: 1.0084811449050903, time cost4.094271421432495
epoch: 157, iter: 5365, loss: 0.7946664094924927, time cost4.071022033691406
epoch: 157, iter: 5366, loss: 1.2537574768066406, time cost4.135296821594238
epoch: 157, iter: 5367, loss: 0.46512115001678467, time cost3.9755148887634277
epoch: 157, iter: 5368, loss: 0.3160373866558075, time cost3.8250467777252197
epoch: 157, iter: 5369, loss: 0.6498345732688904, time cost3.9036498069763184
epoch: 157, iter: 5370, loss: 0.8310208320617676, time cost4.0536298751831055
epoch: 157, iter: 5371, loss: 0.8391729593276978, time cost4.111181974411011
epoch: 157, iter: 5372, loss: 0.42990434169769287, time cost2.8916165828704834
epoch: 158, iter: 5373, loss: 0.9418006539344788, time cost4.144986629486084
epoch: 158, iter: 5374, loss: 0.5584790706634521, time cost4.0078980922698975
epoch: 158, iter: 5375, loss: 0.7474105954170227, time cost4.073451995849609
epoch: 158, iter: 5376, loss: 0.7895324230194092, time cost4.21377420425415
epoch: 158, iter: 5377, loss: 0.629855751991272, time cost4.155731439590454
epoch: 158, iter: 5378, loss: 0.8822081685066223, time cost3.988571882247925
epoch: 158, iter: 5379, loss: 0.6280089020729065, time cost3.9866831302642822
epoch: 158, iter: 5380, loss: 1.02041757106781, time cost4.108381509780884
epoch: 158, iter: 5381, loss: 1.1249518394470215, time cost4.040932655334473
epoch: 158, iter: 5382, loss: 0.7013681530952454, time cost4.163313150405884
epoch: 158, iter: 5383, loss: 0.8375556468963623, time cost4.049047470092773
epoch: 158, iter: 5384, loss: 1.1856276988983154, time cost4.009142160415649
epoch: 158, iter: 5385, loss: 0.9303756356239319, time cost3.984025001525879
epoch: 158, iter: 5386, loss: 0.6906352043151855, time cost3.9762589931488037
epoch: 158, iter: 5387, loss: 1.0396627187728882, time cost4.175731182098389
epoch: 158, iter: 5388, loss: 0.36853036284446716, time cost3.930764675140381
epoch: 158, iter: 5389, loss: 0.4677324891090393, time cost4.091250896453857
epoch: 158, iter: 5390, loss: 0.9446136355400085, time cost3.9787650108337402
epoch: 158, iter: 5391, loss: 0.46665775775909424, time cost4.004155397415161
epoch: 158, iter: 5392, loss: 0.5426597595214844, time cost4.101197242736816
epoch: 158, iter: 5393, loss: 1.1949570178985596, time cost3.972417116165161
epoch: 158, iter: 5394, loss: 1.1183701753616333, time cost3.9477179050445557
epoch: 158, iter: 5395, loss: 0.7472429871559143, time cost4.0390331745147705
epoch: 158, iter: 5396, loss: 0.5961484909057617, time cost3.996565818786621
epoch: 158, iter: 5397, loss: 0.6090967059135437, time cost4.151357889175415
epoch: 158, iter: 5398, loss: 0.9099015593528748, time cost4.0307536125183105
epoch: 158, iter: 5399, loss: 0.7541397213935852, time cost4.158050060272217
epoch: 158, iter: 5400, loss: 0.7622831463813782, time cost4.043511152267456
tensor([[ 71.,  60.,  72.,  ...,   1.,   1.,   1.],
        [ 31.,  26.,  26.,  ...,   9.,   9.,   6.],
        [ 59., 141.,  67.,  ...,   5.,   5.,   1.],
        ...,
        [ 59.,  57.,  39.,  ...,   8.,   8.,   4.],
        [ 14.,  15.,   3.,  ...,   1.,   1.,   1.],
        [ 93., 180., 224.,  ...,   4.,   4.,   5.]])
Epoch: 158, Iteration: 5400:
TEST A@1: 0.5288888888888889
TEST A@5: 0.8755555555555555
TEST A@10: 0.9533333333333334
TEST M@B: 0.4273155677235872
TEST M@A: 0.9571289998060315
TEST W@MB: 0.2301609085688579
TEST W@MA: 0.5914753591188523
TEST Time: 556.1684646606445
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 158, iter: 5401, loss: 0.9124776721000671, time cost3.9285318851470947
epoch: 158, iter: 5402, loss: 0.8786522150039673, time cost3.9721741676330566
epoch: 158, iter: 5403, loss: 1.1291069984436035, time cost3.885080099105835
epoch: 158, iter: 5404, loss: 0.6245145797729492, time cost3.9859087467193604
epoch: 158, iter: 5405, loss: 0.5409479737281799, time cost3.9412009716033936
epoch: 158, iter: 5406, loss: 0.8597532510757446, time cost2.788416862487793
epoch: 159, iter: 5407, loss: 0.36257725954055786, time cost4.038424730300903
epoch: 159, iter: 5408, loss: 0.864527702331543, time cost4.029747009277344
epoch: 159, iter: 5409, loss: 0.5207929611206055, time cost4.022022008895874
epoch: 159, iter: 5410, loss: 0.9231888055801392, time cost4.07969331741333
epoch: 159, iter: 5411, loss: 1.2965909242630005, time cost4.106971740722656
epoch: 159, iter: 5412, loss: 0.5068950057029724, time cost4.047299385070801
epoch: 159, iter: 5413, loss: 0.9898084998130798, time cost4.162520170211792
epoch: 159, iter: 5414, loss: 0.6119599342346191, time cost3.9332492351531982
epoch: 159, iter: 5415, loss: 1.194494605064392, time cost3.9506173133850098
epoch: 159, iter: 5416, loss: 0.7431920170783997, time cost4.135344982147217
epoch: 159, iter: 5417, loss: 0.6595163941383362, time cost4.023099422454834
epoch: 159, iter: 5418, loss: 0.8086994290351868, time cost4.174665927886963
epoch: 159, iter: 5419, loss: 0.813800036907196, time cost4.314245223999023
epoch: 159, iter: 5420, loss: 0.8564944267272949, time cost4.171168565750122
epoch: 159, iter: 5421, loss: 0.45318275690078735, time cost4.08970832824707
epoch: 159, iter: 5422, loss: 0.8203174471855164, time cost4.102856636047363
epoch: 159, iter: 5423, loss: 1.154952883720398, time cost4.052952289581299
epoch: 159, iter: 5424, loss: 0.7662138342857361, time cost4.063622236251831
epoch: 159, iter: 5425, loss: 0.8766329884529114, time cost3.96165132522583
epoch: 159, iter: 5426, loss: 0.7936984300613403, time cost4.059510707855225
epoch: 159, iter: 5427, loss: 0.9298368692398071, time cost4.025355100631714
epoch: 159, iter: 5428, loss: 0.6452412605285645, time cost4.067883729934692
epoch: 159, iter: 5429, loss: 1.2770397663116455, time cost4.064206123352051
epoch: 159, iter: 5430, loss: 0.7666853070259094, time cost4.07653021812439
epoch: 159, iter: 5431, loss: 0.6139018535614014, time cost3.9130184650421143
epoch: 159, iter: 5432, loss: 0.7312799692153931, time cost3.941861867904663
epoch: 159, iter: 5433, loss: 0.7432224154472351, time cost4.065141916275024
epoch: 159, iter: 5434, loss: 0.852931022644043, time cost4.111456394195557
epoch: 159, iter: 5435, loss: 0.6341093182563782, time cost4.015870094299316
epoch: 159, iter: 5436, loss: 0.6057497262954712, time cost3.9265925884246826
epoch: 159, iter: 5437, loss: 0.9056020379066467, time cost4.032665491104126
epoch: 159, iter: 5438, loss: 1.1767845153808594, time cost4.072411298751831
epoch: 159, iter: 5439, loss: 0.706188976764679, time cost3.9077670574188232
epoch: 159, iter: 5440, loss: 0.5368996262550354, time cost2.917717695236206
epoch: 160, iter: 5441, loss: 0.6297833919525146, time cost4.210914850234985
epoch: 160, iter: 5442, loss: 0.6632224917411804, time cost4.014583349227905
epoch: 160, iter: 5443, loss: 0.8756513595581055, time cost3.943777084350586
epoch: 160, iter: 5444, loss: 1.0757627487182617, time cost3.948505163192749
epoch: 160, iter: 5445, loss: 0.4009512960910797, time cost4.0852131843566895
epoch: 160, iter: 5446, loss: 0.6221902966499329, time cost4.022876977920532
epoch: 160, iter: 5447, loss: 1.0357407331466675, time cost4.103381633758545
epoch: 160, iter: 5448, loss: 0.40591520071029663, time cost3.970846176147461
epoch: 160, iter: 5449, loss: 0.6097753643989563, time cost4.099577188491821
epoch: 160, iter: 5450, loss: 1.027321219444275, time cost4.066539287567139
tensor([[ 92.,  59.,  64.,  ...,   1.,   1.,   1.],
        [ 46.,  46.,  45.,  ...,  16.,  16.,   8.],
        [ 68., 139.,  56.,  ...,   4.,   4.,   3.],
        ...,
        [ 40.,  39.,  29.,  ...,  10.,  10.,   5.],
        [ 25.,  27.,   2.,  ...,   1.,   1.,   1.],
        [ 33.,  83., 113.,  ...,   3.,   3.,   4.]])
Epoch: 160, Iteration: 5450:
TEST A@1: 0.48444444444444446
TEST A@5: 0.8133333333333334
TEST A@10: 0.8844444444444445
TEST M@B: 0.3900104688057723
TEST M@A: 0.9518849656778638
TEST W@MB: 0.2093938362293124
TEST W@MA: 0.5880445500730899
TEST Time: 558.6068534851074
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 160, iter: 5451, loss: 0.8753290772438049, time cost4.059042930603027
epoch: 160, iter: 5452, loss: 0.36199405789375305, time cost3.9191949367523193
epoch: 160, iter: 5453, loss: 0.6168020367622375, time cost4.033069133758545
epoch: 160, iter: 5454, loss: 0.6647894978523254, time cost4.103645086288452
epoch: 160, iter: 5455, loss: 1.1188404560089111, time cost4.176591634750366
epoch: 160, iter: 5456, loss: 1.7906951904296875, time cost3.9041621685028076
epoch: 160, iter: 5457, loss: 0.8126735091209412, time cost4.201953887939453
epoch: 160, iter: 5458, loss: 0.9086335301399231, time cost4.1308863162994385
epoch: 160, iter: 5459, loss: 0.8571720123291016, time cost3.9144511222839355
epoch: 160, iter: 5460, loss: 1.5730154514312744, time cost4.105118274688721
epoch: 160, iter: 5461, loss: 0.993268609046936, time cost4.03960394859314
epoch: 160, iter: 5462, loss: 0.4704301357269287, time cost4.104281902313232
epoch: 160, iter: 5463, loss: 0.5703853368759155, time cost4.125438690185547
epoch: 160, iter: 5464, loss: 0.9727261662483215, time cost4.127917528152466
epoch: 160, iter: 5465, loss: 0.8444986939430237, time cost3.9994239807128906
epoch: 160, iter: 5466, loss: 1.1333353519439697, time cost3.9624810218811035
epoch: 160, iter: 5467, loss: 1.1172350645065308, time cost4.009989023208618
epoch: 160, iter: 5468, loss: 0.6162590384483337, time cost4.3394880294799805
epoch: 160, iter: 5469, loss: 0.7274555563926697, time cost4.120185136795044
epoch: 160, iter: 5470, loss: 0.8611619472503662, time cost3.8595218658447266
epoch: 160, iter: 5471, loss: 0.8639078140258789, time cost3.9797048568725586
epoch: 160, iter: 5472, loss: 0.8307547569274902, time cost4.050961971282959
epoch: 160, iter: 5473, loss: 0.6771417260169983, time cost4.059392929077148
epoch: 160, iter: 5474, loss: 0.3916201591491699, time cost2.7218785285949707
epoch: 161, iter: 5475, loss: 1.081912875175476, time cost4.051189184188843
epoch: 161, iter: 5476, loss: 0.546993613243103, time cost3.961652994155884
epoch: 161, iter: 5477, loss: 0.849002480506897, time cost4.027221918106079
epoch: 161, iter: 5478, loss: 0.5921902656555176, time cost4.214618921279907
epoch: 161, iter: 5479, loss: 0.8228480219841003, time cost4.262634992599487
epoch: 161, iter: 5480, loss: 0.42069774866104126, time cost3.9611353874206543
epoch: 161, iter: 5481, loss: 0.8685731291770935, time cost4.012520790100098
epoch: 161, iter: 5482, loss: 0.6336466670036316, time cost4.057117700576782
epoch: 161, iter: 5483, loss: 0.661252498626709, time cost4.075091361999512
epoch: 161, iter: 5484, loss: 0.5109154582023621, time cost3.9936816692352295
epoch: 161, iter: 5485, loss: 0.6721665859222412, time cost3.9449241161346436
epoch: 161, iter: 5486, loss: 0.7252423763275146, time cost4.02853536605835
epoch: 161, iter: 5487, loss: 0.5996913909912109, time cost4.009155035018921
epoch: 161, iter: 5488, loss: 0.468913733959198, time cost3.9432876110076904
epoch: 161, iter: 5489, loss: 0.6983909010887146, time cost3.9807889461517334
epoch: 161, iter: 5490, loss: 0.8182252645492554, time cost4.096219539642334
epoch: 161, iter: 5491, loss: 0.619796633720398, time cost4.062391757965088
epoch: 161, iter: 5492, loss: 0.9684776067733765, time cost3.949334144592285
epoch: 161, iter: 5493, loss: 0.6509474515914917, time cost4.034684419631958
epoch: 161, iter: 5494, loss: 0.6112078428268433, time cost4.040743827819824
epoch: 161, iter: 5495, loss: 0.579839289188385, time cost3.9894981384277344
epoch: 161, iter: 5496, loss: 0.8276652693748474, time cost3.931562662124634
epoch: 161, iter: 5497, loss: 0.728074848651886, time cost4.055370569229126
epoch: 161, iter: 5498, loss: 0.5518249869346619, time cost4.0589659214019775
epoch: 161, iter: 5499, loss: 0.6912409067153931, time cost3.9544520378112793
epoch: 161, iter: 5500, loss: 0.8924617767333984, time cost3.988370895385742
tensor([[ 36.,  20.,  25.,  ...,   2.,   2.,   2.],
        [ 35.,  36.,  33.,  ...,   8.,   8.,   5.],
        [212., 359., 199.,  ...,   8.,   8.,   4.],
        ...,
        [ 46.,  41.,  21.,  ...,  14.,  14.,  16.],
        [ 23.,  22.,   1.,  ...,   1.,   1.,   1.],
        [ 65., 144., 149.,  ...,   2.,   2.,   3.]])
Epoch: 161, Iteration: 5500:
TEST A@1: 0.45111111111111113
TEST A@5: 0.8288888888888889
TEST A@10: 0.9288888888888889
TEST M@B: 0.38743819496774756
TEST M@A: 0.9537315381953403
TEST W@MB: 0.20757364486868116
TEST W@MA: 0.589032729851887
TEST Time: 554.1827988624573
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 161, iter: 5501, loss: 0.7356475591659546, time cost3.864149570465088
epoch: 161, iter: 5502, loss: 0.9930952787399292, time cost3.8362936973571777
epoch: 161, iter: 5503, loss: 0.6706858277320862, time cost3.169339656829834
epoch: 161, iter: 5504, loss: 0.813434898853302, time cost3.3639965057373047
epoch: 161, iter: 5505, loss: 0.4590720236301422, time cost3.6133546829223633
epoch: 161, iter: 5506, loss: 0.647127091884613, time cost4.233455657958984
epoch: 161, iter: 5507, loss: 0.8086318969726562, time cost4.278722286224365
epoch: 161, iter: 5508, loss: 0.2812623083591461, time cost2.958184242248535
epoch: 162, iter: 5509, loss: 1.1745413541793823, time cost4.144588232040405
epoch: 162, iter: 5510, loss: 0.9105890393257141, time cost4.488290786743164
epoch: 162, iter: 5511, loss: 0.9055262207984924, time cost4.394133567810059
epoch: 162, iter: 5512, loss: 0.9910269975662231, time cost4.261740684509277
epoch: 162, iter: 5513, loss: 0.6783533096313477, time cost4.283043622970581
epoch: 162, iter: 5514, loss: 0.9266184568405151, time cost4.359194755554199
epoch: 162, iter: 5515, loss: 0.9677004218101501, time cost4.436331272125244
epoch: 162, iter: 5516, loss: 0.6656192541122437, time cost4.4332780838012695
epoch: 162, iter: 5517, loss: 0.9218330979347229, time cost4.357102870941162
epoch: 162, iter: 5518, loss: 1.400550365447998, time cost4.481906890869141
epoch: 162, iter: 5519, loss: 0.497008740901947, time cost4.294210195541382
epoch: 162, iter: 5520, loss: 0.5475562214851379, time cost4.437490940093994
epoch: 162, iter: 5521, loss: 1.012265920639038, time cost4.347141265869141
epoch: 162, iter: 5522, loss: 0.5520610809326172, time cost4.250109434127808
epoch: 162, iter: 5523, loss: 0.8297135829925537, time cost4.237848281860352
epoch: 162, iter: 5524, loss: 0.6320325136184692, time cost4.300069570541382
epoch: 162, iter: 5525, loss: 1.1592079401016235, time cost4.597069501876831
epoch: 162, iter: 5526, loss: 0.5706427693367004, time cost4.099715948104858
epoch: 162, iter: 5527, loss: 0.8842952251434326, time cost4.40758204460144
epoch: 162, iter: 5528, loss: 0.9318196773529053, time cost4.3226423263549805
epoch: 162, iter: 5529, loss: 0.49313974380493164, time cost4.275212526321411
epoch: 162, iter: 5530, loss: 0.7427924871444702, time cost4.499916076660156
epoch: 162, iter: 5531, loss: 0.4400807321071625, time cost4.188597917556763
epoch: 162, iter: 5532, loss: 0.7284467816352844, time cost4.22677206993103
epoch: 162, iter: 5533, loss: 1.025608777999878, time cost4.3270697593688965
epoch: 162, iter: 5534, loss: 0.7487356066703796, time cost4.264941930770874
epoch: 162, iter: 5535, loss: 0.8969972729682922, time cost4.256138324737549
epoch: 162, iter: 5536, loss: 1.287855625152588, time cost4.147917032241821
epoch: 162, iter: 5537, loss: 0.6693487167358398, time cost4.1494832038879395
epoch: 162, iter: 5538, loss: 0.5384634137153625, time cost4.394566535949707
epoch: 162, iter: 5539, loss: 1.2946491241455078, time cost4.262703895568848
epoch: 162, iter: 5540, loss: 0.6243221759796143, time cost4.279982566833496
epoch: 162, iter: 5541, loss: 0.9733156561851501, time cost4.235937833786011
epoch: 162, iter: 5542, loss: 0.30464643239974976, time cost3.171161651611328
epoch: 163, iter: 5543, loss: 0.6023525595664978, time cost3.863978862762451
epoch: 163, iter: 5544, loss: 0.932128369808197, time cost4.025922060012817
epoch: 163, iter: 5545, loss: 0.9865235686302185, time cost4.2015440464019775
epoch: 163, iter: 5546, loss: 0.5994399785995483, time cost4.036515712738037
epoch: 163, iter: 5547, loss: 0.7574395537376404, time cost4.232616186141968
epoch: 163, iter: 5548, loss: 0.9400989413261414, time cost4.038497447967529
epoch: 163, iter: 5549, loss: 0.6615499258041382, time cost4.13727068901062
epoch: 163, iter: 5550, loss: 0.6444091796875, time cost4.033542633056641
tensor([[ 76.,  78.,  85.,  ...,   8.,   8.,   7.],
        [ 50.,  52.,  45.,  ...,  20.,  20.,   8.],
        [104., 206., 120.,  ...,   1.,   1.,   1.],
        ...,
        [ 53.,  59.,  45.,  ...,  23.,  23.,  13.],
        [109.,  88.,  29.,  ...,   1.,   1.,   1.],
        [ 26., 106.,  77.,  ...,   7.,   7.,   8.]])
Epoch: 163, Iteration: 5550:
TEST A@1: 0.4866666666666667
TEST A@5: 0.84
TEST A@10: 0.9111111111111111
TEST M@B: 0.3850840635429864
TEST M@A: 0.9509511090713804
TEST W@MB: 0.20661005687764625
TEST W@MA: 0.587128101443932
TEST Time: 553.6170225143433
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 163, iter: 5551, loss: 1.1979669332504272, time cost3.967930316925049
epoch: 163, iter: 5552, loss: 0.5395272374153137, time cost4.141935110092163
epoch: 163, iter: 5553, loss: 0.6462159752845764, time cost4.071637392044067
epoch: 163, iter: 5554, loss: 0.7167786955833435, time cost4.1189188957214355
epoch: 163, iter: 5555, loss: 0.8498194217681885, time cost4.1284499168396
epoch: 163, iter: 5556, loss: 0.6287716031074524, time cost4.055578947067261
epoch: 163, iter: 5557, loss: 0.6622973680496216, time cost4.179505109786987
epoch: 163, iter: 5558, loss: 0.6087824702262878, time cost4.156338214874268
epoch: 163, iter: 5559, loss: 0.47812533378601074, time cost4.273216009140015
epoch: 163, iter: 5560, loss: 0.5831324458122253, time cost4.282912254333496
epoch: 163, iter: 5561, loss: 0.6016616225242615, time cost3.978816032409668
epoch: 163, iter: 5562, loss: 1.0446072816848755, time cost4.1104960441589355
epoch: 163, iter: 5563, loss: 0.6090815663337708, time cost4.104211330413818
epoch: 163, iter: 5564, loss: 0.8505632877349854, time cost4.1060309410095215
epoch: 163, iter: 5565, loss: 0.4866570830345154, time cost4.071585655212402
epoch: 163, iter: 5566, loss: 0.6680753231048584, time cost3.894760847091675
epoch: 163, iter: 5567, loss: 0.9341753721237183, time cost3.541778087615967
epoch: 163, iter: 5568, loss: 0.6820929646492004, time cost3.2485101222991943
epoch: 163, iter: 5569, loss: 0.9223185181617737, time cost3.4221725463867188
epoch: 163, iter: 5570, loss: 1.0665901899337769, time cost3.422476291656494
epoch: 163, iter: 5571, loss: 0.9179942011833191, time cost3.6108438968658447
epoch: 163, iter: 5572, loss: 1.323157548904419, time cost3.9158003330230713
epoch: 163, iter: 5573, loss: 0.7082605957984924, time cost3.9420313835144043
epoch: 163, iter: 5574, loss: 0.6523033380508423, time cost4.120598077774048
epoch: 163, iter: 5575, loss: 1.069250464439392, time cost4.114112615585327
epoch: 163, iter: 5576, loss: 0.8832583427429199, time cost3.0103776454925537
epoch: 164, iter: 5577, loss: 0.5574750900268555, time cost4.048733949661255
epoch: 164, iter: 5578, loss: 0.7355513572692871, time cost4.195478916168213
epoch: 164, iter: 5579, loss: 1.5335146188735962, time cost4.223561525344849
epoch: 164, iter: 5580, loss: 0.6498240232467651, time cost4.124973773956299
epoch: 164, iter: 5581, loss: 0.7905844449996948, time cost4.100897789001465
epoch: 164, iter: 5582, loss: 0.6703460216522217, time cost4.065460443496704
epoch: 164, iter: 5583, loss: 0.6195058226585388, time cost4.184725046157837
epoch: 164, iter: 5584, loss: 0.8740382194519043, time cost3.9740142822265625
epoch: 164, iter: 5585, loss: 0.28777822852134705, time cost4.032935619354248
epoch: 164, iter: 5586, loss: 0.6838036775588989, time cost4.078186750411987
epoch: 164, iter: 5587, loss: 1.3345732688903809, time cost4.180977821350098
epoch: 164, iter: 5588, loss: 0.9389392137527466, time cost4.028400421142578
epoch: 164, iter: 5589, loss: 0.8851792216300964, time cost4.123841762542725
epoch: 164, iter: 5590, loss: 0.5519264936447144, time cost4.174050807952881
epoch: 164, iter: 5591, loss: 1.1237962245941162, time cost4.145002841949463
epoch: 164, iter: 5592, loss: 1.2554059028625488, time cost4.093662738800049
epoch: 164, iter: 5593, loss: 0.638556718826294, time cost3.998919725418091
epoch: 164, iter: 5594, loss: 0.5039295554161072, time cost4.001031875610352
epoch: 164, iter: 5595, loss: 0.6736636757850647, time cost3.9932937622070312
epoch: 164, iter: 5596, loss: 0.6388389468193054, time cost3.9679508209228516
epoch: 164, iter: 5597, loss: 0.7237185835838318, time cost3.9200081825256348
epoch: 164, iter: 5598, loss: 0.4449010193347931, time cost3.9737484455108643
epoch: 164, iter: 5599, loss: 0.9301947355270386, time cost3.9789865016937256
epoch: 164, iter: 5600, loss: 0.9404951930046082, time cost4.0174782276153564
tensor([[148., 130., 143.,  ...,   1.,   1.,   1.],
        [ 14.,  13.,  12.,  ...,  12.,  12.,   7.],
        [102., 230., 146.,  ...,   5.,   5.,   3.],
        ...,
        [ 57.,  58.,  39.,  ...,  19.,  19.,  14.],
        [130., 121.,   4.,  ...,   1.,   1.,   1.],
        [ 67., 122., 116.,  ...,  13.,  13.,  16.]])
Epoch: 164, Iteration: 5600:
TEST A@1: 0.48
TEST A@5: 0.8311111111111111
TEST A@10: 0.9177777777777778
TEST M@B: 0.3944827282827671
TEST M@A: 0.954158236377067
TEST W@MB: 0.21286362120687488
TEST W@MA: 0.5896324727087017
TEST Time: 574.062383890152
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 164, iter: 5601, loss: 1.1099133491516113, time cost4.050348997116089
epoch: 164, iter: 5602, loss: 1.0976296663284302, time cost3.9950077533721924
epoch: 164, iter: 5603, loss: 0.5759801864624023, time cost3.9719460010528564
epoch: 164, iter: 5604, loss: 0.4623802602291107, time cost4.03307843208313
epoch: 164, iter: 5605, loss: 0.7403243184089661, time cost4.019718408584595
epoch: 164, iter: 5606, loss: 0.7674853205680847, time cost4.003626585006714
epoch: 164, iter: 5607, loss: 0.288465678691864, time cost4.148219585418701
epoch: 164, iter: 5608, loss: 0.4774162471294403, time cost3.9881222248077393
epoch: 164, iter: 5609, loss: 0.6155785918235779, time cost3.901664972305298
epoch: 164, iter: 5610, loss: 0.7833564281463623, time cost3.088270425796509
epoch: 165, iter: 5611, loss: 0.7603344917297363, time cost4.136437654495239
epoch: 165, iter: 5612, loss: 0.41359788179397583, time cost4.087358474731445
epoch: 165, iter: 5613, loss: 0.6697038412094116, time cost4.04712438583374
epoch: 165, iter: 5614, loss: 0.46785232424736023, time cost4.135134935379028
epoch: 165, iter: 5615, loss: 0.4601389169692993, time cost4.02155876159668
epoch: 165, iter: 5616, loss: 0.6122725605964661, time cost4.123042106628418
epoch: 165, iter: 5617, loss: 0.7609359622001648, time cost4.236504554748535
epoch: 165, iter: 5618, loss: 0.7749646902084351, time cost4.010500907897949
epoch: 165, iter: 5619, loss: 0.8201174736022949, time cost4.248762845993042
epoch: 165, iter: 5620, loss: 0.9182713031768799, time cost3.984426736831665
epoch: 165, iter: 5621, loss: 0.571345329284668, time cost4.0395684242248535
epoch: 165, iter: 5622, loss: 0.5329434871673584, time cost4.046947002410889
epoch: 165, iter: 5623, loss: 1.0361071825027466, time cost4.127891540527344
epoch: 165, iter: 5624, loss: 1.320203185081482, time cost4.010445594787598
epoch: 165, iter: 5625, loss: 0.6631227135658264, time cost3.983316421508789
epoch: 165, iter: 5626, loss: 0.6056802868843079, time cost3.9006295204162598
epoch: 165, iter: 5627, loss: 0.7645642161369324, time cost4.02519679069519
epoch: 165, iter: 5628, loss: 0.9334433674812317, time cost3.964351177215576
epoch: 165, iter: 5629, loss: 0.9138966202735901, time cost4.154514789581299
epoch: 165, iter: 5630, loss: 0.7763269543647766, time cost4.063211679458618
epoch: 165, iter: 5631, loss: 0.8966265320777893, time cost4.1459314823150635
epoch: 165, iter: 5632, loss: 0.3974560797214508, time cost4.018336534500122
epoch: 165, iter: 5633, loss: 0.8316565155982971, time cost3.891824960708618
epoch: 165, iter: 5634, loss: 0.8586398363113403, time cost3.9362738132476807
epoch: 165, iter: 5635, loss: 0.7840684652328491, time cost3.993317127227783
epoch: 165, iter: 5636, loss: 1.3425580263137817, time cost4.04854679107666
epoch: 165, iter: 5637, loss: 0.9638933539390564, time cost3.9690451622009277
epoch: 165, iter: 5638, loss: 0.8069753050804138, time cost4.007712125778198
epoch: 165, iter: 5639, loss: 0.5461061000823975, time cost3.9820117950439453
epoch: 165, iter: 5640, loss: 0.8462415933609009, time cost3.8572747707366943
epoch: 165, iter: 5641, loss: 1.2834519147872925, time cost3.9300754070281982
epoch: 165, iter: 5642, loss: 0.9163050055503845, time cost4.008032321929932
epoch: 165, iter: 5643, loss: 0.5041096806526184, time cost3.8697681427001953
epoch: 165, iter: 5644, loss: 0.3562049865722656, time cost2.851635694503784
epoch: 166, iter: 5645, loss: 0.6210534572601318, time cost3.950875997543335
epoch: 166, iter: 5646, loss: 1.2227672338485718, time cost4.02531623840332
epoch: 166, iter: 5647, loss: 0.4307480454444885, time cost3.9917187690734863
epoch: 166, iter: 5648, loss: 0.5837084054946899, time cost4.08394718170166
epoch: 166, iter: 5649, loss: 0.3167775571346283, time cost3.8613157272338867
epoch: 166, iter: 5650, loss: 0.5853033065795898, time cost3.908508777618408
tensor([[114.,  93., 100.,  ...,   1.,   1.,   1.],
        [ 25.,  13.,  12.,  ...,   8.,   8.,   4.],
        [112., 210.,  96.,  ...,  12.,  12.,   4.],
        ...,
        [ 62.,  59.,  37.,  ...,  20.,  20.,   8.],
        [ 83.,  80.,   5.,  ...,   1.,   1.,   1.],
        [ 61., 162., 180.,  ...,   7.,   7.,   8.]])
Epoch: 166, Iteration: 5650:
TEST A@1: 0.5488888888888889
TEST A@5: 0.8911111111111111
TEST A@10: 0.9577777777777777
TEST M@B: 0.4234129149698797
TEST M@A: 0.957156644911254
TEST W@MB: 0.2269748127931249
TEST W@MA: 0.5915755564712599
TEST Time: 563.1785271167755
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 166, iter: 5651, loss: 0.8864731192588806, time cost3.9506866931915283
epoch: 166, iter: 5652, loss: 0.5030558705329895, time cost4.052018165588379
epoch: 166, iter: 5653, loss: 0.7115322947502136, time cost4.163089990615845
epoch: 166, iter: 5654, loss: 0.3576950430870056, time cost4.068767547607422
epoch: 166, iter: 5655, loss: 1.178863525390625, time cost3.972384214401245
epoch: 166, iter: 5656, loss: 0.4671564996242523, time cost4.0906081199646
epoch: 166, iter: 5657, loss: 1.170179009437561, time cost4.160848379135132
epoch: 166, iter: 5658, loss: 0.5618089437484741, time cost4.015648603439331
epoch: 166, iter: 5659, loss: 0.5692864060401917, time cost4.069533586502075
epoch: 166, iter: 5660, loss: 1.1291812658309937, time cost4.131002426147461
epoch: 166, iter: 5661, loss: 0.8068784475326538, time cost4.0862202644348145
epoch: 166, iter: 5662, loss: 0.8573864698410034, time cost4.070786237716675
epoch: 166, iter: 5663, loss: 0.6615612506866455, time cost4.118621587753296
epoch: 166, iter: 5664, loss: 0.7422028183937073, time cost4.011483192443848
epoch: 166, iter: 5665, loss: 0.8787041306495667, time cost4.013361930847168
epoch: 166, iter: 5666, loss: 0.6362051367759705, time cost3.965104103088379
epoch: 166, iter: 5667, loss: 1.0649255514144897, time cost4.177583456039429
epoch: 166, iter: 5668, loss: 0.9052668213844299, time cost4.011691093444824
epoch: 166, iter: 5669, loss: 0.8596615195274353, time cost4.094647645950317
epoch: 166, iter: 5670, loss: 0.556411623954773, time cost3.9712891578674316
epoch: 166, iter: 5671, loss: 1.116477131843567, time cost4.050104141235352
epoch: 166, iter: 5672, loss: 0.8393527269363403, time cost3.9967894554138184
epoch: 166, iter: 5673, loss: 0.5611879825592041, time cost4.07180118560791
epoch: 166, iter: 5674, loss: 0.6044301390647888, time cost4.034914016723633
epoch: 166, iter: 5675, loss: 0.5359470844268799, time cost3.866678237915039
epoch: 166, iter: 5676, loss: 0.6610474586486816, time cost3.9567441940307617
epoch: 166, iter: 5677, loss: 0.8161013722419739, time cost4.026215076446533
epoch: 166, iter: 5678, loss: 0.4819006323814392, time cost2.867049217224121
epoch: 167, iter: 5679, loss: 1.1101977825164795, time cost4.098718881607056
epoch: 167, iter: 5680, loss: 0.5957111716270447, time cost4.231574296951294
epoch: 167, iter: 5681, loss: 0.6809441447257996, time cost3.988924741744995
epoch: 167, iter: 5682, loss: 0.862075686454773, time cost4.116451978683472
epoch: 167, iter: 5683, loss: 0.7651657462120056, time cost4.020105361938477
epoch: 167, iter: 5684, loss: 0.5278195142745972, time cost4.160206317901611
epoch: 167, iter: 5685, loss: 0.9106356501579285, time cost4.095600366592407
epoch: 167, iter: 5686, loss: 0.551950216293335, time cost4.052867412567139
epoch: 167, iter: 5687, loss: 0.7919807434082031, time cost4.164793014526367
epoch: 167, iter: 5688, loss: 0.8009474277496338, time cost4.024570465087891
epoch: 167, iter: 5689, loss: 0.8158829808235168, time cost4.1206443309783936
epoch: 167, iter: 5690, loss: 0.6147928833961487, time cost4.137316942214966
epoch: 167, iter: 5691, loss: 0.4428921341896057, time cost4.205010652542114
epoch: 167, iter: 5692, loss: 1.5481114387512207, time cost4.332849740982056
epoch: 167, iter: 5693, loss: 0.933677077293396, time cost4.152576208114624
epoch: 167, iter: 5694, loss: 0.4940294027328491, time cost4.244728326797485
epoch: 167, iter: 5695, loss: 0.681956946849823, time cost4.315780878067017
epoch: 167, iter: 5696, loss: 0.7238296270370483, time cost4.235480308532715
epoch: 167, iter: 5697, loss: 0.663282573223114, time cost4.13999605178833
epoch: 167, iter: 5698, loss: 1.0587900876998901, time cost4.239391803741455
epoch: 167, iter: 5699, loss: 0.527025580406189, time cost4.081994295120239
epoch: 167, iter: 5700, loss: 0.5139533281326294, time cost4.16033935546875
tensor([[114.,  82.,  94.,  ...,   1.,   1.,   1.],
        [ 16.,  21.,  16.,  ...,  14.,  14.,  11.],
        [115., 231., 113.,  ...,   7.,   7.,   1.],
        ...,
        [ 54.,  47.,  23.,  ...,  15.,  15.,  11.],
        [ 33.,  35.,   3.,  ...,   1.,   1.,   1.],
        [106., 217., 241.,  ...,   4.,   4.,   6.]])
Epoch: 167, Iteration: 5700:
TEST A@1: 0.47555555555555556
TEST A@5: 0.8177777777777778
TEST A@10: 0.9244444444444444
TEST M@B: 0.391737270913007
TEST M@A: 0.9541064809011444
TEST W@MB: 0.21030641766823926
TEST W@MA: 0.5894069890171019
TEST Time: 558.3876776695251
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 167, iter: 5701, loss: 0.7447857856750488, time cost3.9669101238250732
epoch: 167, iter: 5702, loss: 0.9815372824668884, time cost4.01790452003479
epoch: 167, iter: 5703, loss: 0.9281479716300964, time cost3.987752676010132
epoch: 167, iter: 5704, loss: 1.2421590089797974, time cost4.104873418807983
epoch: 167, iter: 5705, loss: 0.5368697047233582, time cost4.073007106781006
epoch: 167, iter: 5706, loss: 1.038960576057434, time cost4.08458137512207
epoch: 167, iter: 5707, loss: 0.6439253091812134, time cost3.9156529903411865
epoch: 167, iter: 5708, loss: 1.281492829322815, time cost4.001075029373169
epoch: 167, iter: 5709, loss: 0.34953707456588745, time cost3.8812007904052734
epoch: 167, iter: 5710, loss: 1.076318383216858, time cost4.003126621246338
epoch: 167, iter: 5711, loss: 0.46380606293678284, time cost4.12743067741394
epoch: 167, iter: 5712, loss: 0.5679777264595032, time cost2.925658702850342
epoch: 168, iter: 5713, loss: 0.5562001466751099, time cost4.080416917800903
epoch: 168, iter: 5714, loss: 0.7859256863594055, time cost4.045990705490112
epoch: 168, iter: 5715, loss: 1.284143328666687, time cost4.134405612945557
epoch: 168, iter: 5716, loss: 1.2639427185058594, time cost4.016804218292236
epoch: 168, iter: 5717, loss: 0.625799298286438, time cost4.144969701766968
epoch: 168, iter: 5718, loss: 1.0048247575759888, time cost4.136576414108276
epoch: 168, iter: 5719, loss: 0.762182891368866, time cost4.064937114715576
epoch: 168, iter: 5720, loss: 0.45134487748146057, time cost4.165118217468262
epoch: 168, iter: 5721, loss: 0.9566743969917297, time cost4.170889139175415
epoch: 168, iter: 5722, loss: 0.6401621103286743, time cost4.062721014022827
epoch: 168, iter: 5723, loss: 0.9177616834640503, time cost4.154371023178101
epoch: 168, iter: 5724, loss: 0.64744633436203, time cost4.06938099861145
epoch: 168, iter: 5725, loss: 0.595397412776947, time cost4.052702903747559
epoch: 168, iter: 5726, loss: 0.4396919310092926, time cost4.079477548599243
epoch: 168, iter: 5727, loss: 0.5892678499221802, time cost4.12857723236084
epoch: 168, iter: 5728, loss: 0.4585370719432831, time cost3.9864766597747803
epoch: 168, iter: 5729, loss: 0.8791152238845825, time cost3.90022611618042
epoch: 168, iter: 5730, loss: 0.6698007583618164, time cost4.079264163970947
epoch: 168, iter: 5731, loss: 0.702627420425415, time cost4.088846683502197
epoch: 168, iter: 5732, loss: 0.310510516166687, time cost3.899712562561035
epoch: 168, iter: 5733, loss: 0.9471367001533508, time cost4.192109823226929
epoch: 168, iter: 5734, loss: 1.2789627313613892, time cost4.011035680770874
epoch: 168, iter: 5735, loss: 0.7702017426490784, time cost3.9351325035095215
epoch: 168, iter: 5736, loss: 0.3251952826976776, time cost3.976590156555176
epoch: 168, iter: 5737, loss: 0.8713598251342773, time cost4.016021013259888
epoch: 168, iter: 5738, loss: 0.5884124636650085, time cost4.005908250808716
epoch: 168, iter: 5739, loss: 0.7140719294548035, time cost4.039961338043213
epoch: 168, iter: 5740, loss: 0.6034968495368958, time cost3.8926124572753906
epoch: 168, iter: 5741, loss: 0.8610852956771851, time cost3.9282283782958984
epoch: 168, iter: 5742, loss: 0.9587660431861877, time cost3.890719413757324
epoch: 168, iter: 5743, loss: 0.7903054356575012, time cost4.033004999160767
epoch: 168, iter: 5744, loss: 1.012510061264038, time cost3.9925549030303955
epoch: 168, iter: 5745, loss: 0.6617003679275513, time cost3.9383225440979004
epoch: 168, iter: 5746, loss: 0.7296284437179565, time cost2.8437469005584717
epoch: 169, iter: 5747, loss: 0.8694777488708496, time cost3.987823963165283
epoch: 169, iter: 5748, loss: 1.0817402601242065, time cost4.113695383071899
epoch: 169, iter: 5749, loss: 0.8730470538139343, time cost4.025098085403442
epoch: 169, iter: 5750, loss: 1.25531804561615, time cost4.070814609527588
tensor([[ 39.,  34.,  37.,  ...,   1.,   1.,   1.],
        [  8.,  13.,  13.,  ...,  21.,  21.,  14.],
        [123., 233., 133.,  ...,   9.,   9.,   3.],
        ...,
        [103.,  98.,  79.,  ...,  25.,  25.,  16.],
        [ 43.,  42.,  12.,  ...,   1.,   1.,   1.],
        [ 51., 103.,  84.,  ...,   4.,   4.,   5.]])
Epoch: 169, Iteration: 5750:
TEST A@1: 0.5266666666666666
TEST A@5: 0.8577777777777778
TEST A@10: 0.9311111111111111
TEST M@B: 0.41312730235527917
TEST M@A: 0.9535104474416815
TEST W@MB: 0.2218821773424601
TEST W@MA: 0.5889290105157665
TEST Time: 480.34313344955444
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 169, iter: 5751, loss: 0.7565736770629883, time cost4.090603828430176
epoch: 169, iter: 5752, loss: 0.5721932649612427, time cost4.186728000640869
epoch: 169, iter: 5753, loss: 0.5540282130241394, time cost4.243806600570679
epoch: 169, iter: 5754, loss: 0.3955712616443634, time cost4.18586540222168
epoch: 169, iter: 5755, loss: 0.7695925235748291, time cost4.2991650104522705
epoch: 169, iter: 5756, loss: 0.7416375875473022, time cost4.106484651565552
epoch: 169, iter: 5757, loss: 0.5586972832679749, time cost3.949979543685913
epoch: 169, iter: 5758, loss: 0.9682777523994446, time cost3.51503849029541
epoch: 169, iter: 5759, loss: 0.8548768758773804, time cost3.8063268661499023
epoch: 169, iter: 5760, loss: 0.899736225605011, time cost4.248936653137207
epoch: 169, iter: 5761, loss: 0.5765535235404968, time cost4.062565803527832
epoch: 169, iter: 5762, loss: 0.6244994401931763, time cost4.116247653961182
epoch: 169, iter: 5763, loss: 0.7326051592826843, time cost4.160175085067749
epoch: 169, iter: 5764, loss: 0.696047842502594, time cost4.125802755355835
epoch: 169, iter: 5765, loss: 0.5972353219985962, time cost4.2273032665252686
epoch: 169, iter: 5766, loss: 0.9845996499061584, time cost4.2854461669921875
epoch: 169, iter: 5767, loss: 0.46236228942871094, time cost3.979313850402832
epoch: 169, iter: 5768, loss: 0.7442154884338379, time cost4.333090543746948
epoch: 169, iter: 5769, loss: 0.6201772093772888, time cost4.201250314712524
epoch: 169, iter: 5770, loss: 1.146682858467102, time cost4.116184949874878
epoch: 169, iter: 5771, loss: 1.19366455078125, time cost4.192933797836304
epoch: 169, iter: 5772, loss: 0.7672237157821655, time cost4.1165502071380615
epoch: 169, iter: 5773, loss: 0.6385515332221985, time cost4.278832674026489
epoch: 169, iter: 5774, loss: 1.1440980434417725, time cost4.0715491771698
epoch: 169, iter: 5775, loss: 1.1235967874526978, time cost4.130616903305054
epoch: 169, iter: 5776, loss: 0.9670263528823853, time cost4.086820125579834
epoch: 169, iter: 5777, loss: 0.8608693480491638, time cost4.1228578090667725
epoch: 169, iter: 5778, loss: 0.4440663158893585, time cost4.327773332595825
epoch: 169, iter: 5779, loss: 0.6664707064628601, time cost4.248459100723267
epoch: 169, iter: 5780, loss: 0.4113467037677765, time cost3.0121850967407227
epoch: 170, iter: 5781, loss: 0.7357892394065857, time cost4.318657875061035
epoch: 170, iter: 5782, loss: 1.2177467346191406, time cost4.2305052280426025
epoch: 170, iter: 5783, loss: 0.7015766501426697, time cost4.429025650024414
epoch: 170, iter: 5784, loss: 0.6008504033088684, time cost4.436980247497559
epoch: 170, iter: 5785, loss: 0.9800488352775574, time cost3.805058240890503
epoch: 170, iter: 5786, loss: 0.5063717365264893, time cost3.355084180831909
epoch: 170, iter: 5787, loss: 0.6957377195358276, time cost3.8166613578796387
epoch: 170, iter: 5788, loss: 0.797162652015686, time cost3.9573872089385986
epoch: 170, iter: 5789, loss: 0.7898115515708923, time cost3.9850478172302246
epoch: 170, iter: 5790, loss: 0.7551073431968689, time cost4.077287435531616
epoch: 170, iter: 5791, loss: 0.30344071984291077, time cost4.112513303756714
epoch: 170, iter: 5792, loss: 0.7727546095848083, time cost4.084388494491577
epoch: 170, iter: 5793, loss: 0.4432200789451599, time cost4.095993518829346
epoch: 170, iter: 5794, loss: 0.41685187816619873, time cost4.134235620498657
epoch: 170, iter: 5795, loss: 0.46118608117103577, time cost4.18276047706604
epoch: 170, iter: 5796, loss: 0.7524420619010925, time cost4.09650444984436
epoch: 170, iter: 5797, loss: 0.7611233592033386, time cost4.1930742263793945
epoch: 170, iter: 5798, loss: 0.4728759229183197, time cost4.081477642059326
epoch: 170, iter: 5799, loss: 0.5768137574195862, time cost4.039561986923218
epoch: 170, iter: 5800, loss: 0.7379193305969238, time cost3.9873781204223633
tensor([[ 41.,  40.,  48.,  ...,   7.,   7.,   4.],
        [ 16.,  11.,  11.,  ...,  12.,  12.,   7.],
        [165., 303., 171.,  ...,   2.,   2.,   1.],
        ...,
        [ 53.,  54.,  37.,  ...,   5.,   5.,   1.],
        [ 12.,  30.,   8.,  ...,   1.,   1.,   1.],
        [ 58.,  99.,  91.,  ...,   3.,   3.,   2.]])
Epoch: 170, Iteration: 5800:
TEST A@1: 0.5444444444444444
TEST A@5: 0.8577777777777778
TEST A@10: 0.94
TEST M@B: 0.42278840487657793
TEST M@A: 0.9560912794047405
TEST W@MB: 0.22661225389215972
TEST W@MA: 0.5908006172228165
TEST Time: 553.9629790782928
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 170, iter: 5801, loss: 1.4503263235092163, time cost3.909395456314087
epoch: 170, iter: 5802, loss: 0.48495543003082275, time cost3.9146103858947754
epoch: 170, iter: 5803, loss: 0.42446714639663696, time cost4.018060207366943
epoch: 170, iter: 5804, loss: 0.5911458730697632, time cost3.9504640102386475
epoch: 170, iter: 5805, loss: 0.5154768824577332, time cost4.042446136474609
epoch: 170, iter: 5806, loss: 0.9554020762443542, time cost4.045427083969116
epoch: 170, iter: 5807, loss: 1.0085784196853638, time cost3.9185121059417725
epoch: 170, iter: 5808, loss: 1.0842137336730957, time cost4.002842426300049
epoch: 170, iter: 5809, loss: 0.8997229933738708, time cost4.030988931655884
epoch: 170, iter: 5810, loss: 0.7894871830940247, time cost3.976330280303955
epoch: 170, iter: 5811, loss: 0.8147894144058228, time cost3.8569114208221436
epoch: 170, iter: 5812, loss: 0.959351122379303, time cost3.789361000061035
epoch: 170, iter: 5813, loss: 0.5191439986228943, time cost4.025727033615112
epoch: 170, iter: 5814, loss: 0.45586299896240234, time cost2.866806745529175
epoch: 171, iter: 5815, loss: 0.7352848052978516, time cost4.110675811767578
epoch: 171, iter: 5816, loss: 0.4705832302570343, time cost4.204367399215698
epoch: 171, iter: 5817, loss: 0.8432939052581787, time cost4.062025308609009
epoch: 171, iter: 5818, loss: 1.0523898601531982, time cost4.021874666213989
epoch: 171, iter: 5819, loss: 0.5860216617584229, time cost4.034151554107666
epoch: 171, iter: 5820, loss: 0.9272559881210327, time cost4.0991034507751465
epoch: 171, iter: 5821, loss: 0.7310386896133423, time cost3.9568612575531006
epoch: 171, iter: 5822, loss: 0.998474657535553, time cost3.956810712814331
epoch: 171, iter: 5823, loss: 0.8990035057067871, time cost4.173030376434326
epoch: 171, iter: 5824, loss: 1.3310831785202026, time cost4.104865789413452
epoch: 171, iter: 5825, loss: 0.900647759437561, time cost3.9934823513031006
epoch: 171, iter: 5826, loss: 0.6003995537757874, time cost4.046744346618652
epoch: 171, iter: 5827, loss: 0.4472641050815582, time cost4.100903034210205
epoch: 171, iter: 5828, loss: 0.7657411694526672, time cost3.8974592685699463
epoch: 171, iter: 5829, loss: 0.7596420049667358, time cost3.9919421672821045
epoch: 171, iter: 5830, loss: 0.6351266503334045, time cost4.202013969421387
epoch: 171, iter: 5831, loss: 0.46107539534568787, time cost4.008723735809326
epoch: 171, iter: 5832, loss: 0.5268825888633728, time cost3.889672040939331
epoch: 171, iter: 5833, loss: 1.2843587398529053, time cost4.226250648498535
epoch: 171, iter: 5834, loss: 1.1800302267074585, time cost4.103628396987915
epoch: 171, iter: 5835, loss: 0.8625867366790771, time cost4.004906892776489
epoch: 171, iter: 5836, loss: 0.8474422097206116, time cost3.8804588317871094
epoch: 171, iter: 5837, loss: 0.9895708560943604, time cost3.905081272125244
epoch: 171, iter: 5838, loss: 1.0007548332214355, time cost4.15301251411438
epoch: 171, iter: 5839, loss: 0.37075430154800415, time cost4.016145467758179
epoch: 171, iter: 5840, loss: 0.7834794521331787, time cost3.93188214302063
epoch: 171, iter: 5841, loss: 1.058542013168335, time cost3.9421613216400146
epoch: 171, iter: 5842, loss: 0.427865207195282, time cost3.918276309967041
epoch: 171, iter: 5843, loss: 1.0583349466323853, time cost3.939976453781128
epoch: 171, iter: 5844, loss: 0.7975956201553345, time cost3.9932808876037598
epoch: 171, iter: 5845, loss: 0.671227216720581, time cost3.974893569946289
epoch: 171, iter: 5846, loss: 0.8538521528244019, time cost4.0064146518707275
epoch: 171, iter: 5847, loss: 0.9812002182006836, time cost3.9544098377227783
epoch: 171, iter: 5848, loss: 0.4936476945877075, time cost2.8877339363098145
epoch: 172, iter: 5849, loss: 1.135463833808899, time cost3.9645609855651855
epoch: 172, iter: 5850, loss: 0.7381991147994995, time cost3.93356990814209
tensor([[104.,  91.,  93.,  ...,  15.,  15.,  14.],
        [  8.,   6.,   5.,  ...,   8.,   8.,   4.],
        [ 96., 212., 116.,  ...,  17.,  17.,   7.],
        ...,
        [ 60.,  68.,  47.,  ...,  10.,  10.,  10.],
        [ 18.,  16.,   5.,  ...,   1.,   1.,   1.],
        [ 78.,  82., 124.,  ...,   4.,   4.,   4.]])
Epoch: 172, Iteration: 5850:
TEST A@1: 0.4911111111111111
TEST A@5: 0.8311111111111111
TEST A@10: 0.9244444444444444
TEST M@B: 0.39071230820383573
TEST M@A: 0.9509291200768055
TEST W@MB: 0.20920699040223262
TEST W@MA: 0.5868242051773737
TEST Time: 555.1090047359467
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 172, iter: 5851, loss: 1.703735589981079, time cost3.874093532562256
epoch: 172, iter: 5852, loss: 0.7069524526596069, time cost3.8262875080108643
epoch: 172, iter: 5853, loss: 1.039288878440857, time cost3.9354493618011475
epoch: 172, iter: 5854, loss: 0.6664144396781921, time cost3.9696249961853027
epoch: 172, iter: 5855, loss: 0.7946308255195618, time cost4.071244239807129
epoch: 172, iter: 5856, loss: 0.7545461058616638, time cost3.988490343093872
epoch: 172, iter: 5857, loss: 0.9339509010314941, time cost3.89957594871521
epoch: 172, iter: 5858, loss: 0.4213479459285736, time cost3.8903861045837402
epoch: 172, iter: 5859, loss: 0.8223837018013, time cost4.015066385269165
epoch: 172, iter: 5860, loss: 0.7599197030067444, time cost4.093277454376221
epoch: 172, iter: 5861, loss: 0.4615422785282135, time cost3.9754042625427246
epoch: 172, iter: 5862, loss: 0.7324140667915344, time cost4.030386209487915
epoch: 172, iter: 5863, loss: 0.475302517414093, time cost4.055255651473999
epoch: 172, iter: 5864, loss: 1.2348202466964722, time cost3.9343268871307373
epoch: 172, iter: 5865, loss: 0.7231563329696655, time cost4.052951812744141
epoch: 172, iter: 5866, loss: 0.9489657282829285, time cost4.039235591888428
epoch: 172, iter: 5867, loss: 1.1034722328186035, time cost4.0007407665252686
epoch: 172, iter: 5868, loss: 0.6317389607429504, time cost3.991373062133789
epoch: 172, iter: 5869, loss: 0.4166252613067627, time cost3.9616098403930664
epoch: 172, iter: 5870, loss: 0.7268834114074707, time cost3.9882161617279053
epoch: 172, iter: 5871, loss: 0.6166483163833618, time cost3.9703938961029053
epoch: 172, iter: 5872, loss: 0.7297274470329285, time cost4.007750749588013
epoch: 172, iter: 5873, loss: 0.7077600359916687, time cost4.069101333618164
epoch: 172, iter: 5874, loss: 0.47672614455223083, time cost4.102267742156982
epoch: 172, iter: 5875, loss: 0.8775041103363037, time cost4.050821542739868
epoch: 172, iter: 5876, loss: 0.6850656867027283, time cost3.8757588863372803
epoch: 172, iter: 5877, loss: 1.0454944372177124, time cost3.915996789932251
epoch: 172, iter: 5878, loss: 0.4398695230484009, time cost4.0208330154418945
epoch: 172, iter: 5879, loss: 0.8610540628433228, time cost4.057164669036865
epoch: 172, iter: 5880, loss: 0.7125592231750488, time cost4.1503448486328125
epoch: 172, iter: 5881, loss: 0.596939742565155, time cost4.0024213790893555
epoch: 172, iter: 5882, loss: 0.9445204734802246, time cost3.063319206237793
epoch: 173, iter: 5883, loss: 1.6045606136322021, time cost4.021865367889404
epoch: 173, iter: 5884, loss: 0.4137788414955139, time cost4.123098850250244
epoch: 173, iter: 5885, loss: 0.7658011317253113, time cost4.103086948394775
epoch: 173, iter: 5886, loss: 0.45376846194267273, time cost4.011325359344482
epoch: 173, iter: 5887, loss: 0.733404815196991, time cost4.172493934631348
epoch: 173, iter: 5888, loss: 0.7104486227035522, time cost4.08858060836792
epoch: 173, iter: 5889, loss: 0.4622887670993805, time cost4.081537485122681
epoch: 173, iter: 5890, loss: 0.6509876251220703, time cost3.9736368656158447
epoch: 173, iter: 5891, loss: 1.4265261888504028, time cost4.097017049789429
epoch: 173, iter: 5892, loss: 0.7279044985771179, time cost4.243542909622192
epoch: 173, iter: 5893, loss: 0.38113996386528015, time cost4.105152368545532
epoch: 173, iter: 5894, loss: 0.4093266725540161, time cost4.0655882358551025
epoch: 173, iter: 5895, loss: 0.6115772128105164, time cost4.124593734741211
epoch: 173, iter: 5896, loss: 0.6028156280517578, time cost4.108785152435303
epoch: 173, iter: 5897, loss: 0.806846022605896, time cost3.91595721244812
epoch: 173, iter: 5898, loss: 0.5610629320144653, time cost4.211711168289185
epoch: 173, iter: 5899, loss: 0.8030132055282593, time cost4.168145656585693
epoch: 173, iter: 5900, loss: 0.4996999204158783, time cost3.9465746879577637
tensor([[ 14.,  14.,  17.,  ...,  13.,  13.,   6.],
        [ 47.,  28.,  26.,  ...,   9.,   9.,   5.],
        [128., 350., 178.,  ...,   8.,   8.,   2.],
        ...,
        [ 36.,  36.,  24.,  ...,  19.,  19.,  14.],
        [109., 102.,  16.,  ...,   1.,   1.,   1.],
        [ 33.,  76.,  59.,  ...,   6.,   6.,   6.]])
Epoch: 173, Iteration: 5900:
TEST A@1: 0.56
TEST A@5: 0.8755555555555555
TEST A@10: 0.9488888888888889
TEST M@B: 0.41598181234136633
TEST M@A: 0.9532961436048046
TEST W@MB: 0.22234291899489209
TEST W@MA: 0.5886222204474123
TEST Time: 552.9658207893372
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 173, iter: 5901, loss: 0.3201330900192261, time cost3.9118824005126953
epoch: 173, iter: 5902, loss: 0.5122953653335571, time cost4.0973732471466064
epoch: 173, iter: 5903, loss: 0.8302384614944458, time cost4.049527883529663
epoch: 173, iter: 5904, loss: 0.7587245106697083, time cost3.9751315116882324
epoch: 173, iter: 5905, loss: 0.7473855018615723, time cost4.111792325973511
epoch: 173, iter: 5906, loss: 0.946286678314209, time cost3.9971978664398193
epoch: 173, iter: 5907, loss: 0.8045868277549744, time cost4.03168249130249
epoch: 173, iter: 5908, loss: 0.8005757927894592, time cost4.099151611328125
epoch: 173, iter: 5909, loss: 0.9207463264465332, time cost4.110276937484741
epoch: 173, iter: 5910, loss: 0.4444097578525543, time cost3.987464666366577
epoch: 173, iter: 5911, loss: 0.8195165395736694, time cost3.92081880569458
epoch: 173, iter: 5912, loss: 0.7118108868598938, time cost3.9597649574279785
epoch: 173, iter: 5913, loss: 0.9256680011749268, time cost4.10545802116394
epoch: 173, iter: 5914, loss: 0.9683738946914673, time cost3.986250400543213
epoch: 173, iter: 5915, loss: 0.9582536816596985, time cost3.8947017192840576
epoch: 173, iter: 5916, loss: 0.39688873291015625, time cost2.871459484100342
epoch: 174, iter: 5917, loss: 0.62307208776474, time cost4.174400329589844
epoch: 174, iter: 5918, loss: 0.4912355840206146, time cost4.085252046585083
epoch: 174, iter: 5919, loss: 1.2126188278198242, time cost4.029232501983643
epoch: 174, iter: 5920, loss: 0.5769582986831665, time cost4.084027290344238
epoch: 174, iter: 5921, loss: 0.4905818998813629, time cost4.160476446151733
epoch: 174, iter: 5922, loss: 0.5330073237419128, time cost4.190201997756958
epoch: 174, iter: 5923, loss: 0.5890233516693115, time cost4.170632362365723
epoch: 174, iter: 5924, loss: 0.9649342894554138, time cost4.050240755081177
epoch: 174, iter: 5925, loss: 0.6642322540283203, time cost3.9074292182922363
epoch: 174, iter: 5926, loss: 0.838456928730011, time cost4.136705636978149
epoch: 174, iter: 5927, loss: 0.31471729278564453, time cost4.23572301864624
epoch: 174, iter: 5928, loss: 0.6746301054954529, time cost4.0099194049835205
epoch: 174, iter: 5929, loss: 0.4708522856235504, time cost4.046032190322876
epoch: 174, iter: 5930, loss: 0.6920241117477417, time cost4.034845590591431
epoch: 174, iter: 5931, loss: 0.8815783858299255, time cost4.166849851608276
epoch: 174, iter: 5932, loss: 0.6020575165748596, time cost4.056949615478516
epoch: 174, iter: 5933, loss: 0.6977823972702026, time cost4.092095375061035
epoch: 174, iter: 5934, loss: 0.5410289168357849, time cost4.042158842086792
epoch: 174, iter: 5935, loss: 0.598821759223938, time cost4.02593994140625
epoch: 174, iter: 5936, loss: 0.5894571542739868, time cost4.0281994342803955
epoch: 174, iter: 5937, loss: 0.8854848742485046, time cost4.033301591873169
epoch: 174, iter: 5938, loss: 0.6230218410491943, time cost4.0702760219573975
epoch: 174, iter: 5939, loss: 0.3538168966770172, time cost3.919496536254883
epoch: 174, iter: 5940, loss: 0.39001700282096863, time cost3.769686698913574
epoch: 174, iter: 5941, loss: 0.607905387878418, time cost4.07040548324585
epoch: 174, iter: 5942, loss: 0.809012770652771, time cost4.01847767829895
epoch: 174, iter: 5943, loss: 0.3395483195781708, time cost3.87149715423584
epoch: 174, iter: 5944, loss: 0.484042763710022, time cost3.7986526489257812
epoch: 174, iter: 5945, loss: 0.3213094472885132, time cost3.965529203414917
epoch: 174, iter: 5946, loss: 0.8107125163078308, time cost3.8138651847839355
epoch: 174, iter: 5947, loss: 0.9723726511001587, time cost3.8481521606445312
epoch: 174, iter: 5948, loss: 0.9940117597579956, time cost3.954855442047119
epoch: 174, iter: 5949, loss: 1.1214431524276733, time cost4.194847345352173
epoch: 174, iter: 5950, loss: 0.5422719717025757, time cost3.0575411319732666
tensor([[ 24.,  20.,  20.,  ...,   2.,   2.,   2.],
        [ 31.,  29.,  24.,  ...,  11.,  11.,   4.],
        [ 83., 224., 131.,  ...,   4.,   4.,   1.],
        ...,
        [ 55.,  54.,  33.,  ...,  10.,  10.,   8.],
        [ 70.,  72.,   3.,  ...,   1.,   1.,   1.],
        [ 48.,  54.,  75.,  ...,   4.,   4.,   5.]])
Epoch: 174, Iteration: 5950:
TEST A@1: 0.5555555555555556
TEST A@5: 0.8755555555555555
TEST A@10: 0.9577777777777777
TEST M@B: 0.42784919625787327
TEST M@A: 0.9577279322388035
TEST W@MB: 0.22937230249631524
TEST W@MA: 0.5922424457770944
TEST Time: 555.6756575107574
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 175, iter: 5951, loss: 0.9769237637519836, time cost3.8726987838745117
epoch: 175, iter: 5952, loss: 0.6869657039642334, time cost4.2054283618927
epoch: 175, iter: 5953, loss: 0.44534847140312195, time cost4.109503984451294
epoch: 175, iter: 5954, loss: 0.6666221618652344, time cost4.095346212387085
epoch: 175, iter: 5955, loss: 0.44332846999168396, time cost4.06400465965271
epoch: 175, iter: 5956, loss: 0.5172173976898193, time cost4.113270282745361
epoch: 175, iter: 5957, loss: 1.0420336723327637, time cost4.105772495269775
epoch: 175, iter: 5958, loss: 0.5883124470710754, time cost4.118484735488892
epoch: 175, iter: 5959, loss: 0.7520737648010254, time cost4.134324550628662
epoch: 175, iter: 5960, loss: 0.7606465220451355, time cost4.125872850418091
epoch: 175, iter: 5961, loss: 0.880539059638977, time cost3.9578940868377686
epoch: 175, iter: 5962, loss: 1.3306348323822021, time cost3.963413715362549
epoch: 175, iter: 5963, loss: 0.2489466667175293, time cost4.0318567752838135
epoch: 175, iter: 5964, loss: 0.5084471106529236, time cost4.034552574157715
epoch: 175, iter: 5965, loss: 0.7270856499671936, time cost3.902350664138794
epoch: 175, iter: 5966, loss: 0.6903764009475708, time cost3.9303505420684814
epoch: 175, iter: 5967, loss: 0.9750493764877319, time cost4.058290481567383
epoch: 175, iter: 5968, loss: 0.9016517996788025, time cost4.065386772155762
epoch: 175, iter: 5969, loss: 0.5702730417251587, time cost3.932711601257324
epoch: 175, iter: 5970, loss: 0.6842213273048401, time cost4.1085851192474365
epoch: 175, iter: 5971, loss: 0.6562489867210388, time cost4.0012218952178955
epoch: 175, iter: 5972, loss: 0.52305668592453, time cost4.021825790405273
epoch: 175, iter: 5973, loss: 0.6280557513237, time cost3.838064432144165
epoch: 175, iter: 5974, loss: 0.6668016314506531, time cost3.960833787918091
epoch: 175, iter: 5975, loss: 0.8205834627151489, time cost3.8811373710632324
epoch: 175, iter: 5976, loss: 0.5435035228729248, time cost3.8447017669677734
epoch: 175, iter: 5977, loss: 1.0775432586669922, time cost4.057270050048828
epoch: 175, iter: 5978, loss: 0.8062288165092468, time cost3.924469470977783
epoch: 175, iter: 5979, loss: 0.7476195693016052, time cost3.8927910327911377
epoch: 175, iter: 5980, loss: 0.7848217487335205, time cost3.976391315460205
epoch: 175, iter: 5981, loss: 0.5020720958709717, time cost4.072631597518921
epoch: 175, iter: 5982, loss: 0.579539954662323, time cost3.875257730484009
epoch: 175, iter: 5983, loss: 0.6983989477157593, time cost3.866485595703125
epoch: 175, iter: 5984, loss: 0.29541540145874023, time cost2.9467930793762207
epoch: 176, iter: 5985, loss: 0.6213142275810242, time cost3.8701276779174805
epoch: 176, iter: 5986, loss: 0.8477823138237, time cost3.8140993118286133
epoch: 176, iter: 5987, loss: 0.3813181519508362, time cost4.181459188461304
epoch: 176, iter: 5988, loss: 0.8124536275863647, time cost4.104130983352661
epoch: 176, iter: 5989, loss: 0.7190032601356506, time cost4.172330617904663
epoch: 176, iter: 5990, loss: 0.48182132840156555, time cost3.915863513946533
epoch: 176, iter: 5991, loss: 0.6824856996536255, time cost4.138140678405762
epoch: 176, iter: 5992, loss: 0.4572475850582123, time cost4.252932071685791
epoch: 176, iter: 5993, loss: 0.9104279279708862, time cost4.476064205169678
epoch: 176, iter: 5994, loss: 0.29577308893203735, time cost4.386990547180176
epoch: 176, iter: 5995, loss: 0.6200233101844788, time cost4.2533488273620605
epoch: 176, iter: 5996, loss: 0.49285799264907837, time cost4.3728508949279785
epoch: 176, iter: 5997, loss: 0.7017025947570801, time cost4.314409255981445
epoch: 176, iter: 5998, loss: 0.7574496865272522, time cost4.330689907073975
epoch: 176, iter: 5999, loss: 1.2109085321426392, time cost4.423807859420776
epoch: 176, iter: 6000, loss: 0.4210954010486603, time cost4.441773891448975
tensor([[162., 112., 125.,  ...,   1.,   1.,   1.],
        [ 32.,  30.,  25.,  ...,  11.,  11.,   6.],
        [110., 268., 125.,  ...,   7.,   7.,   5.],
        ...,
        [ 80.,  76.,  56.,  ...,  11.,  11.,   8.],
        [ 90.,  86.,   5.,  ...,   1.,   1.,   1.],
        [ 80., 158., 212.,  ...,   4.,   4.,   7.]])
Epoch: 176, Iteration: 6000:
TEST A@1: 0.5355555555555556
TEST A@5: 0.8844444444444445
TEST A@10: 0.9422222222222222
TEST M@B: 0.4136250943037592
TEST M@A: 0.9567327756525151
TEST W@MB: 0.22188338256606022
TEST W@MA: 0.5914391737425634
TEST Time: 559.5718080997467
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 176, iter: 6001, loss: 0.4775210916996002, time cost4.322899103164673
epoch: 176, iter: 6002, loss: 0.8692557215690613, time cost4.385913372039795
epoch: 176, iter: 6003, loss: 0.4330875277519226, time cost4.362893581390381
epoch: 176, iter: 6004, loss: 0.6730325818061829, time cost4.357809066772461
epoch: 176, iter: 6005, loss: 0.7457512021064758, time cost4.47131872177124
epoch: 176, iter: 6006, loss: 0.9762530326843262, time cost3.720250129699707
epoch: 176, iter: 6007, loss: 0.7753701210021973, time cost3.755122661590576
epoch: 176, iter: 6008, loss: 0.8035366535186768, time cost3.9904253482818604
epoch: 176, iter: 6009, loss: 0.5375986099243164, time cost4.072302579879761
epoch: 176, iter: 6010, loss: 0.6656799912452698, time cost4.170581579208374
epoch: 176, iter: 6011, loss: 0.6092900037765503, time cost4.022225856781006
epoch: 176, iter: 6012, loss: 0.6040388941764832, time cost3.86711049079895
epoch: 176, iter: 6013, loss: 0.553450345993042, time cost4.016883611679077
epoch: 176, iter: 6014, loss: 0.8792245388031006, time cost3.879589080810547
epoch: 176, iter: 6015, loss: 0.6885374188423157, time cost4.016386270523071
epoch: 176, iter: 6016, loss: 0.6549167037010193, time cost3.9579010009765625
epoch: 176, iter: 6017, loss: 0.7409921288490295, time cost3.871680498123169
epoch: 176, iter: 6018, loss: 0.37934550642967224, time cost2.8442227840423584
epoch: 177, iter: 6019, loss: 0.8969091773033142, time cost4.272093772888184
epoch: 177, iter: 6020, loss: 0.6436227560043335, time cost4.21475076675415
epoch: 177, iter: 6021, loss: 0.6887363791465759, time cost4.002757787704468
epoch: 177, iter: 6022, loss: 0.8368004560470581, time cost4.106279373168945
epoch: 177, iter: 6023, loss: 0.3790944516658783, time cost4.136523962020874
epoch: 177, iter: 6024, loss: 1.3244426250457764, time cost4.130939245223999
epoch: 177, iter: 6025, loss: 0.7197481393814087, time cost4.071933031082153
epoch: 177, iter: 6026, loss: 0.4451559782028198, time cost4.178398370742798
epoch: 177, iter: 6027, loss: 0.47962871193885803, time cost4.298817157745361
epoch: 177, iter: 6028, loss: 0.4125131368637085, time cost4.030394792556763
epoch: 177, iter: 6029, loss: 0.6039525866508484, time cost4.0058043003082275
epoch: 177, iter: 6030, loss: 0.6102226376533508, time cost3.9928829669952393
epoch: 177, iter: 6031, loss: 0.6962040662765503, time cost4.029794931411743
epoch: 177, iter: 6032, loss: 0.6675618886947632, time cost4.017037868499756
epoch: 177, iter: 6033, loss: 0.9878706336021423, time cost4.141345500946045
epoch: 177, iter: 6034, loss: 0.7707286477088928, time cost4.055681467056274
epoch: 177, iter: 6035, loss: 0.833069920539856, time cost4.1170220375061035
epoch: 177, iter: 6036, loss: 0.8272420167922974, time cost3.989807367324829
epoch: 177, iter: 6037, loss: 0.6529502868652344, time cost4.129710912704468
epoch: 177, iter: 6038, loss: 0.5720463991165161, time cost4.063308000564575
epoch: 177, iter: 6039, loss: 0.43698346614837646, time cost4.071757793426514
epoch: 177, iter: 6040, loss: 1.1011548042297363, time cost3.9420289993286133
epoch: 177, iter: 6041, loss: 0.9071237444877625, time cost3.994922161102295
epoch: 177, iter: 6042, loss: 1.0150622129440308, time cost4.349361181259155
epoch: 177, iter: 6043, loss: 0.5612533092498779, time cost4.072283983230591
epoch: 177, iter: 6044, loss: 0.45707494020462036, time cost4.128854513168335
epoch: 177, iter: 6045, loss: 0.6221626400947571, time cost3.9464845657348633
epoch: 177, iter: 6046, loss: 0.7823360562324524, time cost4.07622504234314
epoch: 177, iter: 6047, loss: 0.6889610886573792, time cost4.073306322097778
epoch: 177, iter: 6048, loss: 1.0721700191497803, time cost3.7403297424316406
epoch: 177, iter: 6049, loss: 0.48081958293914795, time cost3.9923646450042725
epoch: 177, iter: 6050, loss: 1.225942850112915, time cost4.119615077972412
tensor([[ 25.,  21.,  23.,  ...,   1.,   1.,   1.],
        [ 28.,  28.,  26.,  ...,  17.,  17.,   6.],
        [ 90., 241., 106.,  ...,   6.,   6.,   1.],
        ...,
        [ 77.,  73.,  49.,  ...,  10.,  10.,   9.],
        [ 16.,  26.,   4.,  ...,   1.,   1.,   1.],
        [ 47., 175., 191.,  ...,   6.,   6.,  11.]])
Epoch: 177, Iteration: 6050:
TEST A@1: 0.5266666666666666
TEST A@5: 0.8511111111111112
TEST A@10: 0.9355555555555556
TEST M@B: 0.41717690852872413
TEST M@A: 0.9561411255986564
TEST W@MB: 0.22417781036632106
TEST W@MA: 0.5910139616812022
TEST Time: 555.9315176010132
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 177, iter: 6051, loss: 0.49854180216789246, time cost3.9180455207824707
epoch: 177, iter: 6052, loss: 0.6861603856086731, time cost2.9061295986175537
epoch: 178, iter: 6053, loss: 0.4930879473686218, time cost4.121915578842163
epoch: 178, iter: 6054, loss: 0.7015169262886047, time cost3.9871931076049805
epoch: 178, iter: 6055, loss: 0.834233283996582, time cost4.093586206436157
epoch: 178, iter: 6056, loss: 1.045973300933838, time cost4.080732583999634
epoch: 178, iter: 6057, loss: 0.47226792573928833, time cost4.112117767333984
epoch: 178, iter: 6058, loss: 0.8558862209320068, time cost4.117441892623901
epoch: 178, iter: 6059, loss: 0.9024949669837952, time cost4.001429796218872
epoch: 178, iter: 6060, loss: 0.6779370903968811, time cost4.034599781036377
epoch: 178, iter: 6061, loss: 0.8573663234710693, time cost4.04097056388855
epoch: 178, iter: 6062, loss: 0.3125360310077667, time cost4.0000159740448
epoch: 178, iter: 6063, loss: 0.7089184522628784, time cost4.129950284957886
epoch: 178, iter: 6064, loss: 0.7425169348716736, time cost4.026991367340088
epoch: 178, iter: 6065, loss: 0.4651908874511719, time cost4.0495522022247314
epoch: 178, iter: 6066, loss: 0.6209774613380432, time cost4.075300216674805
epoch: 178, iter: 6067, loss: 0.7462671399116516, time cost4.066490650177002
epoch: 178, iter: 6068, loss: 0.9374685883522034, time cost4.134841680526733
epoch: 178, iter: 6069, loss: 0.6592082381248474, time cost4.156035661697388
epoch: 178, iter: 6070, loss: 0.795915424823761, time cost4.139012098312378
epoch: 178, iter: 6071, loss: 0.8669053316116333, time cost4.084234237670898
epoch: 178, iter: 6072, loss: 1.2250243425369263, time cost3.868144989013672
epoch: 178, iter: 6073, loss: 0.5361209511756897, time cost3.998845100402832
epoch: 178, iter: 6074, loss: 0.6062981486320496, time cost3.987407684326172
epoch: 178, iter: 6075, loss: 0.47460976243019104, time cost3.875330686569214
epoch: 178, iter: 6076, loss: 0.7723554372787476, time cost3.8544840812683105
epoch: 178, iter: 6077, loss: 0.9412839412689209, time cost3.9390316009521484
epoch: 178, iter: 6078, loss: 1.0077147483825684, time cost3.8806400299072266
epoch: 178, iter: 6079, loss: 1.5432565212249756, time cost3.8776042461395264
epoch: 178, iter: 6080, loss: 0.7088765501976013, time cost3.8423237800598145
epoch: 178, iter: 6081, loss: 1.1909881830215454, time cost3.820173501968384
epoch: 178, iter: 6082, loss: 1.1107566356658936, time cost3.8256609439849854
epoch: 178, iter: 6083, loss: 0.5580844283103943, time cost3.911597490310669
epoch: 178, iter: 6084, loss: 0.37864556908607483, time cost3.8609120845794678
epoch: 178, iter: 6085, loss: 0.721927285194397, time cost3.913466453552246
epoch: 178, iter: 6086, loss: 0.6677395701408386, time cost2.9366261959075928
epoch: 179, iter: 6087, loss: 0.5128264427185059, time cost3.9314138889312744
epoch: 179, iter: 6088, loss: 0.6245707869529724, time cost3.951775074005127
epoch: 179, iter: 6089, loss: 1.1349787712097168, time cost4.021697044372559
epoch: 179, iter: 6090, loss: 0.5652361512184143, time cost3.9491539001464844
epoch: 179, iter: 6091, loss: 0.4553104043006897, time cost4.0103819370269775
epoch: 179, iter: 6092, loss: 0.5917679667472839, time cost3.976625919342041
epoch: 179, iter: 6093, loss: 1.1624619960784912, time cost3.9589650630950928
epoch: 179, iter: 6094, loss: 0.44620898365974426, time cost3.904392719268799
epoch: 179, iter: 6095, loss: 1.045186996459961, time cost3.9523303508758545
epoch: 179, iter: 6096, loss: 1.2819862365722656, time cost3.927631139755249
epoch: 179, iter: 6097, loss: 0.430065393447876, time cost3.94183611869812
epoch: 179, iter: 6098, loss: 0.6245015263557434, time cost4.10435152053833
epoch: 179, iter: 6099, loss: 0.9603084921836853, time cost4.048503160476685
epoch: 179, iter: 6100, loss: 1.0508573055267334, time cost4.081389427185059
tensor([[ 15.,  14.,  13.,  ...,   1.,   1.,   1.],
        [ 21.,  22.,  21.,  ...,  16.,  16.,   8.],
        [116., 212.,  99.,  ...,   2.,   2.,   1.],
        ...,
        [ 36.,  37.,  10.,  ...,  10.,  10.,   6.],
        [ 68.,  71.,  11.,  ...,   1.,   1.,   1.],
        [ 34., 139., 147.,  ...,   2.,   2.,   2.]])
Epoch: 179, Iteration: 6100:
TEST A@1: 0.5422222222222223
TEST A@5: 0.8844444444444445
TEST A@10: 0.9622222222222222
TEST M@B: 0.42782966921018806
TEST M@A: 0.9584881399406328
TEST W@MB: 0.22968777701118365
TEST W@MA: 0.5926159290462243
TEST Time: 549.4571511745453
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 179, iter: 6101, loss: 1.1568948030471802, time cost3.860755443572998
epoch: 179, iter: 6102, loss: 0.6086487770080566, time cost3.9016079902648926
epoch: 179, iter: 6103, loss: 0.37362533807754517, time cost4.094396591186523
epoch: 179, iter: 6104, loss: 0.20762068033218384, time cost3.9585554599761963
epoch: 179, iter: 6105, loss: 0.4483977258205414, time cost3.9581782817840576
epoch: 179, iter: 6106, loss: 1.3367578983306885, time cost4.066235780715942
epoch: 179, iter: 6107, loss: 0.5756458640098572, time cost4.041417121887207
epoch: 179, iter: 6108, loss: 0.48783594369888306, time cost4.004818677902222
epoch: 179, iter: 6109, loss: 0.6264775991439819, time cost3.9535129070281982
epoch: 179, iter: 6110, loss: 0.5617036819458008, time cost4.0037620067596436
epoch: 179, iter: 6111, loss: 0.7279496788978577, time cost4.014469623565674
epoch: 179, iter: 6112, loss: 1.040995717048645, time cost4.188530683517456
epoch: 179, iter: 6113, loss: 0.649162769317627, time cost3.944695472717285
epoch: 179, iter: 6114, loss: 0.5972070693969727, time cost3.9269988536834717
epoch: 179, iter: 6115, loss: 0.6300532221794128, time cost3.9666106700897217
epoch: 179, iter: 6116, loss: 0.7030043005943298, time cost3.921635150909424
epoch: 179, iter: 6117, loss: 0.3854750394821167, time cost3.995020866394043
epoch: 179, iter: 6118, loss: 0.7585079669952393, time cost3.842437267303467
epoch: 179, iter: 6119, loss: 0.8567198514938354, time cost3.8357906341552734
epoch: 179, iter: 6120, loss: 0.2801896929740906, time cost2.8653311729431152
epoch: 180, iter: 6121, loss: 0.4324474036693573, time cost3.988851547241211
epoch: 180, iter: 6122, loss: 0.7544043660163879, time cost4.065793514251709
epoch: 180, iter: 6123, loss: 0.6701131463050842, time cost4.105285882949829
epoch: 180, iter: 6124, loss: 0.3729230761528015, time cost4.003788232803345
epoch: 180, iter: 6125, loss: 0.7224400043487549, time cost4.024775981903076
epoch: 180, iter: 6126, loss: 0.8170405030250549, time cost4.059240102767944
epoch: 180, iter: 6127, loss: 0.5622335076332092, time cost3.998087167739868
epoch: 180, iter: 6128, loss: 0.31649327278137207, time cost4.19641637802124
epoch: 180, iter: 6129, loss: 0.7389482855796814, time cost4.041004657745361
epoch: 180, iter: 6130, loss: 1.1107332706451416, time cost4.0399065017700195
epoch: 180, iter: 6131, loss: 1.1798039674758911, time cost4.1334755420684814
epoch: 180, iter: 6132, loss: 0.7748521566390991, time cost3.929250478744507
epoch: 180, iter: 6133, loss: 0.5257841348648071, time cost4.065394401550293
epoch: 180, iter: 6134, loss: 0.5030176639556885, time cost4.036577463150024
epoch: 180, iter: 6135, loss: 0.7198390960693359, time cost4.04347562789917
epoch: 180, iter: 6136, loss: 0.615310788154602, time cost4.169804334640503
epoch: 180, iter: 6137, loss: 0.7843724489212036, time cost4.065182447433472
epoch: 180, iter: 6138, loss: 0.9005232453346252, time cost4.057143688201904
epoch: 180, iter: 6139, loss: 0.4548459053039551, time cost4.060662508010864
epoch: 180, iter: 6140, loss: 0.7419198155403137, time cost3.896200656890869
epoch: 180, iter: 6141, loss: 0.688478410243988, time cost3.9434006214141846
epoch: 180, iter: 6142, loss: 0.6272422671318054, time cost3.8670132160186768
epoch: 180, iter: 6143, loss: 0.4684300422668457, time cost4.068029403686523
epoch: 180, iter: 6144, loss: 0.6222072839736938, time cost4.140461444854736
epoch: 180, iter: 6145, loss: 1.1858152151107788, time cost4.113913297653198
epoch: 180, iter: 6146, loss: 0.6764780879020691, time cost4.126438856124878
epoch: 180, iter: 6147, loss: 0.8147954940795898, time cost4.0561158657073975
epoch: 180, iter: 6148, loss: 0.5006412267684937, time cost4.047379016876221
epoch: 180, iter: 6149, loss: 0.8240748047828674, time cost3.986515998840332
epoch: 180, iter: 6150, loss: 0.536048173904419, time cost3.9824631214141846
tensor([[ 44.,  44.,  53.,  ...,  24.,  24.,  20.],
        [ 59.,  44.,  38.,  ...,  14.,  14.,   8.],
        [ 67., 173.,  98.,  ...,   2.,   2.,   1.],
        ...,
        [ 47.,  48.,  38.,  ...,  16.,  16.,   4.],
        [ 23.,  38.,  13.,  ...,   1.,   1.,   1.],
        [ 22.,  87.,  87.,  ...,   4.,   4.,   2.]])
Epoch: 180, Iteration: 6150:
TEST A@1: 0.44666666666666666
TEST A@5: 0.7733333333333333
TEST A@10: 0.8933333333333333
TEST M@B: 0.3576235904596643
TEST M@A: 0.9505787825318615
TEST W@MB: 0.19203057567493434
TEST W@MA: 0.5870753362566993
TEST Time: 561.126763343811
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 180, iter: 6151, loss: 0.6091392636299133, time cost4.1034932136535645
epoch: 180, iter: 6152, loss: 0.6811475157737732, time cost3.9625327587127686
epoch: 180, iter: 6153, loss: 0.5221119523048401, time cost3.8396248817443848
epoch: 180, iter: 6154, loss: 0.43643009662628174, time cost2.9363534450531006
epoch: 181, iter: 6155, loss: 0.8917162418365479, time cost4.078616142272949
epoch: 181, iter: 6156, loss: 1.0539515018463135, time cost4.027991771697998
epoch: 181, iter: 6157, loss: 0.5800654292106628, time cost4.173957109451294
epoch: 181, iter: 6158, loss: 1.0837029218673706, time cost4.074682235717773
epoch: 181, iter: 6159, loss: 0.7553979754447937, time cost4.085784912109375
epoch: 181, iter: 6160, loss: 1.0129996538162231, time cost3.9622011184692383
epoch: 181, iter: 6161, loss: 0.9296876192092896, time cost4.1199164390563965
epoch: 181, iter: 6162, loss: 0.8280523419380188, time cost4.043763875961304
epoch: 181, iter: 6163, loss: 1.3575208187103271, time cost4.031603813171387
epoch: 181, iter: 6164, loss: 0.7893801331520081, time cost4.062762260437012
epoch: 181, iter: 6165, loss: 0.9263784885406494, time cost4.003657102584839
epoch: 181, iter: 6166, loss: 0.6409264802932739, time cost3.9976844787597656
epoch: 181, iter: 6167, loss: 0.9969021677970886, time cost4.23836350440979
epoch: 181, iter: 6168, loss: 0.44907668232917786, time cost4.14538049697876
epoch: 181, iter: 6169, loss: 0.8964133262634277, time cost4.053695440292358
epoch: 181, iter: 6170, loss: 0.7329567670822144, time cost4.052199602127075
epoch: 181, iter: 6171, loss: 0.7157652378082275, time cost4.031551122665405
epoch: 181, iter: 6172, loss: 0.9745772480964661, time cost4.220913887023926
epoch: 181, iter: 6173, loss: 0.6540924906730652, time cost4.058556318283081
epoch: 181, iter: 6174, loss: 0.6273282766342163, time cost4.120230436325073
epoch: 181, iter: 6175, loss: 1.0682049989700317, time cost4.077891826629639
epoch: 181, iter: 6176, loss: 1.0017415285110474, time cost4.068108081817627
epoch: 181, iter: 6177, loss: 1.5405477285385132, time cost4.082449436187744
epoch: 181, iter: 6178, loss: 1.2453075647354126, time cost4.004101276397705
epoch: 181, iter: 6179, loss: 0.7593299746513367, time cost3.912250280380249
epoch: 181, iter: 6180, loss: 0.904810905456543, time cost4.001672029495239
epoch: 181, iter: 6181, loss: 0.5643118023872375, time cost3.963833808898926
epoch: 181, iter: 6182, loss: 0.6539205312728882, time cost4.008289813995361
epoch: 181, iter: 6183, loss: 0.33031782507896423, time cost3.936852216720581
epoch: 181, iter: 6184, loss: 0.760940432548523, time cost4.07455039024353
epoch: 181, iter: 6185, loss: 0.7818312048912048, time cost3.9771995544433594
epoch: 181, iter: 6186, loss: 1.1055727005004883, time cost3.921841859817505
epoch: 181, iter: 6187, loss: 0.4380479156970978, time cost3.9372479915618896
epoch: 181, iter: 6188, loss: 0.33913469314575195, time cost2.7820465564727783
epoch: 182, iter: 6189, loss: 0.9256972670555115, time cost4.0706751346588135
epoch: 182, iter: 6190, loss: 0.7624640464782715, time cost4.087777376174927
epoch: 182, iter: 6191, loss: 0.2945813536643982, time cost4.057620525360107
epoch: 182, iter: 6192, loss: 1.0729501247406006, time cost4.097997426986694
epoch: 182, iter: 6193, loss: 0.6681433320045471, time cost3.9842169284820557
epoch: 182, iter: 6194, loss: 0.38383883237838745, time cost4.001464605331421
epoch: 182, iter: 6195, loss: 0.64278644323349, time cost4.048372268676758
epoch: 182, iter: 6196, loss: 0.30211859941482544, time cost4.199491500854492
epoch: 182, iter: 6197, loss: 0.7621230483055115, time cost4.063724040985107
epoch: 182, iter: 6198, loss: 0.7515095472335815, time cost4.180042505264282
epoch: 182, iter: 6199, loss: 0.33371251821517944, time cost3.9891257286071777
epoch: 182, iter: 6200, loss: 0.9585886597633362, time cost4.034332752227783
tensor([[ 68.,  47.,  55.,  ...,   2.,   2.,   1.],
        [ 12.,  19.,  16.,  ...,   7.,   7.,   6.],
        [ 42., 108.,  55.,  ...,   5.,   5.,   4.],
        ...,
        [ 80.,  76.,  57.,  ...,  15.,  15.,   4.],
        [ 70.,  62.,   3.,  ...,   1.,   1.,   1.],
        [ 67., 177., 206.,  ...,   3.,   3.,   6.]])
Epoch: 182, Iteration: 6200:
TEST A@1: 0.5355555555555556
TEST A@5: 0.8711111111111111
TEST A@10: 0.9533333333333334
TEST M@B: 0.41874602275500183
TEST M@A: 0.9590277518432824
TEST W@MB: 0.22472124318017078
TEST W@MA: 0.5931720642834949
TEST Time: 559.5200729370117
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 182, iter: 6201, loss: 0.6024466753005981, time cost3.9736297130584717
epoch: 182, iter: 6202, loss: 0.48330026865005493, time cost4.031358957290649
epoch: 182, iter: 6203, loss: 0.5647655129432678, time cost4.074964761734009
epoch: 182, iter: 6204, loss: 0.8014174103736877, time cost4.048686265945435
epoch: 182, iter: 6205, loss: 0.542210042476654, time cost3.9911093711853027
epoch: 182, iter: 6206, loss: 0.6086284518241882, time cost3.9143013954162598
epoch: 182, iter: 6207, loss: 1.0427441596984863, time cost4.0481791496276855
epoch: 182, iter: 6208, loss: 1.2546842098236084, time cost3.9581172466278076
epoch: 182, iter: 6209, loss: 1.007340908050537, time cost3.9899368286132812
epoch: 182, iter: 6210, loss: 0.6787779331207275, time cost3.9508283138275146
epoch: 182, iter: 6211, loss: 0.5812599062919617, time cost4.065715551376343
epoch: 182, iter: 6212, loss: 0.452704519033432, time cost3.852353572845459
epoch: 182, iter: 6213, loss: 0.4199169874191284, time cost4.098989009857178
epoch: 182, iter: 6214, loss: 0.6665846705436707, time cost4.116807699203491
epoch: 182, iter: 6215, loss: 1.1209914684295654, time cost3.94466233253479
epoch: 182, iter: 6216, loss: 0.6444025635719299, time cost4.009444713592529
epoch: 182, iter: 6217, loss: 1.1268417835235596, time cost4.176751375198364
epoch: 182, iter: 6218, loss: 0.4917941093444824, time cost4.068640470504761
epoch: 182, iter: 6219, loss: 0.6234351992607117, time cost3.8283305168151855
epoch: 182, iter: 6220, loss: 0.5422420501708984, time cost3.917210340499878
epoch: 182, iter: 6221, loss: 0.638023853302002, time cost3.9690046310424805
epoch: 182, iter: 6222, loss: 0.45216506719589233, time cost2.4060604572296143
epoch: 183, iter: 6223, loss: 0.904219925403595, time cost4.258990049362183
epoch: 183, iter: 6224, loss: 0.41479602456092834, time cost4.008946418762207
epoch: 183, iter: 6225, loss: 0.6898072957992554, time cost4.346840143203735
epoch: 183, iter: 6226, loss: 0.44061151146888733, time cost4.299699068069458
epoch: 183, iter: 6227, loss: 0.5548906326293945, time cost4.384009122848511
epoch: 183, iter: 6228, loss: 0.83897465467453, time cost4.325322389602661
epoch: 183, iter: 6229, loss: 0.7244279384613037, time cost4.390857219696045
epoch: 183, iter: 6230, loss: 0.3291904330253601, time cost4.4198901653289795
epoch: 183, iter: 6231, loss: 0.5896081328392029, time cost4.282764911651611
epoch: 183, iter: 6232, loss: 0.3729148209095001, time cost4.400051116943359
epoch: 183, iter: 6233, loss: 0.5230982899665833, time cost4.534425973892212
epoch: 183, iter: 6234, loss: 0.6896092891693115, time cost4.226962566375732
epoch: 183, iter: 6235, loss: 0.4650871157646179, time cost4.6137049198150635
epoch: 183, iter: 6236, loss: 0.5832955241203308, time cost4.311416149139404
epoch: 183, iter: 6237, loss: 0.9101596474647522, time cost4.262305498123169
epoch: 183, iter: 6238, loss: 0.6512299180030823, time cost4.618150234222412
epoch: 183, iter: 6239, loss: 1.0688488483428955, time cost4.439876556396484
epoch: 183, iter: 6240, loss: 0.9729041457176208, time cost4.4517271518707275
epoch: 183, iter: 6241, loss: 0.46583110094070435, time cost4.308528900146484
epoch: 183, iter: 6242, loss: 1.045215129852295, time cost4.304772853851318
epoch: 183, iter: 6243, loss: 0.6509078741073608, time cost4.307552099227905
epoch: 183, iter: 6244, loss: 0.8906285166740417, time cost4.269508123397827
epoch: 183, iter: 6245, loss: 0.9783146977424622, time cost4.282282829284668
epoch: 183, iter: 6246, loss: 0.6308951377868652, time cost4.480764627456665
epoch: 183, iter: 6247, loss: 0.9854704141616821, time cost4.230720043182373
epoch: 183, iter: 6248, loss: 0.9067547917366028, time cost4.261571884155273
epoch: 183, iter: 6249, loss: 0.8948785662651062, time cost4.33341121673584
epoch: 183, iter: 6250, loss: 0.5111002922058105, time cost4.248483180999756
tensor([[ 77.,  61.,  68.,  ...,   7.,   7.,   3.],
        [ 37.,  44.,  42.,  ...,  25.,  25.,  17.],
        [ 23., 141.,  41.,  ...,   8.,   8.,   4.],
        ...,
        [ 79.,  75.,  64.,  ...,  19.,  19.,  13.],
        [105., 107.,  21.,  ...,   1.,   1.,   1.],
        [ 36., 143., 144.,  ...,   9.,   9.,   9.]])
Epoch: 183, Iteration: 6250:
TEST A@1: 0.41333333333333333
TEST A@5: 0.7311111111111112
TEST A@10: 0.8533333333333334
TEST M@B: 0.3342557582969943
TEST M@A: 0.9467080295327016
TEST W@MB: 0.17953120465729783
TEST W@MA: 0.584571298185355
TEST Time: 533.5910255908966
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 183, iter: 6251, loss: 0.8604428768157959, time cost4.05893611907959
epoch: 183, iter: 6252, loss: 0.9378453493118286, time cost3.9228122234344482
epoch: 183, iter: 6253, loss: 0.5424302816390991, time cost3.9325754642486572
epoch: 183, iter: 6254, loss: 0.45655933022499084, time cost3.895770788192749
epoch: 183, iter: 6255, loss: 0.5776976943016052, time cost3.9913032054901123
epoch: 183, iter: 6256, loss: 0.4369655251502991, time cost2.9530587196350098
epoch: 184, iter: 6257, loss: 0.8710280060768127, time cost4.2369489669799805
epoch: 184, iter: 6258, loss: 1.3006049394607544, time cost4.139125108718872
epoch: 184, iter: 6259, loss: 0.5376943349838257, time cost4.125897645950317
epoch: 184, iter: 6260, loss: 1.227785348892212, time cost4.159345865249634
epoch: 184, iter: 6261, loss: 0.24947458505630493, time cost4.034326076507568
epoch: 184, iter: 6262, loss: 0.7283809185028076, time cost4.1151111125946045
epoch: 184, iter: 6263, loss: 0.7539443373680115, time cost4.02826452255249
epoch: 184, iter: 6264, loss: 0.7619309425354004, time cost4.114592790603638
epoch: 184, iter: 6265, loss: 0.7926556468009949, time cost4.164146661758423
epoch: 184, iter: 6266, loss: 0.9496654272079468, time cost4.083117246627808
epoch: 184, iter: 6267, loss: 0.516365110874176, time cost4.072763919830322
epoch: 184, iter: 6268, loss: 1.1823111772537231, time cost4.132938861846924
epoch: 184, iter: 6269, loss: 0.9261724352836609, time cost4.1423280239105225
epoch: 184, iter: 6270, loss: 0.6004841923713684, time cost4.07061767578125
epoch: 184, iter: 6271, loss: 0.750950813293457, time cost3.8651654720306396
epoch: 184, iter: 6272, loss: 0.5394049882888794, time cost4.126593351364136
epoch: 184, iter: 6273, loss: 0.7158874273300171, time cost4.327922582626343
epoch: 184, iter: 6274, loss: 0.795859694480896, time cost4.019622087478638
epoch: 184, iter: 6275, loss: 0.9264761805534363, time cost4.13273549079895
epoch: 184, iter: 6276, loss: 0.780771017074585, time cost4.106173276901245
epoch: 184, iter: 6277, loss: 0.6803592443466187, time cost4.003051519393921
epoch: 184, iter: 6278, loss: 0.3810575008392334, time cost4.081019401550293
epoch: 184, iter: 6279, loss: 0.5564502477645874, time cost4.19327712059021
epoch: 184, iter: 6280, loss: 0.42832985520362854, time cost4.127014875411987
epoch: 184, iter: 6281, loss: 0.5281261205673218, time cost4.079328775405884
epoch: 184, iter: 6282, loss: 0.49253612756729126, time cost4.121809959411621
epoch: 184, iter: 6283, loss: 1.2467899322509766, time cost4.222691774368286
epoch: 184, iter: 6284, loss: 0.3092480003833771, time cost3.9788424968719482
epoch: 184, iter: 6285, loss: 1.0635735988616943, time cost4.051240682601929
epoch: 184, iter: 6286, loss: 0.4163135290145874, time cost4.084984540939331
epoch: 184, iter: 6287, loss: 0.44632136821746826, time cost3.9268925189971924
epoch: 184, iter: 6288, loss: 0.696591854095459, time cost3.950897455215454
epoch: 184, iter: 6289, loss: 0.7067838311195374, time cost4.084906101226807
epoch: 184, iter: 6290, loss: 0.394553542137146, time cost2.915560722351074
epoch: 185, iter: 6291, loss: 0.7502990365028381, time cost4.124383926391602
epoch: 185, iter: 6292, loss: 0.28870174288749695, time cost4.059784650802612
epoch: 185, iter: 6293, loss: 1.1699624061584473, time cost4.175855398178101
epoch: 185, iter: 6294, loss: 0.8669273257255554, time cost3.976543426513672
epoch: 185, iter: 6295, loss: 0.7511085271835327, time cost4.0939271450042725
epoch: 185, iter: 6296, loss: 0.6437082290649414, time cost4.029452562332153
epoch: 185, iter: 6297, loss: 0.7293481826782227, time cost4.127820014953613
epoch: 185, iter: 6298, loss: 0.7882469296455383, time cost4.107729434967041
epoch: 185, iter: 6299, loss: 0.6620437502861023, time cost4.14413046836853
epoch: 185, iter: 6300, loss: 0.6970403790473938, time cost4.048898458480835
tensor([[ 35.,  23.,  28.,  ...,   2.,   2.,   1.],
        [ 15.,  12.,  12.,  ...,   9.,   9.,   4.],
        [ 48., 146.,  55.,  ...,   1.,   1.,   1.],
        ...,
        [ 51.,  51.,  39.,  ...,  10.,  10.,   8.],
        [ 34.,  28.,   3.,  ...,   1.,   1.,   1.],
        [ 38., 138., 158.,  ...,   2.,   2.,   5.]])
Epoch: 185, Iteration: 6300:
TEST A@1: 0.5444444444444444
TEST A@5: 0.8911111111111111
TEST A@10: 0.9666666666666667
TEST M@B: 0.43180574748280603
TEST M@A: 0.9588187513183211
TEST W@MB: 0.23182853222490737
TEST W@MA: 0.5929966831958499
TEST Time: 554.6609468460083
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 185, iter: 6301, loss: 0.5777246356010437, time cost3.864081859588623
epoch: 185, iter: 6302, loss: 0.6473081111907959, time cost3.9729740619659424
epoch: 185, iter: 6303, loss: 0.7558056712150574, time cost4.024089813232422
epoch: 185, iter: 6304, loss: 0.8098307847976685, time cost3.8942947387695312
epoch: 185, iter: 6305, loss: 0.5711722373962402, time cost3.962069511413574
epoch: 185, iter: 6306, loss: 0.7340657711029053, time cost4.051327228546143
epoch: 185, iter: 6307, loss: 0.6613399386405945, time cost4.108321189880371
epoch: 185, iter: 6308, loss: 0.8232627511024475, time cost4.087545871734619
epoch: 185, iter: 6309, loss: 1.1242039203643799, time cost4.114722013473511
epoch: 185, iter: 6310, loss: 0.9741041660308838, time cost4.098019123077393
epoch: 185, iter: 6311, loss: 0.8915581107139587, time cost4.108638763427734
epoch: 185, iter: 6312, loss: 0.5901992321014404, time cost3.983137845993042
epoch: 185, iter: 6313, loss: 0.8067091703414917, time cost4.003870248794556
epoch: 185, iter: 6314, loss: 0.5501570105552673, time cost4.072892665863037
epoch: 185, iter: 6315, loss: 0.7525492906570435, time cost4.089916944503784
epoch: 185, iter: 6316, loss: 0.8432469964027405, time cost3.877872943878174
epoch: 185, iter: 6317, loss: 0.4869789481163025, time cost3.9315338134765625
epoch: 185, iter: 6318, loss: 0.7150388956069946, time cost3.8411591053009033
epoch: 185, iter: 6319, loss: 1.135610580444336, time cost3.8448867797851562
epoch: 185, iter: 6320, loss: 0.8771442770957947, time cost3.902780294418335
epoch: 185, iter: 6321, loss: 0.9416565895080566, time cost3.806218385696411
epoch: 185, iter: 6322, loss: 1.266524314880371, time cost3.8037919998168945
epoch: 185, iter: 6323, loss: 0.4855319559574127, time cost3.9837536811828613
epoch: 185, iter: 6324, loss: 0.2683809697628021, time cost2.6929402351379395
epoch: 186, iter: 6325, loss: 0.8629763722419739, time cost3.908616542816162
epoch: 186, iter: 6326, loss: 0.905778169631958, time cost3.9177157878875732
epoch: 186, iter: 6327, loss: 0.811039388179779, time cost3.9872958660125732
epoch: 186, iter: 6328, loss: 0.91155606508255, time cost4.087904453277588
epoch: 186, iter: 6329, loss: 0.989772617816925, time cost3.851510524749756
epoch: 186, iter: 6330, loss: 0.3842766582965851, time cost4.135814666748047
epoch: 186, iter: 6331, loss: 0.7508391737937927, time cost3.9493985176086426
epoch: 186, iter: 6332, loss: 0.7418802380561829, time cost3.937877893447876
epoch: 186, iter: 6333, loss: 0.9809379577636719, time cost4.018143892288208
epoch: 186, iter: 6334, loss: 0.54115891456604, time cost4.0059590339660645
epoch: 186, iter: 6335, loss: 0.7997153401374817, time cost4.058684349060059
epoch: 186, iter: 6336, loss: 0.7495056390762329, time cost4.055641412734985
epoch: 186, iter: 6337, loss: 0.747319221496582, time cost4.039858818054199
epoch: 186, iter: 6338, loss: 0.36413538455963135, time cost4.095731735229492
epoch: 186, iter: 6339, loss: 0.8805361390113831, time cost4.2195210456848145
epoch: 186, iter: 6340, loss: 0.48977869749069214, time cost3.941897392272949
epoch: 186, iter: 6341, loss: 0.5222417116165161, time cost3.9852662086486816
epoch: 186, iter: 6342, loss: 1.0512875318527222, time cost3.944263458251953
epoch: 186, iter: 6343, loss: 0.5424696803092957, time cost3.9747989177703857
epoch: 186, iter: 6344, loss: 0.8511446714401245, time cost4.0655858516693115
epoch: 186, iter: 6345, loss: 0.45645955204963684, time cost3.97011137008667
epoch: 186, iter: 6346, loss: 0.5961209535598755, time cost4.030096530914307
epoch: 186, iter: 6347, loss: 0.8659409880638123, time cost4.0738608837127686
epoch: 186, iter: 6348, loss: 0.9186945557594299, time cost3.89988374710083
epoch: 186, iter: 6349, loss: 1.7610305547714233, time cost4.033465147018433
epoch: 186, iter: 6350, loss: 0.8260883688926697, time cost4.0183141231536865
tensor([[283., 219., 228.,  ...,   3.,   3.,   3.],
        [ 36.,  44.,  38.,  ...,  24.,  24.,  13.],
        [ 74., 220.,  82.,  ...,   7.,   7.,   4.],
        ...,
        [ 44.,  43.,  26.,  ...,  10.,  10.,  10.],
        [ 28.,  29.,   6.,  ...,   1.,   1.,   1.],
        [162., 240., 279.,  ...,   4.,   4.,   7.]])
Epoch: 186, Iteration: 6350:
TEST A@1: 0.4311111111111111
TEST A@5: 0.7933333333333333
TEST A@10: 0.8866666666666667
TEST M@B: 0.3622559627997764
TEST M@A: 0.9525372085417844
TEST W@MB: 0.19456951122766497
TEST W@MA: 0.5886545155938581
TEST Time: 555.992785692215
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 186, iter: 6351, loss: 0.5716356039047241, time cost4.056583881378174
epoch: 186, iter: 6352, loss: 0.6701642274856567, time cost3.933806896209717
epoch: 186, iter: 6353, loss: 0.6906174421310425, time cost3.949146270751953
epoch: 186, iter: 6354, loss: 1.3380643129348755, time cost4.02664041519165
epoch: 186, iter: 6355, loss: 0.4524574279785156, time cost3.9980316162109375
epoch: 186, iter: 6356, loss: 0.71233069896698, time cost4.089430332183838
epoch: 186, iter: 6357, loss: 0.7445561289787292, time cost4.070781946182251
epoch: 186, iter: 6358, loss: 0.6029884815216064, time cost2.906747579574585
epoch: 187, iter: 6359, loss: 0.44021645188331604, time cost4.123807668685913
epoch: 187, iter: 6360, loss: 1.074179768562317, time cost4.18190598487854
epoch: 187, iter: 6361, loss: 0.6578303575515747, time cost4.19433856010437
epoch: 187, iter: 6362, loss: 0.7139195799827576, time cost4.123464345932007
epoch: 187, iter: 6363, loss: 0.961353600025177, time cost4.227128982543945
epoch: 187, iter: 6364, loss: 0.6031241416931152, time cost4.151344060897827
epoch: 187, iter: 6365, loss: 0.785104513168335, time cost4.030231714248657
epoch: 187, iter: 6366, loss: 0.9905202984809875, time cost4.073347330093384
epoch: 187, iter: 6367, loss: 0.7853850722312927, time cost4.054382801055908
epoch: 187, iter: 6368, loss: 0.2773710787296295, time cost4.155791521072388
epoch: 187, iter: 6369, loss: 0.8123283386230469, time cost4.054795980453491
epoch: 187, iter: 6370, loss: 0.5874954462051392, time cost4.0372679233551025
epoch: 187, iter: 6371, loss: 0.699492871761322, time cost3.9678614139556885
epoch: 187, iter: 6372, loss: 1.0950452089309692, time cost4.039801597595215
epoch: 187, iter: 6373, loss: 0.516926646232605, time cost4.221030235290527
epoch: 187, iter: 6374, loss: 0.8549493551254272, time cost4.108737468719482
epoch: 187, iter: 6375, loss: 1.023576259613037, time cost3.939425468444824
epoch: 187, iter: 6376, loss: 1.0692323446273804, time cost3.9052562713623047
epoch: 187, iter: 6377, loss: 1.0653555393218994, time cost4.046383619308472
epoch: 187, iter: 6378, loss: 0.3759562373161316, time cost4.108107566833496
epoch: 187, iter: 6379, loss: 0.630028486251831, time cost4.17652702331543
epoch: 187, iter: 6380, loss: 0.744689404964447, time cost4.134856224060059
epoch: 187, iter: 6381, loss: 0.8623316884040833, time cost4.02825403213501
epoch: 187, iter: 6382, loss: 0.8575887680053711, time cost4.021916627883911
epoch: 187, iter: 6383, loss: 0.6347596645355225, time cost4.1058149337768555
epoch: 187, iter: 6384, loss: 0.40672099590301514, time cost4.153401613235474
epoch: 187, iter: 6385, loss: 0.8547261953353882, time cost4.002004623413086
epoch: 187, iter: 6386, loss: 0.9400978684425354, time cost4.027752161026001
epoch: 187, iter: 6387, loss: 0.7047429084777832, time cost3.822439432144165
epoch: 187, iter: 6388, loss: 0.7564456462860107, time cost4.07375955581665
epoch: 187, iter: 6389, loss: 0.902839183807373, time cost3.865079641342163
epoch: 187, iter: 6390, loss: 0.48981598019599915, time cost3.9474740028381348
epoch: 187, iter: 6391, loss: 1.1414800882339478, time cost4.009546518325806
epoch: 187, iter: 6392, loss: 0.5877172946929932, time cost2.9994823932647705
epoch: 188, iter: 6393, loss: 1.0288902521133423, time cost4.024385690689087
epoch: 188, iter: 6394, loss: 0.4663955569267273, time cost4.0413291454315186
epoch: 188, iter: 6395, loss: 0.3159005045890808, time cost3.8962554931640625
epoch: 188, iter: 6396, loss: 0.383291095495224, time cost4.04815411567688
epoch: 188, iter: 6397, loss: 0.29129084944725037, time cost4.167312145233154
epoch: 188, iter: 6398, loss: 0.7205921411514282, time cost3.999208688735962
epoch: 188, iter: 6399, loss: 0.6030246019363403, time cost4.2658607959747314
epoch: 188, iter: 6400, loss: 0.5378751754760742, time cost4.06263279914856
tensor([[177., 131., 137.,  ...,   3.,   3.,   2.],
        [  7.,  12.,  10.,  ...,  23.,  23.,  13.],
        [ 18.,  88.,  50.,  ...,   4.,   4.,   2.],
        ...,
        [ 32.,  24.,  20.,  ...,   2.,   2.,   4.],
        [ 74.,  88.,  41.,  ...,   2.,   2.,   2.],
        [ 82., 108., 111.,  ...,   2.,   2.,   2.]])
Epoch: 188, Iteration: 6400:
TEST A@1: 0.4
TEST A@5: 0.78
TEST A@10: 0.8977777777777778
TEST M@B: 0.35004748266488345
TEST M@A: 0.9511128794020707
TEST W@MB: 0.18820652328801774
TEST W@MA: 0.5872276094410739
TEST Time: 557.246185541153
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 188, iter: 6401, loss: 0.48136410117149353, time cost3.835446357727051
epoch: 188, iter: 6402, loss: 0.4900008738040924, time cost3.8437819480895996
epoch: 188, iter: 6403, loss: 0.7841726541519165, time cost3.914033889770508
epoch: 188, iter: 6404, loss: 0.392205148935318, time cost3.969259262084961
epoch: 188, iter: 6405, loss: 1.0299824476242065, time cost4.073275089263916
epoch: 188, iter: 6406, loss: 0.9059069752693176, time cost4.005257606506348
epoch: 188, iter: 6407, loss: 0.6289113163948059, time cost4.132775068283081
epoch: 188, iter: 6408, loss: 0.6226025223731995, time cost4.022519588470459
epoch: 188, iter: 6409, loss: 1.1984272003173828, time cost4.096359014511108
epoch: 188, iter: 6410, loss: 0.7648334503173828, time cost3.945495843887329
epoch: 188, iter: 6411, loss: 0.6601724624633789, time cost4.057816028594971
epoch: 188, iter: 6412, loss: 0.7662976980209351, time cost3.793463706970215
epoch: 188, iter: 6413, loss: 0.6562545299530029, time cost3.9736859798431396
epoch: 188, iter: 6414, loss: 0.876535952091217, time cost3.926746368408203
epoch: 188, iter: 6415, loss: 0.9576488137245178, time cost3.9816269874572754
epoch: 188, iter: 6416, loss: 0.7748459577560425, time cost4.005208492279053
epoch: 188, iter: 6417, loss: 0.862535834312439, time cost4.098852634429932
epoch: 188, iter: 6418, loss: 0.9851678609848022, time cost3.9641551971435547
epoch: 188, iter: 6419, loss: 0.7683113217353821, time cost3.8538472652435303
epoch: 188, iter: 6420, loss: 0.6814301013946533, time cost4.093555688858032
epoch: 188, iter: 6421, loss: 0.5357577800750732, time cost3.841583251953125
epoch: 188, iter: 6422, loss: 1.2211183309555054, time cost3.9516754150390625
epoch: 188, iter: 6423, loss: 0.7131949663162231, time cost3.7250795364379883
epoch: 188, iter: 6424, loss: 0.7192623615264893, time cost3.841900587081909
epoch: 188, iter: 6425, loss: 0.8562397956848145, time cost3.8540866374969482
epoch: 188, iter: 6426, loss: 0.7433818578720093, time cost2.9099419116973877
epoch: 189, iter: 6427, loss: 0.47628164291381836, time cost4.138890027999878
epoch: 189, iter: 6428, loss: 1.3492488861083984, time cost4.188813924789429
epoch: 189, iter: 6429, loss: 0.36345553398132324, time cost4.1384828090667725
epoch: 189, iter: 6430, loss: 1.165710210800171, time cost4.0653979778289795
epoch: 189, iter: 6431, loss: 0.5657490491867065, time cost4.083702802658081
epoch: 189, iter: 6432, loss: 0.7522910237312317, time cost4.03885293006897
epoch: 189, iter: 6433, loss: 1.2764028310775757, time cost3.928807497024536
epoch: 189, iter: 6434, loss: 0.8148949146270752, time cost4.126677989959717
epoch: 189, iter: 6435, loss: 0.8714210987091064, time cost3.9404296875
epoch: 189, iter: 6436, loss: 0.6270856261253357, time cost4.044812202453613
epoch: 189, iter: 6437, loss: 1.3271114826202393, time cost4.002931118011475
epoch: 189, iter: 6438, loss: 0.8484269380569458, time cost4.09655237197876
epoch: 189, iter: 6439, loss: 0.8008574843406677, time cost3.9823858737945557
epoch: 189, iter: 6440, loss: 1.1471682786941528, time cost3.904186487197876
epoch: 189, iter: 6441, loss: 0.5051643252372742, time cost4.098296403884888
epoch: 189, iter: 6442, loss: 0.9393382668495178, time cost3.927488088607788
epoch: 189, iter: 6443, loss: 0.46533432602882385, time cost4.113625526428223
epoch: 189, iter: 6444, loss: 0.5473765730857849, time cost3.9953370094299316
epoch: 189, iter: 6445, loss: 1.3987798690795898, time cost4.054241895675659
epoch: 189, iter: 6446, loss: 0.609585702419281, time cost4.118770122528076
epoch: 189, iter: 6447, loss: 1.0743153095245361, time cost4.056156873703003
epoch: 189, iter: 6448, loss: 0.8726176619529724, time cost4.0421435832977295
epoch: 189, iter: 6449, loss: 0.6439658999443054, time cost4.0851149559021
epoch: 189, iter: 6450, loss: 0.5696674585342407, time cost4.089584589004517
tensor([[103.,  88.,  92.,  ...,   6.,   6.,   6.],
        [ 15.,  12.,  12.,  ...,   9.,   9.,   8.],
        [ 25., 127.,  43.,  ...,   8.,   8.,   4.],
        ...,
        [ 33.,  27.,  17.,  ...,   5.,   5.,   3.],
        [ 68.,  63.,  22.,  ...,   1.,   1.,   1.],
        [ 74., 136., 175.,  ...,   2.,   2.,   1.]])
Epoch: 189, Iteration: 6450:
TEST A@1: 0.41333333333333333
TEST A@5: 0.7622222222222222
TEST A@10: 0.8866666666666667
TEST M@B: 0.34790761051435704
TEST M@A: 0.9501081065330359
TEST W@MB: 0.18663050898368536
TEST W@MA: 0.5867355283099739
TEST Time: 501.97648453712463
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 189, iter: 6451, loss: 0.923664391040802, time cost4.06125020980835
epoch: 189, iter: 6452, loss: 0.7243810892105103, time cost3.9206907749176025
epoch: 189, iter: 6453, loss: 0.6717115044593811, time cost4.023568868637085
epoch: 189, iter: 6454, loss: 0.4049247205257416, time cost3.9541146755218506
epoch: 189, iter: 6455, loss: 0.3749268651008606, time cost4.131424427032471
epoch: 189, iter: 6456, loss: 0.3326447606086731, time cost4.066327810287476
epoch: 189, iter: 6457, loss: 0.9623929262161255, time cost4.120076417922974
epoch: 189, iter: 6458, loss: 0.6295598745346069, time cost3.9125115871429443
epoch: 189, iter: 6459, loss: 0.7239091992378235, time cost4.1757776737213135
epoch: 189, iter: 6460, loss: 0.8037446737289429, time cost2.8794596195220947
epoch: 190, iter: 6461, loss: 0.6002036929130554, time cost4.100285530090332
epoch: 190, iter: 6462, loss: 0.6766946911811829, time cost4.227828025817871
epoch: 190, iter: 6463, loss: 0.49693238735198975, time cost4.182034254074097
epoch: 190, iter: 6464, loss: 0.9726059436798096, time cost4.143105983734131
epoch: 190, iter: 6465, loss: 0.4725261926651001, time cost4.150585174560547
epoch: 190, iter: 6466, loss: 0.6745143532752991, time cost4.128948450088501
epoch: 190, iter: 6467, loss: 0.7393190264701843, time cost4.287868022918701
epoch: 190, iter: 6468, loss: 0.703007161617279, time cost4.322665214538574
epoch: 190, iter: 6469, loss: 0.7106602191925049, time cost4.187036752700806
epoch: 190, iter: 6470, loss: 0.6597118973731995, time cost4.172745704650879
epoch: 190, iter: 6471, loss: 1.0166622400283813, time cost4.259235620498657
epoch: 190, iter: 6472, loss: 0.7006720304489136, time cost4.177372932434082
epoch: 190, iter: 6473, loss: 0.6547799110412598, time cost4.1975908279418945
epoch: 190, iter: 6474, loss: 0.5464760661125183, time cost4.186203956604004
epoch: 190, iter: 6475, loss: 1.325944185256958, time cost4.313510894775391
epoch: 190, iter: 6476, loss: 0.9783579111099243, time cost4.26404881477356
epoch: 190, iter: 6477, loss: 0.555336594581604, time cost4.1476099491119385
epoch: 190, iter: 6478, loss: 0.8068212270736694, time cost4.150334596633911
epoch: 190, iter: 6479, loss: 1.1346417665481567, time cost4.065999269485474
epoch: 190, iter: 6480, loss: 0.4707678556442261, time cost4.171571969985962
epoch: 190, iter: 6481, loss: 0.829605221748352, time cost4.214155197143555
epoch: 190, iter: 6482, loss: 0.9012083411216736, time cost4.254514217376709
epoch: 190, iter: 6483, loss: 0.43816933035850525, time cost4.202302694320679
epoch: 190, iter: 6484, loss: 0.8506363034248352, time cost4.381943464279175
epoch: 190, iter: 6485, loss: 0.922145664691925, time cost4.304380893707275
epoch: 190, iter: 6486, loss: 0.7890087962150574, time cost4.2209649085998535
epoch: 190, iter: 6487, loss: 0.6550706028938293, time cost3.9854164123535156
epoch: 190, iter: 6488, loss: 0.6863008141517639, time cost4.087767124176025
epoch: 190, iter: 6489, loss: 0.5529704093933105, time cost4.183357000350952
epoch: 190, iter: 6490, loss: 0.9423432350158691, time cost4.106074810028076
epoch: 190, iter: 6491, loss: 0.7059723734855652, time cost4.175286293029785
epoch: 190, iter: 6492, loss: 0.6261534690856934, time cost4.138854026794434
epoch: 190, iter: 6493, loss: 0.6604307889938354, time cost4.2782206535339355
epoch: 190, iter: 6494, loss: 0.5556365251541138, time cost2.8243556022644043
epoch: 191, iter: 6495, loss: 0.5353386998176575, time cost4.0957701206207275
epoch: 191, iter: 6496, loss: 0.7293177247047424, time cost4.128539085388184
epoch: 191, iter: 6497, loss: 0.7139440178871155, time cost4.035008192062378
epoch: 191, iter: 6498, loss: 0.8842081427574158, time cost4.136530160903931
epoch: 191, iter: 6499, loss: 0.826894998550415, time cost3.953016757965088
epoch: 191, iter: 6500, loss: 0.49512067437171936, time cost4.325537443161011
tensor([[ 27.,  25.,  23.,  ...,   1.,   1.,   1.],
        [ 10.,  10.,   9.,  ...,   8.,   8.,   7.],
        [ 22., 177.,  61.,  ...,   2.,   2.,   1.],
        ...,
        [ 44.,  45.,  30.,  ...,  15.,  15.,  10.],
        [ 62.,  57.,  39.,  ...,   1.,   1.,   1.],
        [ 21.,  51.,  52.,  ...,   1.,   1.,   1.]])
Epoch: 191, Iteration: 6500:
TEST A@1: 0.5044444444444445
TEST A@5: 0.8777777777777778
TEST A@10: 0.9577777777777777
TEST M@B: 0.4062899466546202
TEST M@A: 0.954702725977829
TEST W@MB: 0.2170555618691926
TEST W@MA: 0.5896232031688817
TEST Time: 565.6207263469696
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 191, iter: 6501, loss: 0.7640498280525208, time cost4.242929935455322
epoch: 191, iter: 6502, loss: 0.5547220706939697, time cost4.081171751022339
epoch: 191, iter: 6503, loss: 0.7728931307792664, time cost4.028627157211304
epoch: 191, iter: 6504, loss: 0.9175328016281128, time cost3.9942874908447266
epoch: 191, iter: 6505, loss: 0.5441729426383972, time cost3.9996426105499268
epoch: 191, iter: 6506, loss: 0.8481172919273376, time cost4.05100417137146
epoch: 191, iter: 6507, loss: 0.9786421656608582, time cost4.034388303756714
epoch: 191, iter: 6508, loss: 0.7990427613258362, time cost3.9602904319763184
epoch: 191, iter: 6509, loss: 0.6406745910644531, time cost3.9307775497436523
epoch: 191, iter: 6510, loss: 0.5313266515731812, time cost4.0395731925964355
epoch: 191, iter: 6511, loss: 1.619086503982544, time cost3.9380829334259033
epoch: 191, iter: 6512, loss: 0.4131002724170685, time cost4.133835792541504
epoch: 191, iter: 6513, loss: 0.4800112247467041, time cost4.035694360733032
epoch: 191, iter: 6514, loss: 0.5884827971458435, time cost4.119176387786865
epoch: 191, iter: 6515, loss: 1.0924689769744873, time cost3.942793130874634
epoch: 191, iter: 6516, loss: 0.5273938179016113, time cost4.129434823989868
epoch: 191, iter: 6517, loss: 0.6482527256011963, time cost3.851043701171875
epoch: 191, iter: 6518, loss: 0.8380897641181946, time cost3.850186824798584
epoch: 191, iter: 6519, loss: 0.5282476544380188, time cost4.135131120681763
epoch: 191, iter: 6520, loss: 0.7064574956893921, time cost4.007462501525879
epoch: 191, iter: 6521, loss: 1.085004448890686, time cost3.8768911361694336
epoch: 191, iter: 6522, loss: 0.7400233149528503, time cost4.103734254837036
epoch: 191, iter: 6523, loss: 0.5624415278434753, time cost3.9795901775360107
epoch: 191, iter: 6524, loss: 0.4854726493358612, time cost3.9317452907562256
epoch: 191, iter: 6525, loss: 0.7035543918609619, time cost3.9012558460235596
epoch: 191, iter: 6526, loss: 0.745499849319458, time cost3.810839891433716
epoch: 191, iter: 6527, loss: 0.8291916251182556, time cost4.094322204589844
epoch: 191, iter: 6528, loss: 0.46900466084480286, time cost2.8414289951324463
epoch: 192, iter: 6529, loss: 0.7285767197608948, time cost3.921578884124756
epoch: 192, iter: 6530, loss: 0.5451012849807739, time cost4.131794214248657
epoch: 192, iter: 6531, loss: 0.9134289026260376, time cost4.0515758991241455
epoch: 192, iter: 6532, loss: 1.146314024925232, time cost3.8829822540283203
epoch: 192, iter: 6533, loss: 0.7657589912414551, time cost4.053835153579712
epoch: 192, iter: 6534, loss: 0.890123188495636, time cost4.058748960494995
epoch: 192, iter: 6535, loss: 1.0123118162155151, time cost3.9166994094848633
epoch: 192, iter: 6536, loss: 1.1561870574951172, time cost3.9790756702423096
epoch: 192, iter: 6537, loss: 0.31805500388145447, time cost3.861842393875122
epoch: 192, iter: 6538, loss: 0.8067588806152344, time cost3.978886842727661
epoch: 192, iter: 6539, loss: 0.641276478767395, time cost3.9193732738494873
epoch: 192, iter: 6540, loss: 0.5996893048286438, time cost3.940880060195923
epoch: 192, iter: 6541, loss: 0.614846408367157, time cost4.008427619934082
epoch: 192, iter: 6542, loss: 0.7742583751678467, time cost3.8585495948791504
epoch: 192, iter: 6543, loss: 1.453593373298645, time cost3.965644598007202
epoch: 192, iter: 6544, loss: 0.7233070731163025, time cost3.995603084564209
epoch: 192, iter: 6545, loss: 1.1260607242584229, time cost4.0355384349823
epoch: 192, iter: 6546, loss: 0.4798845052719116, time cost3.997805595397949
epoch: 192, iter: 6547, loss: 0.8393696546554565, time cost4.008896589279175
epoch: 192, iter: 6548, loss: 0.5293303728103638, time cost4.010913610458374
epoch: 192, iter: 6549, loss: 0.6953866481781006, time cost3.9562246799468994
epoch: 192, iter: 6550, loss: 0.8667743802070618, time cost4.01263952255249
tensor([[114.,  86., 100.,  ...,   2.,   2.,   2.],
        [  5.,   5.,   5.,  ...,   6.,   6.,   4.],
        [ 46., 138.,  39.,  ...,   5.,   5.,   2.],
        ...,
        [109., 111.,  85.,  ...,  17.,  17.,  12.],
        [ 35.,  33.,   5.,  ...,   1.,   1.,   1.],
        [ 88., 221., 259.,  ...,   5.,   5.,   5.]])
Epoch: 192, Iteration: 6550:
TEST A@1: 0.5022222222222222
TEST A@5: 0.8733333333333333
TEST A@10: 0.9577777777777777
TEST M@B: 0.40116336874711533
TEST M@A: 0.9541322875750354
TEST W@MB: 0.21433403079903796
TEST W@MA: 0.5890282743213169
TEST Time: 565.1985273361206
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 192, iter: 6551, loss: 0.8881787657737732, time cost4.112613677978516
epoch: 192, iter: 6552, loss: 0.32006555795669556, time cost4.101868391036987
epoch: 192, iter: 6553, loss: 0.6736612915992737, time cost4.173623561859131
epoch: 192, iter: 6554, loss: 0.8226407170295715, time cost3.9647040367126465
epoch: 192, iter: 6555, loss: 0.767082691192627, time cost4.010894298553467
epoch: 192, iter: 6556, loss: 1.4286798238754272, time cost4.102556467056274
epoch: 192, iter: 6557, loss: 0.7399738430976868, time cost4.004763841629028
epoch: 192, iter: 6558, loss: 0.8497753739356995, time cost4.214214563369751
epoch: 192, iter: 6559, loss: 0.6326479315757751, time cost4.0146238803863525
epoch: 192, iter: 6560, loss: 0.7601273655891418, time cost3.9736998081207275
epoch: 192, iter: 6561, loss: 0.7350413799285889, time cost3.9389796257019043
epoch: 192, iter: 6562, loss: 1.0738450288772583, time cost2.8101272583007812
epoch: 193, iter: 6563, loss: 1.0630236864089966, time cost4.097283363342285
epoch: 193, iter: 6564, loss: 0.5310966372489929, time cost4.005103588104248
epoch: 193, iter: 6565, loss: 0.782351553440094, time cost4.025274991989136
epoch: 193, iter: 6566, loss: 0.6355472207069397, time cost4.055613279342651
epoch: 193, iter: 6567, loss: 0.6770239472389221, time cost3.9447412490844727
epoch: 193, iter: 6568, loss: 0.9624764323234558, time cost3.965134620666504
epoch: 193, iter: 6569, loss: 0.42437541484832764, time cost4.019189357757568
epoch: 193, iter: 6570, loss: 0.675343930721283, time cost3.9409518241882324
epoch: 193, iter: 6571, loss: 0.7496922016143799, time cost3.968275785446167
epoch: 193, iter: 6572, loss: 1.68246328830719, time cost4.067014217376709
epoch: 193, iter: 6573, loss: 0.6579786539077759, time cost3.945610761642456
epoch: 193, iter: 6574, loss: 0.643378734588623, time cost4.009389162063599
epoch: 193, iter: 6575, loss: 1.0288174152374268, time cost4.178272724151611
epoch: 193, iter: 6576, loss: 0.9386959671974182, time cost4.089060544967651
epoch: 193, iter: 6577, loss: 0.693313717842102, time cost4.00407862663269
epoch: 193, iter: 6578, loss: 0.9330362677574158, time cost4.032898664474487
epoch: 193, iter: 6579, loss: 0.47668108344078064, time cost3.9959700107574463
epoch: 193, iter: 6580, loss: 0.8585492372512817, time cost4.03465723991394
epoch: 193, iter: 6581, loss: 1.0366812944412231, time cost3.9149491786956787
epoch: 193, iter: 6582, loss: 0.7466462254524231, time cost4.060400009155273
epoch: 193, iter: 6583, loss: 1.0766785144805908, time cost3.8651366233825684
epoch: 193, iter: 6584, loss: 0.87416011095047, time cost3.9377236366271973
epoch: 193, iter: 6585, loss: 0.9522600173950195, time cost4.14398193359375
epoch: 193, iter: 6586, loss: 0.595829963684082, time cost4.21328067779541
epoch: 193, iter: 6587, loss: 0.7759366631507874, time cost3.9748611450195312
epoch: 193, iter: 6588, loss: 0.4838375747203827, time cost4.073895692825317
epoch: 193, iter: 6589, loss: 0.7494688630104065, time cost4.070021867752075
epoch: 193, iter: 6590, loss: 0.8297439813613892, time cost4.020557403564453
epoch: 193, iter: 6591, loss: 0.6702049374580383, time cost3.938084125518799
epoch: 193, iter: 6592, loss: 0.46053048968315125, time cost3.959705352783203
epoch: 193, iter: 6593, loss: 1.0887049436569214, time cost3.988720417022705
epoch: 193, iter: 6594, loss: 1.1047662496566772, time cost3.893730640411377
epoch: 193, iter: 6595, loss: 0.4142395257949829, time cost3.927915096282959
epoch: 193, iter: 6596, loss: 0.5175076723098755, time cost2.872131586074829
epoch: 194, iter: 6597, loss: 0.6265142560005188, time cost4.006305456161499
epoch: 194, iter: 6598, loss: 0.5098838806152344, time cost4.013566017150879
epoch: 194, iter: 6599, loss: 0.6176741719245911, time cost4.026176691055298
epoch: 194, iter: 6600, loss: 1.1911839246749878, time cost3.9793403148651123
tensor([[ 27.,  22.,  30.,  ...,   5.,   5.,   4.],
        [  5.,   7.,   7.,  ...,   3.,   3.,   1.],
        [ 88., 298.,  91.,  ...,   6.,   6.,   2.],
        ...,
        [ 58.,  61.,  41.,  ...,  11.,  11.,   7.],
        [ 17.,  19.,   3.,  ...,   1.,   1.,   1.],
        [ 11.,  79.,  81.,  ...,   3.,   3.,   4.]])
Epoch: 194, Iteration: 6600:
TEST A@1: 0.5177777777777778
TEST A@5: 0.86
TEST A@10: 0.9511111111111111
TEST M@B: 0.4114721521234404
TEST M@A: 0.9549845520106203
TEST W@MB: 0.2205475520793247
TEST W@MA: 0.5897845961949701
TEST Time: 551.321977853775
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 194, iter: 6601, loss: 0.7049525380134583, time cost3.989640712738037
epoch: 194, iter: 6602, loss: 0.7892956137657166, time cost3.8815529346466064
epoch: 194, iter: 6603, loss: 0.6095303297042847, time cost3.949962854385376
epoch: 194, iter: 6604, loss: 0.2993498742580414, time cost3.9059135913848877
epoch: 194, iter: 6605, loss: 0.54729163646698, time cost4.100747108459473
epoch: 194, iter: 6606, loss: 0.7686590552330017, time cost4.010413408279419
epoch: 194, iter: 6607, loss: 0.7438898682594299, time cost3.936028242111206
epoch: 194, iter: 6608, loss: 1.0122954845428467, time cost3.949833869934082
epoch: 194, iter: 6609, loss: 0.6761383414268494, time cost3.9400532245635986
epoch: 194, iter: 6610, loss: 0.6038719415664673, time cost4.048591613769531
epoch: 194, iter: 6611, loss: 0.4438522458076477, time cost4.047132968902588
epoch: 194, iter: 6612, loss: 0.48027923703193665, time cost4.0308942794799805
epoch: 194, iter: 6613, loss: 0.8101434707641602, time cost3.9991722106933594
epoch: 194, iter: 6614, loss: 0.8893266916275024, time cost3.9305806159973145
epoch: 194, iter: 6615, loss: 0.9717421531677246, time cost4.052932262420654
epoch: 194, iter: 6616, loss: 0.5463865995407104, time cost4.1454596519470215
epoch: 194, iter: 6617, loss: 0.744640588760376, time cost3.974958896636963
epoch: 194, iter: 6618, loss: 0.5171371698379517, time cost4.0804243087768555
epoch: 194, iter: 6619, loss: 0.7004517912864685, time cost3.9793970584869385
epoch: 194, iter: 6620, loss: 0.5539822578430176, time cost4.018022537231445
epoch: 194, iter: 6621, loss: 0.6791754961013794, time cost3.9415194988250732
epoch: 194, iter: 6622, loss: 0.5418651103973389, time cost3.9307796955108643
epoch: 194, iter: 6623, loss: 0.6634731292724609, time cost4.171327114105225
epoch: 194, iter: 6624, loss: 0.5322949886322021, time cost3.992906332015991
epoch: 194, iter: 6625, loss: 1.0929596424102783, time cost3.927610397338867
epoch: 194, iter: 6626, loss: 1.2145766019821167, time cost3.9405174255371094
epoch: 194, iter: 6627, loss: 0.9897431135177612, time cost3.8346714973449707
epoch: 194, iter: 6628, loss: 0.6686816811561584, time cost3.8281586170196533
epoch: 194, iter: 6629, loss: 0.9824963808059692, time cost3.965909004211426
epoch: 194, iter: 6630, loss: 0.4616403579711914, time cost2.860100030899048
epoch: 195, iter: 6631, loss: 0.9162957072257996, time cost4.0052900314331055
epoch: 195, iter: 6632, loss: 0.9633373022079468, time cost3.982388734817505
epoch: 195, iter: 6633, loss: 0.5522773265838623, time cost4.058024883270264
epoch: 195, iter: 6634, loss: 0.5733467936515808, time cost3.9012129306793213
epoch: 195, iter: 6635, loss: 1.1461677551269531, time cost3.966190814971924
epoch: 195, iter: 6636, loss: 1.2126580476760864, time cost4.22154974937439
epoch: 195, iter: 6637, loss: 0.894313395023346, time cost3.914604902267456
epoch: 195, iter: 6638, loss: 0.7075988054275513, time cost3.967013359069824
epoch: 195, iter: 6639, loss: 0.6886160373687744, time cost4.1431121826171875
epoch: 195, iter: 6640, loss: 1.0110929012298584, time cost4.033250570297241
epoch: 195, iter: 6641, loss: 0.6782240867614746, time cost3.906057119369507
epoch: 195, iter: 6642, loss: 1.1034884452819824, time cost4.040250778198242
epoch: 195, iter: 6643, loss: 0.6446261405944824, time cost4.020457983016968
epoch: 195, iter: 6644, loss: 0.7293928861618042, time cost4.072998523712158
epoch: 195, iter: 6645, loss: 0.4847133159637451, time cost3.811371326446533
epoch: 195, iter: 6646, loss: 1.0468329191207886, time cost4.02335786819458
epoch: 195, iter: 6647, loss: 0.5498418211936951, time cost3.952653646469116
epoch: 195, iter: 6648, loss: 0.924079954624176, time cost4.109557151794434
epoch: 195, iter: 6649, loss: 0.8204322457313538, time cost4.099457263946533
epoch: 195, iter: 6650, loss: 0.9314815402030945, time cost4.062187194824219
tensor([[ 50.,  23.,  29.,  ...,   1.,   1.,   1.],
        [ 14.,  19.,  14.,  ...,  13.,  13.,   7.],
        [ 45., 119.,  63.,  ...,   8.,   8.,   3.],
        ...,
        [ 34.,  35.,  13.,  ...,   8.,   8.,   7.],
        [ 66.,  71.,   8.,  ...,   1.,   1.,   1.],
        [ 13.,  79.,  91.,  ...,   1.,   1.,   2.]])
Epoch: 195, Iteration: 6650:
TEST A@1: 0.4911111111111111
TEST A@5: 0.8377777777777777
TEST A@10: 0.9333333333333333
TEST M@B: 0.4034930479117836
TEST M@A: 0.9555974837672114
TEST W@MB: 0.2160162293667707
TEST W@MA: 0.5905713826242905
TEST Time: 562.0517508983612
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 195, iter: 6651, loss: 0.6689231395721436, time cost4.006714344024658
epoch: 195, iter: 6652, loss: 0.7660565376281738, time cost3.9634571075439453
epoch: 195, iter: 6653, loss: 0.41648781299591064, time cost3.997014284133911
epoch: 195, iter: 6654, loss: 0.389521986246109, time cost4.023287296295166
epoch: 195, iter: 6655, loss: 0.6388667225837708, time cost4.017253160476685
epoch: 195, iter: 6656, loss: 0.7367628812789917, time cost3.8604135513305664
epoch: 195, iter: 6657, loss: 0.5223419666290283, time cost3.889482021331787
epoch: 195, iter: 6658, loss: 0.5283705592155457, time cost3.9288971424102783
epoch: 195, iter: 6659, loss: 0.4238210916519165, time cost3.882070302963257
epoch: 195, iter: 6660, loss: 0.7735421657562256, time cost3.9354779720306396
epoch: 195, iter: 6661, loss: 0.8241925239562988, time cost3.8762192726135254
epoch: 195, iter: 6662, loss: 1.0340919494628906, time cost3.7740824222564697
epoch: 195, iter: 6663, loss: 0.8039052486419678, time cost3.832233190536499
epoch: 195, iter: 6664, loss: 0.4819730222225189, time cost2.8867177963256836
epoch: 196, iter: 6665, loss: 0.7282536029815674, time cost4.02219295501709
epoch: 196, iter: 6666, loss: 0.7689662575721741, time cost3.8562440872192383
epoch: 196, iter: 6667, loss: 0.8681790232658386, time cost4.0185112953186035
epoch: 196, iter: 6668, loss: 0.6899517774581909, time cost4.010111570358276
epoch: 196, iter: 6669, loss: 0.7294117212295532, time cost4.063486099243164
epoch: 196, iter: 6670, loss: 0.7144008874893188, time cost4.06879997253418
epoch: 196, iter: 6671, loss: 0.2858058214187622, time cost3.9791839122772217
epoch: 196, iter: 6672, loss: 0.7236663103103638, time cost3.9677958488464355
epoch: 196, iter: 6673, loss: 0.5984067320823669, time cost4.048968553543091
epoch: 196, iter: 6674, loss: 0.8951455950737, time cost4.246739149093628
epoch: 196, iter: 6675, loss: 1.2029483318328857, time cost4.029337644577026
epoch: 196, iter: 6676, loss: 0.5261578559875488, time cost4.1930012702941895
epoch: 196, iter: 6677, loss: 1.441593050956726, time cost4.079634666442871
epoch: 196, iter: 6678, loss: 0.6249744296073914, time cost4.172188997268677
epoch: 196, iter: 6679, loss: 0.4653393626213074, time cost3.9603652954101562
epoch: 196, iter: 6680, loss: 0.8171479105949402, time cost4.06113600730896
epoch: 196, iter: 6681, loss: 0.7585309743881226, time cost4.104076147079468
epoch: 196, iter: 6682, loss: 0.4280904531478882, time cost4.066920757293701
epoch: 196, iter: 6683, loss: 0.4816869795322418, time cost3.967172861099243
epoch: 196, iter: 6684, loss: 0.9264213442802429, time cost3.9399547576904297
epoch: 196, iter: 6685, loss: 1.0624860525131226, time cost3.9983980655670166
epoch: 196, iter: 6686, loss: 0.6335538029670715, time cost3.900235176086426
epoch: 196, iter: 6687, loss: 0.6277363896369934, time cost4.099876880645752
epoch: 196, iter: 6688, loss: 0.7589790225028992, time cost4.024077653884888
epoch: 196, iter: 6689, loss: 0.9577879905700684, time cost4.246262073516846
epoch: 196, iter: 6690, loss: 0.7837392091751099, time cost4.271491050720215
epoch: 196, iter: 6691, loss: 0.7053035497665405, time cost4.204708576202393
epoch: 196, iter: 6692, loss: 0.8407155871391296, time cost4.314135789871216
epoch: 196, iter: 6693, loss: 0.633279025554657, time cost4.201355934143066
epoch: 196, iter: 6694, loss: 0.5960480570793152, time cost4.149503469467163
epoch: 196, iter: 6695, loss: 1.0155534744262695, time cost4.01963472366333
epoch: 196, iter: 6696, loss: 0.7404491901397705, time cost4.046527147293091
epoch: 196, iter: 6697, loss: 0.6508303284645081, time cost4.390361309051514
epoch: 196, iter: 6698, loss: 0.8561824560165405, time cost2.8994295597076416
epoch: 197, iter: 6699, loss: 0.8191126585006714, time cost4.216390609741211
epoch: 197, iter: 6700, loss: 1.0268559455871582, time cost3.9952690601348877
tensor([[ 87.,  55.,  63.,  ...,   1.,   1.,   1.],
        [ 35.,  25.,  26.,  ...,  15.,  15.,  10.],
        [ 76., 179.,  84.,  ...,  12.,  12.,   3.],
        ...,
        [ 48.,  49.,  35.,  ...,   6.,   6.,   5.],
        [ 34.,  38.,   4.,  ...,   1.,   1.,   1.],
        [111., 175., 223.,  ...,   3.,   3.,   5.]])
Epoch: 197, Iteration: 6700:
TEST A@1: 0.5311111111111111
TEST A@5: 0.8644444444444445
TEST A@10: 0.9466666666666667
TEST M@B: 0.39633651861188546
TEST M@A: 0.9550734972886387
TEST W@MB: 0.2119085522167492
TEST W@MA: 0.590038733742202
TEST Time: 446.0157644748688
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 197, iter: 6701, loss: 1.0963314771652222, time cost4.151788234710693
epoch: 197, iter: 6702, loss: 0.8263913989067078, time cost4.285506010055542
epoch: 197, iter: 6703, loss: 0.5308303236961365, time cost4.276397705078125
epoch: 197, iter: 6704, loss: 0.40021371841430664, time cost4.250023365020752
epoch: 197, iter: 6705, loss: 0.6589292883872986, time cost4.3045337200164795
epoch: 197, iter: 6706, loss: 1.0992408990859985, time cost4.224860429763794
epoch: 197, iter: 6707, loss: 0.5375268459320068, time cost4.285839080810547
epoch: 197, iter: 6708, loss: 0.5900896191596985, time cost4.33101224899292
epoch: 197, iter: 6709, loss: 0.45579713582992554, time cost4.34282112121582
epoch: 197, iter: 6710, loss: 0.5587173104286194, time cost4.276091814041138
epoch: 197, iter: 6711, loss: 0.8272682428359985, time cost4.158655881881714
epoch: 197, iter: 6712, loss: 0.6294005513191223, time cost4.405944585800171
epoch: 197, iter: 6713, loss: 0.7981708645820618, time cost4.34339714050293
epoch: 197, iter: 6714, loss: 1.1720162630081177, time cost4.270690202713013
epoch: 197, iter: 6715, loss: 0.6546863317489624, time cost4.201590538024902
epoch: 197, iter: 6716, loss: 0.8335676193237305, time cost4.227550745010376
epoch: 197, iter: 6717, loss: 0.5554746985435486, time cost4.305418014526367
epoch: 197, iter: 6718, loss: 0.9128326773643494, time cost4.272239923477173
epoch: 197, iter: 6719, loss: 1.36638605594635, time cost4.330494165420532
epoch: 197, iter: 6720, loss: 0.702476441860199, time cost4.265278100967407
epoch: 197, iter: 6721, loss: 0.8553971648216248, time cost4.237316131591797
epoch: 197, iter: 6722, loss: 0.5685876607894897, time cost4.186884880065918
epoch: 197, iter: 6723, loss: 0.9881267547607422, time cost4.354169845581055
epoch: 197, iter: 6724, loss: 0.45690298080444336, time cost4.3082849979400635
epoch: 197, iter: 6725, loss: 1.0271203517913818, time cost4.387558460235596
epoch: 197, iter: 6726, loss: 0.6953158378601074, time cost4.372459888458252
epoch: 197, iter: 6727, loss: 0.6385629177093506, time cost4.2221643924713135
epoch: 197, iter: 6728, loss: 1.0069093704223633, time cost4.187056541442871
epoch: 197, iter: 6729, loss: 1.1144968271255493, time cost4.306003570556641
epoch: 197, iter: 6730, loss: 0.8171060681343079, time cost4.277559757232666
epoch: 197, iter: 6731, loss: 0.8107608556747437, time cost4.066343069076538
epoch: 197, iter: 6732, loss: 0.3810350000858307, time cost3.041214942932129
epoch: 198, iter: 6733, loss: 0.686916708946228, time cost4.258999824523926
epoch: 198, iter: 6734, loss: 1.167319416999817, time cost4.147947311401367
epoch: 198, iter: 6735, loss: 0.723171591758728, time cost3.606337308883667
epoch: 198, iter: 6736, loss: 0.7034968733787537, time cost4.188079595565796
epoch: 198, iter: 6737, loss: 1.226542592048645, time cost4.204810619354248
epoch: 198, iter: 6738, loss: 0.678363561630249, time cost3.9419524669647217
epoch: 198, iter: 6739, loss: 0.7221989631652832, time cost3.945021629333496
epoch: 198, iter: 6740, loss: 0.461021363735199, time cost4.078256845474243
epoch: 198, iter: 6741, loss: 0.5374892354011536, time cost4.034071445465088
epoch: 198, iter: 6742, loss: 1.0540859699249268, time cost4.172895669937134
epoch: 198, iter: 6743, loss: 0.6723842620849609, time cost4.049875497817993
epoch: 198, iter: 6744, loss: 0.7890670895576477, time cost4.241118431091309
epoch: 198, iter: 6745, loss: 0.9479547739028931, time cost4.171342134475708
epoch: 198, iter: 6746, loss: 1.0163441896438599, time cost4.26133394241333
epoch: 198, iter: 6747, loss: 0.6559714078903198, time cost4.108921766281128
epoch: 198, iter: 6748, loss: 0.6336898803710938, time cost4.210517168045044
epoch: 198, iter: 6749, loss: 0.7445282936096191, time cost4.221501111984253
epoch: 198, iter: 6750, loss: 0.9954974055290222, time cost4.2318103313446045
tensor([[ 23.,  18.,  25.,  ...,   1.,   1.,   1.],
        [ 16.,  19.,  17.,  ...,  17.,  17.,   9.],
        [ 92., 258., 117.,  ...,   2.,   2.,   1.],
        ...,
        [ 56.,  54.,  39.,  ...,  11.,  11.,   9.],
        [143., 133.,  18.,  ...,   1.,   1.,   1.],
        [  8.,  17.,  24.,  ...,   1.,   1.,   1.]])
Epoch: 198, Iteration: 6750:
TEST A@1: 0.5422222222222223
TEST A@5: 0.8622222222222222
TEST A@10: 0.9377777777777778
TEST M@B: 0.4217534581159119
TEST M@A: 0.9563303289289868
TEST W@MB: 0.22693151814886167
TEST W@MA: 0.5910016703374233
TEST Time: 561.7277038097382
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 198, iter: 6751, loss: 0.7348352074623108, time cost3.9639370441436768
epoch: 198, iter: 6752, loss: 1.1628189086914062, time cost4.132194995880127
epoch: 198, iter: 6753, loss: 0.7235630750656128, time cost3.974260091781616
epoch: 198, iter: 6754, loss: 0.8296550512313843, time cost4.2947564125061035
epoch: 198, iter: 6755, loss: 0.8853609561920166, time cost4.130192995071411
epoch: 198, iter: 6756, loss: 0.7927358150482178, time cost4.169415235519409
epoch: 198, iter: 6757, loss: 0.37682539224624634, time cost4.208390235900879
epoch: 198, iter: 6758, loss: 0.8051741123199463, time cost4.2349934577941895
epoch: 198, iter: 6759, loss: 0.6158135533332825, time cost4.100454807281494
epoch: 198, iter: 6760, loss: 0.6784204840660095, time cost4.013721704483032
epoch: 198, iter: 6761, loss: 0.6382141709327698, time cost4.032848834991455
epoch: 198, iter: 6762, loss: 0.42977356910705566, time cost4.009214401245117
epoch: 198, iter: 6763, loss: 0.6943150758743286, time cost4.059205532073975
epoch: 198, iter: 6764, loss: 0.5399022102355957, time cost4.031481027603149
epoch: 198, iter: 6765, loss: 0.47052040696144104, time cost4.192198038101196
epoch: 198, iter: 6766, loss: 0.772809624671936, time cost2.7606160640716553
epoch: 199, iter: 6767, loss: 0.651568591594696, time cost4.194745779037476
epoch: 199, iter: 6768, loss: 0.4301523268222809, time cost4.051774501800537
epoch: 199, iter: 6769, loss: 0.5558677911758423, time cost4.2039361000061035
epoch: 199, iter: 6770, loss: 0.5883170366287231, time cost4.016194581985474
epoch: 199, iter: 6771, loss: 0.49346715211868286, time cost4.124854803085327
epoch: 199, iter: 6772, loss: 0.6383010745048523, time cost4.109972238540649
epoch: 199, iter: 6773, loss: 0.7404758930206299, time cost4.234838962554932
epoch: 199, iter: 6774, loss: 0.9281017780303955, time cost4.051090478897095
epoch: 199, iter: 6775, loss: 0.6687082648277283, time cost4.1936774253845215
epoch: 199, iter: 6776, loss: 0.5705705881118774, time cost4.46989631652832
epoch: 199, iter: 6777, loss: 0.5104924440383911, time cost4.1289143562316895
epoch: 199, iter: 6778, loss: 0.6298186182975769, time cost4.1176676750183105
epoch: 199, iter: 6779, loss: 0.5074973106384277, time cost4.215208292007446
epoch: 199, iter: 6780, loss: 0.819922149181366, time cost4.152881622314453
epoch: 199, iter: 6781, loss: 0.8595028519630432, time cost4.150874376296997
epoch: 199, iter: 6782, loss: 0.7969700694084167, time cost4.221736192703247
epoch: 199, iter: 6783, loss: 0.7181048393249512, time cost4.149558067321777
epoch: 199, iter: 6784, loss: 0.9712503552436829, time cost4.036728382110596
epoch: 199, iter: 6785, loss: 0.6315485239028931, time cost4.020815134048462
epoch: 199, iter: 6786, loss: 0.6398051381111145, time cost4.226258277893066
epoch: 199, iter: 6787, loss: 0.7660389542579651, time cost4.024352073669434
epoch: 199, iter: 6788, loss: 1.0784517526626587, time cost4.1362833976745605
epoch: 199, iter: 6789, loss: 0.5900415182113647, time cost4.173902750015259
epoch: 199, iter: 6790, loss: 0.5570819973945618, time cost4.047806978225708
epoch: 199, iter: 6791, loss: 0.7117062211036682, time cost4.104245662689209
epoch: 199, iter: 6792, loss: 0.9038483500480652, time cost4.073899507522583
epoch: 199, iter: 6793, loss: 0.9351102113723755, time cost4.088616371154785
epoch: 199, iter: 6794, loss: 0.9346100091934204, time cost4.025930404663086
epoch: 199, iter: 6795, loss: 0.9263673424720764, time cost4.022235631942749
epoch: 199, iter: 6796, loss: 0.7384186387062073, time cost4.083798170089722
epoch: 199, iter: 6797, loss: 0.9099923372268677, time cost4.060248136520386
epoch: 199, iter: 6798, loss: 0.9790188670158386, time cost4.0067150592803955
epoch: 199, iter: 6799, loss: 0.8483427166938782, time cost3.9852256774902344
epoch: 199, iter: 6800, loss: 0.2918800711631775, time cost2.9738035202026367
tensor([[ 63.,  46.,  49.,  ...,   1.,   1.,   2.],
        [ 36.,  36.,  36.,  ...,  19.,  19.,  12.],
        [ 93., 159., 114.,  ...,   4.,   4.,   3.],
        ...,
        [ 56.,  57.,  37.,  ...,   4.,   4.,   3.],
        [ 55.,  67.,   8.,  ...,   2.,   2.,   1.],
        [194., 221., 265.,  ...,   1.,   1.,   2.]])
Epoch: 199, Iteration: 6800:
TEST A@1: 0.44222222222222224
TEST A@5: 0.8177777777777778
TEST A@10: 0.9177777777777778
TEST M@B: 0.3729788363752386
TEST M@A: 0.9545759545458214
TEST W@MB: 0.20052880593188302
TEST W@MA: 0.5900112589586646
TEST Time: 562.4428124427795
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 200, iter: 6801, loss: 0.6977137923240662, time cost3.9991369247436523
epoch: 200, iter: 6802, loss: 0.450780987739563, time cost4.130936145782471
epoch: 200, iter: 6803, loss: 0.5240156650543213, time cost4.207190275192261
epoch: 200, iter: 6804, loss: 0.6387255787849426, time cost4.010248899459839
epoch: 200, iter: 6805, loss: 0.7770894765853882, time cost4.0397210121154785
epoch: 200, iter: 6806, loss: 0.7298805117607117, time cost4.076425313949585
epoch: 200, iter: 6807, loss: 1.118729591369629, time cost4.140501976013184
epoch: 200, iter: 6808, loss: 0.7179384827613831, time cost4.109782934188843
epoch: 200, iter: 6809, loss: 0.7522671818733215, time cost4.249694585800171
epoch: 200, iter: 6810, loss: 0.6202245950698853, time cost4.104324102401733
epoch: 200, iter: 6811, loss: 1.04150390625, time cost4.02841854095459
epoch: 200, iter: 6812, loss: 0.6910327672958374, time cost4.097982406616211
epoch: 200, iter: 6813, loss: 0.747358500957489, time cost4.078818321228027
epoch: 200, iter: 6814, loss: 0.7244540452957153, time cost3.9838898181915283
epoch: 200, iter: 6815, loss: 1.0722711086273193, time cost4.016543388366699
epoch: 200, iter: 6816, loss: 0.8387022018432617, time cost4.087999105453491
epoch: 200, iter: 6817, loss: 0.5248250365257263, time cost4.022866487503052
epoch: 200, iter: 6818, loss: 0.6472135782241821, time cost4.099206924438477
epoch: 200, iter: 6819, loss: 0.7793164253234863, time cost4.152914762496948
epoch: 200, iter: 6820, loss: 0.9362053871154785, time cost4.162843227386475
epoch: 200, iter: 6821, loss: 1.015695571899414, time cost4.083068132400513
epoch: 200, iter: 6822, loss: 0.4222652316093445, time cost4.206830024719238
epoch: 200, iter: 6823, loss: 0.7516626119613647, time cost4.197441577911377
epoch: 200, iter: 6824, loss: 0.9000933766365051, time cost4.103254795074463
epoch: 200, iter: 6825, loss: 0.6476540565490723, time cost4.20672082901001
epoch: 200, iter: 6826, loss: 0.4568753242492676, time cost4.086467027664185
epoch: 200, iter: 6827, loss: 0.36077845096588135, time cost3.996124744415283
epoch: 200, iter: 6828, loss: 0.745799720287323, time cost4.224033832550049
epoch: 200, iter: 6829, loss: 0.6586428880691528, time cost4.021307468414307
epoch: 200, iter: 6830, loss: 0.821080207824707, time cost4.048318147659302
epoch: 200, iter: 6831, loss: 0.6734609603881836, time cost4.089930057525635
epoch: 200, iter: 6832, loss: 1.0218578577041626, time cost3.9531188011169434
epoch: 200, iter: 6833, loss: 0.8505799174308777, time cost3.9594147205352783
epoch: 200, iter: 6834, loss: 0.42451927065849304, time cost2.921593189239502
epoch: 201, iter: 6835, loss: 0.9364798665046692, time cost4.153493881225586
epoch: 201, iter: 6836, loss: 0.8812212347984314, time cost4.104014158248901
epoch: 201, iter: 6837, loss: 0.8383861780166626, time cost4.114834785461426
epoch: 201, iter: 6838, loss: 0.5759169459342957, time cost4.112791538238525
epoch: 201, iter: 6839, loss: 0.5340795516967773, time cost4.115807294845581
epoch: 201, iter: 6840, loss: 0.8360306620597839, time cost4.14436411857605
epoch: 201, iter: 6841, loss: 0.6286193132400513, time cost4.173191547393799
epoch: 201, iter: 6842, loss: 0.6357036232948303, time cost4.112447500228882
epoch: 201, iter: 6843, loss: 0.6204713582992554, time cost4.121654033660889
epoch: 201, iter: 6844, loss: 0.42151424288749695, time cost4.096263408660889
epoch: 201, iter: 6845, loss: 0.6258889436721802, time cost4.292068243026733
epoch: 201, iter: 6846, loss: 0.8865615725517273, time cost3.995391845703125
epoch: 201, iter: 6847, loss: 0.8358532190322876, time cost4.08414888381958
epoch: 201, iter: 6848, loss: 0.5748412609100342, time cost4.021723031997681
epoch: 201, iter: 6849, loss: 0.8763079047203064, time cost4.058903455734253
epoch: 201, iter: 6850, loss: 0.6166901588439941, time cost4.161814451217651
tensor([[ 48.,  25.,  27.,  ...,   1.,   1.,   1.],
        [ 22.,  35.,  31.,  ...,   9.,   9.,   5.],
        [ 94., 219., 122.,  ...,   4.,   4.,   3.],
        ...,
        [ 43.,  41.,  25.,  ...,  11.,  11.,   6.],
        [ 69.,  82.,  11.,  ...,   1.,   1.,   1.],
        [ 95., 115., 173.,  ...,   2.,   2.,   3.]])
Epoch: 201, Iteration: 6850:
TEST A@1: 0.5111111111111111
TEST A@5: 0.8644444444444445
TEST A@10: 0.9533333333333334
TEST M@B: 0.4204220997606893
TEST M@A: 0.9574588334218023
TEST W@MB: 0.22612168849231556
TEST W@MA: 0.5919983897227818
TEST Time: 565.040857553482
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 201, iter: 6851, loss: 0.43659907579421997, time cost3.818241596221924
epoch: 201, iter: 6852, loss: 0.5388414263725281, time cost3.964812994003296
epoch: 201, iter: 6853, loss: 0.8036501407623291, time cost4.016288757324219
epoch: 201, iter: 6854, loss: 0.8200972676277161, time cost4.008200168609619
epoch: 201, iter: 6855, loss: 0.9792121648788452, time cost4.1880528926849365
epoch: 201, iter: 6856, loss: 0.5317567586898804, time cost4.136078119277954
epoch: 201, iter: 6857, loss: 0.9796046614646912, time cost4.044382810592651
epoch: 201, iter: 6858, loss: 0.26627618074417114, time cost4.135866403579712
epoch: 201, iter: 6859, loss: 1.28468918800354, time cost4.070217132568359
epoch: 201, iter: 6860, loss: 0.3026975095272064, time cost4.1496336460113525
epoch: 201, iter: 6861, loss: 0.46459439396858215, time cost3.92326021194458
epoch: 201, iter: 6862, loss: 0.6068134903907776, time cost3.9657981395721436
epoch: 201, iter: 6863, loss: 0.4798699915409088, time cost3.930347204208374
epoch: 201, iter: 6864, loss: 0.5279921889305115, time cost4.026966571807861
epoch: 201, iter: 6865, loss: 0.5345556139945984, time cost4.249869346618652
epoch: 201, iter: 6866, loss: 0.6327976584434509, time cost3.989591598510742
epoch: 201, iter: 6867, loss: 0.938133180141449, time cost4.039771795272827
epoch: 201, iter: 6868, loss: 0.3961409032344818, time cost2.8384361267089844
epoch: 202, iter: 6869, loss: 0.9119821786880493, time cost4.28057599067688
epoch: 202, iter: 6870, loss: 0.20275437831878662, time cost4.123395919799805
epoch: 202, iter: 6871, loss: 0.7923580408096313, time cost4.128111362457275
epoch: 202, iter: 6872, loss: 0.898506224155426, time cost4.053847312927246
epoch: 202, iter: 6873, loss: 1.0239787101745605, time cost4.0538105964660645
epoch: 202, iter: 6874, loss: 0.6975700855255127, time cost4.029673099517822
epoch: 202, iter: 6875, loss: 0.7186338901519775, time cost4.333781003952026
epoch: 202, iter: 6876, loss: 0.6244186162948608, time cost4.173616647720337
epoch: 202, iter: 6877, loss: 0.6377521753311157, time cost4.157270908355713
epoch: 202, iter: 6878, loss: 0.740023136138916, time cost4.009389400482178
epoch: 202, iter: 6879, loss: 1.0626511573791504, time cost4.093285083770752
epoch: 202, iter: 6880, loss: 0.6485694050788879, time cost4.076833009719849
epoch: 202, iter: 6881, loss: 0.7591646909713745, time cost4.049896001815796
epoch: 202, iter: 6882, loss: 0.975469708442688, time cost4.100841522216797
epoch: 202, iter: 6883, loss: 0.6890144348144531, time cost4.058805465698242
epoch: 202, iter: 6884, loss: 0.3487352430820465, time cost4.020057678222656
epoch: 202, iter: 6885, loss: 1.0471827983856201, time cost4.05428409576416
epoch: 202, iter: 6886, loss: 0.6394785046577454, time cost4.198608636856079
epoch: 202, iter: 6887, loss: 0.494546502828598, time cost4.125019550323486
epoch: 202, iter: 6888, loss: 0.8522631525993347, time cost3.9637954235076904
epoch: 202, iter: 6889, loss: 0.9903699159622192, time cost4.1397788524627686
epoch: 202, iter: 6890, loss: 0.5631982088088989, time cost4.021831274032593
epoch: 202, iter: 6891, loss: 0.6583600640296936, time cost3.9155046939849854
epoch: 202, iter: 6892, loss: 0.542450487613678, time cost3.9215476512908936
epoch: 202, iter: 6893, loss: 0.15057525038719177, time cost4.142248153686523
epoch: 202, iter: 6894, loss: 0.6908988356590271, time cost4.156470537185669
epoch: 202, iter: 6895, loss: 0.6978772282600403, time cost3.9639739990234375
epoch: 202, iter: 6896, loss: 0.6582133173942566, time cost3.940654993057251
epoch: 202, iter: 6897, loss: 0.7628565430641174, time cost3.8963704109191895
epoch: 202, iter: 6898, loss: 0.4396423399448395, time cost4.003927707672119
epoch: 202, iter: 6899, loss: 0.728285551071167, time cost4.031219005584717
epoch: 202, iter: 6900, loss: 1.0454251766204834, time cost4.048432111740112
tensor([[ 52.,  37.,  45.,  ...,   3.,   3.,   3.],
        [ 25.,  34.,  31.,  ...,  16.,  16.,   7.],
        [144., 315., 128.,  ...,  18.,  18.,   8.],
        ...,
        [ 45.,  42.,  28.,  ...,  14.,  14.,   7.],
        [ 31.,  39.,   3.,  ...,   1.,   1.,   1.],
        [ 49., 128., 179.,  ...,   3.,   3.,   8.]])
Epoch: 202, Iteration: 6900:
TEST A@1: 0.5111111111111111
TEST A@5: 0.8244444444444444
TEST A@10: 0.94
TEST M@B: 0.4057815546844907
TEST M@A: 0.9575667275957289
TEST W@MB: 0.21822387930604598
TEST W@MA: 0.5923464495573365
TEST Time: 558.2724912166595
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 202, iter: 6901, loss: 0.5586992502212524, time cost4.152714967727661
epoch: 202, iter: 6902, loss: 0.2388155609369278, time cost2.8813624382019043
epoch: 203, iter: 6903, loss: 0.801662027835846, time cost4.10607123374939
epoch: 203, iter: 6904, loss: 0.7354248762130737, time cost3.995032548904419
epoch: 203, iter: 6905, loss: 0.23760224878787994, time cost3.858707904815674
epoch: 203, iter: 6906, loss: 0.7646394968032837, time cost3.9990451335906982
epoch: 203, iter: 6907, loss: 0.8820355534553528, time cost4.137863397598267
epoch: 203, iter: 6908, loss: 0.8755078911781311, time cost4.002695322036743
epoch: 203, iter: 6909, loss: 0.4889940023422241, time cost4.0495710372924805
epoch: 203, iter: 6910, loss: 0.32233279943466187, time cost3.917217493057251
epoch: 203, iter: 6911, loss: 1.0004441738128662, time cost4.108973503112793
epoch: 203, iter: 6912, loss: 0.30662110447883606, time cost3.9945406913757324
epoch: 203, iter: 6913, loss: 0.6455743908882141, time cost4.018343687057495
epoch: 203, iter: 6914, loss: 0.975330650806427, time cost4.200662851333618
epoch: 203, iter: 6915, loss: 0.7183423042297363, time cost4.012954950332642
epoch: 203, iter: 6916, loss: 0.5246883034706116, time cost3.9950551986694336
epoch: 203, iter: 6917, loss: 0.7255088686943054, time cost4.14133882522583
epoch: 203, iter: 6918, loss: 0.6533674597740173, time cost4.051863431930542
epoch: 203, iter: 6919, loss: 0.6408974528312683, time cost4.175718784332275
epoch: 203, iter: 6920, loss: 0.8130998611450195, time cost3.875236749649048
epoch: 203, iter: 6921, loss: 0.7509190440177917, time cost4.07129430770874
epoch: 203, iter: 6922, loss: 0.8762400150299072, time cost4.0092785358428955
epoch: 203, iter: 6923, loss: 0.4213346242904663, time cost4.042176008224487
epoch: 203, iter: 6924, loss: 0.7689027190208435, time cost4.067464351654053
epoch: 203, iter: 6925, loss: 0.6818444728851318, time cost3.960627317428589
epoch: 203, iter: 6926, loss: 0.7650452256202698, time cost4.1583335399627686
epoch: 203, iter: 6927, loss: 0.29233700037002563, time cost4.103077411651611
epoch: 203, iter: 6928, loss: 0.45087406039237976, time cost4.026705980300903
epoch: 203, iter: 6929, loss: 0.7995383143424988, time cost4.106929302215576
epoch: 203, iter: 6930, loss: 0.7123726010322571, time cost3.9876887798309326
epoch: 203, iter: 6931, loss: 1.899179458618164, time cost4.110295534133911
epoch: 203, iter: 6932, loss: 1.066882848739624, time cost3.8571696281433105
epoch: 203, iter: 6933, loss: 0.7244682312011719, time cost3.960970401763916
epoch: 203, iter: 6934, loss: 0.6751249432563782, time cost3.8277781009674072
epoch: 203, iter: 6935, loss: 0.8366315960884094, time cost4.194950580596924
epoch: 203, iter: 6936, loss: 0.5514798164367676, time cost2.8619213104248047
epoch: 204, iter: 6937, loss: 0.8357958793640137, time cost3.869283437728882
epoch: 204, iter: 6938, loss: 0.8285597562789917, time cost4.065723896026611
epoch: 204, iter: 6939, loss: 1.0775904655456543, time cost4.041278600692749
epoch: 204, iter: 6940, loss: 0.8327229619026184, time cost4.104342222213745
epoch: 204, iter: 6941, loss: 1.0218844413757324, time cost3.7965362071990967
epoch: 204, iter: 6942, loss: 0.5813912153244019, time cost3.447136163711548
epoch: 204, iter: 6943, loss: 0.32143208384513855, time cost3.605853796005249
epoch: 204, iter: 6944, loss: 0.7770522832870483, time cost3.7073724269866943
epoch: 204, iter: 6945, loss: 0.7885189056396484, time cost4.238377571105957
epoch: 204, iter: 6946, loss: 0.9530481100082397, time cost4.314162492752075
epoch: 204, iter: 6947, loss: 0.8857690691947937, time cost4.2052202224731445
epoch: 204, iter: 6948, loss: 0.4565379023551941, time cost4.15892219543457
epoch: 204, iter: 6949, loss: 0.32566994428634644, time cost4.263035535812378
epoch: 204, iter: 6950, loss: 0.7201809883117676, time cost4.325364351272583
tensor([[ 52.,  37.,  42.,  ...,   1.,   1.,   1.],
        [100.,  78.,  77.,  ...,  12.,  12.,   5.],
        [ 72., 152.,  62.,  ...,   6.,   6.,   4.],
        ...,
        [ 52.,  56.,  33.,  ...,   7.,   7.,   5.],
        [ 23.,  23.,   1.,  ...,   1.,   1.,   1.],
        [129., 212., 233.,  ...,   3.,   3.,   6.]])
Epoch: 204, Iteration: 6950:
TEST A@1: 0.5444444444444444
TEST A@5: 0.8622222222222222
TEST A@10: 0.9466666666666667
TEST M@B: 0.4033190150509773
TEST M@A: 0.9514953166415531
TEST W@MB: 0.21512645545113956
TEST W@MA: 0.5871919788734191
TEST Time: 560.3710098266602
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 204, iter: 6951, loss: 1.1690186262130737, time cost4.311931610107422
epoch: 204, iter: 6952, loss: 0.7995343804359436, time cost4.235270738601685
epoch: 204, iter: 6953, loss: 0.5826635360717773, time cost4.491676330566406
epoch: 204, iter: 6954, loss: 1.0843732357025146, time cost4.55174446105957
epoch: 204, iter: 6955, loss: 0.6724542379379272, time cost4.245987415313721
epoch: 204, iter: 6956, loss: 1.172106146812439, time cost4.479971885681152
epoch: 204, iter: 6957, loss: 0.9259527325630188, time cost4.47846245765686
epoch: 204, iter: 6958, loss: 0.5546597838401794, time cost4.570380926132202
epoch: 204, iter: 6959, loss: 1.2679961919784546, time cost4.369138717651367
epoch: 204, iter: 6960, loss: 0.7198067307472229, time cost4.3622167110443115
epoch: 204, iter: 6961, loss: 0.7607800960540771, time cost4.165510177612305
epoch: 204, iter: 6962, loss: 0.9390472769737244, time cost4.1466639041900635
epoch: 204, iter: 6963, loss: 1.040808081626892, time cost4.315278768539429
epoch: 204, iter: 6964, loss: 0.8437345623970032, time cost4.366972208023071
epoch: 204, iter: 6965, loss: 1.0054817199707031, time cost4.5393640995025635
epoch: 204, iter: 6966, loss: 0.4698726236820221, time cost4.210886240005493
epoch: 204, iter: 6967, loss: 1.0601553916931152, time cost4.3830885887146
epoch: 204, iter: 6968, loss: 0.5314704179763794, time cost4.105437517166138
epoch: 204, iter: 6969, loss: 0.7160479426383972, time cost4.167798042297363
epoch: 204, iter: 6970, loss: 0.6261060833930969, time cost3.0222902297973633
epoch: 205, iter: 6971, loss: 0.5698268413543701, time cost3.9449567794799805
epoch: 205, iter: 6972, loss: 0.9789600372314453, time cost4.004165172576904
epoch: 205, iter: 6973, loss: 0.5643667578697205, time cost4.143532991409302
epoch: 205, iter: 6974, loss: 0.8462966084480286, time cost3.9642157554626465
epoch: 205, iter: 6975, loss: 0.5521779656410217, time cost3.889688491821289
epoch: 205, iter: 6976, loss: 0.5970089435577393, time cost4.054400205612183
epoch: 205, iter: 6977, loss: 0.47999387979507446, time cost4.006137371063232
epoch: 205, iter: 6978, loss: 0.7255827188491821, time cost3.9324536323547363
epoch: 205, iter: 6979, loss: 0.7059209942817688, time cost4.044281005859375
epoch: 205, iter: 6980, loss: 0.9375632405281067, time cost4.093642234802246
epoch: 205, iter: 6981, loss: 0.7289894819259644, time cost3.9312708377838135
epoch: 205, iter: 6982, loss: 1.1650928258895874, time cost4.094860792160034
epoch: 205, iter: 6983, loss: 0.5503382086753845, time cost4.154364585876465
epoch: 205, iter: 6984, loss: 0.5927715301513672, time cost4.113178491592407
epoch: 205, iter: 6985, loss: 1.232689619064331, time cost3.9527361392974854
epoch: 205, iter: 6986, loss: 0.6927913427352905, time cost4.025209903717041
epoch: 205, iter: 6987, loss: 0.8119391202926636, time cost3.9669294357299805
epoch: 205, iter: 6988, loss: 0.5465772747993469, time cost4.09237265586853
epoch: 205, iter: 6989, loss: 0.6672828197479248, time cost3.896939516067505
epoch: 205, iter: 6990, loss: 0.9687837958335876, time cost4.044832468032837
epoch: 205, iter: 6991, loss: 0.663551390171051, time cost4.1715333461761475
epoch: 205, iter: 6992, loss: 0.7888693809509277, time cost3.994473934173584
epoch: 205, iter: 6993, loss: 0.7399933934211731, time cost4.0284833908081055
epoch: 205, iter: 6994, loss: 0.5085967779159546, time cost3.9236204624176025
epoch: 205, iter: 6995, loss: 1.1286765336990356, time cost4.009624004364014
epoch: 205, iter: 6996, loss: 0.4715147614479065, time cost4.0677502155303955
epoch: 205, iter: 6997, loss: 0.5781823396682739, time cost3.9113974571228027
epoch: 205, iter: 6998, loss: 0.4589065611362457, time cost3.877000570297241
epoch: 205, iter: 6999, loss: 1.2928626537322998, time cost3.985321283340454
epoch: 205, iter: 7000, loss: 0.5479044914245605, time cost4.093509674072266
tensor([[149., 104., 114.,  ...,   1.,   1.,   1.],
        [ 21.,  15.,  14.,  ...,   2.,   2.,   2.],
        [ 57., 136.,  45.,  ...,  10.,  10.,   4.],
        ...,
        [ 78.,  74.,  52.,  ...,  15.,  15.,   8.],
        [ 59.,  58.,   3.,  ...,   1.,   1.,   1.],
        [239., 293., 340.,  ...,  14.,  14.,  19.]])
Epoch: 205, Iteration: 7000:
TEST A@1: 0.5155555555555555
TEST A@5: 0.8466666666666667
TEST A@10: 0.9266666666666666
TEST M@B: 0.3858451838211465
TEST M@A: 0.9531111117645449
TEST W@MB: 0.2057288241784711
TEST W@MA: 0.5886888759492209
TEST Time: 556.2159359455109
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 205, iter: 7001, loss: 0.6204957962036133, time cost3.913245439529419
epoch: 205, iter: 7002, loss: 0.5861027240753174, time cost4.003753900527954
epoch: 205, iter: 7003, loss: 0.5966633558273315, time cost3.939971446990967
epoch: 205, iter: 7004, loss: 0.49576422572135925, time cost2.8798418045043945
epoch: 206, iter: 7005, loss: 0.9077664613723755, time cost4.099393367767334
epoch: 206, iter: 7006, loss: 0.6535296440124512, time cost4.072490692138672
epoch: 206, iter: 7007, loss: 0.697762668132782, time cost4.153203248977661
epoch: 206, iter: 7008, loss: 0.7486554980278015, time cost4.01438045501709
epoch: 206, iter: 7009, loss: 0.6819009184837341, time cost3.9087085723876953
epoch: 206, iter: 7010, loss: 0.4492316246032715, time cost4.072606325149536
epoch: 206, iter: 7011, loss: 0.74153071641922, time cost4.0375237464904785
epoch: 206, iter: 7012, loss: 0.856510579586029, time cost4.152665615081787
epoch: 206, iter: 7013, loss: 0.7029236555099487, time cost4.031873464584351
epoch: 206, iter: 7014, loss: 0.8698076605796814, time cost4.080787897109985
epoch: 206, iter: 7015, loss: 0.6676693558692932, time cost4.036296367645264
epoch: 206, iter: 7016, loss: 0.8030948042869568, time cost4.066662788391113
epoch: 206, iter: 7017, loss: 0.8658559918403625, time cost4.009547472000122
epoch: 206, iter: 7018, loss: 0.37104928493499756, time cost4.1214659214019775
epoch: 206, iter: 7019, loss: 1.0736346244812012, time cost4.016545295715332
epoch: 206, iter: 7020, loss: 0.4611043334007263, time cost4.011909008026123
epoch: 206, iter: 7021, loss: 0.46898117661476135, time cost4.0744524002075195
epoch: 206, iter: 7022, loss: 0.80397629737854, time cost4.082503795623779
epoch: 206, iter: 7023, loss: 0.6371506452560425, time cost4.071778297424316
epoch: 206, iter: 7024, loss: 0.5664045810699463, time cost4.2276036739349365
epoch: 206, iter: 7025, loss: 1.0847291946411133, time cost4.164216995239258
epoch: 206, iter: 7026, loss: 1.339646577835083, time cost4.094187021255493
epoch: 206, iter: 7027, loss: 0.7135810852050781, time cost4.0464184284210205
epoch: 206, iter: 7028, loss: 0.5102973580360413, time cost4.061156272888184
epoch: 206, iter: 7029, loss: 0.6649076342582703, time cost4.092746734619141
epoch: 206, iter: 7030, loss: 0.5707656741142273, time cost3.9805002212524414
epoch: 206, iter: 7031, loss: 0.4460568130016327, time cost3.980854034423828
epoch: 206, iter: 7032, loss: 0.6379773616790771, time cost3.9865925312042236
epoch: 206, iter: 7033, loss: 0.5227231979370117, time cost3.9164512157440186
epoch: 206, iter: 7034, loss: 0.19015313684940338, time cost4.0870349407196045
epoch: 206, iter: 7035, loss: 0.5965257287025452, time cost3.947092294692993
epoch: 206, iter: 7036, loss: 0.9428633451461792, time cost3.965062141418457
epoch: 206, iter: 7037, loss: 0.4862641990184784, time cost3.9957175254821777
epoch: 206, iter: 7038, loss: 0.3066498041152954, time cost2.761861562728882
epoch: 207, iter: 7039, loss: 0.3582233786582947, time cost4.077402353286743
epoch: 207, iter: 7040, loss: 0.543945848941803, time cost4.201505184173584
epoch: 207, iter: 7041, loss: 0.49687471985816956, time cost4.14071798324585
epoch: 207, iter: 7042, loss: 0.70445317029953, time cost4.141411304473877
epoch: 207, iter: 7043, loss: 0.5022715330123901, time cost4.086741924285889
epoch: 207, iter: 7044, loss: 0.4850359857082367, time cost4.084285259246826
epoch: 207, iter: 7045, loss: 0.7819985747337341, time cost3.9570043087005615
epoch: 207, iter: 7046, loss: 0.4085887372493744, time cost4.1995322704315186
epoch: 207, iter: 7047, loss: 0.5859531760215759, time cost4.164983749389648
epoch: 207, iter: 7048, loss: 0.9392375349998474, time cost4.099943399429321
epoch: 207, iter: 7049, loss: 0.7987373471260071, time cost4.218119382858276
epoch: 207, iter: 7050, loss: 0.8434835076332092, time cost4.094996929168701
tensor([[ 67.,  56.,  60.,  ...,   6.,   6.,   5.],
        [ 23.,  20.,  16.,  ...,  11.,  11.,   5.],
        [ 58., 175.,  78.,  ...,   7.,   7.,   5.],
        ...,
        [ 53.,  50.,  36.,  ...,  23.,  23.,   9.],
        [ 82., 100.,   5.,  ...,   1.,   1.,   1.],
        [ 70., 159., 220.,  ...,   3.,   3.,   4.]])
Epoch: 207, Iteration: 7050:
TEST A@1: 0.46444444444444444
TEST A@5: 0.8511111111111112
TEST A@10: 0.9422222222222222
TEST M@B: 0.39558720048278156
TEST M@A: 0.955756143270223
TEST W@MB: 0.21220091127678442
TEST W@MA: 0.590796199427053
TEST Time: 562.5511910915375
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 207, iter: 7051, loss: 0.49962112307548523, time cost3.9576339721679688
epoch: 207, iter: 7052, loss: 0.5881738066673279, time cost3.9145667552948
epoch: 207, iter: 7053, loss: 0.9592221975326538, time cost3.9057457447052
epoch: 207, iter: 7054, loss: 1.02858304977417, time cost4.078970432281494
epoch: 207, iter: 7055, loss: 0.4399181008338928, time cost4.021784543991089
epoch: 207, iter: 7056, loss: 0.9151815176010132, time cost3.871741771697998
epoch: 207, iter: 7057, loss: 0.8297170996665955, time cost4.118979215621948
epoch: 207, iter: 7058, loss: 0.5390751361846924, time cost3.9277849197387695
epoch: 207, iter: 7059, loss: 0.874057948589325, time cost3.917236089706421
epoch: 207, iter: 7060, loss: 0.825362503528595, time cost3.873499870300293
epoch: 207, iter: 7061, loss: 0.7430897951126099, time cost3.949732542037964
epoch: 207, iter: 7062, loss: 0.7003092169761658, time cost4.026836156845093
epoch: 207, iter: 7063, loss: 0.821217954158783, time cost4.151000022888184
epoch: 207, iter: 7064, loss: 0.6598548293113708, time cost4.1316235065460205
epoch: 207, iter: 7065, loss: 0.8779325485229492, time cost3.947559118270874
epoch: 207, iter: 7066, loss: 0.8375804424285889, time cost3.925093173980713
epoch: 207, iter: 7067, loss: 0.4098720848560333, time cost3.9789857864379883
epoch: 207, iter: 7068, loss: 1.0693782567977905, time cost4.144514560699463
epoch: 207, iter: 7069, loss: 1.1392451524734497, time cost3.977323293685913
epoch: 207, iter: 7070, loss: 0.7613403797149658, time cost3.9427785873413086
epoch: 207, iter: 7071, loss: 0.7812690138816833, time cost3.957019567489624
epoch: 207, iter: 7072, loss: 0.5938411355018616, time cost2.982881546020508
epoch: 208, iter: 7073, loss: 1.0799599885940552, time cost4.118118047714233
epoch: 208, iter: 7074, loss: 0.7395691871643066, time cost4.061511278152466
epoch: 208, iter: 7075, loss: 0.5755785703659058, time cost4.018726825714111
epoch: 208, iter: 7076, loss: 1.033004641532898, time cost4.04601526260376
epoch: 208, iter: 7077, loss: 0.6763686537742615, time cost4.055351257324219
epoch: 208, iter: 7078, loss: 0.9474212527275085, time cost4.015223264694214
epoch: 208, iter: 7079, loss: 1.5544168949127197, time cost4.169973134994507
epoch: 208, iter: 7080, loss: 0.33302757143974304, time cost4.045370817184448
epoch: 208, iter: 7081, loss: 0.7475451827049255, time cost4.16673469543457
epoch: 208, iter: 7082, loss: 0.7959864139556885, time cost4.093722105026245
epoch: 208, iter: 7083, loss: 0.9774602651596069, time cost3.8949975967407227
epoch: 208, iter: 7084, loss: 0.5891983509063721, time cost4.0905537605285645
epoch: 208, iter: 7085, loss: 0.6931583285331726, time cost4.1205949783325195
epoch: 208, iter: 7086, loss: 1.2450467348098755, time cost3.980311393737793
epoch: 208, iter: 7087, loss: 0.7532519102096558, time cost4.014175176620483
epoch: 208, iter: 7088, loss: 0.9251765608787537, time cost4.190488338470459
epoch: 208, iter: 7089, loss: 0.6080987453460693, time cost4.1289222240448
epoch: 208, iter: 7090, loss: 0.7920657992362976, time cost3.9513168334960938
epoch: 208, iter: 7091, loss: 0.46455734968185425, time cost4.019017696380615
epoch: 208, iter: 7092, loss: 1.035376787185669, time cost4.015379905700684
epoch: 208, iter: 7093, loss: 0.7885699272155762, time cost4.040771961212158
epoch: 208, iter: 7094, loss: 0.7090958952903748, time cost4.031412124633789
epoch: 208, iter: 7095, loss: 0.5966837406158447, time cost4.143976211547852
epoch: 208, iter: 7096, loss: 0.587619960308075, time cost4.053567409515381
epoch: 208, iter: 7097, loss: 0.6255861520767212, time cost4.058394908905029
epoch: 208, iter: 7098, loss: 0.6017801761627197, time cost3.9767942428588867
epoch: 208, iter: 7099, loss: 0.4356458783149719, time cost3.972421646118164
epoch: 208, iter: 7100, loss: 1.0946061611175537, time cost4.016534805297852
tensor([[ 26.,  27.,  26.,  ...,   2.,   2.,   3.],
        [ 21.,  18.,  18.,  ...,   9.,   9.,   6.],
        [ 99., 255.,  93.,  ...,   1.,   1.,   1.],
        ...,
        [ 35.,  37.,  22.,  ...,  10.,  10.,   6.],
        [ 44.,  49.,   6.,  ...,   2.,   2.,   1.],
        [ 31.,  77.,  93.,  ...,   2.,   2.,   1.]])
Epoch: 208, Iteration: 7100:
TEST A@1: 0.47555555555555556
TEST A@5: 0.8333333333333334
TEST A@10: 0.9333333333333333
TEST M@B: 0.3865385488055126
TEST M@A: 0.953520628859555
TEST W@MB: 0.20732669642905163
TEST W@MA: 0.5889003392554628
TEST Time: 565.8660206794739
REAL performance: Top1: 0.5533333333333333, Top5: 0.8933333333333333, Top10: 0.9533333333333334, MB: 0.4397689329167464, MA: 0.9601156014365011, WMB: 0.23669329359899205, WMA: 0.5939621694253282
epoch: 208, iter: 7101, loss: 1.3186001777648926, time cost3.792574167251587
epoch: 208, iter: 7102, loss: 0.6190667152404785, time cost3.795898914337158
epoch: 208, iter: 7103, loss: 0.7799240350723267, time cost3.8888256549835205
epoch: 208, iter: 7104, loss: 1.0421226024627686, time cost3.8903307914733887
epoch: 208, iter: 7105, loss: 1.470531702041626, time cost3.955691337585449
epoch: 208, iter: 7106, loss: 0.3041594326496124, time cost2.818028211593628
epoch: 209, iter: 7107, loss: 0.9323413372039795, time cost3.986555814743042
epoch: 209, iter: 7108, loss: 0.409771591424942, time cost4.076226234436035
epoch: 209, iter: 7109, loss: 0.5349894165992737, time cost3.9797866344451904
epoch: 209, iter: 7110, loss: 0.6837939620018005, time cost4.085732460021973
epoch: 209, iter: 7111, loss: 1.2695587873458862, time cost4.071759462356567
epoch: 209, iter: 7112, loss: 0.7445089221000671, time cost3.9906320571899414
epoch: 209, iter: 7113, loss: 0.7834701538085938, time cost4.03234338760376
epoch: 209, iter: 7114, loss: 1.5625468492507935, time cost4.056482791900635
epoch: 209, iter: 7115, loss: 0.6239261031150818, time cost3.898987054824829
epoch: 209, iter: 7116, loss: 0.7628545165061951, time cost4.321849584579468
epoch: 209, iter: 7117, loss: 0.6113734245300293, time cost4.015003442764282
epoch: 209, iter: 7118, loss: 0.8414885997772217, time cost4.120494842529297
epoch: 209, iter: 7119, loss: 0.7056719064712524, time cost3.9419851303100586
epoch: 209, iter: 7120, loss: 0.9610061645507812, time cost4.049343824386597
epoch: 209, iter: 7121, loss: 0.6373213529586792, time cost4.20383620262146
epoch: 209, iter: 7122, loss: 0.5212421417236328, time cost4.085113048553467
epoch: 209, iter: 7123, loss: 0.9905896186828613, time cost3.9583985805511475
epoch: 209, iter: 7124, loss: 0.813726007938385, time cost3.9606740474700928
epoch: 209, iter: 7125, loss: 0.9220780730247498, time cost4.0489585399627686
epoch: 209, iter: 7126, loss: 0.746444821357727, time cost3.9833130836486816
epoch: 209, iter: 7127, loss: 1.0289809703826904, time cost3.895562171936035
epoch: 209, iter: 7128, loss: 0.6186109185218811, time cost3.9799091815948486
epoch: 209, iter: 7129, loss: 0.3449873924255371, time cost3.9168386459350586
epoch: 209, iter: 7130, loss: 0.627206563949585, time cost4.0753467082977295
epoch: 209, iter: 7131, loss: 0.6212521195411682, time cost3.9534356594085693
epoch: 209, iter: 7132, loss: 1.0805720090866089, time cost3.946991205215454
epoch: 209, iter: 7133, loss: 0.573761522769928, time cost3.9711239337921143
epoch: 209, iter: 7134, loss: 0.6534762978553772, time cost3.9534573554992676
epoch: 209, iter: 7135, loss: 0.9762764573097229, time cost3.839362859725952
epoch: 209, iter: 7136, loss: 0.6673764586448669, time cost3.9014813899993896
epoch: 209, iter: 7137, loss: 0.637670636177063, time cost3.961820602416992
epoch: 209, iter: 7138, loss: 0.3218792676925659, time cost4.13644552230835
epoch: 209, iter: 7139, loss: 0.5584815144538879, time cost3.8837907314300537
epoch: 209, iter: 7140, loss: 0.4765779674053192, time cost2.9016273021698
epoch: 210, iter: 7141, loss: 0.6266917586326599, time cost4.023340463638306
epoch: 210, iter: 7142, loss: 0.4886467456817627, time cost3.927885055541992
epoch: 210, iter: 7143, loss: 0.6296762824058533, time cost4.020896673202515
epoch: 210, iter: 7144, loss: 0.7888782024383545, time cost3.9448182582855225
epoch: 210, iter: 7145, loss: 0.8740798830986023, time cost3.9641990661621094
epoch: 210, iter: 7146, loss: 0.41001278162002563, time cost3.8952548503875732
epoch: 210, iter: 7147, loss: 0.783886194229126, time cost4.283185005187988
epoch: 210, iter: 7148, loss: 0.5769509673118591, time cost4.003056526184082
epoch: 210, iter: 7149, loss: 0.5256202816963196, time cost3.9854207038879395
epoch: 210, iter: 7150, loss: 0.6418520212173462, time cost4.162960767745972
tensor([[ 21.,  18.,  23.,  ...,   1.,   1.,   1.],
        [ 14.,  19.,  17.,  ...,   7.,   7.,   4.],
        [ 78., 240.,  50.,  ...,   2.,   2.,   1.],
        ...,
        [ 41.,  36.,  25.,  ...,  11.,  11.,   5.],
        [ 24.,  38.,   5.,  ...,   1.,   1.,   1.],
        [ 44., 118., 118.,  ...,   3.,   3.,   7.]])
Epoch: 210, Iteration: 7150:
TEST A@1: 0.5844444444444444
TEST A@5: 0.9022222222222223
TEST A@10: 0.9688888888888889
TEST M@B: 0.4472062327948879
TEST M@A: 0.9596503701437679
TEST W@MB: 0.24074473162826146
TEST W@MA: 0.5936992482962913
TEST Time: 233.77860116958618
Model Updated
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 210, iter: 7151, loss: 1.11427903175354, time cost3.1381916999816895
epoch: 210, iter: 7152, loss: 0.6849267482757568, time cost3.214088201522827
epoch: 210, iter: 7153, loss: 0.960098922252655, time cost3.21821928024292
epoch: 210, iter: 7154, loss: 0.6837878227233887, time cost3.417285442352295
epoch: 210, iter: 7155, loss: 0.9411176443099976, time cost3.3685033321380615
epoch: 210, iter: 7156, loss: 0.885994553565979, time cost3.321448802947998
epoch: 210, iter: 7157, loss: 1.1214852333068848, time cost3.4162209033966064
epoch: 210, iter: 7158, loss: 0.3634118139743805, time cost3.3047423362731934
epoch: 210, iter: 7159, loss: 1.0143736600875854, time cost3.30372953414917
epoch: 210, iter: 7160, loss: 0.7481752038002014, time cost3.2977473735809326
epoch: 210, iter: 7161, loss: 0.7313908338546753, time cost3.2123301029205322
epoch: 210, iter: 7162, loss: 0.49590373039245605, time cost3.271428108215332
epoch: 210, iter: 7163, loss: 0.5128609538078308, time cost3.283674716949463
epoch: 210, iter: 7164, loss: 0.5583978891372681, time cost3.2553670406341553
epoch: 210, iter: 7165, loss: 0.8572531938552856, time cost3.473665475845337
epoch: 210, iter: 7166, loss: 0.6338499784469604, time cost3.3363964557647705
epoch: 210, iter: 7167, loss: 0.8536145687103271, time cost3.2930209636688232
epoch: 210, iter: 7168, loss: 0.49608874320983887, time cost3.214174747467041
epoch: 210, iter: 7169, loss: 1.0412770509719849, time cost3.3933370113372803
epoch: 210, iter: 7170, loss: 0.424576997756958, time cost3.243807315826416
epoch: 210, iter: 7171, loss: 0.4982956051826477, time cost3.167372465133667
epoch: 210, iter: 7172, loss: 0.7714977860450745, time cost3.1922545433044434
epoch: 210, iter: 7173, loss: 0.7523068785667419, time cost3.2856662273406982
epoch: 210, iter: 7174, loss: 0.754346489906311, time cost2.284942626953125
epoch: 211, iter: 7175, loss: 0.4783204197883606, time cost3.4525277614593506
epoch: 211, iter: 7176, loss: 0.5107252597808838, time cost3.438258647918701
epoch: 211, iter: 7177, loss: 0.4761185050010681, time cost3.3363466262817383
epoch: 211, iter: 7178, loss: 0.4990316927433014, time cost3.263894557952881
epoch: 211, iter: 7179, loss: 0.569969892501831, time cost3.495297431945801
epoch: 211, iter: 7180, loss: 0.5910832285881042, time cost3.287595272064209
epoch: 211, iter: 7181, loss: 0.6290980577468872, time cost3.422668933868408
epoch: 211, iter: 7182, loss: 0.6838815808296204, time cost3.2239248752593994
epoch: 211, iter: 7183, loss: 0.8718015551567078, time cost3.401324510574341
epoch: 211, iter: 7184, loss: 0.5782183408737183, time cost3.3800199031829834
epoch: 211, iter: 7185, loss: 0.9348142743110657, time cost3.3945727348327637
epoch: 211, iter: 7186, loss: 0.6703168749809265, time cost3.3298609256744385
epoch: 211, iter: 7187, loss: 1.2662090063095093, time cost3.207512140274048
epoch: 211, iter: 7188, loss: 0.6637226343154907, time cost3.289233684539795
epoch: 211, iter: 7189, loss: 0.48090991377830505, time cost3.387765884399414
epoch: 211, iter: 7190, loss: 0.5020838379859924, time cost3.2976012229919434
epoch: 211, iter: 7191, loss: 0.6179088354110718, time cost3.3052186965942383
epoch: 211, iter: 7192, loss: 1.2307286262512207, time cost3.2875683307647705
epoch: 211, iter: 7193, loss: 0.5299503803253174, time cost3.3622381687164307
epoch: 211, iter: 7194, loss: 0.8989486694335938, time cost3.3273208141326904
epoch: 211, iter: 7195, loss: 0.8259648680686951, time cost3.237755060195923
epoch: 211, iter: 7196, loss: 0.44800278544425964, time cost3.3225860595703125
epoch: 211, iter: 7197, loss: 0.513447105884552, time cost3.291011095046997
epoch: 211, iter: 7198, loss: 0.3539726734161377, time cost3.2713422775268555
epoch: 211, iter: 7199, loss: 0.9725570678710938, time cost2.8207995891571045
epoch: 211, iter: 7200, loss: 0.5501151084899902, time cost2.8220267295837402
tensor([[ 26.,  21.,  23.,  ...,   1.,   1.,   1.],
        [  8.,  12.,  10.,  ...,  10.,  10.,   5.],
        [191., 356., 179.,  ...,   5.,   5.,   1.],
        ...,
        [ 36.,  31.,  21.,  ...,   9.,   9.,   5.],
        [ 72.,  85.,  43.,  ...,   1.,   1.,   1.],
        [ 36.,  90., 107.,  ...,   3.,   3.,   6.]])
Epoch: 211, Iteration: 7200:
TEST A@1: 0.5844444444444444
TEST A@5: 0.8777777777777778
TEST A@10: 0.9555555555555556
TEST M@B: 0.437301549490233
TEST M@A: 0.9563364095604268
TEST W@MB: 0.23446477854487865
TEST W@MA: 0.5909953455524952
TEST Time: 153.16881203651428
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 211, iter: 7201, loss: 0.5554593205451965, time cost3.09496808052063
epoch: 211, iter: 7202, loss: 0.8749806880950928, time cost3.1608638763427734
epoch: 211, iter: 7203, loss: 0.8030197620391846, time cost3.183074951171875
epoch: 211, iter: 7204, loss: 0.7604200839996338, time cost3.1931962966918945
epoch: 211, iter: 7205, loss: 0.795571506023407, time cost3.2806615829467773
epoch: 211, iter: 7206, loss: 1.3204454183578491, time cost3.2733864784240723
epoch: 211, iter: 7207, loss: 0.8737387657165527, time cost3.199096441268921
epoch: 211, iter: 7208, loss: 0.8450872898101807, time cost2.2651946544647217
epoch: 212, iter: 7209, loss: 1.0826970338821411, time cost3.3841145038604736
epoch: 212, iter: 7210, loss: 0.40735769271850586, time cost3.4328033924102783
epoch: 212, iter: 7211, loss: 0.6776716113090515, time cost3.4724698066711426
epoch: 212, iter: 7212, loss: 0.4756201207637787, time cost3.3669304847717285
epoch: 212, iter: 7213, loss: 0.7683890461921692, time cost3.2692971229553223
epoch: 212, iter: 7214, loss: 0.6108870506286621, time cost3.3492703437805176
epoch: 212, iter: 7215, loss: 0.6346099972724915, time cost3.318894386291504
epoch: 212, iter: 7216, loss: 1.00343656539917, time cost3.357210397720337
epoch: 212, iter: 7217, loss: 0.9642115831375122, time cost3.4151291847229004
epoch: 212, iter: 7218, loss: 0.47581952810287476, time cost3.3333334922790527
epoch: 212, iter: 7219, loss: 1.260221242904663, time cost3.2909767627716064
epoch: 212, iter: 7220, loss: 0.817463219165802, time cost3.371783494949341
epoch: 212, iter: 7221, loss: 0.4963410496711731, time cost3.4494829177856445
epoch: 212, iter: 7222, loss: 1.0485756397247314, time cost3.4588868618011475
epoch: 212, iter: 7223, loss: 0.446662962436676, time cost3.3735671043395996
epoch: 212, iter: 7224, loss: 0.8198279142379761, time cost3.442486047744751
epoch: 212, iter: 7225, loss: 0.573062002658844, time cost3.350160598754883
epoch: 212, iter: 7226, loss: 1.0648690462112427, time cost3.3362905979156494
epoch: 212, iter: 7227, loss: 0.7024441361427307, time cost3.2357606887817383
epoch: 212, iter: 7228, loss: 1.032576560974121, time cost3.468172073364258
epoch: 212, iter: 7229, loss: 0.5664191246032715, time cost3.2040960788726807
epoch: 212, iter: 7230, loss: 0.4326908588409424, time cost3.1651597023010254
epoch: 212, iter: 7231, loss: 0.9166527986526489, time cost3.3098866939544678
epoch: 212, iter: 7232, loss: 0.6104637384414673, time cost3.3222415447235107
epoch: 212, iter: 7233, loss: 0.8901176452636719, time cost3.1789047718048096
epoch: 212, iter: 7234, loss: 0.48703864216804504, time cost3.361392021179199
epoch: 212, iter: 7235, loss: 0.7925411462783813, time cost3.234802484512329
epoch: 212, iter: 7236, loss: 0.8247268199920654, time cost3.374221086502075
epoch: 212, iter: 7237, loss: 0.3087274134159088, time cost3.1366913318634033
epoch: 212, iter: 7238, loss: 0.45390579104423523, time cost3.1464099884033203
epoch: 212, iter: 7239, loss: 0.7533071041107178, time cost3.165703058242798
epoch: 212, iter: 7240, loss: 0.41201668977737427, time cost3.223649024963379
epoch: 212, iter: 7241, loss: 1.075046181678772, time cost3.0537197589874268
epoch: 212, iter: 7242, loss: 0.42126330733299255, time cost2.3791425228118896
epoch: 213, iter: 7243, loss: 0.6042444705963135, time cost3.3596019744873047
epoch: 213, iter: 7244, loss: 0.45276615023612976, time cost3.2721168994903564
epoch: 213, iter: 7245, loss: 0.6637046337127686, time cost3.3140082359313965
epoch: 213, iter: 7246, loss: 0.3105325400829315, time cost3.3515517711639404
epoch: 213, iter: 7247, loss: 1.0598572492599487, time cost3.3394362926483154
epoch: 213, iter: 7248, loss: 0.42874935269355774, time cost3.268951416015625
epoch: 213, iter: 7249, loss: 0.590277910232544, time cost3.4564309120178223
epoch: 213, iter: 7250, loss: 0.5516842603683472, time cost3.3509411811828613
tensor([[ 93.,  76.,  83.,  ...,   3.,   3.,   5.],
        [ 20.,  21.,  17.,  ...,  10.,  10.,   6.],
        [ 35., 168.,  55.,  ...,   4.,   4.,   1.],
        ...,
        [ 52.,  49.,  37.,  ...,  10.,  10.,   5.],
        [ 31.,  32.,   5.,  ...,   1.,   1.,   1.],
        [ 49., 142., 183.,  ...,   2.,   2.,   5.]])
Epoch: 213, Iteration: 7250:
TEST A@1: 0.5288888888888889
TEST A@5: 0.8777777777777778
TEST A@10: 0.9533333333333334
TEST M@B: 0.4260836991855266
TEST M@A: 0.9557552239766255
TEST W@MB: 0.22847277408447036
TEST W@MA: 0.5904105864927698
TEST Time: 131.17710709571838
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 213, iter: 7251, loss: 0.8558921217918396, time cost3.192082643508911
epoch: 213, iter: 7252, loss: 0.34265223145484924, time cost3.3563449382781982
epoch: 213, iter: 7253, loss: 0.7323110103607178, time cost3.369227170944214
epoch: 213, iter: 7254, loss: 0.7896282076835632, time cost3.329169988632202
epoch: 213, iter: 7255, loss: 0.20668397843837738, time cost3.291346311569214
epoch: 213, iter: 7256, loss: 0.47639793157577515, time cost3.233510732650757
epoch: 213, iter: 7257, loss: 0.8856186866760254, time cost3.3574888706207275
epoch: 213, iter: 7258, loss: 0.7957383394241333, time cost3.3488571643829346
epoch: 213, iter: 7259, loss: 0.5994060039520264, time cost3.32259202003479
epoch: 213, iter: 7260, loss: 0.606860876083374, time cost3.286374807357788
epoch: 213, iter: 7261, loss: 1.264766812324524, time cost3.336940050125122
epoch: 213, iter: 7262, loss: 0.751857340335846, time cost3.286106824874878
epoch: 213, iter: 7263, loss: 1.0138920545578003, time cost3.276822566986084
epoch: 213, iter: 7264, loss: 1.137563705444336, time cost3.265353202819824
epoch: 213, iter: 7265, loss: 0.348143070936203, time cost3.301754951477051
epoch: 213, iter: 7266, loss: 0.9762380123138428, time cost3.3996052742004395
epoch: 213, iter: 7267, loss: 0.6404523253440857, time cost3.3003857135772705
epoch: 213, iter: 7268, loss: 0.42920783162117004, time cost3.414303779602051
epoch: 213, iter: 7269, loss: 0.6615899801254272, time cost3.297881841659546
epoch: 213, iter: 7270, loss: 0.6520323157310486, time cost3.1998023986816406
epoch: 213, iter: 7271, loss: 0.741119384765625, time cost3.2618114948272705
epoch: 213, iter: 7272, loss: 0.6801314949989319, time cost3.2024898529052734
epoch: 213, iter: 7273, loss: 0.3732113242149353, time cost3.238805055618286
epoch: 213, iter: 7274, loss: 0.645865261554718, time cost3.325854539871216
epoch: 213, iter: 7275, loss: 0.6365451812744141, time cost3.246652364730835
epoch: 213, iter: 7276, loss: 0.8302657008171082, time cost2.2976818084716797
epoch: 214, iter: 7277, loss: 0.5710522532463074, time cost3.316657543182373
epoch: 214, iter: 7278, loss: 0.8925285339355469, time cost3.2667336463928223
epoch: 214, iter: 7279, loss: 0.49562138319015503, time cost3.3869807720184326
epoch: 214, iter: 7280, loss: 0.5972527265548706, time cost3.470797061920166
epoch: 214, iter: 7281, loss: 0.6783205270767212, time cost3.291182518005371
epoch: 214, iter: 7282, loss: 0.7674529552459717, time cost3.364170551300049
epoch: 214, iter: 7283, loss: 1.2110055685043335, time cost3.261599540710449
epoch: 214, iter: 7284, loss: 0.36086928844451904, time cost3.2329893112182617
epoch: 214, iter: 7285, loss: 0.4194612503051758, time cost3.163733720779419
epoch: 214, iter: 7286, loss: 0.6011613607406616, time cost3.4695119857788086
epoch: 214, iter: 7287, loss: 0.9832344651222229, time cost3.466858148574829
epoch: 214, iter: 7288, loss: 0.8119666576385498, time cost3.292025089263916
epoch: 214, iter: 7289, loss: 0.5889045000076294, time cost3.25007700920105
epoch: 214, iter: 7290, loss: 0.4994904100894928, time cost3.337782382965088
epoch: 214, iter: 7291, loss: 1.1561309099197388, time cost3.2057178020477295
epoch: 214, iter: 7292, loss: 0.7269399762153625, time cost3.2817602157592773
epoch: 214, iter: 7293, loss: 0.692657470703125, time cost3.3651938438415527
epoch: 214, iter: 7294, loss: 0.7860011458396912, time cost3.3527350425720215
epoch: 214, iter: 7295, loss: 0.6967222690582275, time cost3.315903902053833
epoch: 214, iter: 7296, loss: 0.4562193751335144, time cost3.4153635501861572
epoch: 214, iter: 7297, loss: 0.5819019079208374, time cost3.473128080368042
epoch: 214, iter: 7298, loss: 1.0696370601654053, time cost3.182659387588501
epoch: 214, iter: 7299, loss: 0.7881016135215759, time cost3.254436492919922
epoch: 214, iter: 7300, loss: 0.8887603282928467, time cost3.3641960620880127
tensor([[ 21.,  21.,  23.,  ...,   2.,   2.,   1.],
        [ 28.,  19.,  18.,  ...,   5.,   5.,   4.],
        [181., 326.,  90.,  ...,   1.,   1.,   1.],
        ...,
        [ 44.,  41.,  23.,  ...,  17.,  17.,  10.],
        [ 64.,  58.,   6.,  ...,   1.,   1.,   1.],
        [ 45., 133., 147.,  ...,   2.,   2.,   8.]])
Epoch: 214, Iteration: 7300:
TEST A@1: 0.5577777777777778
TEST A@5: 0.9
TEST A@10: 0.96
TEST M@B: 0.43450473827718394
TEST M@A: 0.9568889603272508
TEST W@MB: 0.23324158949286222
TEST W@MA: 0.5913294523451568
TEST Time: 129.81303596496582
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 214, iter: 7301, loss: 0.6729958057403564, time cost3.038396120071411
epoch: 214, iter: 7302, loss: 0.9231897592544556, time cost3.1373777389526367
epoch: 214, iter: 7303, loss: 0.8078133463859558, time cost3.052865505218506
epoch: 214, iter: 7304, loss: 0.6938060522079468, time cost3.1454977989196777
epoch: 214, iter: 7305, loss: 0.696050226688385, time cost3.221762180328369
epoch: 214, iter: 7306, loss: 0.8121423125267029, time cost3.23850679397583
epoch: 214, iter: 7307, loss: 0.5016307234764099, time cost3.256774425506592
epoch: 214, iter: 7308, loss: 0.4935173988342285, time cost3.1410272121429443
epoch: 214, iter: 7309, loss: 0.9374421834945679, time cost3.176082134246826
epoch: 214, iter: 7310, loss: 0.6784845590591431, time cost2.299166202545166
epoch: 215, iter: 7311, loss: 0.6364378929138184, time cost3.496304988861084
epoch: 215, iter: 7312, loss: 1.0225266218185425, time cost3.3770852088928223
epoch: 215, iter: 7313, loss: 0.7121900916099548, time cost3.584275722503662
epoch: 215, iter: 7314, loss: 0.5385403633117676, time cost3.4776957035064697
epoch: 215, iter: 7315, loss: 1.0253607034683228, time cost3.4183034896850586
epoch: 215, iter: 7316, loss: 0.5724236965179443, time cost3.729084014892578
epoch: 215, iter: 7317, loss: 0.6933007836341858, time cost3.7185935974121094
epoch: 215, iter: 7318, loss: 1.0367265939712524, time cost3.5547239780426025
epoch: 215, iter: 7319, loss: 0.6264742612838745, time cost3.4292311668395996
epoch: 215, iter: 7320, loss: 0.8415548205375671, time cost3.35578989982605
epoch: 215, iter: 7321, loss: 0.5866074562072754, time cost3.3813512325286865
epoch: 215, iter: 7322, loss: 0.38374069333076477, time cost3.289466142654419
epoch: 215, iter: 7323, loss: 0.9781584739685059, time cost3.3800535202026367
epoch: 215, iter: 7324, loss: 0.9564160108566284, time cost3.237947702407837
epoch: 215, iter: 7325, loss: 0.4453835189342499, time cost3.3719542026519775
epoch: 215, iter: 7326, loss: 0.8901511430740356, time cost3.2723023891448975
epoch: 215, iter: 7327, loss: 0.8473595380783081, time cost3.2887625694274902
epoch: 215, iter: 7328, loss: 0.6031284332275391, time cost3.311278820037842
epoch: 215, iter: 7329, loss: 0.7139030694961548, time cost3.4026565551757812
epoch: 215, iter: 7330, loss: 1.185866355895996, time cost3.357802629470825
epoch: 215, iter: 7331, loss: 0.5744856595993042, time cost3.3926587104797363
epoch: 215, iter: 7332, loss: 0.7914119958877563, time cost3.424633741378784
epoch: 215, iter: 7333, loss: 0.5930958986282349, time cost3.238173484802246
epoch: 215, iter: 7334, loss: 0.6251835227012634, time cost3.2447123527526855
epoch: 215, iter: 7335, loss: 0.6110614538192749, time cost3.2325849533081055
epoch: 215, iter: 7336, loss: 0.6457487344741821, time cost3.274296760559082
epoch: 215, iter: 7337, loss: 0.3582974672317505, time cost3.346850872039795
epoch: 215, iter: 7338, loss: 0.5953689217567444, time cost3.269315004348755
epoch: 215, iter: 7339, loss: 0.7563230395317078, time cost3.1888537406921387
epoch: 215, iter: 7340, loss: 0.8648647665977478, time cost3.3339991569519043
epoch: 215, iter: 7341, loss: 0.7035001516342163, time cost3.284745931625366
epoch: 215, iter: 7342, loss: 0.685248851776123, time cost3.348703384399414
epoch: 215, iter: 7343, loss: 0.7630135416984558, time cost3.2566349506378174
epoch: 215, iter: 7344, loss: 1.0040658712387085, time cost2.2678442001342773
epoch: 216, iter: 7345, loss: 0.6977142095565796, time cost3.4441869258880615
epoch: 216, iter: 7346, loss: 0.36760246753692627, time cost3.355893611907959
epoch: 216, iter: 7347, loss: 0.8153295516967773, time cost3.37669038772583
epoch: 216, iter: 7348, loss: 0.5938392281532288, time cost3.331219434738159
epoch: 216, iter: 7349, loss: 0.8386238813400269, time cost3.2883405685424805
epoch: 216, iter: 7350, loss: 0.6323862671852112, time cost3.1744143962860107
tensor([[122., 112., 126.,  ...,  11.,  11.,   7.],
        [  7.,   7.,   7.,  ...,  13.,  13.,   7.],
        [124., 316.,  93.,  ...,  10.,  10.,   3.],
        ...,
        [ 48.,  40.,  27.,  ...,  10.,  10.,   7.],
        [ 84.,  73.,  10.,  ...,   1.,   1.,   1.],
        [ 56., 121., 146.,  ...,   2.,   2.,   5.]])
Epoch: 216, Iteration: 7350:
TEST A@1: 0.5088888888888888
TEST A@5: 0.8444444444444444
TEST A@10: 0.9244444444444444
TEST M@B: 0.40371106528526113
TEST M@A: 0.9562292932977323
TEST W@MB: 0.21774448022577755
TEST W@MA: 0.5911133394359585
TEST Time: 148.65122604370117
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 216, iter: 7351, loss: 0.5360766053199768, time cost3.1272783279418945
epoch: 216, iter: 7352, loss: 0.7645377516746521, time cost3.044919490814209
epoch: 216, iter: 7353, loss: 0.9945207834243774, time cost3.2084922790527344
epoch: 216, iter: 7354, loss: 0.7784724831581116, time cost3.1239097118377686
epoch: 216, iter: 7355, loss: 0.8571092486381531, time cost3.1825830936431885
epoch: 216, iter: 7356, loss: 0.6823495626449585, time cost3.360194444656372
epoch: 216, iter: 7357, loss: 0.48306843638420105, time cost3.548325538635254
epoch: 216, iter: 7358, loss: 0.877268373966217, time cost3.311368703842163
epoch: 216, iter: 7359, loss: 0.7174098491668701, time cost3.275448799133301
epoch: 216, iter: 7360, loss: 0.8475611805915833, time cost3.304841995239258
epoch: 216, iter: 7361, loss: 1.3898005485534668, time cost3.233553409576416
epoch: 216, iter: 7362, loss: 0.4041072130203247, time cost3.335512161254883
epoch: 216, iter: 7363, loss: 0.7165077924728394, time cost3.3748927116394043
epoch: 216, iter: 7364, loss: 0.9329437613487244, time cost3.4164788722991943
epoch: 216, iter: 7365, loss: 0.41500845551490784, time cost3.392780065536499
epoch: 216, iter: 7366, loss: 0.4210408926010132, time cost3.3465476036071777
epoch: 216, iter: 7367, loss: 0.3855949640274048, time cost3.4567737579345703
epoch: 216, iter: 7368, loss: 1.0971543788909912, time cost3.3251593112945557
epoch: 216, iter: 7369, loss: 0.4656729996204376, time cost3.209091901779175
epoch: 216, iter: 7370, loss: 0.5792537927627563, time cost3.280304431915283
epoch: 216, iter: 7371, loss: 0.9052097797393799, time cost3.2592532634735107
epoch: 216, iter: 7372, loss: 0.6671844720840454, time cost3.223785877227783
epoch: 216, iter: 7373, loss: 0.5140312910079956, time cost3.0787038803100586
epoch: 216, iter: 7374, loss: 0.3822318911552429, time cost3.3077645301818848
epoch: 216, iter: 7375, loss: 0.8004465103149414, time cost3.088291645050049
epoch: 216, iter: 7376, loss: 0.8489185571670532, time cost3.056727409362793
epoch: 216, iter: 7377, loss: 0.6248098015785217, time cost3.2421648502349854
epoch: 216, iter: 7378, loss: 0.4414561688899994, time cost2.262748956680298
epoch: 217, iter: 7379, loss: 0.5545495748519897, time cost3.4374196529388428
epoch: 217, iter: 7380, loss: 0.6406293511390686, time cost3.4305288791656494
epoch: 217, iter: 7381, loss: 0.5833325386047363, time cost3.3339197635650635
epoch: 217, iter: 7382, loss: 0.6122381687164307, time cost3.2874867916107178
epoch: 217, iter: 7383, loss: 0.5527400970458984, time cost3.4148497581481934
epoch: 217, iter: 7384, loss: 0.18701957166194916, time cost3.2793331146240234
epoch: 217, iter: 7385, loss: 0.4721585810184479, time cost3.289818048477173
epoch: 217, iter: 7386, loss: 0.8502482175827026, time cost3.3300235271453857
epoch: 217, iter: 7387, loss: 0.8364475965499878, time cost3.259726047515869
epoch: 217, iter: 7388, loss: 0.571384847164154, time cost3.2063050270080566
epoch: 217, iter: 7389, loss: 0.6686007976531982, time cost3.29213285446167
epoch: 217, iter: 7390, loss: 0.7720270156860352, time cost3.2346739768981934
epoch: 217, iter: 7391, loss: 0.5258687138557434, time cost3.245867967605591
epoch: 217, iter: 7392, loss: 0.5735359191894531, time cost3.285033702850342
epoch: 217, iter: 7393, loss: 0.7225928902626038, time cost3.214963912963867
epoch: 217, iter: 7394, loss: 0.6140241622924805, time cost3.3026986122131348
epoch: 217, iter: 7395, loss: 0.8967218399047852, time cost3.226309299468994
epoch: 217, iter: 7396, loss: 0.385001003742218, time cost3.2696800231933594
epoch: 217, iter: 7397, loss: 0.5290451049804688, time cost3.314681053161621
epoch: 217, iter: 7398, loss: 0.7736970782279968, time cost3.2410888671875
epoch: 217, iter: 7399, loss: 0.8584161996841431, time cost3.3616549968719482
epoch: 217, iter: 7400, loss: 0.6750566363334656, time cost3.3046905994415283
tensor([[ 76.,  60.,  76.,  ...,   4.,   4.,   2.],
        [  5.,  11.,   8.,  ...,   8.,   8.,   5.],
        [122., 341., 140.,  ...,   2.,   2.,   1.],
        ...,
        [ 67.,  66.,  45.,  ...,   7.,   7.,   4.],
        [ 37.,  50.,  22.,  ...,   1.,   1.,   1.],
        [ 36.,  94., 106.,  ...,   1.,   1.,   1.]])
Epoch: 217, Iteration: 7400:
TEST A@1: 0.56
TEST A@5: 0.88
TEST A@10: 0.9422222222222222
TEST M@B: 0.42714318473582263
TEST M@A: 0.9589916928478457
TEST W@MB: 0.23111757073172287
TEST W@MA: 0.5931586725257995
TEST Time: 150.22615313529968
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 217, iter: 7401, loss: 0.4831220507621765, time cost3.077042579650879
epoch: 217, iter: 7402, loss: 0.604138970375061, time cost3.1259357929229736
epoch: 217, iter: 7403, loss: 0.44329774379730225, time cost3.2964048385620117
epoch: 217, iter: 7404, loss: 0.5570838451385498, time cost3.283787488937378
epoch: 217, iter: 7405, loss: 0.6617811918258667, time cost3.1798763275146484
epoch: 217, iter: 7406, loss: 0.3796028196811676, time cost3.34395432472229
epoch: 217, iter: 7407, loss: 0.5639683604240417, time cost3.3375558853149414
epoch: 217, iter: 7408, loss: 0.5135666728019714, time cost3.3167245388031006
epoch: 217, iter: 7409, loss: 0.530776858329773, time cost3.2018442153930664
epoch: 217, iter: 7410, loss: 0.5729699730873108, time cost3.1736886501312256
epoch: 217, iter: 7411, loss: 0.36728423833847046, time cost3.1217918395996094
epoch: 217, iter: 7412, loss: 0.7687667012214661, time cost2.403062343597412
epoch: 218, iter: 7413, loss: 0.9501243829727173, time cost3.4448680877685547
epoch: 218, iter: 7414, loss: 0.9305869936943054, time cost3.29884934425354
epoch: 218, iter: 7415, loss: 0.5724301338195801, time cost3.3501789569854736
epoch: 218, iter: 7416, loss: 1.0271104574203491, time cost3.4122347831726074
epoch: 218, iter: 7417, loss: 0.34992802143096924, time cost3.3579370975494385
epoch: 218, iter: 7418, loss: 0.6189326047897339, time cost3.392167568206787
epoch: 218, iter: 7419, loss: 0.4698878824710846, time cost3.190978527069092
epoch: 218, iter: 7420, loss: 1.106013298034668, time cost3.347825527191162
epoch: 218, iter: 7421, loss: 0.5379621386528015, time cost3.2449393272399902
epoch: 218, iter: 7422, loss: 0.8111593723297119, time cost3.257093906402588
epoch: 218, iter: 7423, loss: 0.7338788509368896, time cost3.3458375930786133
epoch: 218, iter: 7424, loss: 0.748270571231842, time cost3.4804975986480713
epoch: 218, iter: 7425, loss: 0.8644735217094421, time cost3.3527660369873047
epoch: 218, iter: 7426, loss: 0.6283724904060364, time cost3.318208694458008
epoch: 218, iter: 7427, loss: 0.5679143667221069, time cost3.288292169570923
epoch: 218, iter: 7428, loss: 0.6915913820266724, time cost3.3045654296875
epoch: 218, iter: 7429, loss: 0.803396999835968, time cost3.4698915481567383
epoch: 218, iter: 7430, loss: 0.49507924914360046, time cost3.3443520069122314
epoch: 218, iter: 7431, loss: 0.41605985164642334, time cost3.3537209033966064
epoch: 218, iter: 7432, loss: 0.4832703173160553, time cost3.2282004356384277
epoch: 218, iter: 7433, loss: 0.27826234698295593, time cost3.388366222381592
epoch: 218, iter: 7434, loss: 0.7224644422531128, time cost3.4309635162353516
epoch: 218, iter: 7435, loss: 0.5092809796333313, time cost3.237192153930664
epoch: 218, iter: 7436, loss: 0.9224293231964111, time cost3.3992409706115723
epoch: 218, iter: 7437, loss: 0.4423694312572479, time cost3.3695054054260254
epoch: 218, iter: 7438, loss: 0.5543379783630371, time cost3.311129570007324
epoch: 218, iter: 7439, loss: 0.4022100269794464, time cost3.2950825691223145
epoch: 218, iter: 7440, loss: 0.7840539216995239, time cost3.232135057449341
epoch: 218, iter: 7441, loss: 0.6875085830688477, time cost3.2161293029785156
epoch: 218, iter: 7442, loss: 0.8577513694763184, time cost3.2355568408966064
epoch: 218, iter: 7443, loss: 0.39735016226768494, time cost3.1915414333343506
epoch: 218, iter: 7444, loss: 0.9404318928718567, time cost3.3285634517669678
epoch: 218, iter: 7445, loss: 1.073331594467163, time cost3.18350887298584
epoch: 218, iter: 7446, loss: 0.6790841817855835, time cost2.2787482738494873
epoch: 219, iter: 7447, loss: 0.6154381632804871, time cost3.5282206535339355
epoch: 219, iter: 7448, loss: 0.9990627765655518, time cost3.58931303024292
epoch: 219, iter: 7449, loss: 0.7861952781677246, time cost3.7157084941864014
epoch: 219, iter: 7450, loss: 0.6888613700866699, time cost3.5025792121887207
tensor([[ 35.,  35.,  34.,  ...,   7.,   7.,   6.],
        [ 16.,  23.,  20.,  ...,  14.,  14.,   9.],
        [246., 422., 270.,  ...,  15.,  15.,   8.],
        ...,
        [ 43.,  39.,  12.,  ...,   8.,   8.,   6.],
        [126., 120.,  28.,  ...,   1.,   1.,   1.],
        [ 27.,  73.,  82.,  ...,   2.,   2.,   3.]])
Epoch: 219, Iteration: 7450:
TEST A@1: 0.5244444444444445
TEST A@5: 0.8733333333333333
TEST A@10: 0.9577777777777777
TEST M@B: 0.41828976589535594
TEST M@A: 0.9575079726061768
TEST W@MB: 0.2250797824080966
TEST W@MA: 0.5919590451439576
TEST Time: 148.94976782798767
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 219, iter: 7451, loss: 0.6245681047439575, time cost3.147383689880371
epoch: 219, iter: 7452, loss: 0.4898218512535095, time cost3.1841564178466797
epoch: 219, iter: 7453, loss: 0.6219182014465332, time cost3.3065335750579834
epoch: 219, iter: 7454, loss: 0.7589948773384094, time cost3.4261362552642822
epoch: 219, iter: 7455, loss: 0.7804951071739197, time cost3.3145604133605957
epoch: 219, iter: 7456, loss: 0.8689420819282532, time cost3.4572105407714844
epoch: 219, iter: 7457, loss: 0.42882025241851807, time cost3.159912109375
epoch: 219, iter: 7458, loss: 1.183344841003418, time cost3.5219345092773438
epoch: 219, iter: 7459, loss: 0.5510696768760681, time cost3.3385860919952393
epoch: 219, iter: 7460, loss: 0.48568254709243774, time cost3.3372488021850586
epoch: 219, iter: 7461, loss: 1.186668872833252, time cost3.297308921813965
epoch: 219, iter: 7462, loss: 0.6083635091781616, time cost3.440272331237793
epoch: 219, iter: 7463, loss: 0.935471773147583, time cost3.299461603164673
epoch: 219, iter: 7464, loss: 1.4776945114135742, time cost3.337824583053589
epoch: 219, iter: 7465, loss: 0.45337483286857605, time cost3.388068199157715
epoch: 219, iter: 7466, loss: 0.5112280249595642, time cost3.3821756839752197
epoch: 219, iter: 7467, loss: 0.5345067381858826, time cost3.2823987007141113
epoch: 219, iter: 7468, loss: 0.9223672151565552, time cost3.513998508453369
epoch: 219, iter: 7469, loss: 0.47468283772468567, time cost3.361624240875244
epoch: 219, iter: 7470, loss: 0.752713680267334, time cost3.2964906692504883
epoch: 219, iter: 7471, loss: 1.2546616792678833, time cost3.4329171180725098
epoch: 219, iter: 7472, loss: 0.9714346528053284, time cost3.3914847373962402
epoch: 219, iter: 7473, loss: 0.8576487898826599, time cost3.3480677604675293
epoch: 219, iter: 7474, loss: 0.7258272767066956, time cost3.211040496826172
epoch: 219, iter: 7475, loss: 0.3518925607204437, time cost3.274380683898926
epoch: 219, iter: 7476, loss: 0.5399113893508911, time cost3.207690715789795
epoch: 219, iter: 7477, loss: 0.49616947770118713, time cost3.2725770473480225
epoch: 219, iter: 7478, loss: 1.2619787454605103, time cost3.3219659328460693
epoch: 219, iter: 7479, loss: 0.86255943775177, time cost3.1518397331237793
epoch: 219, iter: 7480, loss: 0.4964098334312439, time cost2.2459182739257812
epoch: 220, iter: 7481, loss: 0.7486305832862854, time cost3.4262590408325195
epoch: 220, iter: 7482, loss: 1.0723239183425903, time cost3.317716121673584
epoch: 220, iter: 7483, loss: 0.589357852935791, time cost3.3129003047943115
epoch: 220, iter: 7484, loss: 0.6935458779335022, time cost3.611499786376953
epoch: 220, iter: 7485, loss: 0.8408546447753906, time cost3.4101147651672363
epoch: 220, iter: 7486, loss: 0.6799905300140381, time cost3.61244535446167
epoch: 220, iter: 7487, loss: 0.8114379048347473, time cost3.312741994857788
epoch: 220, iter: 7488, loss: 0.7763598561286926, time cost3.3504040241241455
epoch: 220, iter: 7489, loss: 0.3030114769935608, time cost3.441758394241333
epoch: 220, iter: 7490, loss: 0.571403443813324, time cost3.3520684242248535
epoch: 220, iter: 7491, loss: 0.7350866198539734, time cost3.2566566467285156
epoch: 220, iter: 7492, loss: 0.550693929195404, time cost3.2763335704803467
epoch: 220, iter: 7493, loss: 0.4483335316181183, time cost3.334803581237793
epoch: 220, iter: 7494, loss: 1.2425702810287476, time cost3.2822444438934326
epoch: 220, iter: 7495, loss: 0.945170521736145, time cost3.2908077239990234
epoch: 220, iter: 7496, loss: 0.45855456590652466, time cost3.2389371395111084
epoch: 220, iter: 7497, loss: 0.9932626485824585, time cost3.3605897426605225
epoch: 220, iter: 7498, loss: 1.1239393949508667, time cost3.2786800861358643
epoch: 220, iter: 7499, loss: 0.44030576944351196, time cost3.3268790245056152
epoch: 220, iter: 7500, loss: 0.9568973779678345, time cost3.345949172973633
tensor([[ 44.,  34.,  43.,  ...,   1.,   1.,   1.],
        [  5.,   6.,   6.,  ...,   9.,   9.,   5.],
        [108., 242.,  81.,  ...,   1.,   1.,   1.],
        ...,
        [ 80.,  81.,  53.,  ...,  11.,  11.,   8.],
        [ 31.,  40.,   5.,  ...,   1.,   1.,   1.],
        [106., 258., 270.,  ...,   3.,   3.,   7.]])
Epoch: 220, Iteration: 7500:
TEST A@1: 0.5711111111111111
TEST A@5: 0.8933333333333333
TEST A@10: 0.9688888888888889
TEST M@B: 0.4435851192012607
TEST M@A: 0.9601704676849028
TEST W@MB: 0.23947192583878296
TEST W@MA: 0.5940274133090856
TEST Time: 132.18308067321777
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 220, iter: 7501, loss: 0.6691849231719971, time cost3.2062058448791504
epoch: 220, iter: 7502, loss: 0.4987954795360565, time cost3.090909481048584
epoch: 220, iter: 7503, loss: 0.3427235782146454, time cost3.2924275398254395
epoch: 220, iter: 7504, loss: 0.4279446303844452, time cost3.3349945545196533
epoch: 220, iter: 7505, loss: 0.4838991165161133, time cost3.393120050430298
epoch: 220, iter: 7506, loss: 0.42785122990608215, time cost3.2847681045532227
epoch: 220, iter: 7507, loss: 1.0146987438201904, time cost3.353731155395508
epoch: 220, iter: 7508, loss: 0.8159310817718506, time cost3.1115713119506836
epoch: 220, iter: 7509, loss: 0.8975792527198792, time cost3.1855416297912598
epoch: 220, iter: 7510, loss: 0.6661899089813232, time cost3.1776671409606934
epoch: 220, iter: 7511, loss: 0.8434373736381531, time cost3.2231786251068115
epoch: 220, iter: 7512, loss: 0.9707446098327637, time cost3.2818832397460938
epoch: 220, iter: 7513, loss: 0.6421574354171753, time cost3.2888805866241455
epoch: 220, iter: 7514, loss: 0.3512602746486664, time cost2.321165084838867
epoch: 221, iter: 7515, loss: 1.032210350036621, time cost3.392157554626465
epoch: 221, iter: 7516, loss: 0.5050842761993408, time cost3.395296812057495
epoch: 221, iter: 7517, loss: 0.7157178521156311, time cost3.339202404022217
epoch: 221, iter: 7518, loss: 0.906018853187561, time cost3.28906512260437
epoch: 221, iter: 7519, loss: 0.4270032048225403, time cost3.328629493713379
epoch: 221, iter: 7520, loss: 0.5884111523628235, time cost3.277336597442627
epoch: 221, iter: 7521, loss: 1.159612774848938, time cost3.409942626953125
epoch: 221, iter: 7522, loss: 0.8229890465736389, time cost3.425445079803467
epoch: 221, iter: 7523, loss: 0.8001028895378113, time cost3.4136953353881836
epoch: 221, iter: 7524, loss: 0.727452278137207, time cost3.4460337162017822
epoch: 221, iter: 7525, loss: 0.4985475540161133, time cost3.357361316680908
epoch: 221, iter: 7526, loss: 0.920518696308136, time cost3.3771235942840576
epoch: 221, iter: 7527, loss: 1.007581114768982, time cost3.226689338684082
epoch: 221, iter: 7528, loss: 0.6400970816612244, time cost3.2969746589660645
epoch: 221, iter: 7529, loss: 0.6212924122810364, time cost3.4273247718811035
epoch: 221, iter: 7530, loss: 0.6849368214607239, time cost3.3099966049194336
epoch: 221, iter: 7531, loss: 1.503229022026062, time cost3.4358725547790527
epoch: 221, iter: 7532, loss: 0.7692660689353943, time cost3.248692512512207
epoch: 221, iter: 7533, loss: 0.7493581175804138, time cost3.3972816467285156
epoch: 221, iter: 7534, loss: 0.7447080016136169, time cost3.4237821102142334
epoch: 221, iter: 7535, loss: 1.0656181573867798, time cost3.3538360595703125
epoch: 221, iter: 7536, loss: 1.3991328477859497, time cost3.226844310760498
epoch: 221, iter: 7537, loss: 0.7181030511856079, time cost3.3944318294525146
epoch: 221, iter: 7538, loss: 0.6058191657066345, time cost3.3103697299957275
epoch: 221, iter: 7539, loss: 0.7380901575088501, time cost3.3691625595092773
epoch: 221, iter: 7540, loss: 0.38354626297950745, time cost3.2881405353546143
epoch: 221, iter: 7541, loss: 0.392736554145813, time cost3.182835817337036
epoch: 221, iter: 7542, loss: 0.7406365871429443, time cost3.13889217376709
epoch: 221, iter: 7543, loss: 1.1746028661727905, time cost3.1654250621795654
epoch: 221, iter: 7544, loss: 0.566596508026123, time cost3.41817045211792
epoch: 221, iter: 7545, loss: 0.6096633672714233, time cost3.1100151538848877
epoch: 221, iter: 7546, loss: 1.0478031635284424, time cost3.328652858734131
epoch: 221, iter: 7547, loss: 0.8569784760475159, time cost3.2595202922821045
epoch: 221, iter: 7548, loss: 0.43172982335090637, time cost2.354078531265259
epoch: 222, iter: 7549, loss: 0.982688844203949, time cost3.371826171875
epoch: 222, iter: 7550, loss: 0.48072871565818787, time cost3.435631275177002
tensor([[ 42.,  35.,  38.,  ...,   1.,   1.,   2.],
        [  5.,   6.,   5.,  ...,   5.,   5.,   2.],
        [ 66., 228.,  67.,  ...,   3.,   3.,   2.],
        ...,
        [ 61.,  54.,  38.,  ...,   6.,   6.,   6.],
        [ 82.,  84.,   5.,  ...,   1.,   1.,   1.],
        [ 43.,  99.,  90.,  ...,   2.,   2.,   7.]])
Epoch: 222, Iteration: 7550:
TEST A@1: 0.5311111111111111
TEST A@5: 0.8822222222222222
TEST A@10: 0.9577777777777777
TEST M@B: 0.4325493775393855
TEST M@A: 0.9591314036468607
TEST W@MB: 0.23221369064847489
TEST W@MA: 0.5933327389533501
TEST Time: 147.95074582099915
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 222, iter: 7551, loss: 0.8813326358795166, time cost3.1770408153533936
epoch: 222, iter: 7552, loss: 0.6448018550872803, time cost3.1244776248931885
epoch: 222, iter: 7553, loss: 0.7879189252853394, time cost3.386857509613037
epoch: 222, iter: 7554, loss: 0.5711169838905334, time cost3.2383008003234863
epoch: 222, iter: 7555, loss: 0.6877120137214661, time cost3.2897090911865234
epoch: 222, iter: 7556, loss: 0.45781946182250977, time cost3.2691121101379395
epoch: 222, iter: 7557, loss: 1.040574550628662, time cost3.2873823642730713
epoch: 222, iter: 7558, loss: 0.6789387464523315, time cost3.3426551818847656
epoch: 222, iter: 7559, loss: 0.9063074588775635, time cost3.315436840057373
epoch: 222, iter: 7560, loss: 0.6895560026168823, time cost3.2542238235473633
epoch: 222, iter: 7561, loss: 0.594296932220459, time cost3.2654383182525635
epoch: 222, iter: 7562, loss: 0.6069175601005554, time cost3.2882273197174072
epoch: 222, iter: 7563, loss: 0.7473105192184448, time cost3.3853912353515625
epoch: 222, iter: 7564, loss: 0.8189290165901184, time cost3.386223554611206
epoch: 222, iter: 7565, loss: 0.5072385668754578, time cost3.227987051010132
epoch: 222, iter: 7566, loss: 0.8974668383598328, time cost3.5205078125
epoch: 222, iter: 7567, loss: 0.3939981460571289, time cost3.2094500064849854
epoch: 222, iter: 7568, loss: 0.9500132203102112, time cost3.338017225265503
epoch: 222, iter: 7569, loss: 0.71921706199646, time cost3.645847797393799
epoch: 222, iter: 7570, loss: 0.510154128074646, time cost3.369431257247925
epoch: 222, iter: 7571, loss: 0.3009585440158844, time cost3.425611972808838
epoch: 222, iter: 7572, loss: 1.004693865776062, time cost3.479337215423584
epoch: 222, iter: 7573, loss: 0.49200719594955444, time cost3.3145523071289062
epoch: 222, iter: 7574, loss: 0.9684445858001709, time cost3.2900590896606445
epoch: 222, iter: 7575, loss: 0.7706947922706604, time cost3.410931348800659
epoch: 222, iter: 7576, loss: 0.6549158096313477, time cost3.3075218200683594
epoch: 222, iter: 7577, loss: 0.5652194023132324, time cost3.160978078842163
epoch: 222, iter: 7578, loss: 0.4402743875980377, time cost3.189303159713745
epoch: 222, iter: 7579, loss: 0.6433392763137817, time cost3.4104933738708496
epoch: 222, iter: 7580, loss: 1.1107375621795654, time cost3.3737456798553467
epoch: 222, iter: 7581, loss: 0.5333203673362732, time cost3.3104658126831055
epoch: 222, iter: 7582, loss: 0.5809041261672974, time cost2.2643158435821533
epoch: 223, iter: 7583, loss: 0.9043435454368591, time cost3.396174430847168
epoch: 223, iter: 7584, loss: 0.7645116448402405, time cost3.2324366569519043
epoch: 223, iter: 7585, loss: 0.528917670249939, time cost3.524149179458618
epoch: 223, iter: 7586, loss: 0.44890281558036804, time cost3.3295319080352783
epoch: 223, iter: 7587, loss: 0.6341964602470398, time cost3.399204730987549
epoch: 223, iter: 7588, loss: 1.081754446029663, time cost3.3174233436584473
epoch: 223, iter: 7589, loss: 0.6017584800720215, time cost3.258359909057617
epoch: 223, iter: 7590, loss: 0.6185989379882812, time cost3.344102144241333
epoch: 223, iter: 7591, loss: 1.0031421184539795, time cost3.5698413848876953
epoch: 223, iter: 7592, loss: 0.8950983285903931, time cost3.3399603366851807
epoch: 223, iter: 7593, loss: 0.6135956645011902, time cost3.4159271717071533
epoch: 223, iter: 7594, loss: 0.661557674407959, time cost3.294597864151001
epoch: 223, iter: 7595, loss: 0.8058624267578125, time cost3.404710054397583
epoch: 223, iter: 7596, loss: 0.5902462005615234, time cost3.3794734477996826
epoch: 223, iter: 7597, loss: 0.48286983370780945, time cost3.396148443222046
epoch: 223, iter: 7598, loss: 0.5800648331642151, time cost3.3914382457733154
epoch: 223, iter: 7599, loss: 0.9213670492172241, time cost3.345578908920288
epoch: 223, iter: 7600, loss: 0.4893333315849304, time cost3.420362710952759
tensor([[ 90.,  83.,  97.,  ...,  10.,  10.,   8.],
        [ 22.,  22.,  19.,  ...,  10.,  10.,   7.],
        [ 75., 227.,  90.,  ...,   3.,   3.,   2.],
        ...,
        [ 36.,  42.,  25.,  ...,   8.,   8.,   7.],
        [144., 162.,  55.,  ...,   1.,   1.,   1.],
        [ 43., 149., 143.,  ...,   9.,   9.,  18.]])
Epoch: 223, Iteration: 7600:
TEST A@1: 0.44666666666666666
TEST A@5: 0.78
TEST A@10: 0.9222222222222223
TEST M@B: 0.37365490599863554
TEST M@A: 0.9531229190474879
TEST W@MB: 0.2007718978600528
TEST W@MA: 0.5888750928360261
TEST Time: 125.41602110862732
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 223, iter: 7601, loss: 0.4465961456298828, time cost3.131633996963501
epoch: 223, iter: 7602, loss: 0.29471439123153687, time cost3.2264516353607178
epoch: 223, iter: 7603, loss: 0.5818859934806824, time cost3.2725353240966797
epoch: 223, iter: 7604, loss: 1.0685145854949951, time cost3.284245729446411
epoch: 223, iter: 7605, loss: 0.47058141231536865, time cost3.709923505783081
epoch: 223, iter: 7606, loss: 1.1709734201431274, time cost3.3682608604431152
epoch: 223, iter: 7607, loss: 0.8964154124259949, time cost3.324049949645996
epoch: 223, iter: 7608, loss: 0.661279559135437, time cost3.4246327877044678
epoch: 223, iter: 7609, loss: 0.6656163334846497, time cost3.3500635623931885
epoch: 223, iter: 7610, loss: 0.3019092381000519, time cost3.54394268989563
epoch: 223, iter: 7611, loss: 0.5760136842727661, time cost3.2515833377838135
epoch: 223, iter: 7612, loss: 0.39634308218955994, time cost3.291409969329834
epoch: 223, iter: 7613, loss: 0.5665177702903748, time cost3.48127818107605
epoch: 223, iter: 7614, loss: 0.6802018880844116, time cost3.307990550994873
epoch: 223, iter: 7615, loss: 0.7735934853553772, time cost3.2199838161468506
epoch: 223, iter: 7616, loss: 0.46078047156333923, time cost2.4525930881500244
epoch: 224, iter: 7617, loss: 0.8444209098815918, time cost3.416949510574341
epoch: 224, iter: 7618, loss: 0.8985273241996765, time cost3.6361639499664307
epoch: 224, iter: 7619, loss: 1.1560003757476807, time cost3.4306466579437256
epoch: 224, iter: 7620, loss: 0.6386491656303406, time cost3.4280707836151123
epoch: 224, iter: 7621, loss: 0.6158030033111572, time cost3.2221016883850098
epoch: 224, iter: 7622, loss: 0.45895981788635254, time cost3.3252294063568115
epoch: 224, iter: 7623, loss: 1.120792269706726, time cost3.2765889167785645
epoch: 224, iter: 7624, loss: 0.8197649717330933, time cost3.2928080558776855
epoch: 224, iter: 7625, loss: 0.9184057712554932, time cost3.3504161834716797
epoch: 224, iter: 7626, loss: 0.26008865237236023, time cost3.3094940185546875
epoch: 224, iter: 7627, loss: 0.8908138275146484, time cost3.3023412227630615
epoch: 224, iter: 7628, loss: 0.7472308874130249, time cost3.211355209350586
epoch: 224, iter: 7629, loss: 0.6053899526596069, time cost3.321593999862671
epoch: 224, iter: 7630, loss: 0.6943266987800598, time cost3.5172770023345947
epoch: 224, iter: 7631, loss: 0.5776376724243164, time cost3.4792726039886475
epoch: 224, iter: 7632, loss: 1.0102629661560059, time cost3.503016948699951
epoch: 224, iter: 7633, loss: 0.5748507380485535, time cost3.3650574684143066
epoch: 224, iter: 7634, loss: 0.97991544008255, time cost3.416034698486328
epoch: 224, iter: 7635, loss: 0.5496097207069397, time cost3.2967803478240967
epoch: 224, iter: 7636, loss: 0.8721911907196045, time cost3.2989683151245117
epoch: 224, iter: 7637, loss: 0.8454902172088623, time cost3.2955093383789062
epoch: 224, iter: 7638, loss: 0.7579569816589355, time cost3.257885456085205
epoch: 224, iter: 7639, loss: 1.030737042427063, time cost3.3046581745147705
epoch: 224, iter: 7640, loss: 0.6475251317024231, time cost3.295501947402954
epoch: 224, iter: 7641, loss: 0.4362342655658722, time cost3.601026773452759
epoch: 224, iter: 7642, loss: 0.4225575923919678, time cost3.6168625354766846
epoch: 224, iter: 7643, loss: 0.5471448302268982, time cost3.501278877258301
epoch: 224, iter: 7644, loss: 0.518394410610199, time cost3.1554927825927734
epoch: 224, iter: 7645, loss: 0.916660726070404, time cost3.2210986614227295
epoch: 224, iter: 7646, loss: 0.7282009720802307, time cost3.2891499996185303
epoch: 224, iter: 7647, loss: 0.6535220742225647, time cost3.245851755142212
epoch: 224, iter: 7648, loss: 0.4417603611946106, time cost3.390428066253662
epoch: 224, iter: 7649, loss: 0.759506106376648, time cost3.1400792598724365
epoch: 224, iter: 7650, loss: 0.3010445535182953, time cost2.328127861022949
tensor([[ 89.,  49.,  61.,  ...,   1.,   1.,   1.],
        [ 16.,  10.,   9.,  ...,   7.,   7.,   5.],
        [ 80., 239., 127.,  ...,  17.,  17.,  12.],
        ...,
        [ 54.,  47.,  32.,  ...,  12.,  12.,  10.],
        [ 70.,  74.,  16.,  ...,   1.,   1.,   1.],
        [147., 243., 298.,  ...,   1.,   1.,   2.]])
Epoch: 224, Iteration: 7650:
TEST A@1: 0.4533333333333333
TEST A@5: 0.8444444444444444
TEST A@10: 0.9266666666666666
TEST M@B: 0.37778416342760984
TEST M@A: 0.9544902614188336
TEST W@MB: 0.20189381780355675
TEST W@MA: 0.5897892147736178
TEST Time: 132.41669058799744
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 225, iter: 7651, loss: 0.8324717283248901, time cost3.2959821224212646
epoch: 225, iter: 7652, loss: 0.502044141292572, time cost3.1915674209594727
epoch: 225, iter: 7653, loss: 0.5955123901367188, time cost3.277507781982422
epoch: 225, iter: 7654, loss: 1.036492943763733, time cost3.2406389713287354
epoch: 225, iter: 7655, loss: 0.5710779428482056, time cost3.3744430541992188
epoch: 225, iter: 7656, loss: 0.8528309464454651, time cost3.4002463817596436
epoch: 225, iter: 7657, loss: 0.7044786214828491, time cost3.3945281505584717
epoch: 225, iter: 7658, loss: 0.7912083864212036, time cost3.570833683013916
epoch: 225, iter: 7659, loss: 0.9575539827346802, time cost3.476243019104004
epoch: 225, iter: 7660, loss: 0.35776010155677795, time cost3.54095458984375
epoch: 225, iter: 7661, loss: 0.7122315168380737, time cost3.4966342449188232
epoch: 225, iter: 7662, loss: 1.0227158069610596, time cost3.632889986038208
epoch: 225, iter: 7663, loss: 0.7259582877159119, time cost3.292839527130127
epoch: 225, iter: 7664, loss: 0.7769389748573303, time cost3.1500089168548584
epoch: 225, iter: 7665, loss: 0.9850199818611145, time cost3.6034977436065674
epoch: 225, iter: 7666, loss: 0.6646270751953125, time cost3.2954938411712646
epoch: 225, iter: 7667, loss: 0.8816965818405151, time cost3.340819835662842
epoch: 225, iter: 7668, loss: 0.6035006046295166, time cost3.3424439430236816
epoch: 225, iter: 7669, loss: 0.9438713788986206, time cost3.3502299785614014
epoch: 225, iter: 7670, loss: 0.42433661222457886, time cost3.6865994930267334
epoch: 225, iter: 7671, loss: 0.7655341625213623, time cost2.827033042907715
epoch: 225, iter: 7672, loss: 0.7773939371109009, time cost2.990720510482788
epoch: 225, iter: 7673, loss: 0.632466733455658, time cost3.0345449447631836
epoch: 225, iter: 7674, loss: 1.0168489217758179, time cost3.8762338161468506
epoch: 225, iter: 7675, loss: 0.34616991877555847, time cost4.462872743606567
epoch: 225, iter: 7676, loss: 0.5409121513366699, time cost3.663984775543213
epoch: 225, iter: 7677, loss: 0.7461935877799988, time cost3.59179425239563
epoch: 225, iter: 7678, loss: 0.7505279183387756, time cost3.625213384628296
epoch: 225, iter: 7679, loss: 0.5853085517883301, time cost3.5627880096435547
epoch: 225, iter: 7680, loss: 0.36779099702835083, time cost3.7419652938842773
epoch: 225, iter: 7681, loss: 0.7203770875930786, time cost3.616762638092041
epoch: 225, iter: 7682, loss: 0.8150222301483154, time cost3.5867056846618652
epoch: 225, iter: 7683, loss: 0.5010160207748413, time cost3.8023030757904053
epoch: 225, iter: 7684, loss: 0.819492518901825, time cost2.5534026622772217
epoch: 226, iter: 7685, loss: 0.5565701127052307, time cost3.697664737701416
epoch: 226, iter: 7686, loss: 0.634703516960144, time cost4.113171339035034
epoch: 226, iter: 7687, loss: 0.5281647443771362, time cost3.621337652206421
epoch: 226, iter: 7688, loss: 0.4759902358055115, time cost3.76473331451416
epoch: 226, iter: 7689, loss: 0.6145853996276855, time cost3.619204521179199
epoch: 226, iter: 7690, loss: 0.5499727129936218, time cost3.0094118118286133
epoch: 226, iter: 7691, loss: 0.562653660774231, time cost3.4448440074920654
epoch: 226, iter: 7692, loss: 0.7555080056190491, time cost3.319901943206787
epoch: 226, iter: 7693, loss: 0.6841816306114197, time cost3.759836196899414
epoch: 226, iter: 7694, loss: 0.8270739316940308, time cost3.491959810256958
epoch: 226, iter: 7695, loss: 1.1689448356628418, time cost3.573481798171997
epoch: 226, iter: 7696, loss: 0.32829052209854126, time cost3.5452709197998047
epoch: 226, iter: 7697, loss: 0.6456319689750671, time cost3.291895627975464
epoch: 226, iter: 7698, loss: 0.6498551964759827, time cost3.6591362953186035
epoch: 226, iter: 7699, loss: 0.557460606098175, time cost3.3253891468048096
epoch: 226, iter: 7700, loss: 0.6372600197792053, time cost3.4625508785247803
tensor([[ 30.,  30.,  36.,  ...,   3.,   3.,   3.],
        [ 13.,  11.,  10.,  ...,   2.,   2.,   1.],
        [210., 387., 273.,  ...,   1.,   1.,   1.],
        ...,
        [ 83.,  82.,  59.,  ...,  21.,  21.,  12.],
        [128., 149.,  65.,  ...,   1.,   1.,   1.],
        [ 93., 171., 174.,  ...,  11.,  11.,  18.]])
Epoch: 226, Iteration: 7700:
TEST A@1: 0.49777777777777776
TEST A@5: 0.8155555555555556
TEST A@10: 0.9066666666666666
TEST M@B: 0.39487699269222803
TEST M@A: 0.9530889106958453
TEST W@MB: 0.21332797379914198
TEST W@MA: 0.5888882729910162
TEST Time: 153.68713688850403
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 226, iter: 7701, loss: 0.28301894664764404, time cost3.2244536876678467
epoch: 226, iter: 7702, loss: 1.3451954126358032, time cost3.456805944442749
epoch: 226, iter: 7703, loss: 0.5646262168884277, time cost3.2582976818084717
epoch: 226, iter: 7704, loss: 0.32411953806877136, time cost3.484771728515625
epoch: 226, iter: 7705, loss: 0.6978880763053894, time cost3.351006269454956
epoch: 226, iter: 7706, loss: 0.6679852604866028, time cost3.4099109172821045
epoch: 226, iter: 7707, loss: 0.8404121398925781, time cost3.5547034740448
epoch: 226, iter: 7708, loss: 1.0149613618850708, time cost3.3471274375915527
epoch: 226, iter: 7709, loss: 0.4177473187446594, time cost3.482104778289795
epoch: 226, iter: 7710, loss: 0.390568345785141, time cost3.5549733638763428
epoch: 226, iter: 7711, loss: 0.37299278378486633, time cost3.3804988861083984
epoch: 226, iter: 7712, loss: 0.44443219900131226, time cost3.4471070766448975
epoch: 226, iter: 7713, loss: 0.6432355046272278, time cost3.1771738529205322
epoch: 226, iter: 7714, loss: 0.40252047777175903, time cost3.31032657623291
epoch: 226, iter: 7715, loss: 0.49798333644866943, time cost3.566380500793457
epoch: 226, iter: 7716, loss: 0.542113184928894, time cost3.416938304901123
epoch: 226, iter: 7717, loss: 0.5278925895690918, time cost3.4088313579559326
epoch: 226, iter: 7718, loss: 1.0862486362457275, time cost2.4520833492279053
epoch: 227, iter: 7719, loss: 0.6680590510368347, time cost3.549102544784546
epoch: 227, iter: 7720, loss: 0.5153684020042419, time cost3.5418479442596436
epoch: 227, iter: 7721, loss: 0.5768103003501892, time cost3.369929552078247
epoch: 227, iter: 7722, loss: 0.7737405896186829, time cost3.555445909500122
epoch: 227, iter: 7723, loss: 1.0234839916229248, time cost3.4624290466308594
epoch: 227, iter: 7724, loss: 0.7899349927902222, time cost3.382340431213379
epoch: 227, iter: 7725, loss: 0.6731823086738586, time cost3.7249786853790283
epoch: 227, iter: 7726, loss: 0.4231823682785034, time cost3.31833815574646
epoch: 227, iter: 7727, loss: 0.8712956309318542, time cost3.4377894401550293
epoch: 227, iter: 7728, loss: 0.5548617839813232, time cost3.621528148651123
epoch: 227, iter: 7729, loss: 0.7075763940811157, time cost3.3886666297912598
epoch: 227, iter: 7730, loss: 0.8033538460731506, time cost3.9312477111816406
epoch: 227, iter: 7731, loss: 0.42077869176864624, time cost3.2982404232025146
epoch: 227, iter: 7732, loss: 0.4325534701347351, time cost3.4597713947296143
epoch: 227, iter: 7733, loss: 1.1611542701721191, time cost3.689514636993408
epoch: 227, iter: 7734, loss: 0.44859257340431213, time cost3.4448845386505127
epoch: 227, iter: 7735, loss: 0.32338809967041016, time cost3.5487234592437744
epoch: 227, iter: 7736, loss: 0.7130223512649536, time cost3.4991979598999023
epoch: 227, iter: 7737, loss: 0.7894954681396484, time cost3.3975391387939453
epoch: 227, iter: 7738, loss: 0.7822811603546143, time cost3.6319751739501953
epoch: 227, iter: 7739, loss: 0.4732201099395752, time cost3.3856959342956543
epoch: 227, iter: 7740, loss: 0.6851975321769714, time cost3.462949514389038
epoch: 227, iter: 7741, loss: 0.4722859263420105, time cost3.466609001159668
epoch: 227, iter: 7742, loss: 0.5590983033180237, time cost3.421321153640747
epoch: 227, iter: 7743, loss: 0.6417781114578247, time cost3.6042368412017822
epoch: 227, iter: 7744, loss: 0.5836009383201599, time cost3.325117588043213
epoch: 227, iter: 7745, loss: 0.6849326491355896, time cost3.2996530532836914
epoch: 227, iter: 7746, loss: 0.888799250125885, time cost3.4388740062713623
epoch: 227, iter: 7747, loss: 1.0103098154067993, time cost3.300290584564209
epoch: 227, iter: 7748, loss: 0.948539674282074, time cost3.560150623321533
epoch: 227, iter: 7749, loss: 0.8939517140388489, time cost3.2725164890289307
epoch: 227, iter: 7750, loss: 0.6078476309776306, time cost3.326193332672119
tensor([[ 37.,  21.,  25.,  ...,   1.,   1.,   1.],
        [  4.,   4.,   4.,  ...,   3.,   3.,   1.],
        [163., 258., 174.,  ...,   3.,   3.,   2.],
        ...,
        [ 61.,  59.,  33.,  ...,  12.,  12.,  13.],
        [ 29.,  46.,  18.,  ...,   1.,   1.,   1.],
        [ 32., 110.,  94.,  ...,   4.,   4.,   9.]])
Epoch: 227, Iteration: 7750:
TEST A@1: 0.4288888888888889
TEST A@5: 0.7955555555555556
TEST A@10: 0.8955555555555555
TEST M@B: 0.36702647164314645
TEST M@A: 0.9528196707246677
TEST W@MB: 0.1971776360904066
TEST W@MA: 0.5889652849110322
TEST Time: 131.3050103187561
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 227, iter: 7751, loss: 0.811457633972168, time cost3.150111675262451
epoch: 227, iter: 7752, loss: 0.8595936894416809, time cost2.45458722114563
epoch: 228, iter: 7753, loss: 0.8901771306991577, time cost3.4396824836730957
epoch: 228, iter: 7754, loss: 0.614604651927948, time cost3.4955954551696777
epoch: 228, iter: 7755, loss: 0.7654302716255188, time cost3.3789117336273193
epoch: 228, iter: 7756, loss: 0.7489258050918579, time cost3.3976776599884033
epoch: 228, iter: 7757, loss: 0.8378757834434509, time cost3.6385509967803955
epoch: 228, iter: 7758, loss: 0.5742069482803345, time cost3.406301736831665
epoch: 228, iter: 7759, loss: 0.7605119347572327, time cost3.3843469619750977
epoch: 228, iter: 7760, loss: 0.8066915273666382, time cost3.563291072845459
epoch: 228, iter: 7761, loss: 0.6258098483085632, time cost3.358902931213379
epoch: 228, iter: 7762, loss: 0.6503384709358215, time cost3.4560418128967285
epoch: 228, iter: 7763, loss: 0.7873430252075195, time cost3.425386428833008
epoch: 228, iter: 7764, loss: 0.4524916410446167, time cost3.4567203521728516
epoch: 228, iter: 7765, loss: 0.2249191254377365, time cost3.6115591526031494
epoch: 228, iter: 7766, loss: 0.615820586681366, time cost3.4250340461730957
epoch: 228, iter: 7767, loss: 0.8993299603462219, time cost3.53120756149292
epoch: 228, iter: 7768, loss: 0.5482973456382751, time cost3.4622058868408203
epoch: 228, iter: 7769, loss: 1.1478015184402466, time cost3.4086220264434814
epoch: 228, iter: 7770, loss: 0.5452513098716736, time cost3.6350996494293213
epoch: 228, iter: 7771, loss: 0.3678097426891327, time cost3.382880687713623
epoch: 228, iter: 7772, loss: 0.7448487877845764, time cost3.439763069152832
epoch: 228, iter: 7773, loss: 0.6339560747146606, time cost3.400754928588867
epoch: 228, iter: 7774, loss: 0.5857203006744385, time cost3.2627429962158203
epoch: 228, iter: 7775, loss: 0.7241225838661194, time cost3.8211843967437744
epoch: 228, iter: 7776, loss: 0.39723706245422363, time cost3.3052639961242676
epoch: 228, iter: 7777, loss: 0.9645984768867493, time cost3.3349297046661377
epoch: 228, iter: 7778, loss: 0.5209646821022034, time cost3.5946333408355713
epoch: 228, iter: 7779, loss: 0.755062460899353, time cost3.3350882530212402
epoch: 228, iter: 7780, loss: 0.782260537147522, time cost3.4636051654815674
epoch: 228, iter: 7781, loss: 0.9737992286682129, time cost3.378753185272217
epoch: 228, iter: 7782, loss: 0.8589036464691162, time cost3.3822648525238037
epoch: 228, iter: 7783, loss: 0.9239015579223633, time cost3.522251844406128
epoch: 228, iter: 7784, loss: 0.7529966235160828, time cost3.3052234649658203
epoch: 228, iter: 7785, loss: 0.8161659836769104, time cost3.157376527786255
epoch: 228, iter: 7786, loss: 0.45003798604011536, time cost2.695939064025879
epoch: 229, iter: 7787, loss: 0.6715555191040039, time cost3.5399231910705566
epoch: 229, iter: 7788, loss: 0.6206620335578918, time cost3.798631429672241
epoch: 229, iter: 7789, loss: 1.0608656406402588, time cost3.3629918098449707
epoch: 229, iter: 7790, loss: 0.6645538806915283, time cost3.4898788928985596
epoch: 229, iter: 7791, loss: 0.6804227828979492, time cost3.5100793838500977
epoch: 229, iter: 7792, loss: 0.5276961326599121, time cost3.447519302368164
epoch: 229, iter: 7793, loss: 1.088112235069275, time cost3.6127851009368896
epoch: 229, iter: 7794, loss: 0.5781970024108887, time cost3.2987008094787598
epoch: 229, iter: 7795, loss: 1.0367600917816162, time cost3.463844060897827
epoch: 229, iter: 7796, loss: 0.5350394248962402, time cost3.5740792751312256
epoch: 229, iter: 7797, loss: 0.6029601097106934, time cost3.4338510036468506
epoch: 229, iter: 7798, loss: 0.864654004573822, time cost3.4936447143554688
epoch: 229, iter: 7799, loss: 0.9397536516189575, time cost3.5281970500946045
epoch: 229, iter: 7800, loss: 0.57960444688797, time cost3.415668249130249
tensor([[ 54.,  35.,  38.,  ...,   1.,   1.,   1.],
        [ 18.,  17.,  17.,  ...,   7.,   7.,   4.],
        [ 76., 170.,  83.,  ...,  10.,  10.,   5.],
        ...,
        [ 96.,  95.,  75.,  ...,  22.,  22.,  15.],
        [ 70.,  79.,  34.,  ...,   1.,   1.,   1.],
        [ 70., 169., 171.,  ...,   6.,   6.,   7.]])
Epoch: 229, Iteration: 7800:
TEST A@1: 0.5333333333333333
TEST A@5: 0.84
TEST A@10: 0.9355555555555556
TEST M@B: 0.4123406793168568
TEST M@A: 0.9552487722707409
TEST W@MB: 0.22128464768685413
TEST W@MA: 0.5904148175347212
TEST Time: 142.6233105659485
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 229, iter: 7801, loss: 0.6892972588539124, time cost3.1505300998687744
epoch: 229, iter: 7802, loss: 0.7910519242286682, time cost3.4100096225738525
epoch: 229, iter: 7803, loss: 0.47847631573677063, time cost3.194446086883545
epoch: 229, iter: 7804, loss: 0.9570601582527161, time cost3.301593780517578
epoch: 229, iter: 7805, loss: 0.4831226170063019, time cost3.6503195762634277
epoch: 229, iter: 7806, loss: 0.48704764246940613, time cost3.4013662338256836
epoch: 229, iter: 7807, loss: 0.6048310399055481, time cost3.60475492477417
epoch: 229, iter: 7808, loss: 0.8113839030265808, time cost3.3516900539398193
epoch: 229, iter: 7809, loss: 0.4683722257614136, time cost3.358250141143799
epoch: 229, iter: 7810, loss: 0.9020059704780579, time cost3.5578794479370117
epoch: 229, iter: 7811, loss: 0.5890684127807617, time cost3.4068596363067627
epoch: 229, iter: 7812, loss: 0.7052393555641174, time cost3.6168253421783447
epoch: 229, iter: 7813, loss: 0.5133682489395142, time cost3.4779601097106934
epoch: 229, iter: 7814, loss: 0.3497205972671509, time cost3.3129544258117676
epoch: 229, iter: 7815, loss: 0.7672568559646606, time cost3.4065136909484863
epoch: 229, iter: 7816, loss: 0.6006791591644287, time cost3.2624783515930176
epoch: 229, iter: 7817, loss: 0.6201093792915344, time cost3.397740602493286
epoch: 229, iter: 7818, loss: 0.8671971559524536, time cost3.3636324405670166
epoch: 229, iter: 7819, loss: 0.44752785563468933, time cost3.232726812362671
epoch: 229, iter: 7820, loss: 0.4375933110713959, time cost2.278383731842041
epoch: 230, iter: 7821, loss: 0.5032223463058472, time cost3.684656858444214
epoch: 230, iter: 7822, loss: 0.45093265175819397, time cost3.3888959884643555
epoch: 230, iter: 7823, loss: 1.0503597259521484, time cost3.439337968826294
epoch: 230, iter: 7824, loss: 0.5866385698318481, time cost3.2915403842926025
epoch: 230, iter: 7825, loss: 0.6577883362770081, time cost3.500307559967041
epoch: 230, iter: 7826, loss: 0.5352024435997009, time cost3.53902006149292
epoch: 230, iter: 7827, loss: 0.4035458266735077, time cost3.2143964767456055
epoch: 230, iter: 7828, loss: 0.5392608046531677, time cost3.7182114124298096
epoch: 230, iter: 7829, loss: 0.5427826642990112, time cost3.2614240646362305
epoch: 230, iter: 7830, loss: 0.3541618883609772, time cost3.4781594276428223
epoch: 230, iter: 7831, loss: 0.39118054509162903, time cost3.5472145080566406
epoch: 230, iter: 7832, loss: 0.4585571885108948, time cost3.5780997276306152
epoch: 230, iter: 7833, loss: 0.939592719078064, time cost3.522826671600342
epoch: 230, iter: 7834, loss: 0.5834349393844604, time cost3.5076935291290283
epoch: 230, iter: 7835, loss: 0.5706777572631836, time cost3.5136818885803223
epoch: 230, iter: 7836, loss: 0.7671278715133667, time cost3.7605371475219727
epoch: 230, iter: 7837, loss: 0.6410747766494751, time cost3.3680191040039062
epoch: 230, iter: 7838, loss: 0.7303065061569214, time cost3.703740358352661
epoch: 230, iter: 7839, loss: 1.1580440998077393, time cost3.615351438522339
epoch: 230, iter: 7840, loss: 0.8323851823806763, time cost3.525001049041748
epoch: 230, iter: 7841, loss: 0.4548572897911072, time cost3.776245355606079
epoch: 230, iter: 7842, loss: 0.43444377183914185, time cost3.4671518802642822
epoch: 230, iter: 7843, loss: 0.24968557059764862, time cost3.5860044956207275
epoch: 230, iter: 7844, loss: 0.7595235705375671, time cost3.503286123275757
epoch: 230, iter: 7845, loss: 0.6559749841690063, time cost3.5546462535858154
epoch: 230, iter: 7846, loss: 0.38235974311828613, time cost3.702263832092285
epoch: 230, iter: 7847, loss: 0.47726067900657654, time cost3.4260592460632324
epoch: 230, iter: 7848, loss: 0.7201372385025024, time cost3.524273633956909
epoch: 230, iter: 7849, loss: 1.123974323272705, time cost3.649179697036743
epoch: 230, iter: 7850, loss: 0.8462050557136536, time cost3.423480987548828
tensor([[101.,  73.,  73.,  ...,   1.,   1.,   1.],
        [ 11.,  10.,  10.,  ...,   3.,   3.,   2.],
        [146., 271., 140.,  ...,   7.,   7.,   3.],
        ...,
        [ 91.,  85.,  63.,  ...,  23.,  23.,  19.],
        [ 46.,  58.,  43.,  ...,   1.,   1.,   1.],
        [ 96., 189., 183.,  ...,   7.,   7.,  10.]])
Epoch: 230, Iteration: 7850:
TEST A@1: 0.5244444444444445
TEST A@5: 0.8466666666666667
TEST A@10: 0.94
TEST M@B: 0.41692198663283647
TEST M@A: 0.9562651401139162
TEST W@MB: 0.22408186192525703
TEST W@MA: 0.5911012645841152
TEST Time: 154.5747401714325
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 230, iter: 7851, loss: 0.6863741874694824, time cost3.072866439819336
epoch: 230, iter: 7852, loss: 0.7619342803955078, time cost3.483214855194092
epoch: 230, iter: 7853, loss: 1.2453337907791138, time cost3.401946544647217
epoch: 230, iter: 7854, loss: 0.2273906022310257, time cost2.393364429473877
epoch: 231, iter: 7855, loss: 0.29637953639030457, time cost3.45011305809021
epoch: 231, iter: 7856, loss: 0.6825429201126099, time cost3.505901336669922
epoch: 231, iter: 7857, loss: 1.344639539718628, time cost3.838348150253296
epoch: 231, iter: 7858, loss: 0.5704447627067566, time cost3.487187385559082
epoch: 231, iter: 7859, loss: 0.8820927143096924, time cost3.6194348335266113
epoch: 231, iter: 7860, loss: 0.8201718330383301, time cost3.482194423675537
epoch: 231, iter: 7861, loss: 0.7790788412094116, time cost3.3575379848480225
epoch: 231, iter: 7862, loss: 0.6713407039642334, time cost3.6977782249450684
epoch: 231, iter: 7863, loss: 0.585818350315094, time cost3.454011917114258
epoch: 231, iter: 7864, loss: 0.7198481559753418, time cost3.529038429260254
epoch: 231, iter: 7865, loss: 1.0566741228103638, time cost3.4237687587738037
epoch: 231, iter: 7866, loss: 0.30455684661865234, time cost3.3195688724517822
epoch: 231, iter: 7867, loss: 0.8333477973937988, time cost3.701371669769287
epoch: 231, iter: 7868, loss: 0.9463351964950562, time cost3.469874620437622
epoch: 231, iter: 7869, loss: 0.5357901453971863, time cost3.5418906211853027
epoch: 231, iter: 7870, loss: 0.8240081071853638, time cost3.5281431674957275
epoch: 231, iter: 7871, loss: 0.5738606452941895, time cost3.353425979614258
epoch: 231, iter: 7872, loss: 0.8390605449676514, time cost3.7562530040740967
epoch: 231, iter: 7873, loss: 0.5447172522544861, time cost3.457904100418091
epoch: 231, iter: 7874, loss: 0.7193593978881836, time cost3.3458261489868164
epoch: 231, iter: 7875, loss: 1.2930594682693481, time cost3.4835100173950195
epoch: 231, iter: 7876, loss: 0.9465844035148621, time cost3.3374533653259277
epoch: 231, iter: 7877, loss: 0.8938664197921753, time cost3.595296621322632
epoch: 231, iter: 7878, loss: 0.9370702505111694, time cost3.4098150730133057
epoch: 231, iter: 7879, loss: 1.323724389076233, time cost3.4340169429779053
epoch: 231, iter: 7880, loss: 1.5938899517059326, time cost3.5327091217041016
epoch: 231, iter: 7881, loss: 0.7481880784034729, time cost3.2460744380950928
epoch: 231, iter: 7882, loss: 0.6576219201087952, time cost2.952178716659546
epoch: 231, iter: 7883, loss: 0.5774778127670288, time cost2.77630352973938
epoch: 231, iter: 7884, loss: 0.8031553030014038, time cost2.764800786972046
epoch: 231, iter: 7885, loss: 0.5667821764945984, time cost2.801400661468506
epoch: 231, iter: 7886, loss: 0.4218754768371582, time cost3.4386892318725586
epoch: 231, iter: 7887, loss: 0.5702749490737915, time cost3.6316933631896973
epoch: 231, iter: 7888, loss: 0.4605542719364166, time cost2.7005605697631836
epoch: 232, iter: 7889, loss: 0.6973291635513306, time cost3.901660680770874
epoch: 232, iter: 7890, loss: 0.6220580339431763, time cost3.839604139328003
epoch: 232, iter: 7891, loss: 0.9476552605628967, time cost3.642038583755493
epoch: 232, iter: 7892, loss: 0.7328764796257019, time cost3.7696259021759033
epoch: 232, iter: 7893, loss: 0.38311684131622314, time cost4.041573524475098
epoch: 232, iter: 7894, loss: 0.7401021122932434, time cost3.5940330028533936
epoch: 232, iter: 7895, loss: 0.48479968309402466, time cost3.8445017337799072
epoch: 232, iter: 7896, loss: 1.2206283807754517, time cost3.722923994064331
epoch: 232, iter: 7897, loss: 0.7669610381126404, time cost3.953679084777832
epoch: 232, iter: 7898, loss: 0.49697479605674744, time cost3.8409547805786133
epoch: 232, iter: 7899, loss: 0.8645398020744324, time cost3.8592844009399414
epoch: 232, iter: 7900, loss: 0.5568623542785645, time cost3.736072063446045
tensor([[ 62.,  51.,  59.,  ...,   1.,   1.,   1.],
        [ 10.,  17.,  15.,  ...,  12.,  12.,   6.],
        [ 71., 140.,  60.,  ...,   6.,   6.,   3.],
        ...,
        [ 63.,  62.,  44.,  ...,   7.,   7.,   7.],
        [ 33.,  33.,   8.,  ...,   1.,   1.,   1.],
        [155., 248., 298.,  ...,   4.,   4.,  10.]])
Epoch: 232, Iteration: 7900:
TEST A@1: 0.5222222222222223
TEST A@5: 0.8333333333333334
TEST A@10: 0.9266666666666666
TEST M@B: 0.4124068730951698
TEST M@A: 0.9577576280316072
TEST W@MB: 0.22237204019333554
TEST W@MA: 0.5925031586449975
TEST Time: 130.41152834892273
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 232, iter: 7901, loss: 0.475980281829834, time cost3.484748363494873
epoch: 232, iter: 7902, loss: 0.25107601284980774, time cost3.207672595977783
epoch: 232, iter: 7903, loss: 0.5212958455085754, time cost3.4623045921325684
epoch: 232, iter: 7904, loss: 0.5559618473052979, time cost3.4165613651275635
epoch: 232, iter: 7905, loss: 0.7682062387466431, time cost3.4085609912872314
epoch: 232, iter: 7906, loss: 0.5657668113708496, time cost3.631504535675049
epoch: 232, iter: 7907, loss: 1.1998634338378906, time cost3.38877272605896
epoch: 232, iter: 7908, loss: 0.5049883127212524, time cost3.3895373344421387
epoch: 232, iter: 7909, loss: 0.8228333592414856, time cost3.5249879360198975
epoch: 232, iter: 7910, loss: 0.7092494368553162, time cost3.291891574859619
epoch: 232, iter: 7911, loss: 0.4655386805534363, time cost3.481370449066162
epoch: 232, iter: 7912, loss: 0.539207935333252, time cost3.4717259407043457
epoch: 232, iter: 7913, loss: 0.761628270149231, time cost3.3431694507598877
epoch: 232, iter: 7914, loss: 0.5627185702323914, time cost3.642249584197998
epoch: 232, iter: 7915, loss: 0.9676385521888733, time cost3.2151834964752197
epoch: 232, iter: 7916, loss: 0.29518362879753113, time cost3.423341989517212
epoch: 232, iter: 7917, loss: 0.8674478530883789, time cost3.3125228881835938
epoch: 232, iter: 7918, loss: 0.762959897518158, time cost3.131765127182007
epoch: 232, iter: 7919, loss: 0.5845046043395996, time cost3.393836259841919
epoch: 232, iter: 7920, loss: 0.353174090385437, time cost3.345529079437256
epoch: 232, iter: 7921, loss: 1.0564192533493042, time cost3.4355876445770264
epoch: 232, iter: 7922, loss: 0.6264192461967468, time cost2.5243611335754395
epoch: 233, iter: 7923, loss: 0.672265350818634, time cost3.3326833248138428
epoch: 233, iter: 7924, loss: 0.5491561889648438, time cost3.6959221363067627
epoch: 233, iter: 7925, loss: 0.4682104289531708, time cost3.458906888961792
epoch: 233, iter: 7926, loss: 0.5535796284675598, time cost3.4290645122528076
epoch: 233, iter: 7927, loss: 0.542775571346283, time cost3.5204765796661377
epoch: 233, iter: 7928, loss: 0.39434346556663513, time cost3.3988285064697266
epoch: 233, iter: 7929, loss: 0.9452553987503052, time cost3.574812173843384
epoch: 233, iter: 7930, loss: 0.355834037065506, time cost3.2596404552459717
epoch: 233, iter: 7931, loss: 0.7783693075180054, time cost3.289262056350708
epoch: 233, iter: 7932, loss: 0.6882449388504028, time cost3.6798036098480225
epoch: 233, iter: 7933, loss: 0.8109592199325562, time cost3.4165823459625244
epoch: 233, iter: 7934, loss: 0.477158784866333, time cost3.3831472396850586
epoch: 233, iter: 7935, loss: 1.0591973066329956, time cost3.464787483215332
epoch: 233, iter: 7936, loss: 0.8599001169204712, time cost3.4246344566345215
epoch: 233, iter: 7937, loss: 0.6226337552070618, time cost3.513460397720337
epoch: 233, iter: 7938, loss: 1.0689477920532227, time cost3.4614102840423584
epoch: 233, iter: 7939, loss: 0.4842362105846405, time cost3.3770809173583984
epoch: 233, iter: 7940, loss: 0.36871644854545593, time cost3.5943853855133057
epoch: 233, iter: 7941, loss: 0.6403833031654358, time cost3.4879753589630127
epoch: 233, iter: 7942, loss: 0.6137049198150635, time cost3.481734275817871
epoch: 233, iter: 7943, loss: 0.705032229423523, time cost3.3310739994049072
epoch: 233, iter: 7944, loss: 0.9563063979148865, time cost3.558501958847046
epoch: 233, iter: 7945, loss: 0.8524140119552612, time cost3.718111276626587
epoch: 233, iter: 7946, loss: 0.6531961560249329, time cost3.628067970275879
epoch: 233, iter: 7947, loss: 0.5524160861968994, time cost3.4056146144866943
epoch: 233, iter: 7948, loss: 0.49670571088790894, time cost3.4665865898132324
epoch: 233, iter: 7949, loss: 0.5129194855690002, time cost3.4234142303466797
epoch: 233, iter: 7950, loss: 0.8146986365318298, time cost3.577306032180786
tensor([[ 41.,  37.,  47.,  ...,   3.,   3.,   1.],
        [ 39.,  50.,  45.,  ...,  14.,  14.,   9.],
        [108., 355., 173.,  ...,   6.,   6.,   4.],
        ...,
        [ 58.,  53.,  29.,  ...,  15.,  15.,  10.],
        [126., 146.,  36.,  ...,   1.,   1.,   1.],
        [ 18.,  91.,  61.,  ...,   2.,   2.,   2.]])
Epoch: 233, Iteration: 7950:
TEST A@1: 0.5022222222222222
TEST A@5: 0.86
TEST A@10: 0.9511111111111111
TEST M@B: 0.4143268416718517
TEST M@A: 0.9586088318319341
TEST W@MB: 0.22366479845114826
TEST W@MA: 0.5929934818789279
TEST Time: 151.46042919158936
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 233, iter: 7951, loss: 0.37912335991859436, time cost3.220317840576172
epoch: 233, iter: 7952, loss: 1.0796540975570679, time cost3.2735464572906494
epoch: 233, iter: 7953, loss: 0.6385819911956787, time cost3.356435775756836
epoch: 233, iter: 7954, loss: 0.6522861123085022, time cost3.457458734512329
epoch: 233, iter: 7955, loss: 0.5020282864570618, time cost3.4860963821411133
epoch: 233, iter: 7956, loss: 0.5198705196380615, time cost2.4974892139434814
epoch: 234, iter: 7957, loss: 0.7571667432785034, time cost3.491149425506592
epoch: 234, iter: 7958, loss: 0.5820106863975525, time cost3.389232635498047
epoch: 234, iter: 7959, loss: 0.596103847026825, time cost3.42775821685791
epoch: 234, iter: 7960, loss: 0.6970656514167786, time cost3.4511544704437256
epoch: 234, iter: 7961, loss: 0.600615918636322, time cost3.387934923171997
epoch: 234, iter: 7962, loss: 0.8670042753219604, time cost3.4366681575775146
epoch: 234, iter: 7963, loss: 0.7626215219497681, time cost3.3053579330444336
epoch: 234, iter: 7964, loss: 0.7243677973747253, time cost3.492868661880493
epoch: 234, iter: 7965, loss: 0.608161985874176, time cost3.4394032955169678
epoch: 234, iter: 7966, loss: 0.7728128433227539, time cost3.4146740436553955
epoch: 234, iter: 7967, loss: 0.8553341627120972, time cost3.4733669757843018
epoch: 234, iter: 7968, loss: 0.3857203423976898, time cost3.516615629196167
epoch: 234, iter: 7969, loss: 0.4511832296848297, time cost3.4039695262908936
epoch: 234, iter: 7970, loss: 0.9727494120597839, time cost3.2541098594665527
epoch: 234, iter: 7971, loss: 0.8276934623718262, time cost3.449636936187744
epoch: 234, iter: 7972, loss: 0.5640720129013062, time cost3.331411361694336
epoch: 234, iter: 7973, loss: 1.0606683492660522, time cost3.2505149841308594
epoch: 234, iter: 7974, loss: 0.9533793926239014, time cost3.3273656368255615
epoch: 234, iter: 7975, loss: 0.45840996503829956, time cost3.419790506362915
epoch: 234, iter: 7976, loss: 0.7254157066345215, time cost3.500643491744995
epoch: 234, iter: 7977, loss: 1.058487892150879, time cost3.134385585784912
epoch: 234, iter: 7978, loss: 1.1757956743240356, time cost3.384155511856079
epoch: 234, iter: 7979, loss: 0.30941256880760193, time cost3.381838321685791
epoch: 234, iter: 7980, loss: 0.7857558131217957, time cost3.4150021076202393
epoch: 234, iter: 7981, loss: 0.49766814708709717, time cost3.5410542488098145
epoch: 234, iter: 7982, loss: 0.4961072504520416, time cost3.6478216648101807
epoch: 234, iter: 7983, loss: 0.7926909923553467, time cost3.575312852859497
epoch: 234, iter: 7984, loss: 0.6839743256568909, time cost3.3522517681121826
epoch: 234, iter: 7985, loss: 0.5965890288352966, time cost3.5777270793914795
epoch: 234, iter: 7986, loss: 0.45374926924705505, time cost3.4202914237976074
epoch: 234, iter: 7987, loss: 0.3726869821548462, time cost3.4217758178710938
epoch: 234, iter: 7988, loss: 0.5364331007003784, time cost3.4839887619018555
epoch: 234, iter: 7989, loss: 0.6137639284133911, time cost3.305548667907715
epoch: 234, iter: 7990, loss: 0.3520975410938263, time cost2.4366540908813477
epoch: 235, iter: 7991, loss: 0.4933192729949951, time cost3.3938703536987305
epoch: 235, iter: 7992, loss: 0.47884640097618103, time cost3.294796943664551
epoch: 235, iter: 7993, loss: 0.7562016248703003, time cost3.556206703186035
epoch: 235, iter: 7994, loss: 0.7145482301712036, time cost3.514936685562134
epoch: 235, iter: 7995, loss: 0.7110168933868408, time cost3.6851694583892822
epoch: 235, iter: 7996, loss: 0.45461511611938477, time cost3.3423707485198975
epoch: 235, iter: 7997, loss: 0.7264969944953918, time cost3.4868414402008057
epoch: 235, iter: 7998, loss: 0.5582953095436096, time cost3.6517422199249268
epoch: 235, iter: 7999, loss: 0.6254904866218567, time cost3.5612146854400635
epoch: 235, iter: 8000, loss: 0.5827266573905945, time cost3.4542789459228516
tensor([[ 71.,  52.,  65.,  ...,   4.,   4.,   3.],
        [ 13.,  19.,  16.,  ...,  11.,  11.,   9.],
        [125., 329., 173.,  ...,  11.,  11.,   6.],
        ...,
        [ 85.,  85.,  62.,  ...,  12.,  12.,   8.],
        [ 33.,  39.,  16.,  ...,   1.,   1.,   1.],
        [ 76., 182., 219.,  ...,   2.,   2.,   2.]])
Epoch: 235, Iteration: 8000:
TEST A@1: 0.4577777777777778
TEST A@5: 0.8222222222222222
TEST A@10: 0.9244444444444444
TEST M@B: 0.40020496740231554
TEST M@A: 0.9577573451115527
TEST W@MB: 0.21766160152076855
TEST W@MA: 0.592442283538372
TEST Time: 136.05884790420532
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 235, iter: 8001, loss: 0.34803083539009094, time cost3.3620214462280273
epoch: 235, iter: 8002, loss: 0.41176214814186096, time cost3.2541353702545166
epoch: 235, iter: 8003, loss: 0.5962017774581909, time cost3.267676830291748
epoch: 235, iter: 8004, loss: 0.7584225535392761, time cost3.676002264022827
epoch: 235, iter: 8005, loss: 0.5564998388290405, time cost3.3605406284332275
epoch: 235, iter: 8006, loss: 0.3889082968235016, time cost3.553847074508667
epoch: 235, iter: 8007, loss: 0.3926408588886261, time cost3.436872959136963
epoch: 235, iter: 8008, loss: 0.7286803126335144, time cost3.423753023147583
epoch: 235, iter: 8009, loss: 0.4331825375556946, time cost3.7646560668945312
epoch: 235, iter: 8010, loss: 0.5459038615226746, time cost3.4886534214019775
epoch: 235, iter: 8011, loss: 0.8878776431083679, time cost3.3741157054901123
epoch: 235, iter: 8012, loss: 0.6856071949005127, time cost3.6093759536743164
epoch: 235, iter: 8013, loss: 0.6522210240364075, time cost3.207796573638916
epoch: 235, iter: 8014, loss: 0.7001412510871887, time cost3.548719644546509
epoch: 235, iter: 8015, loss: 0.8813279867172241, time cost3.4728140830993652
epoch: 235, iter: 8016, loss: 0.8104429841041565, time cost3.3193106651306152
epoch: 235, iter: 8017, loss: 0.7389528751373291, time cost3.6913702487945557
epoch: 235, iter: 8018, loss: 0.8161352276802063, time cost3.2664923667907715
epoch: 235, iter: 8019, loss: 0.5133318901062012, time cost3.3903543949127197
epoch: 235, iter: 8020, loss: 1.0901442766189575, time cost3.423344373703003
epoch: 235, iter: 8021, loss: 1.1270885467529297, time cost3.2960731983184814
epoch: 235, iter: 8022, loss: 0.5824124217033386, time cost3.4126996994018555
epoch: 235, iter: 8023, loss: 0.5927587151527405, time cost3.353698253631592
epoch: 235, iter: 8024, loss: 0.6826513409614563, time cost2.3001081943511963
epoch: 236, iter: 8025, loss: 0.6661956310272217, time cost3.3517937660217285
epoch: 236, iter: 8026, loss: 0.5402930378913879, time cost3.4249496459960938
epoch: 236, iter: 8027, loss: 0.5385375022888184, time cost3.6065292358398438
epoch: 236, iter: 8028, loss: 0.5663326978683472, time cost3.438966751098633
epoch: 236, iter: 8029, loss: 0.5795027017593384, time cost3.4534924030303955
epoch: 236, iter: 8030, loss: 0.6670363545417786, time cost3.579725980758667
epoch: 236, iter: 8031, loss: 0.5558006167411804, time cost3.5718204975128174
epoch: 236, iter: 8032, loss: 0.6567184925079346, time cost3.7496836185455322
epoch: 236, iter: 8033, loss: 1.117448091506958, time cost3.52207612991333
epoch: 236, iter: 8034, loss: 0.6585588455200195, time cost3.4025721549987793
epoch: 236, iter: 8035, loss: 0.6989734768867493, time cost3.7108564376831055
epoch: 236, iter: 8036, loss: 0.82419353723526, time cost3.5117883682250977
epoch: 236, iter: 8037, loss: 0.5474492311477661, time cost3.520920515060425
epoch: 236, iter: 8038, loss: 0.6349773406982422, time cost3.6156115531921387
epoch: 236, iter: 8039, loss: 0.3448825776576996, time cost3.296480894088745
epoch: 236, iter: 8040, loss: 0.6006529927253723, time cost3.5988199710845947
epoch: 236, iter: 8041, loss: 0.7424037456512451, time cost3.4152417182922363
epoch: 236, iter: 8042, loss: 0.7809106111526489, time cost3.37782621383667
epoch: 236, iter: 8043, loss: 0.850589394569397, time cost3.5769293308258057
epoch: 236, iter: 8044, loss: 0.7503362894058228, time cost3.5338070392608643
epoch: 236, iter: 8045, loss: 0.7262609601020813, time cost3.415281295776367
epoch: 236, iter: 8046, loss: 0.5064260363578796, time cost3.4812264442443848
epoch: 236, iter: 8047, loss: 0.9909337162971497, time cost3.6104400157928467
epoch: 236, iter: 8048, loss: 0.4990710914134979, time cost3.6866536140441895
epoch: 236, iter: 8049, loss: 0.8220652937889099, time cost3.3264830112457275
epoch: 236, iter: 8050, loss: 0.5648617744445801, time cost3.4040474891662598
tensor([[ 43.,  38.,  49.,  ...,   3.,   3.,   3.],
        [  6.,   8.,   7.,  ...,   4.,   4.,   3.],
        [ 79., 260.,  95.,  ...,   1.,   1.,   1.],
        ...,
        [ 71.,  69.,  42.,  ...,  16.,  16.,  13.],
        [ 55.,  64.,  14.,  ...,   1.,   1.,   1.],
        [ 73., 224., 253.,  ...,   2.,   2.,   6.]])
Epoch: 236, Iteration: 8050:
TEST A@1: 0.5444444444444444
TEST A@5: 0.8777777777777778
TEST A@10: 0.9511111111111111
TEST M@B: 0.43097189307374834
TEST M@A: 0.9590200451563393
TEST W@MB: 0.23221171375779262
TEST W@MA: 0.5931129706482917
TEST Time: 146.89286422729492
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 236, iter: 8051, loss: 0.6483869552612305, time cost3.583042621612549
epoch: 236, iter: 8052, loss: 0.37873104214668274, time cost3.379185676574707
epoch: 236, iter: 8053, loss: 0.6745259761810303, time cost3.4683306217193604
epoch: 236, iter: 8054, loss: 0.5190795660018921, time cost3.5776166915893555
epoch: 236, iter: 8055, loss: 0.4131680428981781, time cost3.4191198348999023
epoch: 236, iter: 8056, loss: 0.5806695818901062, time cost3.382800817489624
epoch: 236, iter: 8057, loss: 0.9948892593383789, time cost3.514782428741455
epoch: 236, iter: 8058, loss: 0.4898991584777832, time cost2.473207473754883
epoch: 237, iter: 8059, loss: 0.6457130908966064, time cost3.682831048965454
epoch: 237, iter: 8060, loss: 0.28639742732048035, time cost3.611062526702881
epoch: 237, iter: 8061, loss: 0.8010461330413818, time cost3.782047748565674
epoch: 237, iter: 8062, loss: 0.41469815373420715, time cost3.492610454559326
epoch: 237, iter: 8063, loss: 0.5831692218780518, time cost3.5340075492858887
epoch: 237, iter: 8064, loss: 0.5190486907958984, time cost3.6099390983581543
epoch: 237, iter: 8065, loss: 0.5177850127220154, time cost3.39451265335083
epoch: 237, iter: 8066, loss: 0.9101283550262451, time cost3.573629140853882
epoch: 237, iter: 8067, loss: 0.7551992535591125, time cost3.5261521339416504
epoch: 237, iter: 8068, loss: 0.9432118535041809, time cost3.543757677078247
epoch: 237, iter: 8069, loss: 0.5626672506332397, time cost3.4906888008117676
epoch: 237, iter: 8070, loss: 0.6906319856643677, time cost3.4932329654693604
epoch: 237, iter: 8071, loss: 1.1920461654663086, time cost3.290797472000122
epoch: 237, iter: 8072, loss: 0.7646220326423645, time cost3.5932679176330566
epoch: 237, iter: 8073, loss: 0.6091169118881226, time cost2.9408793449401855
epoch: 237, iter: 8074, loss: 0.7144320011138916, time cost2.804218292236328
epoch: 237, iter: 8075, loss: 0.8111384510993958, time cost2.8552517890930176
epoch: 237, iter: 8076, loss: 0.8307191133499146, time cost2.8415145874023438
epoch: 237, iter: 8077, loss: 0.6450387835502625, time cost3.806718587875366
epoch: 237, iter: 8078, loss: 0.7340937256813049, time cost3.894090175628662
epoch: 237, iter: 8079, loss: 1.2344305515289307, time cost3.9725632667541504
epoch: 237, iter: 8080, loss: 0.7584311962127686, time cost3.821669816970825
epoch: 237, iter: 8081, loss: 0.7691216468811035, time cost3.807220220565796
epoch: 237, iter: 8082, loss: 0.47223639488220215, time cost3.9157071113586426
epoch: 237, iter: 8083, loss: 0.5926318168640137, time cost3.8089590072631836
epoch: 237, iter: 8084, loss: 1.0682892799377441, time cost3.7417056560516357
epoch: 237, iter: 8085, loss: 0.5205976963043213, time cost3.5077948570251465
epoch: 237, iter: 8086, loss: 0.7369398474693298, time cost3.8112215995788574
epoch: 237, iter: 8087, loss: 0.6740890145301819, time cost3.6566264629364014
epoch: 237, iter: 8088, loss: 0.8521851301193237, time cost3.851611852645874
epoch: 237, iter: 8089, loss: 0.6268609166145325, time cost3.710158348083496
epoch: 237, iter: 8090, loss: 1.2407437562942505, time cost3.88390851020813
epoch: 237, iter: 8091, loss: 0.9239106774330139, time cost3.7429394721984863
epoch: 237, iter: 8092, loss: 0.30598196387290955, time cost2.7764766216278076
epoch: 238, iter: 8093, loss: 0.7206665277481079, time cost3.773394823074341
epoch: 238, iter: 8094, loss: 0.7070255875587463, time cost2.965815305709839
epoch: 238, iter: 8095, loss: 0.4539836645126343, time cost3.510612964630127
epoch: 238, iter: 8096, loss: 0.39668968319892883, time cost3.668717861175537
epoch: 238, iter: 8097, loss: 0.8174078464508057, time cost3.7625763416290283
epoch: 238, iter: 8098, loss: 0.5322305560112, time cost3.504047393798828
epoch: 238, iter: 8099, loss: 0.4586419463157654, time cost3.4773507118225098
epoch: 238, iter: 8100, loss: 0.8418063521385193, time cost3.5920956134796143
tensor([[ 18.,  17.,  21.,  ...,  11.,  11.,   8.],
        [ 16.,  15.,  13.,  ...,   6.,   6.,   5.],
        [ 99., 232.,  77.,  ...,   1.,   1.,   1.],
        ...,
        [ 54.,  55.,  32.,  ...,  21.,  21.,   9.],
        [ 29.,  28.,  15.,  ...,   2.,   2.,   1.],
        [ 45., 193., 179.,  ...,   1.,   1.,   7.]])
Epoch: 238, Iteration: 8100:
TEST A@1: 0.4866666666666667
TEST A@5: 0.8311111111111111
TEST A@10: 0.92
TEST M@B: 0.39487007613739705
TEST M@A: 0.9549619267094467
TEST W@MB: 0.21283352511849649
TEST W@MA: 0.5904127873689418
TEST Time: 146.13921689987183
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 238, iter: 8101, loss: 0.8645592331886292, time cost3.3739585876464844
epoch: 238, iter: 8102, loss: 0.40915337204933167, time cost3.2196707725524902
epoch: 238, iter: 8103, loss: 0.6803659796714783, time cost3.571300506591797
epoch: 238, iter: 8104, loss: 0.9431787729263306, time cost3.3500711917877197
epoch: 238, iter: 8105, loss: 0.8199244737625122, time cost3.474985122680664
epoch: 238, iter: 8106, loss: 0.5734248757362366, time cost3.497189998626709
epoch: 238, iter: 8107, loss: 0.5185317993164062, time cost3.5019376277923584
epoch: 238, iter: 8108, loss: 0.39094966650009155, time cost3.756066083908081
epoch: 238, iter: 8109, loss: 0.5754611492156982, time cost3.678173303604126
epoch: 238, iter: 8110, loss: 0.45256245136260986, time cost3.432696580886841
epoch: 238, iter: 8111, loss: 0.8603662848472595, time cost3.7648587226867676
epoch: 238, iter: 8112, loss: 1.0215966701507568, time cost3.3609015941619873
epoch: 238, iter: 8113, loss: 1.040322184562683, time cost3.4357125759124756
epoch: 238, iter: 8114, loss: 1.0192327499389648, time cost3.673957109451294
epoch: 238, iter: 8115, loss: 0.6750361323356628, time cost3.3804335594177246
epoch: 238, iter: 8116, loss: 0.6039177179336548, time cost3.43688702583313
epoch: 238, iter: 8117, loss: 0.7766289114952087, time cost3.426997661590576
epoch: 238, iter: 8118, loss: 0.47379690408706665, time cost3.3904943466186523
epoch: 238, iter: 8119, loss: 0.6104910969734192, time cost3.5989573001861572
epoch: 238, iter: 8120, loss: 0.40070387721061707, time cost3.350947141647339
epoch: 238, iter: 8121, loss: 0.33081936836242676, time cost3.394449472427368
epoch: 238, iter: 8122, loss: 0.5728020071983337, time cost3.4012715816497803
epoch: 238, iter: 8123, loss: 0.38737523555755615, time cost3.4927093982696533
epoch: 238, iter: 8124, loss: 0.6081333160400391, time cost3.614588975906372
epoch: 238, iter: 8125, loss: 0.477448433637619, time cost3.4008865356445312
epoch: 238, iter: 8126, loss: 0.2696587145328522, time cost2.4233458042144775
epoch: 239, iter: 8127, loss: 0.740134596824646, time cost3.543600559234619
epoch: 239, iter: 8128, loss: 0.5306413769721985, time cost3.4600160121917725
epoch: 239, iter: 8129, loss: 0.43185853958129883, time cost3.671072244644165
epoch: 239, iter: 8130, loss: 1.005627989768982, time cost3.366065263748169
epoch: 239, iter: 8131, loss: 0.8782852292060852, time cost3.553147315979004
epoch: 239, iter: 8132, loss: 0.6116753220558167, time cost3.6936614513397217
epoch: 239, iter: 8133, loss: 1.1179879903793335, time cost3.280031442642212
epoch: 239, iter: 8134, loss: 0.48754435777664185, time cost3.665879249572754
epoch: 239, iter: 8135, loss: 0.4503483772277832, time cost3.4530367851257324
epoch: 239, iter: 8136, loss: 0.6091398596763611, time cost3.43111515045166
epoch: 239, iter: 8137, loss: 0.4075595438480377, time cost3.544358730316162
epoch: 239, iter: 8138, loss: 0.9306964874267578, time cost3.5794296264648438
epoch: 239, iter: 8139, loss: 0.8527833223342896, time cost3.4883909225463867
epoch: 239, iter: 8140, loss: 0.705646276473999, time cost3.6701242923736572
epoch: 239, iter: 8141, loss: 0.6786304116249084, time cost3.503851890563965
epoch: 239, iter: 8142, loss: 0.6736080646514893, time cost3.5912628173828125
epoch: 239, iter: 8143, loss: 0.7170555591583252, time cost3.3429391384124756
epoch: 239, iter: 8144, loss: 0.8110944628715515, time cost3.3624165058135986
epoch: 239, iter: 8145, loss: 0.8193752765655518, time cost3.5515222549438477
epoch: 239, iter: 8146, loss: 0.798207700252533, time cost3.384443521499634
epoch: 239, iter: 8147, loss: 0.3489886224269867, time cost3.3070695400238037
epoch: 239, iter: 8148, loss: 0.5663866996765137, time cost3.713726282119751
epoch: 239, iter: 8149, loss: 0.4894038736820221, time cost3.2378504276275635
epoch: 239, iter: 8150, loss: 0.6517640948295593, time cost3.748512029647827
tensor([[ 44.,  34.,  39.,  ...,   2.,   2.,   1.],
        [ 35.,  22.,  18.,  ...,   7.,   7.,   4.],
        [130., 301., 124.,  ...,   8.,   8.,   4.],
        ...,
        [ 63.,  65.,  37.,  ...,  20.,  20.,  13.],
        [ 57.,  49.,   8.,  ...,   1.,   1.,   1.],
        [ 26.,  61.,  82.,  ...,   1.,   1.,   2.]])
Epoch: 239, Iteration: 8150:
TEST A@1: 0.5622222222222222
TEST A@5: 0.8977777777777778
TEST A@10: 0.9555555555555556
TEST M@B: 0.43201414994595927
TEST M@A: 0.9592870226994984
TEST W@MB: 0.23207667849110994
TEST W@MA: 0.5934915371142725
TEST Time: 167.22084617614746
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 239, iter: 8151, loss: 0.9175729155540466, time cost3.5123190879821777
epoch: 239, iter: 8152, loss: 0.256156861782074, time cost3.4123082160949707
epoch: 239, iter: 8153, loss: 0.5579909086227417, time cost3.33406400680542
epoch: 239, iter: 8154, loss: 0.711664617061615, time cost3.3750898838043213
epoch: 239, iter: 8155, loss: 0.7716251015663147, time cost3.39882755279541
epoch: 239, iter: 8156, loss: 0.5846630930900574, time cost3.555187702178955
epoch: 239, iter: 8157, loss: 0.4333215355873108, time cost3.3191051483154297
epoch: 239, iter: 8158, loss: 0.7414184808731079, time cost3.404845714569092
epoch: 239, iter: 8159, loss: 0.4972120225429535, time cost3.701707601547241
epoch: 239, iter: 8160, loss: 0.5248805284500122, time cost2.3356847763061523
epoch: 240, iter: 8161, loss: 0.8825240731239319, time cost3.8080084323883057
epoch: 240, iter: 8162, loss: 0.6231563687324524, time cost3.5269196033477783
epoch: 240, iter: 8163, loss: 0.9110042452812195, time cost3.5875251293182373
epoch: 240, iter: 8164, loss: 0.732506513595581, time cost3.8785431385040283
epoch: 240, iter: 8165, loss: 0.6268206834793091, time cost3.5913712978363037
epoch: 240, iter: 8166, loss: 0.36604589223861694, time cost3.6798903942108154
epoch: 240, iter: 8167, loss: 0.6666685342788696, time cost3.6733362674713135
epoch: 240, iter: 8168, loss: 0.5855885148048401, time cost3.606834650039673
epoch: 240, iter: 8169, loss: 0.9649304151535034, time cost3.714280605316162
epoch: 240, iter: 8170, loss: 0.4727286696434021, time cost3.7103512287139893
epoch: 240, iter: 8171, loss: 0.511232852935791, time cost3.519648790359497
epoch: 240, iter: 8172, loss: 0.4142509996891022, time cost3.605274200439453
epoch: 240, iter: 8173, loss: 1.0035403966903687, time cost3.3654415607452393
epoch: 240, iter: 8174, loss: 1.1555538177490234, time cost3.530608654022217
epoch: 240, iter: 8175, loss: 0.9496752619743347, time cost3.34904408454895
epoch: 240, iter: 8176, loss: 0.4603516757488251, time cost3.466338634490967
epoch: 240, iter: 8177, loss: 1.2243633270263672, time cost3.793720006942749
epoch: 240, iter: 8178, loss: 0.5043458938598633, time cost3.326970338821411
epoch: 240, iter: 8179, loss: 0.5742166042327881, time cost3.2495861053466797
epoch: 240, iter: 8180, loss: 0.8121938705444336, time cost3.7799346446990967
epoch: 240, iter: 8181, loss: 0.9262426495552063, time cost3.3313534259796143
epoch: 240, iter: 8182, loss: 0.5992451906204224, time cost3.4461829662323
epoch: 240, iter: 8183, loss: 0.95729660987854, time cost3.4825332164764404
epoch: 240, iter: 8184, loss: 0.8197916746139526, time cost3.4321742057800293
epoch: 240, iter: 8185, loss: 1.1453324556350708, time cost3.5939884185791016
epoch: 240, iter: 8186, loss: 0.8587373495101929, time cost3.5289392471313477
epoch: 240, iter: 8187, loss: 0.6470792889595032, time cost3.446927070617676
epoch: 240, iter: 8188, loss: 1.022159218788147, time cost3.4889109134674072
epoch: 240, iter: 8189, loss: 0.9579737186431885, time cost3.3718814849853516
epoch: 240, iter: 8190, loss: 0.9067667126655579, time cost3.5646426677703857
epoch: 240, iter: 8191, loss: 0.7238693833351135, time cost3.669980525970459
epoch: 240, iter: 8192, loss: 0.7049381732940674, time cost3.5410284996032715
epoch: 240, iter: 8193, loss: 0.6974548697471619, time cost3.8427751064300537
epoch: 240, iter: 8194, loss: 0.30645328760147095, time cost2.6199846267700195
epoch: 241, iter: 8195, loss: 0.875133216381073, time cost3.6321537494659424
epoch: 241, iter: 8196, loss: 1.0843555927276611, time cost3.456352949142456
epoch: 241, iter: 8197, loss: 0.5774317383766174, time cost3.5765504837036133
epoch: 241, iter: 8198, loss: 0.9070258140563965, time cost3.6336212158203125
epoch: 241, iter: 8199, loss: 0.7546029090881348, time cost3.4965202808380127
epoch: 241, iter: 8200, loss: 1.0207748413085938, time cost3.504014015197754
tensor([[170., 146., 157.,  ...,   6.,   6.,   5.],
        [ 20.,  18.,  17.,  ...,   4.,   4.,   4.],
        [ 41., 206.,  63.,  ...,   6.,   6.,   2.],
        ...,
        [ 45.,  40.,  30.,  ...,  11.,  11.,   9.],
        [122., 103.,  42.,  ...,   1.,   1.,   1.],
        [ 67., 117., 152.,  ...,   1.,   1.,   1.]])
Epoch: 241, Iteration: 8200:
TEST A@1: 0.4888888888888889
TEST A@5: 0.8622222222222222
TEST A@10: 0.9422222222222222
TEST M@B: 0.3909681375082199
TEST M@A: 0.9539512149636147
TEST W@MB: 0.2086652041926948
TEST W@MA: 0.5893323557363911
TEST Time: 157.13350534439087
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 241, iter: 8201, loss: 0.579494059085846, time cost3.2358410358428955
epoch: 241, iter: 8202, loss: 0.9269542098045349, time cost3.498806953430176
epoch: 241, iter: 8203, loss: 0.9990094304084778, time cost3.530165433883667
epoch: 241, iter: 8204, loss: 0.5520228743553162, time cost3.389439344406128
epoch: 241, iter: 8205, loss: 0.7136425971984863, time cost3.6753690242767334
epoch: 241, iter: 8206, loss: 0.6387027502059937, time cost3.403411388397217
epoch: 241, iter: 8207, loss: 0.2759515941143036, time cost3.579953670501709
epoch: 241, iter: 8208, loss: 0.7741569876670837, time cost3.4961493015289307
epoch: 241, iter: 8209, loss: 0.4502072036266327, time cost3.605363607406616
epoch: 241, iter: 8210, loss: 1.1089482307434082, time cost3.596698760986328
epoch: 241, iter: 8211, loss: 0.357143759727478, time cost3.475834608078003
epoch: 241, iter: 8212, loss: 0.9982991218566895, time cost3.5795717239379883
epoch: 241, iter: 8213, loss: 0.5153077244758606, time cost3.9139766693115234
epoch: 241, iter: 8214, loss: 0.91253662109375, time cost3.673766851425171
epoch: 241, iter: 8215, loss: 0.45097723603248596, time cost3.5819551944732666
epoch: 241, iter: 8216, loss: 0.6285542249679565, time cost3.2477731704711914
epoch: 241, iter: 8217, loss: 0.523880660533905, time cost3.399580240249634
epoch: 241, iter: 8218, loss: 0.8475366830825806, time cost3.599581480026245
epoch: 241, iter: 8219, loss: 1.0968475341796875, time cost3.6973676681518555
epoch: 241, iter: 8220, loss: 0.7384873628616333, time cost3.505838394165039
epoch: 241, iter: 8221, loss: 0.8110450506210327, time cost3.498039960861206
epoch: 241, iter: 8222, loss: 0.38770079612731934, time cost3.401059150695801
epoch: 241, iter: 8223, loss: 0.5234816074371338, time cost3.545731544494629
epoch: 241, iter: 8224, loss: 0.5749910473823547, time cost3.3918139934539795
epoch: 241, iter: 8225, loss: 0.4521993100643158, time cost3.3481342792510986
epoch: 241, iter: 8226, loss: 1.0256520509719849, time cost3.710861921310425
epoch: 241, iter: 8227, loss: 0.8975439667701721, time cost3.377150774002075
epoch: 241, iter: 8228, loss: 0.42300063371658325, time cost2.40838360786438
epoch: 242, iter: 8229, loss: 0.7619999051094055, time cost2.96132493019104
epoch: 242, iter: 8230, loss: 0.5078713297843933, time cost2.785996437072754
epoch: 242, iter: 8231, loss: 0.5766788125038147, time cost3.1627533435821533
epoch: 242, iter: 8232, loss: 1.3063442707061768, time cost3.841921091079712
epoch: 242, iter: 8233, loss: 0.8359982371330261, time cost3.708937883377075
epoch: 242, iter: 8234, loss: 0.6062710881233215, time cost3.463407278060913
epoch: 242, iter: 8235, loss: 0.6637778878211975, time cost3.7492921352386475
epoch: 242, iter: 8236, loss: 0.3773113191127777, time cost4.3635478019714355
epoch: 242, iter: 8237, loss: 0.7584373950958252, time cost4.187743186950684
epoch: 242, iter: 8238, loss: 0.5794508457183838, time cost3.8007395267486572
epoch: 242, iter: 8239, loss: 0.6792586445808411, time cost4.032021999359131
epoch: 242, iter: 8240, loss: 0.3553938865661621, time cost4.674102544784546
epoch: 242, iter: 8241, loss: 0.3401240408420563, time cost4.068203687667847
epoch: 242, iter: 8242, loss: 0.7167794108390808, time cost4.046663045883179
epoch: 242, iter: 8243, loss: 0.5661283731460571, time cost4.151357889175415
epoch: 242, iter: 8244, loss: 0.6165589690208435, time cost4.423802137374878
epoch: 242, iter: 8245, loss: 0.5277238488197327, time cost3.7889764308929443
epoch: 242, iter: 8246, loss: 1.2783397436141968, time cost3.6483101844787598
epoch: 242, iter: 8247, loss: 0.30094221234321594, time cost3.8426547050476074
epoch: 242, iter: 8248, loss: 0.5567311644554138, time cost3.6230599880218506
epoch: 242, iter: 8249, loss: 0.8516459465026855, time cost3.675131320953369
epoch: 242, iter: 8250, loss: 0.3401235044002533, time cost3.7491512298583984
tensor([[ 39.,  30.,  31.,  ...,   3.,   3.,   2.],
        [  6.,  11.,   9.,  ...,   7.,   7.,   2.],
        [ 85., 287., 106.,  ...,   2.,   2.,   1.],
        ...,
        [ 33.,  35.,  20.,  ...,   8.,   8.,   4.],
        [ 92.,  99.,  97.,  ...,   1.,   1.,   1.],
        [ 25.,  66.,  75.,  ...,   1.,   1.,   4.]])
Epoch: 242, Iteration: 8250:
TEST A@1: 0.5533333333333333
TEST A@5: 0.8755555555555555
TEST A@10: 0.9577777777777777
TEST M@B: 0.4251859810063907
TEST M@A: 0.9588351548931798
TEST W@MB: 0.2287129807265888
TEST W@MA: 0.5931020624205161
TEST Time: 152.08174300193787
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 242, iter: 8251, loss: 0.48493167757987976, time cost3.4206809997558594
epoch: 242, iter: 8252, loss: 1.0403881072998047, time cost3.407442808151245
epoch: 242, iter: 8253, loss: 0.740617036819458, time cost3.4696359634399414
epoch: 242, iter: 8254, loss: 0.6818543672561646, time cost3.4858756065368652
epoch: 242, iter: 8255, loss: 0.5507435202598572, time cost3.468245267868042
epoch: 242, iter: 8256, loss: 0.6837102174758911, time cost3.4896292686462402
epoch: 242, iter: 8257, loss: 0.5765247941017151, time cost3.572622060775757
epoch: 242, iter: 8258, loss: 0.7282037138938904, time cost3.245523691177368
epoch: 242, iter: 8259, loss: 0.3969590365886688, time cost3.5315327644348145
epoch: 242, iter: 8260, loss: 0.9505805373191833, time cost3.513662338256836
epoch: 242, iter: 8261, loss: 0.4708709120750427, time cost3.328195810317993
epoch: 242, iter: 8262, loss: 0.6837067604064941, time cost2.7050366401672363
epoch: 243, iter: 8263, loss: 1.0648518800735474, time cost3.3300154209136963
epoch: 243, iter: 8264, loss: 0.5270498991012573, time cost3.434037208557129
epoch: 243, iter: 8265, loss: 1.2844386100769043, time cost3.5686707496643066
epoch: 243, iter: 8266, loss: 0.6216861009597778, time cost3.5822885036468506
epoch: 243, iter: 8267, loss: 0.7856937646865845, time cost3.3650386333465576
epoch: 243, iter: 8268, loss: 0.5080516934394836, time cost3.7183890342712402
epoch: 243, iter: 8269, loss: 0.46429672837257385, time cost3.550164222717285
epoch: 243, iter: 8270, loss: 0.522455632686615, time cost3.4537079334259033
epoch: 243, iter: 8271, loss: 0.6600144505500793, time cost3.6330292224884033
epoch: 243, iter: 8272, loss: 0.7398000359535217, time cost3.6669986248016357
epoch: 243, iter: 8273, loss: 0.500254213809967, time cost3.6060616970062256
epoch: 243, iter: 8274, loss: 0.7528146505355835, time cost3.49894642829895
epoch: 243, iter: 8275, loss: 0.9735292196273804, time cost3.5346004962921143
epoch: 243, iter: 8276, loss: 0.7391727566719055, time cost3.544666051864624
epoch: 243, iter: 8277, loss: 0.8806516528129578, time cost3.5460360050201416
epoch: 243, iter: 8278, loss: 0.7972955703735352, time cost3.4140164852142334
epoch: 243, iter: 8279, loss: 1.1374447345733643, time cost3.385864734649658
epoch: 243, iter: 8280, loss: 0.3022615611553192, time cost3.434171199798584
epoch: 243, iter: 8281, loss: 0.7564186453819275, time cost3.4171500205993652
epoch: 243, iter: 8282, loss: 0.8326080441474915, time cost3.2903823852539062
epoch: 243, iter: 8283, loss: 0.8297945261001587, time cost3.5483932495117188
epoch: 243, iter: 8284, loss: 0.5813747048377991, time cost3.4199440479278564
epoch: 243, iter: 8285, loss: 0.7890509366989136, time cost3.3421249389648438
epoch: 243, iter: 8286, loss: 0.5298891663551331, time cost3.723057985305786
epoch: 243, iter: 8287, loss: 0.5795756578445435, time cost3.540367841720581
epoch: 243, iter: 8288, loss: 0.7084494233131409, time cost3.4672858715057373
epoch: 243, iter: 8289, loss: 0.5833299160003662, time cost3.5546867847442627
epoch: 243, iter: 8290, loss: 0.652155339717865, time cost3.32782244682312
epoch: 243, iter: 8291, loss: 0.4483739733695984, time cost3.3505656719207764
epoch: 243, iter: 8292, loss: 0.6543285846710205, time cost3.3972177505493164
epoch: 243, iter: 8293, loss: 0.6881207823753357, time cost3.543062925338745
epoch: 243, iter: 8294, loss: 0.8357052206993103, time cost3.5369856357574463
epoch: 243, iter: 8295, loss: 0.2690573036670685, time cost3.532067060470581
epoch: 243, iter: 8296, loss: 0.5284619927406311, time cost2.569366455078125
epoch: 244, iter: 8297, loss: 0.6938379406929016, time cost3.6332993507385254
epoch: 244, iter: 8298, loss: 0.4949524402618408, time cost3.4861018657684326
epoch: 244, iter: 8299, loss: 0.3604273796081543, time cost3.420869827270508
epoch: 244, iter: 8300, loss: 0.4213832914829254, time cost3.662006139755249
tensor([[ 14.,   9.,  17.,  ...,   1.,   1.,   1.],
        [ 10.,  16.,  11.,  ...,   8.,   8.,   6.],
        [200., 407., 223.,  ...,   4.,   4.,   1.],
        ...,
        [100.,  98.,  74.,  ...,  15.,  15.,  11.],
        [  9.,   9.,   7.,  ...,   1.,   1.,   1.],
        [117., 200., 197.,  ...,   4.,   4.,   7.]])
Epoch: 244, Iteration: 8300:
TEST A@1: 0.5488888888888889
TEST A@5: 0.88
TEST A@10: 0.9533333333333334
TEST M@B: 0.44180579127725245
TEST M@A: 0.9608336697923285
TEST W@MB: 0.23875180700231402
TEST W@MA: 0.5947392449352952
TEST Time: 114.95726943016052
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 244, iter: 8301, loss: 0.8151089549064636, time cost3.2786529064178467
epoch: 244, iter: 8302, loss: 0.6392273902893066, time cost3.370882511138916
epoch: 244, iter: 8303, loss: 1.1873912811279297, time cost3.4225451946258545
epoch: 244, iter: 8304, loss: 0.663811981678009, time cost3.4763331413269043
epoch: 244, iter: 8305, loss: 0.28610366582870483, time cost3.4706594944000244
epoch: 244, iter: 8306, loss: 0.9317023754119873, time cost3.429857015609741
epoch: 244, iter: 8307, loss: 0.4777940511703491, time cost3.487521171569824
epoch: 244, iter: 8308, loss: 1.1725475788116455, time cost3.3661386966705322
epoch: 244, iter: 8309, loss: 0.8676925897598267, time cost3.476882219314575
epoch: 244, iter: 8310, loss: 0.6446473002433777, time cost3.443821668624878
epoch: 244, iter: 8311, loss: 1.1647127866744995, time cost3.5557382106781006
epoch: 244, iter: 8312, loss: 0.20881660282611847, time cost3.4294657707214355
epoch: 244, iter: 8313, loss: 0.5141817331314087, time cost3.6545372009277344
epoch: 244, iter: 8314, loss: 0.827704131603241, time cost3.661343574523926
epoch: 244, iter: 8315, loss: 0.9082873463630676, time cost3.503143072128296
epoch: 244, iter: 8316, loss: 0.7113386392593384, time cost3.7441470623016357
epoch: 244, iter: 8317, loss: 0.5341845750808716, time cost3.6140120029449463
epoch: 244, iter: 8318, loss: 0.6784623861312866, time cost3.490781784057617
epoch: 244, iter: 8319, loss: 0.7707170844078064, time cost3.467679738998413
epoch: 244, iter: 8320, loss: 0.4368717074394226, time cost3.5626726150512695
epoch: 244, iter: 8321, loss: 0.681800127029419, time cost3.476362466812134
epoch: 244, iter: 8322, loss: 0.4733618497848511, time cost3.4878311157226562
epoch: 244, iter: 8323, loss: 0.6974091529846191, time cost3.603407144546509
epoch: 244, iter: 8324, loss: 0.5870506763458252, time cost3.4258346557617188
epoch: 244, iter: 8325, loss: 0.5611346364021301, time cost3.40690541267395
epoch: 244, iter: 8326, loss: 0.7552004456520081, time cost3.43330979347229
epoch: 244, iter: 8327, loss: 0.8136541247367859, time cost3.385908842086792
epoch: 244, iter: 8328, loss: 0.8354895710945129, time cost3.6610400676727295
epoch: 244, iter: 8329, loss: 0.652911365032196, time cost3.498246669769287
epoch: 244, iter: 8330, loss: 0.45575037598609924, time cost2.6345736980438232
epoch: 245, iter: 8331, loss: 0.6380309462547302, time cost3.620527982711792
epoch: 245, iter: 8332, loss: 0.7321736812591553, time cost3.6003026962280273
epoch: 245, iter: 8333, loss: 1.3207788467407227, time cost3.5092403888702393
epoch: 245, iter: 8334, loss: 0.4301195740699768, time cost3.491542100906372
epoch: 245, iter: 8335, loss: 0.8421960473060608, time cost3.5576343536376953
epoch: 245, iter: 8336, loss: 0.6931041479110718, time cost3.6706979274749756
epoch: 245, iter: 8337, loss: 0.3409439027309418, time cost3.5326452255249023
epoch: 245, iter: 8338, loss: 0.47775763273239136, time cost3.4795212745666504
epoch: 245, iter: 8339, loss: 0.3822213113307953, time cost3.5148355960845947
epoch: 245, iter: 8340, loss: 0.38392579555511475, time cost3.592628002166748
epoch: 245, iter: 8341, loss: 0.5795538425445557, time cost3.309861183166504
epoch: 245, iter: 8342, loss: 0.9288774132728577, time cost3.5205914974212646
epoch: 245, iter: 8343, loss: 0.784340500831604, time cost3.58878755569458
epoch: 245, iter: 8344, loss: 0.7712811827659607, time cost3.575146436691284
epoch: 245, iter: 8345, loss: 0.45578452944755554, time cost3.5651938915252686
epoch: 245, iter: 8346, loss: 0.7702084183692932, time cost3.5906689167022705
epoch: 245, iter: 8347, loss: 0.5040534138679504, time cost3.6210341453552246
epoch: 245, iter: 8348, loss: 1.0423165559768677, time cost3.624453544616699
epoch: 245, iter: 8349, loss: 0.5686482787132263, time cost3.5328283309936523
epoch: 245, iter: 8350, loss: 0.37531912326812744, time cost3.534473419189453
tensor([[106.,  76.,  81.,  ...,   1.,   1.,   1.],
        [ 29.,  20.,  19.,  ...,   9.,   9.,   5.],
        [103., 161., 114.,  ...,   7.,   7.,   3.],
        ...,
        [ 90.,  92.,  65.,  ...,   7.,   7.,   6.],
        [ 14.,  18.,   4.,  ...,   1.,   1.,   1.],
        [ 84., 184., 234.,  ...,   1.,   1.,   1.]])
Epoch: 245, Iteration: 8350:
TEST A@1: 0.5288888888888889
TEST A@5: 0.8933333333333333
TEST A@10: 0.9666666666666667
TEST M@B: 0.4363987643483482
TEST M@A: 0.9560439079841155
TEST W@MB: 0.23481400672230265
TEST W@MA: 0.590413800168067
TEST Time: 122.38886332511902
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 245, iter: 8351, loss: 0.7227240204811096, time cost3.4406826496124268
epoch: 245, iter: 8352, loss: 0.6673694849014282, time cost3.609635829925537
epoch: 245, iter: 8353, loss: 0.7241490483283997, time cost3.8495898246765137
epoch: 245, iter: 8354, loss: 0.4151265621185303, time cost3.7372870445251465
epoch: 245, iter: 8355, loss: 0.8215956091880798, time cost3.5778863430023193
epoch: 245, iter: 8356, loss: 0.3412587344646454, time cost3.6787664890289307
epoch: 245, iter: 8357, loss: 0.6360241770744324, time cost3.8596503734588623
epoch: 245, iter: 8358, loss: 1.1579928398132324, time cost3.708082675933838
epoch: 245, iter: 8359, loss: 0.7504755258560181, time cost3.4826033115386963
epoch: 245, iter: 8360, loss: 0.8764252066612244, time cost3.4582314491271973
epoch: 245, iter: 8361, loss: 0.5805854201316833, time cost3.9117846488952637
epoch: 245, iter: 8362, loss: 0.6371304392814636, time cost3.74227237701416
epoch: 245, iter: 8363, loss: 0.5909668207168579, time cost3.563103199005127
epoch: 245, iter: 8364, loss: 0.42351651191711426, time cost2.563680648803711
epoch: 246, iter: 8365, loss: 0.6279322504997253, time cost3.6380743980407715
epoch: 246, iter: 8366, loss: 0.7479761838912964, time cost3.3425822257995605
epoch: 246, iter: 8367, loss: 0.7189278602600098, time cost2.840890884399414
epoch: 246, iter: 8368, loss: 0.34544456005096436, time cost2.822218894958496
epoch: 246, iter: 8369, loss: 0.6547630429267883, time cost2.825646162033081
epoch: 246, iter: 8370, loss: 0.4758967459201813, time cost2.838780641555786
epoch: 246, iter: 8371, loss: 0.22340266406536102, time cost2.8060407638549805
epoch: 246, iter: 8372, loss: 0.24450334906578064, time cost2.984915018081665
epoch: 246, iter: 8373, loss: 0.5786981582641602, time cost3.4072134494781494
epoch: 246, iter: 8374, loss: 0.5798689126968384, time cost3.265350580215454
epoch: 246, iter: 8375, loss: 0.8211894035339355, time cost3.520885944366455
epoch: 246, iter: 8376, loss: 0.6952621936798096, time cost3.43615460395813
epoch: 246, iter: 8377, loss: 0.652567982673645, time cost3.4627304077148438
epoch: 246, iter: 8378, loss: 0.34234756231307983, time cost3.3890984058380127
epoch: 246, iter: 8379, loss: 0.8755691647529602, time cost3.447096824645996
epoch: 246, iter: 8380, loss: 0.42727550864219666, time cost3.519376754760742
epoch: 246, iter: 8381, loss: 0.6945356726646423, time cost3.5687668323516846
epoch: 246, iter: 8382, loss: 0.6015008687973022, time cost3.3874268531799316
epoch: 246, iter: 8383, loss: 0.7362523674964905, time cost3.372187376022339
epoch: 246, iter: 8384, loss: 0.49889254570007324, time cost3.3533759117126465
epoch: 246, iter: 8385, loss: 1.0317182540893555, time cost3.4750170707702637
epoch: 246, iter: 8386, loss: 0.4323851764202118, time cost3.5544841289520264
epoch: 246, iter: 8387, loss: 0.3419456481933594, time cost3.313466787338257
epoch: 246, iter: 8388, loss: 0.5117037296295166, time cost3.316516160964966
epoch: 246, iter: 8389, loss: 0.7016617655754089, time cost3.365495443344116
epoch: 246, iter: 8390, loss: 0.4786145091056824, time cost3.2678983211517334
epoch: 246, iter: 8391, loss: 0.7089526653289795, time cost3.4753787517547607
epoch: 246, iter: 8392, loss: 0.6268053650856018, time cost3.3146145343780518
epoch: 246, iter: 8393, loss: 0.7201964259147644, time cost3.367872953414917
epoch: 246, iter: 8394, loss: 0.45633605122566223, time cost3.4083166122436523
epoch: 246, iter: 8395, loss: 0.9002589583396912, time cost3.322402238845825
epoch: 246, iter: 8396, loss: 0.7077760100364685, time cost3.286342144012451
epoch: 246, iter: 8397, loss: 0.3374738395214081, time cost3.3015811443328857
epoch: 246, iter: 8398, loss: 0.41872933506965637, time cost2.430483818054199
epoch: 247, iter: 8399, loss: 0.6438785791397095, time cost3.3702445030212402
epoch: 247, iter: 8400, loss: 0.9715054631233215, time cost3.433323860168457
tensor([[ 56.,  46.,  53.,  ...,  10.,  10.,  11.],
        [ 10.,   9.,   8.,  ...,   6.,   6.,   4.],
        [100., 236., 117.,  ...,   2.,   2.,   1.],
        ...,
        [ 89.,  95.,  56.,  ...,  12.,  12.,   8.],
        [  5.,   4.,   1.,  ...,   1.,   1.,   1.],
        [ 59., 156., 194.,  ...,   2.,   2.,   4.]])
Epoch: 247, Iteration: 8400:
TEST A@1: 0.44
TEST A@5: 0.8266666666666667
TEST A@10: 0.9288888888888889
TEST M@B: 0.3798141592834869
TEST M@A: 0.9547971871945535
TEST W@MB: 0.20446649412240842
TEST W@MA: 0.5900521424043036
TEST Time: 157.202570438385
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 247, iter: 8401, loss: 1.025780439376831, time cost3.402674674987793
epoch: 247, iter: 8402, loss: 0.5365962386131287, time cost3.438683032989502
epoch: 247, iter: 8403, loss: 0.5192065238952637, time cost3.3984601497650146
epoch: 247, iter: 8404, loss: 0.747157871723175, time cost3.491818904876709
epoch: 247, iter: 8405, loss: 0.8515227437019348, time cost3.296158790588379
epoch: 247, iter: 8406, loss: 0.9476677775382996, time cost3.3215956687927246
epoch: 247, iter: 8407, loss: 0.5403808951377869, time cost3.3649542331695557
epoch: 247, iter: 8408, loss: 0.6762866377830505, time cost3.3845667839050293
epoch: 247, iter: 8409, loss: 0.884160578250885, time cost3.437375783920288
epoch: 247, iter: 8410, loss: 0.37159109115600586, time cost3.42240571975708
epoch: 247, iter: 8411, loss: 0.5881821513175964, time cost3.2711164951324463
epoch: 247, iter: 8412, loss: 0.42828211188316345, time cost3.388317584991455
epoch: 247, iter: 8413, loss: 1.219144582748413, time cost3.3028934001922607
epoch: 247, iter: 8414, loss: 1.12119460105896, time cost3.642338275909424
epoch: 247, iter: 8415, loss: 0.6982374787330627, time cost3.459526538848877
epoch: 247, iter: 8416, loss: 0.5823081135749817, time cost3.3234567642211914
epoch: 247, iter: 8417, loss: 0.6216371059417725, time cost3.452571392059326
epoch: 247, iter: 8418, loss: 0.744256317615509, time cost3.2143352031707764
epoch: 247, iter: 8419, loss: 0.7895045280456543, time cost3.396787166595459
epoch: 247, iter: 8420, loss: 0.536494255065918, time cost3.479520559310913
epoch: 247, iter: 8421, loss: 0.6936720013618469, time cost3.3487918376922607
epoch: 247, iter: 8422, loss: 1.3398098945617676, time cost3.319647789001465
epoch: 247, iter: 8423, loss: 0.750705361366272, time cost3.3627538681030273
epoch: 247, iter: 8424, loss: 1.1575793027877808, time cost3.3446106910705566
epoch: 247, iter: 8425, loss: 0.825135350227356, time cost3.3711905479431152
epoch: 247, iter: 8426, loss: 0.4484919607639313, time cost3.3423373699188232
epoch: 247, iter: 8427, loss: 0.7539573907852173, time cost3.355020046234131
epoch: 247, iter: 8428, loss: 0.5651339292526245, time cost3.330456018447876
epoch: 247, iter: 8429, loss: 0.4352879226207733, time cost3.2821216583251953
epoch: 247, iter: 8430, loss: 0.44263574481010437, time cost3.2734532356262207
epoch: 247, iter: 8431, loss: 0.4415149688720703, time cost3.288161277770996
epoch: 247, iter: 8432, loss: 0.4488641619682312, time cost2.4285154342651367
epoch: 248, iter: 8433, loss: 0.6264016628265381, time cost3.3835976123809814
epoch: 248, iter: 8434, loss: 0.8639320135116577, time cost3.314697742462158
epoch: 248, iter: 8435, loss: 0.42004433274269104, time cost3.409766435623169
epoch: 248, iter: 8436, loss: 0.8159131407737732, time cost3.4184436798095703
epoch: 248, iter: 8437, loss: 0.8663462400436401, time cost3.505309820175171
epoch: 248, iter: 8438, loss: 0.9984363913536072, time cost3.3957934379577637
epoch: 248, iter: 8439, loss: 0.8775172829627991, time cost3.3992269039154053
epoch: 248, iter: 8440, loss: 0.6183958053588867, time cost3.474212646484375
epoch: 248, iter: 8441, loss: 0.6227260231971741, time cost3.5013480186462402
epoch: 248, iter: 8442, loss: 0.756034791469574, time cost3.413159132003784
epoch: 248, iter: 8443, loss: 0.9698814749717712, time cost3.337157964706421
epoch: 248, iter: 8444, loss: 0.549853503704071, time cost3.439448356628418
epoch: 248, iter: 8445, loss: 0.3513701260089874, time cost3.394028663635254
epoch: 248, iter: 8446, loss: 0.9926103353500366, time cost3.4687395095825195
epoch: 248, iter: 8447, loss: 0.6719083786010742, time cost3.3401715755462646
epoch: 248, iter: 8448, loss: 0.6291678547859192, time cost3.3755266666412354
epoch: 248, iter: 8449, loss: 0.6124340295791626, time cost3.4580271244049072
epoch: 248, iter: 8450, loss: 0.48351722955703735, time cost3.3165018558502197
tensor([[ 69.,  57.,  66.,  ...,   4.,   4.,   4.],
        [ 61.,  44.,  44.,  ...,   9.,   9.,   6.],
        [ 44., 157.,  36.,  ...,   1.,   1.,   1.],
        ...,
        [ 24.,  23.,  12.,  ...,  10.,  10.,   7.],
        [ 14.,  17.,   4.,  ...,   1.,   1.,   1.],
        [ 75., 160., 196.,  ...,   3.,   3.,   7.]])
Epoch: 248, Iteration: 8450:
TEST A@1: 0.4866666666666667
TEST A@5: 0.8444444444444444
TEST A@10: 0.9333333333333333
TEST M@B: 0.3961563786350789
TEST M@A: 0.9563579035557156
TEST W@MB: 0.21388127949110086
TEST W@MA: 0.5913752454289273
TEST Time: 129.86752223968506
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 248, iter: 8451, loss: 0.5223942399024963, time cost3.2649285793304443
epoch: 248, iter: 8452, loss: 0.6182271838188171, time cost3.299025774002075
epoch: 248, iter: 8453, loss: 0.8904073238372803, time cost3.458038091659546
epoch: 248, iter: 8454, loss: 0.5724868178367615, time cost3.394848108291626
epoch: 248, iter: 8455, loss: 0.8099443912506104, time cost3.3808090686798096
epoch: 248, iter: 8456, loss: 1.0215922594070435, time cost3.451420545578003
epoch: 248, iter: 8457, loss: 0.9002663493156433, time cost3.4834508895874023
epoch: 248, iter: 8458, loss: 0.5064359307289124, time cost3.284724712371826
epoch: 248, iter: 8459, loss: 0.5694458484649658, time cost3.4095146656036377
epoch: 248, iter: 8460, loss: 0.41671261191368103, time cost3.3007619380950928
epoch: 248, iter: 8461, loss: 1.0757218599319458, time cost3.4556455612182617
epoch: 248, iter: 8462, loss: 0.48607006669044495, time cost3.3655612468719482
epoch: 248, iter: 8463, loss: 0.7234264612197876, time cost3.1478493213653564
epoch: 248, iter: 8464, loss: 0.8118904232978821, time cost3.3319594860076904
epoch: 248, iter: 8465, loss: 0.5979322791099548, time cost3.2973084449768066
epoch: 248, iter: 8466, loss: 0.47093844413757324, time cost2.3306703567504883
epoch: 249, iter: 8467, loss: 1.1256496906280518, time cost3.39945650100708
epoch: 249, iter: 8468, loss: 0.45839205384254456, time cost3.30812668800354
epoch: 249, iter: 8469, loss: 0.5066424608230591, time cost3.264970064163208
epoch: 249, iter: 8470, loss: 0.29792356491088867, time cost3.2875049114227295
epoch: 249, iter: 8471, loss: 0.6470649838447571, time cost3.404541254043579
epoch: 249, iter: 8472, loss: 0.7387832999229431, time cost3.2772598266601562
epoch: 249, iter: 8473, loss: 0.6107975840568542, time cost3.326509714126587
epoch: 249, iter: 8474, loss: 0.650783121585846, time cost3.3698203563690186
epoch: 249, iter: 8475, loss: 0.6146366000175476, time cost3.3477256298065186
epoch: 249, iter: 8476, loss: 0.62531977891922, time cost3.3375444412231445
epoch: 249, iter: 8477, loss: 0.37876400351524353, time cost3.43595814704895
epoch: 249, iter: 8478, loss: 0.16642580926418304, time cost3.28889536857605
epoch: 249, iter: 8479, loss: 0.5279331803321838, time cost3.4024698734283447
epoch: 249, iter: 8480, loss: 0.7348719239234924, time cost3.399158477783203
epoch: 249, iter: 8481, loss: 0.5178856253623962, time cost3.4198553562164307
epoch: 249, iter: 8482, loss: 0.7137470841407776, time cost3.3560643196105957
epoch: 249, iter: 8483, loss: 0.46819424629211426, time cost3.4033660888671875
epoch: 249, iter: 8484, loss: 0.5124172568321228, time cost3.346611738204956
epoch: 249, iter: 8485, loss: 0.675325334072113, time cost3.413694381713867
epoch: 249, iter: 8486, loss: 1.0622429847717285, time cost3.315809965133667
epoch: 249, iter: 8487, loss: 0.5663473010063171, time cost3.2267699241638184
epoch: 249, iter: 8488, loss: 0.6909025311470032, time cost3.381355047225952
epoch: 249, iter: 8489, loss: 0.8953732848167419, time cost3.5281906127929688
epoch: 249, iter: 8490, loss: 0.9160352349281311, time cost3.668358564376831
epoch: 249, iter: 8491, loss: 0.6315440535545349, time cost3.5119664669036865
epoch: 249, iter: 8492, loss: 0.4388183653354645, time cost3.379678964614868
epoch: 249, iter: 8493, loss: 1.0504021644592285, time cost3.214332342147827
epoch: 249, iter: 8494, loss: 1.1396665573120117, time cost3.2331607341766357
epoch: 249, iter: 8495, loss: 0.3508266508579254, time cost3.494584560394287
epoch: 249, iter: 8496, loss: 0.4096902310848236, time cost3.2854418754577637
epoch: 249, iter: 8497, loss: 0.5798717141151428, time cost3.3445281982421875
epoch: 249, iter: 8498, loss: 0.9283810257911682, time cost3.4230380058288574
epoch: 249, iter: 8499, loss: 0.509843111038208, time cost3.280867099761963
epoch: 249, iter: 8500, loss: 0.26034992933273315, time cost2.2685134410858154
tensor([[ 33.,  34.,  31.,  ...,   6.,   6.,   5.],
        [ 17.,  12.,   9.,  ...,   1.,   1.,   1.],
        [152., 359., 145.,  ...,   1.,   1.,   1.],
        ...,
        [ 57.,  54.,  36.,  ...,  21.,  21.,  12.],
        [ 29.,  42.,  14.,  ...,   1.,   1.,   1.],
        [ 50.,  76.,  88.,  ...,   2.,   2.,   3.]])
Epoch: 249, Iteration: 8500:
TEST A@1: 0.5022222222222222
TEST A@5: 0.8444444444444444
TEST A@10: 0.94
TEST M@B: 0.41131522938905074
TEST M@A: 0.9550857998669916
TEST W@MB: 0.2214114914305812
TEST W@MA: 0.5901776929658938
TEST Time: 141.86401915550232
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 250, iter: 8501, loss: 0.9080971479415894, time cost3.499176025390625
epoch: 250, iter: 8502, loss: 1.1914629936218262, time cost3.2950596809387207
epoch: 250, iter: 8503, loss: 0.42038825154304504, time cost3.4124691486358643
epoch: 250, iter: 8504, loss: 1.0471497774124146, time cost3.382073402404785
epoch: 250, iter: 8505, loss: 0.513235330581665, time cost3.485227584838867
epoch: 250, iter: 8506, loss: 0.9196822047233582, time cost3.474790096282959
epoch: 250, iter: 8507, loss: 1.2851732969284058, time cost3.4955334663391113
epoch: 250, iter: 8508, loss: 0.7114895582199097, time cost3.4558918476104736
epoch: 250, iter: 8509, loss: 0.7600762844085693, time cost3.3199658393859863
epoch: 250, iter: 8510, loss: 0.6842901706695557, time cost3.2167298793792725
epoch: 250, iter: 8511, loss: 0.5601285696029663, time cost3.5585551261901855
epoch: 250, iter: 8512, loss: 0.6274710297584534, time cost3.427699327468872
epoch: 250, iter: 8513, loss: 0.33169838786125183, time cost3.4842426776885986
epoch: 250, iter: 8514, loss: 1.0509729385375977, time cost3.4534337520599365
epoch: 250, iter: 8515, loss: 0.5892764925956726, time cost3.2659785747528076
epoch: 250, iter: 8516, loss: 1.0378590822219849, time cost3.317355155944824
epoch: 250, iter: 8517, loss: 0.5765535235404968, time cost3.469580888748169
epoch: 250, iter: 8518, loss: 0.4046189785003662, time cost3.4501631259918213
epoch: 250, iter: 8519, loss: 0.41795483231544495, time cost3.467146635055542
epoch: 250, iter: 8520, loss: 0.7121196985244751, time cost3.372836112976074
epoch: 250, iter: 8521, loss: 0.4699100852012634, time cost3.465085029602051
epoch: 250, iter: 8522, loss: 0.5552772283554077, time cost3.5262372493743896
epoch: 250, iter: 8523, loss: 0.7637630105018616, time cost3.4502005577087402
epoch: 250, iter: 8524, loss: 0.6469802856445312, time cost3.21917462348938
epoch: 250, iter: 8525, loss: 0.5413777232170105, time cost3.3092784881591797
epoch: 250, iter: 8526, loss: 1.1744966506958008, time cost3.292201042175293
epoch: 250, iter: 8527, loss: 0.819273054599762, time cost3.3844943046569824
epoch: 250, iter: 8528, loss: 0.43063825368881226, time cost3.3758163452148438
epoch: 250, iter: 8529, loss: 0.7406200170516968, time cost3.2721962928771973
epoch: 250, iter: 8530, loss: 0.48173490166664124, time cost3.36104154586792
epoch: 250, iter: 8531, loss: 0.4275573492050171, time cost3.292215585708618
epoch: 250, iter: 8532, loss: 0.4378073215484619, time cost3.378753185272217
epoch: 250, iter: 8533, loss: 0.27123287320137024, time cost3.284605026245117
epoch: 250, iter: 8534, loss: 0.5818271636962891, time cost2.4551279544830322
epoch: 251, iter: 8535, loss: 0.7699334025382996, time cost3.371051549911499
epoch: 251, iter: 8536, loss: 0.8163281679153442, time cost3.4508986473083496
epoch: 251, iter: 8537, loss: 0.5299809575080872, time cost3.400418758392334
epoch: 251, iter: 8538, loss: 0.5326969027519226, time cost3.428853988647461
epoch: 251, iter: 8539, loss: 0.6618528366088867, time cost3.300145149230957
epoch: 251, iter: 8540, loss: 0.5897433161735535, time cost3.4443764686584473
epoch: 251, iter: 8541, loss: 1.0537089109420776, time cost3.305023431777954
epoch: 251, iter: 8542, loss: 0.6344716548919678, time cost3.3030905723571777
epoch: 251, iter: 8543, loss: 0.2637575566768646, time cost3.4418725967407227
epoch: 251, iter: 8544, loss: 0.9168121218681335, time cost3.3490092754364014
epoch: 251, iter: 8545, loss: 0.45213043689727783, time cost3.4659228324890137
epoch: 251, iter: 8546, loss: 1.0506808757781982, time cost3.4803242683410645
epoch: 251, iter: 8547, loss: 0.530179500579834, time cost3.445704221725464
epoch: 251, iter: 8548, loss: 0.6138208508491516, time cost3.395188093185425
epoch: 251, iter: 8549, loss: 0.8806415796279907, time cost3.4247324466705322
epoch: 251, iter: 8550, loss: 0.5731534957885742, time cost3.417484760284424
tensor([[ 78.,  63.,  76.,  ...,   2.,   2.,   1.],
        [  8.,   8.,   6.,  ...,   5.,   5.,   5.],
        [ 87., 267.,  70.,  ...,   2.,   2.,   1.],
        ...,
        [ 35.,  29.,  16.,  ...,   8.,   8.,   5.],
        [ 19.,  24.,   6.,  ...,   1.,   1.,   1.],
        [100., 198., 260.,  ...,   1.,   1.,   3.]])
Epoch: 251, Iteration: 8550:
TEST A@1: 0.5777777777777777
TEST A@5: 0.9066666666666666
TEST A@10: 0.9644444444444444
TEST M@B: 0.4472035710793393
TEST M@A: 0.9607348962825029
TEST W@MB: 0.24095475156820909
TEST W@MA: 0.5945384247832751
TEST Time: 145.86853504180908
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 251, iter: 8551, loss: 0.6311377882957458, time cost3.2429420948028564
epoch: 251, iter: 8552, loss: 0.6753151416778564, time cost3.4023547172546387
epoch: 251, iter: 8553, loss: 1.015691876411438, time cost3.19700026512146
epoch: 251, iter: 8554, loss: 0.3861444294452667, time cost3.4933536052703857
epoch: 251, iter: 8555, loss: 0.8128138184547424, time cost3.477322816848755
epoch: 251, iter: 8556, loss: 0.6733647584915161, time cost3.2630162239074707
epoch: 251, iter: 8557, loss: 0.9734247922897339, time cost3.4814863204956055
epoch: 251, iter: 8558, loss: 0.8195740580558777, time cost3.4619550704956055
epoch: 251, iter: 8559, loss: 0.5909178853034973, time cost3.4034175872802734
epoch: 251, iter: 8560, loss: 0.8097758293151855, time cost3.424128532409668
epoch: 251, iter: 8561, loss: 0.9322369694709778, time cost3.3919429779052734
epoch: 251, iter: 8562, loss: 0.6240862607955933, time cost3.2850987911224365
epoch: 251, iter: 8563, loss: 0.7377446889877319, time cost3.3119957447052
epoch: 251, iter: 8564, loss: 0.3549388647079468, time cost3.31119704246521
epoch: 251, iter: 8565, loss: 0.43935543298721313, time cost3.4011240005493164
epoch: 251, iter: 8566, loss: 0.6605400443077087, time cost3.3068606853485107
epoch: 251, iter: 8567, loss: 0.597165584564209, time cost3.2832448482513428
epoch: 251, iter: 8568, loss: 0.2687350809574127, time cost2.4557557106018066
epoch: 252, iter: 8569, loss: 0.4414273500442505, time cost3.5373499393463135
epoch: 252, iter: 8570, loss: 0.9062855243682861, time cost3.3995797634124756
epoch: 252, iter: 8571, loss: 0.6963240504264832, time cost3.448242664337158
epoch: 252, iter: 8572, loss: 0.8189656734466553, time cost3.3480074405670166
epoch: 252, iter: 8573, loss: 0.9638388752937317, time cost3.4558393955230713
epoch: 252, iter: 8574, loss: 0.3685961067676544, time cost3.4945058822631836
epoch: 252, iter: 8575, loss: 1.0088531970977783, time cost3.6484718322753906
epoch: 252, iter: 8576, loss: 0.6761642098426819, time cost3.5554251670837402
epoch: 252, iter: 8577, loss: 0.911672830581665, time cost3.3167433738708496
epoch: 252, iter: 8578, loss: 0.765834391117096, time cost3.296259641647339
epoch: 252, iter: 8579, loss: 1.33646821975708, time cost3.4102513790130615
epoch: 252, iter: 8580, loss: 0.6332608461380005, time cost3.3842270374298096
epoch: 252, iter: 8581, loss: 0.8583460450172424, time cost3.427156925201416
epoch: 252, iter: 8582, loss: 0.7165278792381287, time cost3.432328701019287
epoch: 252, iter: 8583, loss: 0.8427088856697083, time cost3.486112117767334
epoch: 252, iter: 8584, loss: 0.7291591763496399, time cost3.2971601486206055
epoch: 252, iter: 8585, loss: 0.5604751706123352, time cost3.516390800476074
epoch: 252, iter: 8586, loss: 0.6950774192810059, time cost3.4492411613464355
epoch: 252, iter: 8587, loss: 0.31658196449279785, time cost3.4755327701568604
epoch: 252, iter: 8588, loss: 0.9887105822563171, time cost3.334944248199463
epoch: 252, iter: 8589, loss: 0.5941470861434937, time cost3.4290804862976074
epoch: 252, iter: 8590, loss: 0.6066805720329285, time cost3.3936336040496826
epoch: 252, iter: 8591, loss: 0.6846972703933716, time cost3.3594253063201904
epoch: 252, iter: 8592, loss: 0.6844564080238342, time cost3.5196666717529297
epoch: 252, iter: 8593, loss: 0.5824606418609619, time cost3.4567394256591797
epoch: 252, iter: 8594, loss: 0.4209889769554138, time cost3.3650004863739014
epoch: 252, iter: 8595, loss: 0.6934475898742676, time cost3.3656749725341797
epoch: 252, iter: 8596, loss: 0.6221668720245361, time cost3.304866313934326
epoch: 252, iter: 8597, loss: 0.5623223185539246, time cost3.364283323287964
epoch: 252, iter: 8598, loss: 0.6178408861160278, time cost3.3384082317352295
epoch: 252, iter: 8599, loss: 0.8412307500839233, time cost3.2763781547546387
epoch: 252, iter: 8600, loss: 0.6282815337181091, time cost3.2868101596832275
tensor([[ 56.,  40.,  46.,  ...,   2.,   2.,   2.],
        [ 55.,  41.,  38.,  ...,  18.,  18.,   7.],
        [ 86., 238.,  99.,  ...,   2.,   2.,   1.],
        ...,
        [ 34.,  32.,  19.,  ...,  15.,  15.,  11.],
        [ 46.,  53.,  14.,  ...,   1.,   1.,   1.],
        [ 85., 134., 201.,  ...,   2.,   2.,   7.]])
Epoch: 252, Iteration: 8600:
TEST A@1: 0.4688888888888889
TEST A@5: 0.82
TEST A@10: 0.9133333333333333
TEST M@B: 0.3761561558572426
TEST M@A: 0.952021282837401
TEST W@MB: 0.2018643921475629
TEST W@MA: 0.5881005274884072
TEST Time: 139.03993129730225
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 252, iter: 8601, loss: 0.8258689641952515, time cost3.231004238128662
epoch: 252, iter: 8602, loss: 0.1685623824596405, time cost2.4022769927978516
epoch: 253, iter: 8603, loss: 0.7001723647117615, time cost3.385201930999756
epoch: 253, iter: 8604, loss: 0.5487493276596069, time cost3.369778633117676
epoch: 253, iter: 8605, loss: 0.8681148886680603, time cost3.3649203777313232
epoch: 253, iter: 8606, loss: 0.9430539608001709, time cost3.348099708557129
epoch: 253, iter: 8607, loss: 0.5491268038749695, time cost3.327495813369751
epoch: 253, iter: 8608, loss: 0.5142563581466675, time cost3.2530620098114014
epoch: 253, iter: 8609, loss: 0.4960382878780365, time cost3.3223490715026855
epoch: 253, iter: 8610, loss: 0.36491239070892334, time cost3.4201080799102783
epoch: 253, iter: 8611, loss: 0.736961841583252, time cost3.3267619609832764
epoch: 253, iter: 8612, loss: 0.6893013119697571, time cost3.4171812534332275
epoch: 253, iter: 8613, loss: 0.9562901258468628, time cost3.402278184890747
epoch: 253, iter: 8614, loss: 0.8821170926094055, time cost3.2945849895477295
epoch: 253, iter: 8615, loss: 0.6380043625831604, time cost3.403735876083374
epoch: 253, iter: 8616, loss: 0.7055405974388123, time cost3.407531499862671
epoch: 253, iter: 8617, loss: 0.6283462643623352, time cost3.4083690643310547
epoch: 253, iter: 8618, loss: 0.48769599199295044, time cost3.3231353759765625
epoch: 253, iter: 8619, loss: 0.456656277179718, time cost3.2429988384246826
epoch: 253, iter: 8620, loss: 0.8805974125862122, time cost3.369875431060791
epoch: 253, iter: 8621, loss: 0.4607638716697693, time cost3.3996493816375732
epoch: 253, iter: 8622, loss: 0.8598432540893555, time cost3.3767645359039307
epoch: 253, iter: 8623, loss: 0.2807879149913788, time cost3.4068167209625244
epoch: 253, iter: 8624, loss: 0.40727004408836365, time cost3.37683367729187
epoch: 253, iter: 8625, loss: 0.8918944597244263, time cost3.5322253704071045
epoch: 253, iter: 8626, loss: 0.9350532293319702, time cost3.3369863033294678
epoch: 253, iter: 8627, loss: 0.8113880753517151, time cost3.3634424209594727
epoch: 253, iter: 8628, loss: 0.5030762553215027, time cost3.3859715461730957
epoch: 253, iter: 8629, loss: 1.082810878753662, time cost3.2474043369293213
epoch: 253, iter: 8630, loss: 0.388315349817276, time cost3.366708993911743
epoch: 253, iter: 8631, loss: 0.37842342257499695, time cost3.3013787269592285
epoch: 253, iter: 8632, loss: 0.7500661611557007, time cost3.291414260864258
epoch: 253, iter: 8633, loss: 0.9029693007469177, time cost3.282064437866211
epoch: 253, iter: 8634, loss: 0.5347699522972107, time cost3.244617223739624
epoch: 253, iter: 8635, loss: 0.7724692225456238, time cost3.2469394207000732
epoch: 253, iter: 8636, loss: 0.9654245972633362, time cost2.408597469329834
epoch: 254, iter: 8637, loss: 0.8642721772193909, time cost3.450347900390625
epoch: 254, iter: 8638, loss: 0.5390005111694336, time cost3.358445405960083
epoch: 254, iter: 8639, loss: 0.7075492739677429, time cost3.3147594928741455
epoch: 254, iter: 8640, loss: 0.3373887240886688, time cost3.3813328742980957
epoch: 254, iter: 8641, loss: 0.3221225142478943, time cost3.3193531036376953
epoch: 254, iter: 8642, loss: 1.0679361820220947, time cost3.237711191177368
epoch: 254, iter: 8643, loss: 0.6009200811386108, time cost3.3743319511413574
epoch: 254, iter: 8644, loss: 0.3877656161785126, time cost3.2825381755828857
epoch: 254, iter: 8645, loss: 0.7331526279449463, time cost3.265549898147583
epoch: 254, iter: 8646, loss: 0.7216577529907227, time cost3.373204469680786
epoch: 254, iter: 8647, loss: 0.6029442548751831, time cost3.4318602085113525
epoch: 254, iter: 8648, loss: 0.6319961547851562, time cost3.401535749435425
epoch: 254, iter: 8649, loss: 0.5033884644508362, time cost3.236518383026123
epoch: 254, iter: 8650, loss: 0.7732141017913818, time cost3.3110263347625732
tensor([[138., 115., 125.,  ...,   2.,   2.,   1.],
        [  8.,   9.,   8.,  ...,   7.,   7.,   5.],
        [110., 279., 119.,  ...,   6.,   6.,   2.],
        ...,
        [ 71.,  68.,  52.,  ...,  19.,  19.,   9.],
        [ 68.,  73.,  18.,  ...,   1.,   1.,   1.],
        [ 83., 126., 204.,  ...,   1.,   1.,   2.]])
Epoch: 254, Iteration: 8650:
TEST A@1: 0.5133333333333333
TEST A@5: 0.8711111111111111
TEST A@10: 0.9533333333333334
TEST M@B: 0.4289207774047281
TEST M@A: 0.9595595159927414
TEST W@MB: 0.2319068771340525
TEST W@MA: 0.5937612438470129
TEST Time: 157.81080770492554
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 254, iter: 8651, loss: 0.8436611890792847, time cost3.1583950519561768
epoch: 254, iter: 8652, loss: 0.37907537817955017, time cost3.2056119441986084
epoch: 254, iter: 8653, loss: 0.6782529354095459, time cost3.3121535778045654
epoch: 254, iter: 8654, loss: 0.5914601683616638, time cost3.3298778533935547
epoch: 254, iter: 8655, loss: 0.8004430532455444, time cost3.402040958404541
epoch: 254, iter: 8656, loss: 0.6932743787765503, time cost3.338168144226074
epoch: 254, iter: 8657, loss: 0.5676985383033752, time cost3.39538311958313
epoch: 254, iter: 8658, loss: 0.5274381041526794, time cost3.276745080947876
epoch: 254, iter: 8659, loss: 1.297925353050232, time cost3.364365339279175
epoch: 254, iter: 8660, loss: 0.8748742341995239, time cost3.2444584369659424
epoch: 254, iter: 8661, loss: 0.8199738264083862, time cost3.2641706466674805
epoch: 254, iter: 8662, loss: 0.6071042418479919, time cost3.264735221862793
epoch: 254, iter: 8663, loss: 0.920289158821106, time cost3.3203389644622803
epoch: 254, iter: 8664, loss: 0.60231614112854, time cost3.2401349544525146
epoch: 254, iter: 8665, loss: 0.8406422138214111, time cost3.2862298488616943
epoch: 254, iter: 8666, loss: 0.7982105016708374, time cost3.240684747695923
epoch: 254, iter: 8667, loss: 0.8094519376754761, time cost3.273770332336426
epoch: 254, iter: 8668, loss: 0.4786549210548401, time cost3.261735439300537
epoch: 254, iter: 8669, loss: 0.4872012436389923, time cost3.194920063018799
epoch: 254, iter: 8670, loss: 0.3439592719078064, time cost2.466130018234253
epoch: 255, iter: 8671, loss: 0.42226505279541016, time cost3.436415433883667
epoch: 255, iter: 8672, loss: 0.5507028102874756, time cost3.3968698978424072
epoch: 255, iter: 8673, loss: 0.8192991614341736, time cost3.5985498428344727
epoch: 255, iter: 8674, loss: 0.3268432915210724, time cost3.6257200241088867
epoch: 255, iter: 8675, loss: 0.5222617387771606, time cost3.4689273834228516
epoch: 255, iter: 8676, loss: 0.7426034212112427, time cost3.6038854122161865
epoch: 255, iter: 8677, loss: 0.528013288974762, time cost3.336747646331787
epoch: 255, iter: 8678, loss: 0.5992670655250549, time cost3.5338668823242188
epoch: 255, iter: 8679, loss: 0.6576413512229919, time cost3.3052284717559814
epoch: 255, iter: 8680, loss: 0.5004911422729492, time cost3.2033891677856445
epoch: 255, iter: 8681, loss: 0.7045142650604248, time cost3.2195541858673096
epoch: 255, iter: 8682, loss: 0.43098074197769165, time cost3.3563995361328125
epoch: 255, iter: 8683, loss: 0.44336289167404175, time cost3.4007277488708496
epoch: 255, iter: 8684, loss: 0.7865270972251892, time cost3.3673746585845947
epoch: 255, iter: 8685, loss: 0.6475518941879272, time cost3.43996524810791
epoch: 255, iter: 8686, loss: 0.5313085317611694, time cost3.420362949371338
epoch: 255, iter: 8687, loss: 0.6061021089553833, time cost3.443688154220581
epoch: 255, iter: 8688, loss: 0.5736330151557922, time cost3.4297783374786377
epoch: 255, iter: 8689, loss: 0.63899827003479, time cost3.413825511932373
epoch: 255, iter: 8690, loss: 0.7691778540611267, time cost3.27701997756958
epoch: 255, iter: 8691, loss: 0.8629641532897949, time cost3.2807655334472656
epoch: 255, iter: 8692, loss: 0.5826820731163025, time cost3.4565348625183105
epoch: 255, iter: 8693, loss: 0.7295390367507935, time cost3.4427664279937744
epoch: 255, iter: 8694, loss: 0.5874326825141907, time cost3.4648659229278564
epoch: 255, iter: 8695, loss: 0.5014720559120178, time cost3.5557658672332764
epoch: 255, iter: 8696, loss: 0.5643383264541626, time cost3.3002138137817383
epoch: 255, iter: 8697, loss: 0.9839465022087097, time cost3.2536940574645996
epoch: 255, iter: 8698, loss: 1.036259651184082, time cost3.2081358432769775
epoch: 255, iter: 8699, loss: 0.8951387405395508, time cost3.105334520339966
epoch: 255, iter: 8700, loss: 0.6457923054695129, time cost3.2567827701568604
tensor([[ 45.,  34.,  38.,  ...,   3.,   3.,   3.],
        [ 13.,   9.,   9.,  ...,   4.,   4.,   1.],
        [ 21., 173.,  79.,  ...,   2.,   2.,   1.],
        ...,
        [ 52.,  50.,  31.,  ...,  12.,  12.,   9.],
        [ 31.,  35.,  14.,  ...,   1.,   1.,   1.],
        [ 74., 181., 171.,  ...,   3.,   3.,   7.]])
Epoch: 255, Iteration: 8700:
TEST A@1: 0.5444444444444444
TEST A@5: 0.8688888888888889
TEST A@10: 0.9488888888888889
TEST M@B: 0.42278943028104726
TEST M@A: 0.9564439505017585
TEST W@MB: 0.22769095175523302
TEST W@MA: 0.5911885190089747
TEST Time: 145.23929810523987
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 255, iter: 8701, loss: 0.9046961069107056, time cost3.291142702102661
epoch: 255, iter: 8702, loss: 0.5787357687950134, time cost3.180123805999756
epoch: 255, iter: 8703, loss: 0.5625494122505188, time cost3.2797012329101562
epoch: 255, iter: 8704, loss: 0.525592029094696, time cost2.392239809036255
epoch: 256, iter: 8705, loss: 0.5673661828041077, time cost3.492952823638916
epoch: 256, iter: 8706, loss: 0.5800909996032715, time cost3.375349283218384
epoch: 256, iter: 8707, loss: 0.7111513614654541, time cost3.365347385406494
epoch: 256, iter: 8708, loss: 0.6985236406326294, time cost3.348818778991699
epoch: 256, iter: 8709, loss: 0.6974969506263733, time cost3.355198621749878
epoch: 256, iter: 8710, loss: 1.046966552734375, time cost3.3707001209259033
epoch: 256, iter: 8711, loss: 0.7471009492874146, time cost3.4045920372009277
epoch: 256, iter: 8712, loss: 0.6733583211898804, time cost3.358120918273926
epoch: 256, iter: 8713, loss: 0.8882738947868347, time cost3.3489744663238525
epoch: 256, iter: 8714, loss: 0.8981173038482666, time cost3.3671910762786865
epoch: 256, iter: 8715, loss: 0.6488975286483765, time cost3.397815704345703
epoch: 256, iter: 8716, loss: 0.444087415933609, time cost3.3618547916412354
epoch: 256, iter: 8717, loss: 0.5730610489845276, time cost3.41379451751709
epoch: 256, iter: 8718, loss: 0.5408793687820435, time cost3.357001543045044
epoch: 256, iter: 8719, loss: 0.48384496569633484, time cost3.3131649494171143
epoch: 256, iter: 8720, loss: 0.3031936287879944, time cost3.3485260009765625
epoch: 256, iter: 8721, loss: 1.1615946292877197, time cost3.390667676925659
epoch: 256, iter: 8722, loss: 0.5924893617630005, time cost3.3219499588012695
epoch: 256, iter: 8723, loss: 0.6632918119430542, time cost3.336361885070801
epoch: 256, iter: 8724, loss: 0.4144626259803772, time cost3.252506732940674
epoch: 256, iter: 8725, loss: 0.7461995482444763, time cost3.2841219902038574
epoch: 256, iter: 8726, loss: 0.4297545552253723, time cost3.3356261253356934
epoch: 256, iter: 8727, loss: 0.5164008736610413, time cost3.4743313789367676
epoch: 256, iter: 8728, loss: 0.3048780858516693, time cost3.3068809509277344
epoch: 256, iter: 8729, loss: 0.966521680355072, time cost3.331082820892334
epoch: 256, iter: 8730, loss: 0.9592905640602112, time cost3.339064598083496
epoch: 256, iter: 8731, loss: 0.9449699521064758, time cost3.1760683059692383
epoch: 256, iter: 8732, loss: 0.9523177146911621, time cost3.321211814880371
epoch: 256, iter: 8733, loss: 0.6995468735694885, time cost3.3020670413970947
epoch: 256, iter: 8734, loss: 0.5120359063148499, time cost3.2497527599334717
epoch: 256, iter: 8735, loss: 0.3236779570579529, time cost3.2847485542297363
epoch: 256, iter: 8736, loss: 0.7381445169448853, time cost3.354649066925049
epoch: 256, iter: 8737, loss: 0.5473194718360901, time cost3.3510584831237793
epoch: 256, iter: 8738, loss: 0.5032904148101807, time cost2.3836753368377686
epoch: 257, iter: 8739, loss: 0.5914350152015686, time cost3.5555951595306396
epoch: 257, iter: 8740, loss: 0.5906277298927307, time cost3.3753774166107178
epoch: 257, iter: 8741, loss: 0.6138679385185242, time cost3.2938528060913086
epoch: 257, iter: 8742, loss: 0.9003676772117615, time cost3.2139039039611816
epoch: 257, iter: 8743, loss: 0.2979626953601837, time cost3.489847421646118
epoch: 257, iter: 8744, loss: 0.5009987354278564, time cost3.393280506134033
epoch: 257, iter: 8745, loss: 0.8710678219795227, time cost3.3121068477630615
epoch: 257, iter: 8746, loss: 1.0303035974502563, time cost3.346705913543701
epoch: 257, iter: 8747, loss: 1.1236391067504883, time cost3.376847982406616
epoch: 257, iter: 8748, loss: 0.6892762184143066, time cost3.434701919555664
epoch: 257, iter: 8749, loss: 0.461470365524292, time cost3.3592231273651123
epoch: 257, iter: 8750, loss: 0.6705306172370911, time cost3.418907642364502
tensor([[ 55.,  54.,  73.,  ...,  10.,  10.,  13.],
        [ 11.,  14.,  11.,  ...,   2.,   2.,   2.],
        [ 69., 234.,  63.,  ...,   1.,   1.,   1.],
        ...,
        [ 65.,  63.,  36.,  ...,  34.,  34.,  28.],
        [  9.,   9.,   7.,  ...,   1.,   1.,   1.],
        [ 35., 146., 148.,  ...,   1.,   1.,   1.]])
Epoch: 257, Iteration: 8750:
TEST A@1: 0.48444444444444446
TEST A@5: 0.84
TEST A@10: 0.9266666666666666
TEST M@B: 0.39863428315051785
TEST M@A: 0.9562868462539617
TEST W@MB: 0.21507175840433534
TEST W@MA: 0.5914612883756851
TEST Time: 147.27839589118958
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 257, iter: 8751, loss: 0.4898682236671448, time cost3.231330394744873
epoch: 257, iter: 8752, loss: 0.3479553759098053, time cost3.150787830352783
epoch: 257, iter: 8753, loss: 0.5618839859962463, time cost3.281545639038086
epoch: 257, iter: 8754, loss: 0.704997181892395, time cost3.1605172157287598
epoch: 257, iter: 8755, loss: 0.464530885219574, time cost3.286846876144409
epoch: 257, iter: 8756, loss: 0.3706676661968231, time cost3.3712475299835205
epoch: 257, iter: 8757, loss: 0.46724504232406616, time cost3.307373285293579
epoch: 257, iter: 8758, loss: 0.6665317416191101, time cost3.3070099353790283
epoch: 257, iter: 8759, loss: 0.35113298892974854, time cost3.2895495891571045
epoch: 257, iter: 8760, loss: 0.5096312165260315, time cost3.272291660308838
epoch: 257, iter: 8761, loss: 0.6323900818824768, time cost3.4025330543518066
epoch: 257, iter: 8762, loss: 0.6541672348976135, time cost3.2853996753692627
epoch: 257, iter: 8763, loss: 0.6530196070671082, time cost3.281151056289673
epoch: 257, iter: 8764, loss: 0.5137875080108643, time cost3.2471513748168945
epoch: 257, iter: 8765, loss: 0.6465923190116882, time cost3.2830684185028076
epoch: 257, iter: 8766, loss: 0.8409184217453003, time cost3.4219777584075928
epoch: 257, iter: 8767, loss: 0.8250695466995239, time cost3.178631544113159
epoch: 257, iter: 8768, loss: 0.4979497492313385, time cost3.273327589035034
epoch: 257, iter: 8769, loss: 0.4367765188217163, time cost3.2657692432403564
epoch: 257, iter: 8770, loss: 0.47370779514312744, time cost3.3021602630615234
epoch: 257, iter: 8771, loss: 0.6419429183006287, time cost3.200756311416626
epoch: 257, iter: 8772, loss: 0.33864930272102356, time cost2.3175628185272217
epoch: 258, iter: 8773, loss: 0.6960690021514893, time cost3.33840274810791
epoch: 258, iter: 8774, loss: 0.4908972978591919, time cost3.517066478729248
epoch: 258, iter: 8775, loss: 1.6110397577285767, time cost3.4778223037719727
epoch: 258, iter: 8776, loss: 0.5098122954368591, time cost3.3628485202789307
epoch: 258, iter: 8777, loss: 0.4208788275718689, time cost3.4119739532470703
epoch: 258, iter: 8778, loss: 0.3044871389865875, time cost3.51880145072937
epoch: 258, iter: 8779, loss: 0.5964309573173523, time cost3.5420308113098145
epoch: 258, iter: 8780, loss: 0.5922057032585144, time cost3.3097527027130127
epoch: 258, iter: 8781, loss: 0.8313513994216919, time cost3.408069133758545
epoch: 258, iter: 8782, loss: 0.453730046749115, time cost3.2856028079986572
epoch: 258, iter: 8783, loss: 0.6523138880729675, time cost3.26375412940979
epoch: 258, iter: 8784, loss: 0.3371947705745697, time cost3.389453887939453
epoch: 258, iter: 8785, loss: 0.745319128036499, time cost3.389756917953491
epoch: 258, iter: 8786, loss: 0.3976665437221527, time cost3.263119697570801
epoch: 258, iter: 8787, loss: 0.3244366943836212, time cost3.4550442695617676
epoch: 258, iter: 8788, loss: 0.8771260976791382, time cost3.2868154048919678
epoch: 258, iter: 8789, loss: 0.34406059980392456, time cost3.3980467319488525
epoch: 258, iter: 8790, loss: 0.93454509973526, time cost3.4327850341796875
epoch: 258, iter: 8791, loss: 0.5686516761779785, time cost3.4254562854766846
epoch: 258, iter: 8792, loss: 0.7235295176506042, time cost3.492677927017212
epoch: 258, iter: 8793, loss: 0.8308097124099731, time cost3.5233922004699707
epoch: 258, iter: 8794, loss: 0.8438526391983032, time cost3.4307942390441895
epoch: 258, iter: 8795, loss: 0.31859466433525085, time cost3.2993173599243164
epoch: 258, iter: 8796, loss: 0.735449492931366, time cost3.3623499870300293
epoch: 258, iter: 8797, loss: 0.5966564416885376, time cost3.4014430046081543
epoch: 258, iter: 8798, loss: 0.6942076683044434, time cost3.274717330932617
epoch: 258, iter: 8799, loss: 0.3790434002876282, time cost3.6129465103149414
epoch: 258, iter: 8800, loss: 0.7800188660621643, time cost3.1975691318511963
tensor([[ 53.,  44.,  50.,  ...,   3.,   3.,   5.],
        [ 12.,  15.,  12.,  ...,   9.,   9.,   6.],
        [ 65., 176., 103.,  ...,   1.,   1.,   1.],
        ...,
        [ 69.,  69.,  49.,  ...,  12.,  12.,  11.],
        [ 50.,  49.,  15.,  ...,   1.,   1.,   1.],
        [ 60., 169., 196.,  ...,   1.,   1.,   4.]])
Epoch: 258, Iteration: 8800:
TEST A@1: 0.5666666666666667
TEST A@5: 0.8977777777777778
TEST A@10: 0.9555555555555556
TEST M@B: 0.43554192323272733
TEST M@A: 0.9603286325035114
TEST W@MB: 0.2343252423995211
TEST W@MA: 0.5942160554824218
TEST Time: 149.30127429962158
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 258, iter: 8801, loss: 0.4656965136528015, time cost3.283050537109375
epoch: 258, iter: 8802, loss: 0.5626949667930603, time cost3.160317897796631
epoch: 258, iter: 8803, loss: 0.4854918122291565, time cost3.2156434059143066
epoch: 258, iter: 8804, loss: 0.5455028414726257, time cost3.1691818237304688
epoch: 258, iter: 8805, loss: 0.6505923271179199, time cost3.2493464946746826
epoch: 258, iter: 8806, loss: 0.6250526905059814, time cost2.339036703109741
epoch: 259, iter: 8807, loss: 0.9050634503364563, time cost3.3833985328674316
epoch: 259, iter: 8808, loss: 0.9292830228805542, time cost3.383856773376465
epoch: 259, iter: 8809, loss: 0.8222588300704956, time cost3.271453380584717
epoch: 259, iter: 8810, loss: 1.3608050346374512, time cost3.2984631061553955
epoch: 259, iter: 8811, loss: 0.23044417798519135, time cost3.3325653076171875
epoch: 259, iter: 8812, loss: 0.40497109293937683, time cost3.2514193058013916
epoch: 259, iter: 8813, loss: 0.4963647723197937, time cost3.3387973308563232
epoch: 259, iter: 8814, loss: 0.4335237145423889, time cost3.3449480533599854
epoch: 259, iter: 8815, loss: 0.6377936601638794, time cost3.384192705154419
epoch: 259, iter: 8816, loss: 0.44127967953681946, time cost3.3460588455200195
epoch: 259, iter: 8817, loss: 0.8875160813331604, time cost3.4978513717651367
epoch: 259, iter: 8818, loss: 0.48247358202934265, time cost3.316037178039551
epoch: 259, iter: 8819, loss: 0.40056970715522766, time cost3.3860795497894287
epoch: 259, iter: 8820, loss: 0.8372365832328796, time cost3.2470920085906982
epoch: 259, iter: 8821, loss: 0.8458963632583618, time cost3.248018741607666
epoch: 259, iter: 8822, loss: 0.9013195633888245, time cost3.3605592250823975
epoch: 259, iter: 8823, loss: 0.9269614219665527, time cost3.3851118087768555
epoch: 259, iter: 8824, loss: 0.692028820514679, time cost3.3058831691741943
epoch: 259, iter: 8825, loss: 0.5534164309501648, time cost3.4285202026367188
epoch: 259, iter: 8826, loss: 0.6571762561798096, time cost3.436469316482544
epoch: 259, iter: 8827, loss: 0.5504767894744873, time cost3.2581000328063965
epoch: 259, iter: 8828, loss: 0.8081316351890564, time cost3.357832908630371
epoch: 259, iter: 8829, loss: 1.0933538675308228, time cost2.8231217861175537
epoch: 259, iter: 8830, loss: 0.5814238786697388, time cost2.817333936691284
epoch: 259, iter: 8831, loss: 0.8958033323287964, time cost2.886168956756592
epoch: 259, iter: 8832, loss: 0.5675340890884399, time cost3.934279203414917
epoch: 259, iter: 8833, loss: 0.6075791120529175, time cost3.9309988021850586
epoch: 259, iter: 8834, loss: 0.40260380506515503, time cost3.853642463684082
epoch: 259, iter: 8835, loss: 0.5591256618499756, time cost3.5804030895233154
epoch: 259, iter: 8836, loss: 0.7399727702140808, time cost3.8085458278656006
epoch: 259, iter: 8837, loss: 0.6151875853538513, time cost3.531712770462036
epoch: 259, iter: 8838, loss: 0.35907456278800964, time cost3.768458366394043
epoch: 259, iter: 8839, loss: 0.9213941097259521, time cost3.4968361854553223
epoch: 259, iter: 8840, loss: 0.6773855686187744, time cost2.875506639480591
epoch: 260, iter: 8841, loss: 0.8199449181556702, time cost3.506953477859497
epoch: 260, iter: 8842, loss: 0.6145410537719727, time cost3.527134656906128
epoch: 260, iter: 8843, loss: 0.6215036511421204, time cost3.5862538814544678
epoch: 260, iter: 8844, loss: 1.270569920539856, time cost3.6416826248168945
epoch: 260, iter: 8845, loss: 1.1117221117019653, time cost3.784707546234131
epoch: 260, iter: 8846, loss: 0.5321587920188904, time cost3.604830026626587
epoch: 260, iter: 8847, loss: 0.7942602038383484, time cost3.7058730125427246
epoch: 260, iter: 8848, loss: 0.7378590703010559, time cost2.9113755226135254
epoch: 260, iter: 8849, loss: 1.4594030380249023, time cost3.5064616203308105
epoch: 260, iter: 8850, loss: 0.9035852551460266, time cost3.3337838649749756
tensor([[ 62.,  47.,  55.,  ...,   5.,   5.,   6.],
        [ 26.,  24.,  24.,  ...,   7.,   7.,   4.],
        [153., 304., 172.,  ...,  10.,  10.,   5.],
        ...,
        [ 75.,  69.,  47.,  ...,  18.,  18.,   8.],
        [ 34.,  32.,   6.,  ...,   1.,   1.,   1.],
        [ 86., 217., 256.,  ...,   1.,   1.,   2.]])
Epoch: 260, Iteration: 8850:
TEST A@1: 0.5333333333333333
TEST A@5: 0.8933333333333333
TEST A@10: 0.9488888888888889
TEST M@B: 0.4298938870098511
TEST M@A: 0.9595612123004856
TEST W@MB: 0.231903853240083
TEST W@MA: 0.5936663094609426
TEST Time: 132.02368879318237
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 260, iter: 8851, loss: 0.8879750370979309, time cost3.279137372970581
epoch: 260, iter: 8852, loss: 0.26561012864112854, time cost3.2356839179992676
epoch: 260, iter: 8853, loss: 0.6269267201423645, time cost3.1330320835113525
epoch: 260, iter: 8854, loss: 0.24999673664569855, time cost3.327371835708618
epoch: 260, iter: 8855, loss: 0.8557735085487366, time cost3.2338128089904785
epoch: 260, iter: 8856, loss: 0.6501267552375793, time cost3.2084832191467285
epoch: 260, iter: 8857, loss: 0.8300115466117859, time cost3.2226297855377197
epoch: 260, iter: 8858, loss: 1.1293805837631226, time cost3.2979977130889893
epoch: 260, iter: 8859, loss: 0.23213531076908112, time cost3.349774122238159
epoch: 260, iter: 8860, loss: 0.5793958306312561, time cost3.2091431617736816
epoch: 260, iter: 8861, loss: 0.6356276273727417, time cost3.3810460567474365
epoch: 260, iter: 8862, loss: 0.7115007042884827, time cost3.2457938194274902
epoch: 260, iter: 8863, loss: 0.5653440356254578, time cost3.27494215965271
epoch: 260, iter: 8864, loss: 0.7486003041267395, time cost3.222912311553955
epoch: 260, iter: 8865, loss: 0.4641420245170593, time cost3.1881322860717773
epoch: 260, iter: 8866, loss: 0.8919661045074463, time cost3.552091121673584
epoch: 260, iter: 8867, loss: 0.998015284538269, time cost3.3210690021514893
epoch: 260, iter: 8868, loss: 0.523237407207489, time cost3.323158025741577
epoch: 260, iter: 8869, loss: 0.5560564994812012, time cost3.4835290908813477
epoch: 260, iter: 8870, loss: 0.5483047962188721, time cost3.426295518875122
epoch: 260, iter: 8871, loss: 0.46607300639152527, time cost3.1276493072509766
epoch: 260, iter: 8872, loss: 0.4557546079158783, time cost3.109905242919922
epoch: 260, iter: 8873, loss: 1.5401617288589478, time cost3.1314375400543213
epoch: 260, iter: 8874, loss: 0.24276593327522278, time cost2.2814390659332275
epoch: 261, iter: 8875, loss: 0.43037471175193787, time cost3.4371225833892822
epoch: 261, iter: 8876, loss: 0.49869105219841003, time cost3.305732250213623
epoch: 261, iter: 8877, loss: 0.4953668415546417, time cost3.2729597091674805
epoch: 261, iter: 8878, loss: 0.4863646626472473, time cost3.4346351623535156
epoch: 261, iter: 8879, loss: 0.6459292769432068, time cost3.2796719074249268
epoch: 261, iter: 8880, loss: 0.6799096465110779, time cost3.2940731048583984
epoch: 261, iter: 8881, loss: 0.8410554528236389, time cost3.4802262783050537
epoch: 261, iter: 8882, loss: 0.7460268139839172, time cost3.3433761596679688
epoch: 261, iter: 8883, loss: 0.894290566444397, time cost3.2320733070373535
epoch: 261, iter: 8884, loss: 0.5845961570739746, time cost3.2378807067871094
epoch: 261, iter: 8885, loss: 0.8665019869804382, time cost3.2473623752593994
epoch: 261, iter: 8886, loss: 0.39730674028396606, time cost3.1791832447052
epoch: 261, iter: 8887, loss: 0.9563231468200684, time cost3.3965630531311035
epoch: 261, iter: 8888, loss: 0.9933065176010132, time cost3.390678644180298
epoch: 261, iter: 8889, loss: 0.649652898311615, time cost3.241971015930176
epoch: 261, iter: 8890, loss: 0.43275174498558044, time cost3.3105266094207764
epoch: 261, iter: 8891, loss: 0.8585317134857178, time cost3.3173086643218994
epoch: 261, iter: 8892, loss: 0.5346246957778931, time cost3.284940481185913
epoch: 261, iter: 8893, loss: 0.4652498960494995, time cost3.2603566646575928
epoch: 261, iter: 8894, loss: 0.5001687407493591, time cost3.4284372329711914
epoch: 261, iter: 8895, loss: 0.7203369140625, time cost3.318450689315796
epoch: 261, iter: 8896, loss: 0.659614086151123, time cost3.1879994869232178
epoch: 261, iter: 8897, loss: 0.3767685890197754, time cost3.2548022270202637
epoch: 261, iter: 8898, loss: 0.7295090556144714, time cost3.2101693153381348
epoch: 261, iter: 8899, loss: 1.0776822566986084, time cost3.240596055984497
epoch: 261, iter: 8900, loss: 1.051476001739502, time cost3.145097494125366
tensor([[ 45.,  36.,  36.,  ...,   2.,   2.,   3.],
        [ 22.,  20.,  19.,  ...,   8.,   8.,   3.],
        [130., 314., 146.,  ...,   1.,   1.,   1.],
        ...,
        [ 58.,  55.,  46.,  ...,  10.,  10.,   4.],
        [ 37.,  40.,  11.,  ...,   1.,   1.,   1.],
        [ 29.,  89.,  90.,  ...,   2.,   2.,   2.]])
Epoch: 261, Iteration: 8900:
TEST A@1: 0.54
TEST A@5: 0.8911111111111111
TEST A@10: 0.9622222222222222
TEST M@B: 0.4396655880463229
TEST M@A: 0.9622973810603753
TEST W@MB: 0.23699816283120373
TEST W@MA: 0.5959421395965869
TEST Time: 117.67801880836487
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 261, iter: 8901, loss: 0.6289293169975281, time cost3.1418533325195312
epoch: 261, iter: 8902, loss: 0.5149592757225037, time cost3.1433658599853516
epoch: 261, iter: 8903, loss: 0.6816525459289551, time cost3.0945403575897217
epoch: 261, iter: 8904, loss: 0.6269262433052063, time cost3.184471368789673
epoch: 261, iter: 8905, loss: 0.5650519728660583, time cost3.15968656539917
epoch: 261, iter: 8906, loss: 0.3603561818599701, time cost3.13955020904541
epoch: 261, iter: 8907, loss: 1.0277670621871948, time cost3.209333896636963
epoch: 261, iter: 8908, loss: 0.5609254240989685, time cost2.2726035118103027
epoch: 262, iter: 8909, loss: 0.7365943193435669, time cost3.444770097732544
epoch: 262, iter: 8910, loss: 0.6621654629707336, time cost3.2892940044403076
epoch: 262, iter: 8911, loss: 0.3456784784793854, time cost3.242600202560425
epoch: 262, iter: 8912, loss: 0.3862595558166504, time cost3.3050334453582764
epoch: 262, iter: 8913, loss: 0.6241872310638428, time cost3.3148956298828125
epoch: 262, iter: 8914, loss: 0.43979597091674805, time cost3.3768632411956787
epoch: 262, iter: 8915, loss: 0.7137103080749512, time cost3.3573720455169678
epoch: 262, iter: 8916, loss: 0.5445196628570557, time cost3.2329604625701904
epoch: 262, iter: 8917, loss: 0.45212259888648987, time cost3.141263246536255
epoch: 262, iter: 8918, loss: 0.6113090515136719, time cost3.2840261459350586
epoch: 262, iter: 8919, loss: 0.39810457825660706, time cost3.3261399269104004
epoch: 262, iter: 8920, loss: 0.8095815181732178, time cost3.2016241550445557
epoch: 262, iter: 8921, loss: 0.44232046604156494, time cost3.3419299125671387
epoch: 262, iter: 8922, loss: 0.6955894827842712, time cost3.1467490196228027
epoch: 262, iter: 8923, loss: 0.866578996181488, time cost3.310839891433716
epoch: 262, iter: 8924, loss: 0.8619849681854248, time cost3.333054780960083
epoch: 262, iter: 8925, loss: 0.5800512433052063, time cost3.2895431518554688
epoch: 262, iter: 8926, loss: 0.5987412333488464, time cost3.2169628143310547
epoch: 262, iter: 8927, loss: 0.9317338466644287, time cost3.2501490116119385
epoch: 262, iter: 8928, loss: 0.4718872606754303, time cost3.3293657302856445
epoch: 262, iter: 8929, loss: 0.36691033840179443, time cost3.241345167160034
epoch: 262, iter: 8930, loss: 0.5548390746116638, time cost3.1985697746276855
epoch: 262, iter: 8931, loss: 1.1853446960449219, time cost3.1646344661712646
epoch: 262, iter: 8932, loss: 0.6937838792800903, time cost3.1250550746917725
epoch: 262, iter: 8933, loss: 0.843493640422821, time cost3.2293355464935303
epoch: 262, iter: 8934, loss: 0.8479709029197693, time cost3.2747809886932373
epoch: 262, iter: 8935, loss: 0.5392749309539795, time cost3.262695074081421
epoch: 262, iter: 8936, loss: 0.36321669816970825, time cost3.1489763259887695
epoch: 262, iter: 8937, loss: 0.7708238363265991, time cost3.2586958408355713
epoch: 262, iter: 8938, loss: 1.0675355195999146, time cost3.1542556285858154
epoch: 262, iter: 8939, loss: 0.7408424615859985, time cost3.215513229370117
epoch: 262, iter: 8940, loss: 0.4707847237586975, time cost3.2225728034973145
epoch: 262, iter: 8941, loss: 0.9995161294937134, time cost3.1551215648651123
epoch: 262, iter: 8942, loss: 0.5844085812568665, time cost2.300070285797119
epoch: 263, iter: 8943, loss: 0.4680519104003906, time cost3.2936525344848633
epoch: 263, iter: 8944, loss: 0.6277360916137695, time cost3.189725875854492
epoch: 263, iter: 8945, loss: 0.2853650152683258, time cost3.359910488128662
epoch: 263, iter: 8946, loss: 0.8811980485916138, time cost3.2914462089538574
epoch: 263, iter: 8947, loss: 0.5545994639396667, time cost3.249903440475464
epoch: 263, iter: 8948, loss: 0.584065318107605, time cost3.376514196395874
epoch: 263, iter: 8949, loss: 0.5576754212379456, time cost3.2974328994750977
epoch: 263, iter: 8950, loss: 0.3764110505580902, time cost3.2686455249786377
tensor([[111.,  62.,  68.,  ...,   7.,   7.,   6.],
        [  9.,  10.,   9.,  ...,  10.,  10.,   5.],
        [165., 371., 185.,  ...,  14.,  14.,   8.],
        ...,
        [ 35.,  39.,  20.,  ...,   8.,   8.,   3.],
        [  9.,   7.,   6.,  ...,   1.,   1.,   1.],
        [ 59., 130., 165.,  ...,   3.,   3.,   6.]])
Epoch: 263, Iteration: 8950:
TEST A@1: 0.40444444444444444
TEST A@5: 0.7977777777777778
TEST A@10: 0.9022222222222223
TEST M@B: 0.3648670036498528
TEST M@A: 0.9550848100693926
TEST W@MB: 0.19742554850822017
TEST W@MA: 0.5903380827174786
TEST Time: 125.72112560272217
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 263, iter: 8951, loss: 0.796518087387085, time cost3.1979124546051025
epoch: 263, iter: 8952, loss: 1.2253358364105225, time cost3.2816476821899414
epoch: 263, iter: 8953, loss: 0.6610248684883118, time cost3.3453850746154785
epoch: 263, iter: 8954, loss: 0.6227469444274902, time cost3.1698668003082275
epoch: 263, iter: 8955, loss: 0.7556220889091492, time cost3.2206485271453857
epoch: 263, iter: 8956, loss: 0.5932435393333435, time cost3.3289973735809326
epoch: 263, iter: 8957, loss: 0.4459335207939148, time cost3.2696876525878906
epoch: 263, iter: 8958, loss: 0.9600203037261963, time cost3.2394003868103027
epoch: 263, iter: 8959, loss: 0.7399570941925049, time cost3.1566731929779053
epoch: 263, iter: 8960, loss: 0.670689582824707, time cost3.4771289825439453
epoch: 263, iter: 8961, loss: 0.4339347779750824, time cost3.1122591495513916
epoch: 263, iter: 8962, loss: 0.2966289222240448, time cost3.04921555519104
epoch: 263, iter: 8963, loss: 0.6960234642028809, time cost2.7763874530792236
epoch: 263, iter: 8964, loss: 0.6127166748046875, time cost2.7903621196746826
epoch: 263, iter: 8965, loss: 0.7963403463363647, time cost2.7726707458496094
epoch: 263, iter: 8966, loss: 0.6226334571838379, time cost3.246206045150757
epoch: 263, iter: 8967, loss: 0.5970537066459656, time cost4.444345235824585
epoch: 263, iter: 8968, loss: 0.655847430229187, time cost3.8102879524230957
epoch: 263, iter: 8969, loss: 0.8747777342796326, time cost3.6385533809661865
epoch: 263, iter: 8970, loss: 0.5270829200744629, time cost3.2307016849517822
epoch: 263, iter: 8971, loss: 0.6522555351257324, time cost3.5166525840759277
epoch: 263, iter: 8972, loss: 0.8117982745170593, time cost3.370368719100952
epoch: 263, iter: 8973, loss: 0.8003875017166138, time cost3.683155059814453
epoch: 263, iter: 8974, loss: 0.40307730436325073, time cost3.116086483001709
epoch: 263, iter: 8975, loss: 0.43297678232192993, time cost3.2791748046875
epoch: 263, iter: 8976, loss: 0.5017760992050171, time cost2.4332778453826904
epoch: 264, iter: 8977, loss: 0.7353729605674744, time cost3.62998104095459
epoch: 264, iter: 8978, loss: 0.6264785528182983, time cost3.7734265327453613
epoch: 264, iter: 8979, loss: 1.065679669380188, time cost3.7184383869171143
epoch: 264, iter: 8980, loss: 0.5958269238471985, time cost3.4762074947357178
epoch: 264, iter: 8981, loss: 0.7272131443023682, time cost3.641371488571167
epoch: 264, iter: 8982, loss: 0.6724096536636353, time cost3.6417009830474854
epoch: 264, iter: 8983, loss: 0.8189643025398254, time cost3.241959810256958
epoch: 264, iter: 8984, loss: 0.8442755341529846, time cost2.832195997238159
epoch: 264, iter: 8985, loss: 0.5376213192939758, time cost3.2065770626068115
epoch: 264, iter: 8986, loss: 0.5110086798667908, time cost3.414491653442383
epoch: 264, iter: 8987, loss: 0.45237860083580017, time cost3.3675992488861084
epoch: 264, iter: 8988, loss: 0.39788249135017395, time cost3.378807544708252
epoch: 264, iter: 8989, loss: 0.28902408480644226, time cost3.344926357269287
epoch: 264, iter: 8990, loss: 1.0212445259094238, time cost3.3431715965270996
epoch: 264, iter: 8991, loss: 0.5346789360046387, time cost3.2818877696990967
epoch: 264, iter: 8992, loss: 0.25471892952919006, time cost3.33390212059021
epoch: 264, iter: 8993, loss: 0.4768904149532318, time cost3.4336423873901367
epoch: 264, iter: 8994, loss: 0.6312534213066101, time cost3.3299670219421387
epoch: 264, iter: 8995, loss: 1.0707051753997803, time cost3.439995288848877
epoch: 264, iter: 8996, loss: 0.642214298248291, time cost3.2958850860595703
epoch: 264, iter: 8997, loss: 0.23931388556957245, time cost3.4959423542022705
epoch: 264, iter: 8998, loss: 0.5946410298347473, time cost3.372112274169922
epoch: 264, iter: 8999, loss: 0.7262716889381409, time cost3.2716503143310547
epoch: 264, iter: 9000, loss: 0.471579372882843, time cost3.560901165008545
tensor([[ 27.,  25.,  26.,  ...,   2.,   2.,   2.],
        [ 38.,  30.,  26.,  ...,   9.,   9.,   4.],
        [111., 298., 123.,  ...,   2.,   2.,   1.],
        ...,
        [ 45.,  43.,  28.,  ...,   4.,   4.,   2.],
        [ 40.,  37.,  15.,  ...,   1.,   1.,   1.],
        [ 67., 112., 121.,  ...,   2.,   2.,   3.]])
Epoch: 264, Iteration: 9000:
TEST A@1: 0.5444444444444444
TEST A@5: 0.8911111111111111
TEST A@10: 0.9555555555555556
TEST M@B: 0.4315386492247373
TEST M@A: 0.9599980209766636
TEST W@MB: 0.23253906303820457
TEST W@MA: 0.594194245552333
TEST Time: 110.11200284957886
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 264, iter: 9001, loss: 0.6872835755348206, time cost3.2450778484344482
epoch: 264, iter: 9002, loss: 0.4369812607765198, time cost3.175525665283203
epoch: 264, iter: 9003, loss: 0.5093865394592285, time cost3.2979531288146973
epoch: 264, iter: 9004, loss: 0.790894091129303, time cost3.405207395553589
epoch: 264, iter: 9005, loss: 0.9161192774772644, time cost3.3460469245910645
epoch: 264, iter: 9006, loss: 0.530038595199585, time cost3.321927785873413
epoch: 264, iter: 9007, loss: 0.6023088693618774, time cost3.30117130279541
epoch: 264, iter: 9008, loss: 0.4018994867801666, time cost3.2975950241088867
epoch: 264, iter: 9009, loss: 0.9331826567649841, time cost3.34236216545105
epoch: 264, iter: 9010, loss: 0.5345714092254639, time cost2.423905849456787
epoch: 265, iter: 9011, loss: 0.5641104578971863, time cost3.3775010108947754
epoch: 265, iter: 9012, loss: 0.763419508934021, time cost3.2964155673980713
epoch: 265, iter: 9013, loss: 0.9975100755691528, time cost3.294865608215332
epoch: 265, iter: 9014, loss: 1.2293721437454224, time cost3.143988847732544
epoch: 265, iter: 9015, loss: 0.3119928538799286, time cost3.2319397926330566
epoch: 265, iter: 9016, loss: 0.6142845749855042, time cost3.198293924331665
epoch: 265, iter: 9017, loss: 0.9570738673210144, time cost3.2713048458099365
epoch: 265, iter: 9018, loss: 0.6575427055358887, time cost3.1747326850891113
epoch: 265, iter: 9019, loss: 0.6828951239585876, time cost3.35011887550354
epoch: 265, iter: 9020, loss: 0.6591877937316895, time cost3.0972423553466797
epoch: 265, iter: 9021, loss: 0.616086483001709, time cost3.24417781829834
epoch: 265, iter: 9022, loss: 0.3313927948474884, time cost3.1769471168518066
epoch: 265, iter: 9023, loss: 0.3996812403202057, time cost3.2094833850860596
epoch: 265, iter: 9024, loss: 0.7765842080116272, time cost3.3672661781311035
epoch: 265, iter: 9025, loss: 0.6137558817863464, time cost3.1965739727020264
epoch: 265, iter: 9026, loss: 0.46003371477127075, time cost3.3636465072631836
epoch: 265, iter: 9027, loss: 1.055528998374939, time cost3.406214475631714
epoch: 265, iter: 9028, loss: 0.7203016877174377, time cost3.28595232963562
epoch: 265, iter: 9029, loss: 0.4251421391963959, time cost3.3103253841400146
epoch: 265, iter: 9030, loss: 0.5469643473625183, time cost3.254918336868286
epoch: 265, iter: 9031, loss: 0.8008455634117126, time cost3.4007623195648193
epoch: 265, iter: 9032, loss: 0.3987467885017395, time cost3.2545039653778076
epoch: 265, iter: 9033, loss: 0.4263524115085602, time cost3.261979818344116
epoch: 265, iter: 9034, loss: 0.7479773759841919, time cost3.362607479095459
epoch: 265, iter: 9035, loss: 0.6672062873840332, time cost3.2723023891448975
epoch: 265, iter: 9036, loss: 0.5957666039466858, time cost3.4302518367767334
epoch: 265, iter: 9037, loss: 0.8072192668914795, time cost3.2233848571777344
epoch: 265, iter: 9038, loss: 0.5368780493736267, time cost3.1741199493408203
epoch: 265, iter: 9039, loss: 0.8613859415054321, time cost3.567826747894287
epoch: 265, iter: 9040, loss: 0.724628210067749, time cost3.5987703800201416
epoch: 265, iter: 9041, loss: 0.6187257170677185, time cost3.287111520767212
epoch: 265, iter: 9042, loss: 0.7081716656684875, time cost3.172233819961548
epoch: 265, iter: 9043, loss: 0.7364345192909241, time cost3.1440582275390625
epoch: 265, iter: 9044, loss: 0.4217991232872009, time cost2.2859244346618652
epoch: 266, iter: 9045, loss: 1.1085273027420044, time cost3.474599599838257
epoch: 266, iter: 9046, loss: 0.9212409257888794, time cost3.234844207763672
epoch: 266, iter: 9047, loss: 0.8769035339355469, time cost3.4285831451416016
epoch: 266, iter: 9048, loss: 0.32914066314697266, time cost3.5424416065216064
epoch: 266, iter: 9049, loss: 0.545460045337677, time cost3.546168327331543
epoch: 266, iter: 9050, loss: 0.40259987115859985, time cost3.596879720687866
tensor([[ 24.,  22.,  29.,  ...,   4.,   4.,   2.],
        [ 55.,  49.,  46.,  ...,  11.,  11.,   5.],
        [132., 319., 101.,  ...,   1.,   1.,   1.],
        ...,
        [ 70.,  65.,  38.,  ...,  18.,  18.,  15.],
        [ 25.,  31.,  10.,  ...,   1.,   1.,   1.],
        [114., 208., 229.,  ...,   4.,   4.,   6.]])
Epoch: 266, Iteration: 9050:
TEST A@1: 0.5644444444444444
TEST A@5: 0.8688888888888889
TEST A@10: 0.9444444444444444
TEST M@B: 0.43942508693302706
TEST M@A: 0.959259377590085
TEST W@MB: 0.2375875036995431
TEST W@MA: 0.59366609089633
TEST Time: 104.9862151145935
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 266, iter: 9051, loss: 0.6437197327613831, time cost3.1520323753356934
epoch: 266, iter: 9052, loss: 0.790378987789154, time cost3.1314697265625
epoch: 266, iter: 9053, loss: 0.48434990644454956, time cost3.082646369934082
epoch: 266, iter: 9054, loss: 0.7759060263633728, time cost3.3113906383514404
epoch: 266, iter: 9055, loss: 0.2927780747413635, time cost3.136876106262207
epoch: 266, iter: 9056, loss: 1.435762643814087, time cost3.312525749206543
epoch: 266, iter: 9057, loss: 0.48889923095703125, time cost3.207674264907837
epoch: 266, iter: 9058, loss: 0.4971648156642914, time cost3.3416714668273926
epoch: 266, iter: 9059, loss: 0.6803527474403381, time cost3.223024368286133
epoch: 266, iter: 9060, loss: 0.6474232077598572, time cost3.307234764099121
epoch: 266, iter: 9061, loss: 0.5740466117858887, time cost3.4032986164093018
epoch: 266, iter: 9062, loss: 0.5506923198699951, time cost3.530853033065796
epoch: 266, iter: 9063, loss: 0.8414146304130554, time cost3.8359317779541016
epoch: 266, iter: 9064, loss: 0.9177067875862122, time cost3.1947546005249023
epoch: 266, iter: 9065, loss: 0.6071698069572449, time cost3.216938018798828
epoch: 266, iter: 9066, loss: 1.0410469770431519, time cost3.3576290607452393
epoch: 266, iter: 9067, loss: 0.5667261481285095, time cost3.5189924240112305
epoch: 266, iter: 9068, loss: 0.5496203899383545, time cost3.5019805431365967
epoch: 266, iter: 9069, loss: 0.40196359157562256, time cost3.2137973308563232
epoch: 266, iter: 9070, loss: 0.8824421763420105, time cost3.1960225105285645
epoch: 266, iter: 9071, loss: 0.6034579277038574, time cost3.195599317550659
epoch: 266, iter: 9072, loss: 0.6843191981315613, time cost3.329040050506592
epoch: 266, iter: 9073, loss: 0.27773141860961914, time cost3.2698867321014404
epoch: 266, iter: 9074, loss: 1.0626726150512695, time cost3.132622480392456
epoch: 266, iter: 9075, loss: 0.5794481039047241, time cost3.3528337478637695
epoch: 266, iter: 9076, loss: 1.01475191116333, time cost3.444458484649658
epoch: 266, iter: 9077, loss: 0.4970934987068176, time cost3.221461057662964
epoch: 266, iter: 9078, loss: 0.4858883023262024, time cost2.3875057697296143
epoch: 267, iter: 9079, loss: 0.6794434785842896, time cost3.370884656906128
epoch: 267, iter: 9080, loss: 0.7229835987091064, time cost3.327873945236206
epoch: 267, iter: 9081, loss: 0.7271827459335327, time cost3.2168474197387695
epoch: 267, iter: 9082, loss: 0.6791439652442932, time cost3.3154141902923584
epoch: 267, iter: 9083, loss: 0.5671140551567078, time cost3.2594504356384277
epoch: 267, iter: 9084, loss: 0.7864845991134644, time cost3.203428030014038
epoch: 267, iter: 9085, loss: 1.099325180053711, time cost3.1415188312530518
epoch: 267, iter: 9086, loss: 1.1697173118591309, time cost3.137585163116455
epoch: 267, iter: 9087, loss: 0.5880078673362732, time cost3.199033260345459
epoch: 267, iter: 9088, loss: 0.32285958528518677, time cost3.305330514907837
epoch: 267, iter: 9089, loss: 0.6001529097557068, time cost3.0893001556396484
epoch: 267, iter: 9090, loss: 0.5448390245437622, time cost3.3100426197052
epoch: 267, iter: 9091, loss: 0.7288525104522705, time cost3.1401233673095703
epoch: 267, iter: 9092, loss: 0.7025508880615234, time cost3.1869752407073975
epoch: 267, iter: 9093, loss: 0.4386681914329529, time cost3.2262415885925293
epoch: 267, iter: 9094, loss: 0.5889574289321899, time cost3.1744587421417236
epoch: 267, iter: 9095, loss: 0.5689290165901184, time cost3.1763648986816406
epoch: 267, iter: 9096, loss: 0.711300253868103, time cost3.2081997394561768
epoch: 267, iter: 9097, loss: 0.38205835223197937, time cost3.2192156314849854
epoch: 267, iter: 9098, loss: 0.657903254032135, time cost3.154982089996338
epoch: 267, iter: 9099, loss: 0.7863315343856812, time cost3.269052743911743
epoch: 267, iter: 9100, loss: 0.5044994354248047, time cost3.137449264526367
tensor([[ 77.,  64.,  78.,  ...,   3.,   3.,   2.],
        [ 46.,  40.,  35.,  ...,   8.,   8.,   5.],
        [107., 276.,  77.,  ...,   2.,   2.,   1.],
        ...,
        [ 58.,  56.,  23.,  ...,  25.,  25.,  13.],
        [ 13.,  15.,   3.,  ...,   1.,   1.,   1.],
        [119., 216., 208.,  ...,   3.,   3.,   4.]])
Epoch: 267, Iteration: 9100:
TEST A@1: 0.5333333333333333
TEST A@5: 0.8844444444444445
TEST A@10: 0.9488888888888889
TEST M@B: 0.42350038698177095
TEST M@A: 0.9584870794421979
TEST W@MB: 0.22777004884432425
TEST W@MA: 0.5929227547219327
TEST Time: 94.65771174430847
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 267, iter: 9101, loss: 0.7288061380386353, time cost3.326450824737549
epoch: 267, iter: 9102, loss: 0.5343747735023499, time cost3.0961251258850098
epoch: 267, iter: 9103, loss: 0.7728272676467896, time cost3.3811769485473633
epoch: 267, iter: 9104, loss: 0.6215041875839233, time cost3.0507545471191406
epoch: 267, iter: 9105, loss: 0.687075138092041, time cost3.294013738632202
epoch: 267, iter: 9106, loss: 0.3604511022567749, time cost3.1065430641174316
epoch: 267, iter: 9107, loss: 0.7686411142349243, time cost3.084970712661743
epoch: 267, iter: 9108, loss: 0.8766419887542725, time cost3.192307233810425
epoch: 267, iter: 9109, loss: 0.6349042654037476, time cost3.221734046936035
epoch: 267, iter: 9110, loss: 0.278958261013031, time cost3.1369359493255615
epoch: 267, iter: 9111, loss: 0.5080366134643555, time cost2.9457108974456787
epoch: 267, iter: 9112, loss: 0.47955459356307983, time cost2.312978744506836
epoch: 268, iter: 9113, loss: 0.6732795834541321, time cost3.615189552307129
epoch: 268, iter: 9114, loss: 0.8510266542434692, time cost3.2036564350128174
epoch: 268, iter: 9115, loss: 0.8692963719367981, time cost3.2726805210113525
epoch: 268, iter: 9116, loss: 0.38002127408981323, time cost3.2813189029693604
epoch: 268, iter: 9117, loss: 0.8243509531021118, time cost3.5073609352111816
epoch: 268, iter: 9118, loss: 0.893666684627533, time cost3.303288698196411
epoch: 268, iter: 9119, loss: 0.42101502418518066, time cost3.316164970397949
epoch: 268, iter: 9120, loss: 0.6737877726554871, time cost4.550878286361694
epoch: 268, iter: 9121, loss: 0.4478566646575928, time cost3.491593599319458
epoch: 268, iter: 9122, loss: 0.6955154538154602, time cost3.1965484619140625
epoch: 268, iter: 9123, loss: 0.386638879776001, time cost2.863208293914795
epoch: 268, iter: 9124, loss: 0.5663769841194153, time cost3.5612874031066895
epoch: 268, iter: 9125, loss: 0.5129339694976807, time cost3.245745897293091
epoch: 268, iter: 9126, loss: 1.5489720106124878, time cost3.3170831203460693
epoch: 268, iter: 9127, loss: 0.5806547999382019, time cost3.1959521770477295
epoch: 268, iter: 9128, loss: 0.9969851970672607, time cost3.11672306060791
epoch: 268, iter: 9129, loss: 0.7032046914100647, time cost3.1825520992279053
epoch: 268, iter: 9130, loss: 0.3223896324634552, time cost3.158888578414917
epoch: 268, iter: 9131, loss: 0.4902951419353485, time cost3.1298227310180664
epoch: 268, iter: 9132, loss: 0.4842309355735779, time cost3.0404646396636963
epoch: 268, iter: 9133, loss: 0.6286289691925049, time cost3.311171531677246
epoch: 268, iter: 9134, loss: 0.7613362073898315, time cost3.097959518432617
epoch: 268, iter: 9135, loss: 1.1872936487197876, time cost3.21492600440979
epoch: 268, iter: 9136, loss: 0.27208831906318665, time cost3.200482130050659
epoch: 268, iter: 9137, loss: 0.6394028067588806, time cost3.1325130462646484
epoch: 268, iter: 9138, loss: 0.6110886335372925, time cost3.506403684616089
epoch: 268, iter: 9139, loss: 0.43317827582359314, time cost3.156184196472168
epoch: 268, iter: 9140, loss: 0.5261356234550476, time cost3.088994026184082
epoch: 268, iter: 9141, loss: 1.0551265478134155, time cost3.1215786933898926
epoch: 268, iter: 9142, loss: 0.8679047226905823, time cost3.1919758319854736
epoch: 268, iter: 9143, loss: 0.6401018500328064, time cost3.0937912464141846
epoch: 268, iter: 9144, loss: 1.091426134109497, time cost3.231182098388672
epoch: 268, iter: 9145, loss: 0.6231480240821838, time cost3.120457887649536
epoch: 268, iter: 9146, loss: 0.7850824594497681, time cost2.2507071495056152
epoch: 269, iter: 9147, loss: 0.8080779910087585, time cost3.4136881828308105
epoch: 269, iter: 9148, loss: 0.5516412258148193, time cost3.398902416229248
epoch: 269, iter: 9149, loss: 0.4663392901420593, time cost3.2191805839538574
epoch: 269, iter: 9150, loss: 0.47618603706359863, time cost3.3183069229125977
tensor([[159., 139., 149.,  ...,  21.,  21.,  15.],
        [ 16.,  12.,  11.,  ...,   9.,   9.,   5.],
        [114., 368., 160.,  ...,   5.,   5.,   3.],
        ...,
        [ 38.,  39.,  31.,  ...,   8.,   8.,   2.],
        [ 16.,  26.,  13.,  ...,   1.,   1.,   1.],
        [ 45., 121., 115.,  ...,   3.,   3.,   2.]])
Epoch: 269, Iteration: 9150:
TEST A@1: 0.5266666666666666
TEST A@5: 0.8444444444444444
TEST A@10: 0.94
TEST M@B: 0.4077414729631077
TEST M@A: 0.9585513494207286
TEST W@MB: 0.22018262682890216
TEST W@MA: 0.5931142478257279
TEST Time: 104.23963928222656
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 269, iter: 9151, loss: 0.3264659643173218, time cost3.086207151412964
epoch: 269, iter: 9152, loss: 0.43008723855018616, time cost3.1185531616210938
epoch: 269, iter: 9153, loss: 0.28485310077667236, time cost3.1843831539154053
epoch: 269, iter: 9154, loss: 0.44235658645629883, time cost3.234701633453369
epoch: 269, iter: 9155, loss: 0.5094672441482544, time cost3.219491958618164
epoch: 269, iter: 9156, loss: 0.8662258386611938, time cost3.1646530628204346
epoch: 269, iter: 9157, loss: 0.7156026363372803, time cost3.210559368133545
epoch: 269, iter: 9158, loss: 1.1475847959518433, time cost3.1647114753723145
epoch: 269, iter: 9159, loss: 0.5209164619445801, time cost3.1970858573913574
epoch: 269, iter: 9160, loss: 1.0083717107772827, time cost3.2192444801330566
epoch: 269, iter: 9161, loss: 1.4792815446853638, time cost3.33343768119812
epoch: 269, iter: 9162, loss: 0.5252798199653625, time cost3.074138641357422
epoch: 269, iter: 9163, loss: 0.8495779633522034, time cost3.195343494415283
epoch: 269, iter: 9164, loss: 0.6155697703361511, time cost3.161919593811035
epoch: 269, iter: 9165, loss: 0.575165867805481, time cost3.2304794788360596
epoch: 269, iter: 9166, loss: 0.9054376482963562, time cost3.2538883686065674
epoch: 269, iter: 9167, loss: 0.6597069501876831, time cost3.143183708190918
epoch: 269, iter: 9168, loss: 0.538533091545105, time cost3.406064748764038
epoch: 269, iter: 9169, loss: 0.5337974429130554, time cost3.0964536666870117
epoch: 269, iter: 9170, loss: 0.45648878812789917, time cost3.243875026702881
epoch: 269, iter: 9171, loss: 0.7106331586837769, time cost3.20039439201355
epoch: 269, iter: 9172, loss: 0.6575910449028015, time cost3.240446090698242
epoch: 269, iter: 9173, loss: 0.5073474049568176, time cost3.063483476638794
epoch: 269, iter: 9174, loss: 0.8183453679084778, time cost3.795313596725464
epoch: 269, iter: 9175, loss: 0.44805705547332764, time cost3.629000663757324
epoch: 269, iter: 9176, loss: 1.0049139261245728, time cost3.2611615657806396
epoch: 269, iter: 9177, loss: 0.5082923173904419, time cost3.206005811691284
epoch: 269, iter: 9178, loss: 0.7640356421470642, time cost3.1677045822143555
epoch: 269, iter: 9179, loss: 0.45184701681137085, time cost3.0791831016540527
epoch: 269, iter: 9180, loss: 0.22779646515846252, time cost2.2924137115478516
epoch: 270, iter: 9181, loss: 0.5177022814750671, time cost3.3210129737854004
epoch: 270, iter: 9182, loss: 0.8410351872444153, time cost3.1818976402282715
epoch: 270, iter: 9183, loss: 0.5786441564559937, time cost3.1728053092956543
epoch: 270, iter: 9184, loss: 0.5448644757270813, time cost3.312549114227295
epoch: 270, iter: 9185, loss: 1.0301408767700195, time cost3.262392282485962
epoch: 270, iter: 9186, loss: 0.4594036638736725, time cost3.237718343734741
epoch: 270, iter: 9187, loss: 0.2926158905029297, time cost3.2342355251312256
epoch: 270, iter: 9188, loss: 0.526148796081543, time cost3.276066303253174
epoch: 270, iter: 9189, loss: 0.4761536419391632, time cost3.384307384490967
epoch: 270, iter: 9190, loss: 0.21161186695098877, time cost3.2519519329071045
epoch: 270, iter: 9191, loss: 0.5172686576843262, time cost3.1168246269226074
epoch: 270, iter: 9192, loss: 0.40533825755119324, time cost3.15293550491333
epoch: 270, iter: 9193, loss: 0.4677671790122986, time cost3.1674530506134033
epoch: 270, iter: 9194, loss: 0.6887154579162598, time cost3.2519822120666504
epoch: 270, iter: 9195, loss: 0.5985898971557617, time cost3.297227621078491
epoch: 270, iter: 9196, loss: 0.536766767501831, time cost3.2570314407348633
epoch: 270, iter: 9197, loss: 0.5512221455574036, time cost3.2374167442321777
epoch: 270, iter: 9198, loss: 0.6389101147651672, time cost3.3101208209991455
epoch: 270, iter: 9199, loss: 0.6898926496505737, time cost3.158594846725464
epoch: 270, iter: 9200, loss: 1.0181838274002075, time cost3.201343297958374
tensor([[132.,  97.,  99.,  ...,   1.,   1.,   1.],
        [ 15.,  13.,  13.,  ...,   6.,   6.,   2.],
        [ 65., 184.,  85.,  ...,   4.,   4.,   1.],
        ...,
        [ 40.,  37.,  21.,  ...,  15.,  15.,   6.],
        [ 50.,  47.,  14.,  ...,   1.,   1.,   1.],
        [ 39.,  54.,  86.,  ...,   1.,   1.,   1.]])
Epoch: 270, Iteration: 9200:
TEST A@1: 0.5177777777777778
TEST A@5: 0.8933333333333333
TEST A@10: 0.9577777777777777
TEST M@B: 0.4214388937937821
TEST M@A: 0.9587509464279025
TEST W@MB: 0.22605702234476477
TEST W@MA: 0.5929965372699558
TEST Time: 102.12873005867004
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 270, iter: 9201, loss: 0.8178164958953857, time cost3.060980796813965
epoch: 270, iter: 9202, loss: 0.4379400908946991, time cost3.082151412963867
epoch: 270, iter: 9203, loss: 0.8988817930221558, time cost3.0391488075256348
epoch: 270, iter: 9204, loss: 0.8903448581695557, time cost3.1182870864868164
epoch: 270, iter: 9205, loss: 0.31819480657577515, time cost3.176610231399536
epoch: 270, iter: 9206, loss: 0.5183414220809937, time cost3.088911533355713
epoch: 270, iter: 9207, loss: 1.5158101320266724, time cost3.197248935699463
epoch: 270, iter: 9208, loss: 0.5903245210647583, time cost3.148252248764038
epoch: 270, iter: 9209, loss: 0.826072096824646, time cost3.2615041732788086
epoch: 270, iter: 9210, loss: 0.6103582978248596, time cost3.7233994007110596
epoch: 270, iter: 9211, loss: 0.49260076880455017, time cost3.158498764038086
epoch: 270, iter: 9212, loss: 0.310613751411438, time cost3.0751237869262695
epoch: 270, iter: 9213, loss: 0.6946634650230408, time cost3.1083502769470215
epoch: 270, iter: 9214, loss: 0.46474534273147583, time cost2.2864344120025635
epoch: 271, iter: 9215, loss: 0.598000168800354, time cost3.295217990875244
epoch: 271, iter: 9216, loss: 0.22296783328056335, time cost3.276364803314209
epoch: 271, iter: 9217, loss: 0.6632562279701233, time cost3.286802053451538
epoch: 271, iter: 9218, loss: 0.7675621509552002, time cost3.3184258937835693
epoch: 271, iter: 9219, loss: 0.4811409115791321, time cost3.350397825241089
epoch: 271, iter: 9220, loss: 0.5493444204330444, time cost3.2748751640319824
epoch: 271, iter: 9221, loss: 1.107804775238037, time cost3.1069061756134033
epoch: 271, iter: 9222, loss: 0.3869704008102417, time cost3.2010562419891357
epoch: 271, iter: 9223, loss: 0.7012087106704712, time cost3.170375347137451
epoch: 271, iter: 9224, loss: 0.5193332433700562, time cost3.1236350536346436
epoch: 271, iter: 9225, loss: 0.49584755301475525, time cost3.1421234607696533
epoch: 271, iter: 9226, loss: 0.7149953246116638, time cost3.1401419639587402
epoch: 271, iter: 9227, loss: 0.5887448787689209, time cost3.1940503120422363
epoch: 271, iter: 9228, loss: 0.7243810296058655, time cost3.1082277297973633
epoch: 271, iter: 9229, loss: 0.787640392780304, time cost3.3996856212615967
epoch: 271, iter: 9230, loss: 0.6890367865562439, time cost3.1029796600341797
epoch: 271, iter: 9231, loss: 0.7639720439910889, time cost3.096428871154785
epoch: 271, iter: 9232, loss: 0.6568015813827515, time cost3.1891655921936035
epoch: 271, iter: 9233, loss: 0.7049432396888733, time cost3.192981481552124
epoch: 271, iter: 9234, loss: 0.6289709210395813, time cost3.140770673751831
epoch: 271, iter: 9235, loss: 0.36862310767173767, time cost3.1359715461730957
epoch: 271, iter: 9236, loss: 0.7375584244728088, time cost3.271348714828491
epoch: 271, iter: 9237, loss: 0.9559924006462097, time cost3.729456663131714
epoch: 271, iter: 9238, loss: 0.4568501114845276, time cost3.15486478805542
epoch: 271, iter: 9239, loss: 0.5276378989219666, time cost3.211634635925293
epoch: 271, iter: 9240, loss: 0.5680633783340454, time cost3.1067051887512207
epoch: 271, iter: 9241, loss: 0.5936474204063416, time cost3.111928701400757
epoch: 271, iter: 9242, loss: 0.6823030114173889, time cost3.083630084991455
epoch: 271, iter: 9243, loss: 0.5581670999526978, time cost3.090665578842163
epoch: 271, iter: 9244, loss: 0.6866331696510315, time cost3.428483486175537
epoch: 271, iter: 9245, loss: 0.4240652620792389, time cost3.1087758541107178
epoch: 271, iter: 9246, loss: 0.7399742603302002, time cost3.0140326023101807
epoch: 271, iter: 9247, loss: 0.5536725521087646, time cost3.0281057357788086
epoch: 271, iter: 9248, loss: 0.5333462357521057, time cost2.202566385269165
epoch: 272, iter: 9249, loss: 0.41571056842803955, time cost3.2784366607666016
epoch: 272, iter: 9250, loss: 0.5193171501159668, time cost3.280527353286743
tensor([[ 46.,  38.,  36.,  ...,   6.,   6.,   9.],
        [ 32.,  19.,  17.,  ...,   5.,   5.,   3.],
        [ 41., 179.,  81.,  ...,   3.,   3.,   3.],
        ...,
        [ 58.,  62.,  46.,  ...,  18.,  18.,   9.],
        [124., 131.,  25.,  ...,   1.,   1.,   1.],
        [ 17.,  36.,  45.,  ...,   1.,   1.,   1.]])
Epoch: 272, Iteration: 9250:
TEST A@1: 0.4777777777777778
TEST A@5: 0.8466666666666667
TEST A@10: 0.9288888888888889
TEST M@B: 0.38218130572832215
TEST M@A: 0.952596458742129
TEST W@MB: 0.20388836667090793
TEST W@MA: 0.5881907635905683
TEST Time: 104.02100014686584
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 272, iter: 9251, loss: 0.7375340461730957, time cost3.063511371612549
epoch: 272, iter: 9252, loss: 0.9639227986335754, time cost3.0058958530426025
epoch: 272, iter: 9253, loss: 0.419544517993927, time cost3.1526246070861816
epoch: 272, iter: 9254, loss: 0.6037657856941223, time cost3.201798677444458
epoch: 272, iter: 9255, loss: 1.118410348892212, time cost3.1061599254608154
epoch: 272, iter: 9256, loss: 0.7209257483482361, time cost3.221741199493408
epoch: 272, iter: 9257, loss: 0.6960633993148804, time cost3.218052387237549
epoch: 272, iter: 9258, loss: 0.4335358142852783, time cost3.1137406826019287
epoch: 272, iter: 9259, loss: 0.749455451965332, time cost3.188654661178589
epoch: 272, iter: 9260, loss: 0.4895852208137512, time cost3.164337396621704
epoch: 272, iter: 9261, loss: 0.5765726566314697, time cost3.126145362854004
epoch: 272, iter: 9262, loss: 0.6235110759735107, time cost3.150258779525757
epoch: 272, iter: 9263, loss: 0.5851613879203796, time cost3.2440574169158936
epoch: 272, iter: 9264, loss: 0.5045920610427856, time cost3.1762733459472656
epoch: 272, iter: 9265, loss: 0.4162653982639313, time cost3.1373775005340576
epoch: 272, iter: 9266, loss: 0.4952039420604706, time cost3.1422488689422607
epoch: 272, iter: 9267, loss: 0.4441995322704315, time cost3.344531297683716
epoch: 272, iter: 9268, loss: 0.5402425527572632, time cost3.1014199256896973
epoch: 272, iter: 9269, loss: 0.5707515478134155, time cost3.126295804977417
epoch: 272, iter: 9270, loss: 0.9261540770530701, time cost3.1145925521850586
epoch: 272, iter: 9271, loss: 0.8260208964347839, time cost3.1498570442199707
epoch: 272, iter: 9272, loss: 0.3361893892288208, time cost3.3903164863586426
epoch: 272, iter: 9273, loss: 0.4696655869483948, time cost3.1184096336364746
epoch: 272, iter: 9274, loss: 0.9599854946136475, time cost3.297724962234497
epoch: 272, iter: 9275, loss: 0.713454008102417, time cost3.187208414077759
epoch: 272, iter: 9276, loss: 0.7172299027442932, time cost3.156770706176758
epoch: 272, iter: 9277, loss: 0.4023331105709076, time cost3.1018431186676025
epoch: 272, iter: 9278, loss: 0.4321367144584656, time cost3.1514596939086914
epoch: 272, iter: 9279, loss: 0.5464131832122803, time cost3.349217176437378
epoch: 272, iter: 9280, loss: 0.5576515197753906, time cost3.1035382747650146
epoch: 272, iter: 9281, loss: 0.5843068361282349, time cost3.230588436126709
epoch: 272, iter: 9282, loss: 0.4088898301124573, time cost2.232738733291626
epoch: 273, iter: 9283, loss: 0.7937771677970886, time cost3.4067223072052
epoch: 273, iter: 9284, loss: 0.7862393856048584, time cost3.282371759414673
epoch: 273, iter: 9285, loss: 0.626948356628418, time cost3.241905450820923
epoch: 273, iter: 9286, loss: 0.22246235609054565, time cost3.272869110107422
epoch: 273, iter: 9287, loss: 0.5414497256278992, time cost3.2239108085632324
epoch: 273, iter: 9288, loss: 0.41616129875183105, time cost3.1683332920074463
epoch: 273, iter: 9289, loss: 0.4626791775226593, time cost3.229609727859497
epoch: 273, iter: 9290, loss: 0.5863505601882935, time cost3.309891700744629
epoch: 273, iter: 9291, loss: 0.5764773488044739, time cost3.299368381500244
epoch: 273, iter: 9292, loss: 0.47632357478141785, time cost3.378661870956421
epoch: 273, iter: 9293, loss: 0.9195021986961365, time cost3.5591630935668945
epoch: 273, iter: 9294, loss: 1.0201733112335205, time cost3.1171183586120605
epoch: 273, iter: 9295, loss: 0.5433678030967712, time cost3.233900547027588
epoch: 273, iter: 9296, loss: 0.6336764693260193, time cost3.4203102588653564
epoch: 273, iter: 9297, loss: 0.2327389419078827, time cost3.2532927989959717
epoch: 273, iter: 9298, loss: 0.6682791113853455, time cost3.263897180557251
epoch: 273, iter: 9299, loss: 0.796840488910675, time cost3.128610610961914
epoch: 273, iter: 9300, loss: 0.5823811888694763, time cost3.1321210861206055
tensor([[  9.,  10.,  10.,  ...,   6.,   6.,   6.],
        [  9.,  10.,  10.,  ...,  10.,  10.,   6.],
        [ 44., 165.,  67.,  ...,   1.,   1.,   1.],
        ...,
        [ 48.,  49.,  27.,  ...,  12.,  12.,   7.],
        [ 25.,  28.,   8.,  ...,   1.,   1.,   1.],
        [ 80., 159., 160.,  ...,   2.,   2.,   6.]])
Epoch: 273, Iteration: 9300:
TEST A@1: 0.5266666666666666
TEST A@5: 0.8644444444444445
TEST A@10: 0.9622222222222222
TEST M@B: 0.42216912865181483
TEST M@A: 0.9595066292280007
TEST W@MB: 0.22703450222919852
TEST W@MA: 0.593701030679403
TEST Time: 101.80308151245117
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 273, iter: 9301, loss: 0.5981850028038025, time cost3.0029706954956055
epoch: 273, iter: 9302, loss: 1.1729656457901, time cost3.1275932788848877
epoch: 273, iter: 9303, loss: 0.38666966557502747, time cost3.1154427528381348
epoch: 273, iter: 9304, loss: 0.43179845809936523, time cost3.215980052947998
epoch: 273, iter: 9305, loss: 0.672227680683136, time cost3.2228312492370605
epoch: 273, iter: 9306, loss: 0.4674619734287262, time cost3.237149477005005
epoch: 273, iter: 9307, loss: 0.46409541368484497, time cost3.2128188610076904
epoch: 273, iter: 9308, loss: 0.6697008609771729, time cost3.313483953475952
epoch: 273, iter: 9309, loss: 0.47126370668411255, time cost3.1220462322235107
epoch: 273, iter: 9310, loss: 0.5505640506744385, time cost3.0264573097229004
epoch: 273, iter: 9311, loss: 0.577170729637146, time cost3.1311182975769043
epoch: 273, iter: 9312, loss: 0.39574676752090454, time cost3.101865530014038
epoch: 273, iter: 9313, loss: 0.5473508238792419, time cost2.997518539428711
epoch: 273, iter: 9314, loss: 0.7271379828453064, time cost2.9720261096954346
epoch: 273, iter: 9315, loss: 0.526542603969574, time cost3.072002410888672
epoch: 273, iter: 9316, loss: 0.23207031190395355, time cost2.186150074005127
epoch: 274, iter: 9317, loss: 0.8040928244590759, time cost3.306304931640625
epoch: 274, iter: 9318, loss: 0.9162840247154236, time cost3.206371307373047
epoch: 274, iter: 9319, loss: 0.6257250308990479, time cost3.4196279048919678
epoch: 274, iter: 9320, loss: 0.41319558024406433, time cost3.2887187004089355
epoch: 274, iter: 9321, loss: 0.8809186816215515, time cost3.1173348426818848
epoch: 274, iter: 9322, loss: 1.0616940259933472, time cost3.235642910003662
epoch: 274, iter: 9323, loss: 0.3500244915485382, time cost3.1970276832580566
epoch: 274, iter: 9324, loss: 0.6784713268280029, time cost3.27569317817688
epoch: 274, iter: 9325, loss: 0.7248609662055969, time cost3.2090001106262207
epoch: 274, iter: 9326, loss: 0.5388936996459961, time cost3.19563627243042
epoch: 274, iter: 9327, loss: 0.6750277280807495, time cost3.2541861534118652
epoch: 274, iter: 9328, loss: 0.872865617275238, time cost3.179591178894043
epoch: 274, iter: 9329, loss: 0.6429850459098816, time cost3.171720027923584
epoch: 274, iter: 9330, loss: 0.4279212951660156, time cost3.1562001705169678
epoch: 274, iter: 9331, loss: 0.7473004460334778, time cost3.2015950679779053
epoch: 274, iter: 9332, loss: 1.2016279697418213, time cost3.272982120513916
epoch: 274, iter: 9333, loss: 0.5503166913986206, time cost3.1594150066375732
epoch: 274, iter: 9334, loss: 0.7961168885231018, time cost2.871694326400757
epoch: 274, iter: 9335, loss: 0.9246178269386292, time cost2.89799165725708
epoch: 274, iter: 9336, loss: 0.635306715965271, time cost3.0036797523498535
epoch: 274, iter: 9337, loss: 0.5429589748382568, time cost3.255554676055908
epoch: 274, iter: 9338, loss: 0.8792482018470764, time cost4.544124126434326
epoch: 274, iter: 9339, loss: 0.8025665879249573, time cost3.376278877258301
epoch: 274, iter: 9340, loss: 0.6062306761741638, time cost3.295370101928711
epoch: 274, iter: 9341, loss: 0.8019552826881409, time cost3.3844826221466064
epoch: 274, iter: 9342, loss: 0.9987461566925049, time cost3.146449327468872
epoch: 274, iter: 9343, loss: 0.5970419645309448, time cost3.2259058952331543
epoch: 274, iter: 9344, loss: 0.32721126079559326, time cost3.407550096511841
epoch: 274, iter: 9345, loss: 0.670575737953186, time cost3.296778917312622
epoch: 274, iter: 9346, loss: 0.6991562247276306, time cost3.1333067417144775
epoch: 274, iter: 9347, loss: 0.5479838252067566, time cost3.1848931312561035
epoch: 274, iter: 9348, loss: 0.8677656054496765, time cost3.403993844985962
epoch: 274, iter: 9349, loss: 0.6959553360939026, time cost3.1020562648773193
epoch: 274, iter: 9350, loss: 0.681009829044342, time cost2.648209810256958
tensor([[143.,  94., 101.,  ...,   6.,   6.,   4.],
        [ 16.,  17.,  14.,  ...,  12.,  12.,   5.],
        [ 25.,  75.,  54.,  ...,   4.,   4.,   1.],
        ...,
        [ 39.,  41.,  19.,  ...,   6.,   6.,   1.],
        [ 52.,  54.,   9.,  ...,   1.,   1.,   1.],
        [ 71.,  84., 126.,  ...,   1.,   1.,   1.]])
Epoch: 274, Iteration: 9350:
TEST A@1: 0.5066666666666667
TEST A@5: 0.8511111111111112
TEST A@10: 0.9466666666666667
TEST M@B: 0.4088531384030198
TEST M@A: 0.9579163580895844
TEST W@MB: 0.2197222931538595
TEST W@MA: 0.5924874552984563
TEST Time: 108.82090067863464
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 275, iter: 9351, loss: 0.5508303046226501, time cost3.16325306892395
epoch: 275, iter: 9352, loss: 0.7230592966079712, time cost3.2585418224334717
epoch: 275, iter: 9353, loss: 0.7258141040802002, time cost3.196082592010498
epoch: 275, iter: 9354, loss: 0.6149529814720154, time cost3.190880060195923
epoch: 275, iter: 9355, loss: 0.6437428593635559, time cost3.237700939178467
epoch: 275, iter: 9356, loss: 0.978887140750885, time cost3.228070020675659
epoch: 275, iter: 9357, loss: 0.5062311291694641, time cost3.1886649131774902
epoch: 275, iter: 9358, loss: 0.5254240036010742, time cost3.286717176437378
epoch: 275, iter: 9359, loss: 0.7545865178108215, time cost3.131615161895752
epoch: 275, iter: 9360, loss: 0.6420759558677673, time cost3.5615642070770264
epoch: 275, iter: 9361, loss: 0.5748918056488037, time cost3.202327251434326
epoch: 275, iter: 9362, loss: 0.64414381980896, time cost3.266986846923828
epoch: 275, iter: 9363, loss: 0.9405822157859802, time cost3.2215089797973633
epoch: 275, iter: 9364, loss: 0.52129065990448, time cost3.2097463607788086
epoch: 275, iter: 9365, loss: 0.49395379424095154, time cost3.2369110584259033
epoch: 275, iter: 9366, loss: 0.884129524230957, time cost3.182487726211548
epoch: 275, iter: 9367, loss: 0.39608022570610046, time cost3.1958558559417725
epoch: 275, iter: 9368, loss: 0.6036298871040344, time cost3.382227659225464
epoch: 275, iter: 9369, loss: 0.8773613572120667, time cost3.1253769397735596
epoch: 275, iter: 9370, loss: 0.5863547325134277, time cost3.2738418579101562
epoch: 275, iter: 9371, loss: 0.35736268758773804, time cost3.142563581466675
epoch: 275, iter: 9372, loss: 0.9742125272750854, time cost3.2024712562561035
epoch: 275, iter: 9373, loss: 0.3441879451274872, time cost3.184147596359253
epoch: 275, iter: 9374, loss: 0.8929518461227417, time cost3.105466604232788
epoch: 275, iter: 9375, loss: 0.5327787399291992, time cost3.053227424621582
epoch: 275, iter: 9376, loss: 0.6663532853126526, time cost3.19165301322937
epoch: 275, iter: 9377, loss: 0.9872293472290039, time cost3.2309017181396484
epoch: 275, iter: 9378, loss: 0.41127702593803406, time cost3.2391669750213623
epoch: 275, iter: 9379, loss: 0.46395429968833923, time cost3.2665905952453613
epoch: 275, iter: 9380, loss: 0.969447910785675, time cost3.253469228744507
epoch: 275, iter: 9381, loss: 1.2580071687698364, time cost3.091029167175293
epoch: 275, iter: 9382, loss: 0.7417225241661072, time cost3.2283246517181396
epoch: 275, iter: 9383, loss: 0.370571106672287, time cost3.190866470336914
epoch: 275, iter: 9384, loss: 0.5939643383026123, time cost2.2537851333618164
epoch: 276, iter: 9385, loss: 0.587439239025116, time cost3.319058656692505
epoch: 276, iter: 9386, loss: 0.5778875946998596, time cost3.2236292362213135
epoch: 276, iter: 9387, loss: 0.7610549926757812, time cost3.2915525436401367
epoch: 276, iter: 9388, loss: 0.3457668423652649, time cost3.279928684234619
epoch: 276, iter: 9389, loss: 0.6823790669441223, time cost3.236499786376953
epoch: 276, iter: 9390, loss: 0.7220279574394226, time cost3.2269985675811768
epoch: 276, iter: 9391, loss: 0.7353536486625671, time cost3.262226104736328
epoch: 276, iter: 9392, loss: 1.4465492963790894, time cost3.357008934020996
epoch: 276, iter: 9393, loss: 0.641697108745575, time cost3.3809051513671875
epoch: 276, iter: 9394, loss: 0.44216322898864746, time cost3.414497137069702
epoch: 276, iter: 9395, loss: 0.8394681215286255, time cost3.2754886150360107
epoch: 276, iter: 9396, loss: 0.6448665261268616, time cost3.226924180984497
epoch: 276, iter: 9397, loss: 0.608847439289093, time cost3.227586507797241
epoch: 276, iter: 9398, loss: 0.892828106880188, time cost3.308547019958496
epoch: 276, iter: 9399, loss: 0.24611322581768036, time cost3.1364905834198
epoch: 276, iter: 9400, loss: 0.5022978186607361, time cost3.2010858058929443
tensor([[136., 118., 121.,  ...,  31.,  31.,  27.],
        [  3.,   3.,   3.,  ...,   7.,   7.,   4.],
        [ 63., 268., 112.,  ...,   8.,   8.,   4.],
        ...,
        [ 35.,  33.,  18.,  ...,   4.,   4.,   2.],
        [ 10.,  18.,  13.,  ...,   1.,   1.,   1.],
        [ 79., 121., 165.,  ...,   2.,   2.,   3.]])
Epoch: 276, Iteration: 9400:
TEST A@1: 0.48
TEST A@5: 0.8377777777777777
TEST A@10: 0.9333333333333333
TEST M@B: 0.3804576766198816
TEST M@A: 0.9538864503553255
TEST W@MB: 0.20330770276158033
TEST W@MA: 0.5894896357784178
TEST Time: 109.91652131080627
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 276, iter: 9401, loss: 0.713792622089386, time cost3.1893508434295654
epoch: 276, iter: 9402, loss: 0.4810638129711151, time cost3.150148868560791
epoch: 276, iter: 9403, loss: 0.3153812289237976, time cost3.2361416816711426
epoch: 276, iter: 9404, loss: 0.5850096344947815, time cost3.195997953414917
epoch: 276, iter: 9405, loss: 0.9392184019088745, time cost3.1675539016723633
epoch: 276, iter: 9406, loss: 0.6245237588882446, time cost3.2096107006073
epoch: 276, iter: 9407, loss: 0.807501494884491, time cost3.3017938137054443
epoch: 276, iter: 9408, loss: 0.6360793709754944, time cost3.2202517986297607
epoch: 276, iter: 9409, loss: 0.4785398244857788, time cost3.188753604888916
epoch: 276, iter: 9410, loss: 0.7196758389472961, time cost3.142118215560913
epoch: 276, iter: 9411, loss: 1.2560089826583862, time cost3.1758687496185303
epoch: 276, iter: 9412, loss: 0.41713017225265503, time cost3.3212757110595703
epoch: 276, iter: 9413, loss: 0.2872612178325653, time cost3.081754684448242
epoch: 276, iter: 9414, loss: 0.8914233446121216, time cost3.1784331798553467
epoch: 276, iter: 9415, loss: 0.8364617228507996, time cost3.0766165256500244
epoch: 276, iter: 9416, loss: 0.7125757932662964, time cost3.0829315185546875
epoch: 276, iter: 9417, loss: 0.6104890704154968, time cost3.0808522701263428
epoch: 276, iter: 9418, loss: 0.7739728093147278, time cost2.3573713302612305
epoch: 277, iter: 9419, loss: 0.5273732542991638, time cost3.44650936126709
epoch: 277, iter: 9420, loss: 0.5521084070205688, time cost3.3256924152374268
epoch: 277, iter: 9421, loss: 0.524828314781189, time cost3.326704263687134
epoch: 277, iter: 9422, loss: 0.6689162254333496, time cost3.30364990234375
epoch: 277, iter: 9423, loss: 0.4644221365451813, time cost3.0595924854278564
epoch: 277, iter: 9424, loss: 0.2737182080745697, time cost3.237577199935913
epoch: 277, iter: 9425, loss: 0.64201420545578, time cost3.2945220470428467
epoch: 277, iter: 9426, loss: 0.7998199462890625, time cost3.254572629928589
epoch: 277, iter: 9427, loss: 0.4224344789981842, time cost3.698901414871216
epoch: 277, iter: 9428, loss: 0.46164238452911377, time cost3.77506160736084
epoch: 277, iter: 9429, loss: 0.6245576739311218, time cost3.739422559738159
epoch: 277, iter: 9430, loss: 0.6353639960289001, time cost3.390108108520508
epoch: 277, iter: 9431, loss: 0.5284134745597839, time cost3.3130390644073486
epoch: 277, iter: 9432, loss: 0.7074655890464783, time cost3.168276309967041
epoch: 277, iter: 9433, loss: 0.28635406494140625, time cost3.138505697250366
epoch: 277, iter: 9434, loss: 0.6479108333587646, time cost3.3741931915283203
epoch: 277, iter: 9435, loss: 1.0366666316986084, time cost3.1624596118927
epoch: 277, iter: 9436, loss: 0.5826789140701294, time cost3.182900905609131
epoch: 277, iter: 9437, loss: 0.657825767993927, time cost3.0923774242401123
epoch: 277, iter: 9438, loss: 0.28575316071510315, time cost3.2009172439575195
epoch: 277, iter: 9439, loss: 0.6912745833396912, time cost3.1815450191497803
epoch: 277, iter: 9440, loss: 0.7536026835441589, time cost3.0643277168273926
epoch: 277, iter: 9441, loss: 1.0145657062530518, time cost3.342775344848633
epoch: 277, iter: 9442, loss: 0.41969192028045654, time cost3.1412298679351807
epoch: 277, iter: 9443, loss: 0.5078780651092529, time cost3.1622087955474854
epoch: 277, iter: 9444, loss: 0.3651663362979889, time cost3.219343423843384
epoch: 277, iter: 9445, loss: 0.7941781878471375, time cost3.1906046867370605
epoch: 277, iter: 9446, loss: 0.47175702452659607, time cost3.1679205894470215
epoch: 277, iter: 9447, loss: 0.4544419050216675, time cost3.1552700996398926
epoch: 277, iter: 9448, loss: 0.7955002188682556, time cost3.121742010116577
epoch: 277, iter: 9449, loss: 0.9321088194847107, time cost3.2801005840301514
epoch: 277, iter: 9450, loss: 0.48487114906311035, time cost3.3001649379730225
tensor([[ 11.,  10.,  14.,  ...,   6.,   6.,  11.],
        [ 13.,  14.,  12.,  ...,   8.,   8.,   5.],
        [245., 429., 262.,  ...,   1.,   1.,   1.],
        ...,
        [ 51.,  51.,  29.,  ...,   8.,   8.,   6.],
        [ 12.,  12.,   7.,  ...,   1.,   1.,   1.],
        [  9.,  37.,  39.,  ...,   1.,   1.,   2.]])
Epoch: 277, Iteration: 9450:
TEST A@1: 0.5311111111111111
TEST A@5: 0.88
TEST A@10: 0.9577777777777777
TEST M@B: 0.4339269800410423
TEST M@A: 0.9593490303706319
TEST W@MB: 0.23382150740391885
TEST W@MA: 0.5934294994420005
TEST Time: 110.08531069755554
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 277, iter: 9451, loss: 0.7818362712860107, time cost3.10028338432312
epoch: 277, iter: 9452, loss: 0.6225287318229675, time cost2.1876609325408936
epoch: 278, iter: 9453, loss: 0.6049792170524597, time cost3.272942304611206
epoch: 278, iter: 9454, loss: 0.7922949194908142, time cost3.27677059173584
epoch: 278, iter: 9455, loss: 0.6220386028289795, time cost3.185323715209961
epoch: 278, iter: 9456, loss: 0.46748611330986023, time cost3.1317391395568848
epoch: 278, iter: 9457, loss: 0.8438184857368469, time cost3.1357762813568115
epoch: 278, iter: 9458, loss: 0.3365536332130432, time cost3.36604905128479
epoch: 278, iter: 9459, loss: 0.3089696764945984, time cost3.2775635719299316
epoch: 278, iter: 9460, loss: 0.579415500164032, time cost3.160186290740967
epoch: 278, iter: 9461, loss: 0.35425475239753723, time cost3.23266339302063
epoch: 278, iter: 9462, loss: 0.5501768589019775, time cost3.249133348464966
epoch: 278, iter: 9463, loss: 0.5399860143661499, time cost3.1402640342712402
epoch: 278, iter: 9464, loss: 0.792934000492096, time cost3.155066967010498
epoch: 278, iter: 9465, loss: 1.0569205284118652, time cost3.1535918712615967
epoch: 278, iter: 9466, loss: 0.38963931798934937, time cost3.2031307220458984
epoch: 278, iter: 9467, loss: 0.6248724460601807, time cost3.119426965713501
epoch: 278, iter: 9468, loss: 1.0110268592834473, time cost3.166563034057617
epoch: 278, iter: 9469, loss: 0.7534214854240417, time cost3.1994192600250244
epoch: 278, iter: 9470, loss: 0.6271633505821228, time cost3.3302950859069824
epoch: 278, iter: 9471, loss: 0.6100837588310242, time cost3.168750524520874
epoch: 278, iter: 9472, loss: 0.5216325521469116, time cost3.176633596420288
epoch: 278, iter: 9473, loss: 0.5846478939056396, time cost3.149991750717163
epoch: 278, iter: 9474, loss: 0.6890855431556702, time cost3.130451202392578
epoch: 278, iter: 9475, loss: 0.9219779968261719, time cost3.252868175506592
epoch: 278, iter: 9476, loss: 0.5356306433677673, time cost3.2303311824798584
epoch: 278, iter: 9477, loss: 0.9226616024971008, time cost3.1902661323547363
epoch: 278, iter: 9478, loss: 0.6791693568229675, time cost3.204476833343506
epoch: 278, iter: 9479, loss: 1.2938354015350342, time cost3.298800468444824
epoch: 278, iter: 9480, loss: 0.946121335029602, time cost3.255174398422241
epoch: 278, iter: 9481, loss: 0.6032573580741882, time cost3.116603374481201
epoch: 278, iter: 9482, loss: 0.6536905169487, time cost3.2261898517608643
epoch: 278, iter: 9483, loss: 0.4800381660461426, time cost3.2530882358551025
epoch: 278, iter: 9484, loss: 0.4710445702075958, time cost3.143280029296875
epoch: 278, iter: 9485, loss: 0.9840613603591919, time cost3.1889665126800537
epoch: 278, iter: 9486, loss: 0.6093045473098755, time cost2.2591464519500732
epoch: 279, iter: 9487, loss: 0.583224892616272, time cost3.304990291595459
epoch: 279, iter: 9488, loss: 0.5011994242668152, time cost3.202425718307495
epoch: 279, iter: 9489, loss: 0.7599791884422302, time cost3.418367862701416
epoch: 279, iter: 9490, loss: 0.4290057420730591, time cost3.2439815998077393
epoch: 279, iter: 9491, loss: 0.33582577109336853, time cost3.2592716217041016
epoch: 279, iter: 9492, loss: 0.46098974347114563, time cost3.3145604133605957
epoch: 279, iter: 9493, loss: 0.3579198122024536, time cost3.2232229709625244
epoch: 279, iter: 9494, loss: 0.9104099273681641, time cost3.1917355060577393
epoch: 279, iter: 9495, loss: 0.7144313454627991, time cost3.052546501159668
epoch: 279, iter: 9496, loss: 0.39968106150627136, time cost3.200103759765625
epoch: 279, iter: 9497, loss: 1.3081871271133423, time cost3.2590112686157227
epoch: 279, iter: 9498, loss: 0.4491998553276062, time cost3.284057140350342
epoch: 279, iter: 9499, loss: 0.6111800670623779, time cost3.23348331451416
epoch: 279, iter: 9500, loss: 0.8882953524589539, time cost3.109497547149658
tensor([[161., 105., 117.,  ...,   2.,   2.,   1.],
        [  4.,   5.,   5.,  ...,   8.,   8.,   6.],
        [ 98., 256.,  95.,  ...,   8.,   8.,   4.],
        ...,
        [ 66.,  62.,  39.,  ...,  12.,  12.,   8.],
        [ 77.,  76.,  10.,  ...,   1.,   1.,   1.],
        [191., 246., 288.,  ...,   1.,   1.,   2.]])
Epoch: 279, Iteration: 9500:
TEST A@1: 0.4777777777777778
TEST A@5: 0.8311111111111111
TEST A@10: 0.9266666666666666
TEST M@B: 0.3952387427165895
TEST M@A: 0.9545756716748094
TEST W@MB: 0.21258265407045782
TEST W@MA: 0.589702808692501
TEST Time: 107.1085455417633
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 279, iter: 9501, loss: 0.7100192308425903, time cost3.2198150157928467
epoch: 279, iter: 9502, loss: 0.5580107569694519, time cost3.268756628036499
epoch: 279, iter: 9503, loss: 0.992671012878418, time cost3.8942184448242188
epoch: 279, iter: 9504, loss: 0.3894994258880615, time cost3.7473256587982178
epoch: 279, iter: 9505, loss: 0.8174858093261719, time cost3.6303694248199463
epoch: 279, iter: 9506, loss: 0.9020827412605286, time cost3.4184417724609375
epoch: 279, iter: 9507, loss: 0.6894129514694214, time cost3.258176565170288
epoch: 279, iter: 9508, loss: 0.8966591358184814, time cost3.0976455211639404
epoch: 279, iter: 9509, loss: 0.666129469871521, time cost3.104536294937134
epoch: 279, iter: 9510, loss: 0.8011361956596375, time cost3.231140375137329
epoch: 279, iter: 9511, loss: 0.3611697256565094, time cost3.165283441543579
epoch: 279, iter: 9512, loss: 0.628932774066925, time cost3.129368543624878
epoch: 279, iter: 9513, loss: 1.033200979232788, time cost3.199753999710083
epoch: 279, iter: 9514, loss: 0.9807202219963074, time cost3.1892404556274414
epoch: 279, iter: 9515, loss: 0.8542867302894592, time cost3.087815999984741
epoch: 279, iter: 9516, loss: 0.5388020277023315, time cost3.193812370300293
epoch: 279, iter: 9517, loss: 0.8568804860115051, time cost3.157299757003784
epoch: 279, iter: 9518, loss: 0.5220802426338196, time cost3.231208324432373
epoch: 279, iter: 9519, loss: 0.3835631310939789, time cost3.0477325916290283
epoch: 279, iter: 9520, loss: 0.6157610416412354, time cost2.2502522468566895
epoch: 280, iter: 9521, loss: 0.4787701368331909, time cost3.3221232891082764
epoch: 280, iter: 9522, loss: 0.5109969973564148, time cost3.3922793865203857
epoch: 280, iter: 9523, loss: 0.44203341007232666, time cost3.3648476600646973
epoch: 280, iter: 9524, loss: 0.6788877844810486, time cost3.2711806297302246
epoch: 280, iter: 9525, loss: 0.7705431580543518, time cost3.601775646209717
epoch: 280, iter: 9526, loss: 0.5605105757713318, time cost4.00985312461853
epoch: 280, iter: 9527, loss: 0.7683165669441223, time cost3.375810146331787
epoch: 280, iter: 9528, loss: 0.7816546559333801, time cost3.2728476524353027
epoch: 280, iter: 9529, loss: 0.6173916459083557, time cost3.2460103034973145
epoch: 280, iter: 9530, loss: 0.6172133088111877, time cost3.3169307708740234
epoch: 280, iter: 9531, loss: 0.9510491490364075, time cost3.184211015701294
epoch: 280, iter: 9532, loss: 0.6635544896125793, time cost3.13847017288208
epoch: 280, iter: 9533, loss: 0.6573103666305542, time cost3.183995008468628
epoch: 280, iter: 9534, loss: 0.4722795784473419, time cost3.375609874725342
epoch: 280, iter: 9535, loss: 0.766566276550293, time cost3.26712703704834
epoch: 280, iter: 9536, loss: 0.49862679839134216, time cost3.2423789501190186
epoch: 280, iter: 9537, loss: 0.5135720372200012, time cost3.118851661682129
epoch: 280, iter: 9538, loss: 0.3990538716316223, time cost3.2817277908325195
epoch: 280, iter: 9539, loss: 0.7788693308830261, time cost3.138727903366089
epoch: 280, iter: 9540, loss: 1.0356266498565674, time cost3.4509072303771973
epoch: 280, iter: 9541, loss: 0.8664718270301819, time cost3.1431479454040527
epoch: 280, iter: 9542, loss: 0.38887548446655273, time cost3.2019155025482178
epoch: 280, iter: 9543, loss: 0.30952364206314087, time cost3.2268078327178955
epoch: 280, iter: 9544, loss: 0.8856676816940308, time cost3.08803653717041
epoch: 280, iter: 9545, loss: 0.46037566661834717, time cost3.125471353530884
epoch: 280, iter: 9546, loss: 1.073762059211731, time cost3.176614761352539
epoch: 280, iter: 9547, loss: 0.8110401630401611, time cost3.0850319862365723
epoch: 280, iter: 9548, loss: 0.7992165684700012, time cost3.1071417331695557
epoch: 280, iter: 9549, loss: 0.5029166340827942, time cost3.1146292686462402
epoch: 280, iter: 9550, loss: 0.7547832727432251, time cost3.1362528800964355
tensor([[ 92.,  75.,  81.,  ...,   2.,   2.,   3.],
        [ 96.,  60.,  55.,  ...,  14.,  14.,  12.],
        [ 51., 167.,  66.,  ...,   6.,   6.,   4.],
        ...,
        [ 70.,  66.,  45.,  ...,  25.,  25.,  15.],
        [ 60.,  69.,   7.,  ...,   1.,   1.,   1.],
        [ 78., 138., 179.,  ...,   1.,   1.,   5.]])
Epoch: 280, Iteration: 9550:
TEST A@1: 0.43333333333333335
TEST A@5: 0.7888888888888889
TEST A@10: 0.8977777777777778
TEST M@B: 0.354077258926621
TEST M@A: 0.9492777609603389
TEST W@MB: 0.18921777927356515
TEST W@MA: 0.5861521395980442
TEST Time: 103.60472583770752
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 280, iter: 9551, loss: 0.4758787155151367, time cost3.119706153869629
epoch: 280, iter: 9552, loss: 0.9409303069114685, time cost3.0155744552612305
epoch: 280, iter: 9553, loss: 0.6740881204605103, time cost2.799557685852051
epoch: 280, iter: 9554, loss: 0.692647397518158, time cost1.9868519306182861
epoch: 281, iter: 9555, loss: 0.7810086011886597, time cost3.1019287109375
epoch: 281, iter: 9556, loss: 0.8133925199508667, time cost3.4332802295684814
epoch: 281, iter: 9557, loss: 1.323958396911621, time cost3.139437675476074
epoch: 281, iter: 9558, loss: 0.9104956984519958, time cost3.162299394607544
epoch: 281, iter: 9559, loss: 0.5748611688613892, time cost3.062039613723755
epoch: 281, iter: 9560, loss: 0.7688339352607727, time cost3.417863607406616
epoch: 281, iter: 9561, loss: 0.7558274865150452, time cost3.1125550270080566
epoch: 281, iter: 9562, loss: 0.5045939087867737, time cost3.057969093322754
epoch: 281, iter: 9563, loss: 0.36774158477783203, time cost3.1991922855377197
epoch: 281, iter: 9564, loss: 0.6226478815078735, time cost3.272233009338379
epoch: 281, iter: 9565, loss: 0.7345103621482849, time cost3.0738184452056885
epoch: 281, iter: 9566, loss: 0.6772431135177612, time cost3.0100221633911133
epoch: 281, iter: 9567, loss: 0.49910813570022583, time cost3.0954747200012207
epoch: 281, iter: 9568, loss: 0.7039108276367188, time cost2.9177544116973877
epoch: 281, iter: 9569, loss: 0.5587683916091919, time cost3.108348846435547
epoch: 281, iter: 9570, loss: 0.32020965218544006, time cost2.9425411224365234
epoch: 281, iter: 9571, loss: 0.8753282427787781, time cost2.975736379623413
epoch: 281, iter: 9572, loss: 0.28634700179100037, time cost3.2833809852600098
epoch: 281, iter: 9573, loss: 0.4837922751903534, time cost3.425027370452881
epoch: 281, iter: 9574, loss: 0.9187164902687073, time cost3.368687152862549
epoch: 281, iter: 9575, loss: 0.5677812099456787, time cost3.0888895988464355
epoch: 281, iter: 9576, loss: 0.8125348091125488, time cost3.314619302749634
epoch: 281, iter: 9577, loss: 0.5926575660705566, time cost3.3054935932159424
epoch: 281, iter: 9578, loss: 0.6381771564483643, time cost3.1630568504333496
epoch: 281, iter: 9579, loss: 0.6039682030677795, time cost3.223571538925171
epoch: 281, iter: 9580, loss: 0.8596521615982056, time cost3.213219165802002
epoch: 281, iter: 9581, loss: 0.4126494824886322, time cost3.2289347648620605
epoch: 281, iter: 9582, loss: 0.6846802830696106, time cost3.173283576965332
epoch: 281, iter: 9583, loss: 0.6414958238601685, time cost3.0625674724578857
epoch: 281, iter: 9584, loss: 0.48494619131088257, time cost3.081886053085327
epoch: 281, iter: 9585, loss: 0.7468622922897339, time cost3.07002592086792
epoch: 281, iter: 9586, loss: 0.6517432332038879, time cost2.923361301422119
epoch: 281, iter: 9587, loss: 0.5231401920318604, time cost2.875575304031372
epoch: 281, iter: 9588, loss: 0.5662047863006592, time cost2.2247824668884277
epoch: 282, iter: 9589, loss: 0.32523366808891296, time cost3.416962146759033
epoch: 282, iter: 9590, loss: 0.7169194221496582, time cost3.252027750015259
epoch: 282, iter: 9591, loss: 0.4783751368522644, time cost3.1296229362487793
epoch: 282, iter: 9592, loss: 0.6636497378349304, time cost3.2063076496124268
epoch: 282, iter: 9593, loss: 0.8164222836494446, time cost3.2250277996063232
epoch: 282, iter: 9594, loss: 0.4865640699863434, time cost3.1815826892852783
epoch: 282, iter: 9595, loss: 0.37223726511001587, time cost3.167902708053589
epoch: 282, iter: 9596, loss: 0.735184907913208, time cost3.5347096920013428
epoch: 282, iter: 9597, loss: 1.0466593503952026, time cost3.3245322704315186
epoch: 282, iter: 9598, loss: 0.845346212387085, time cost3.4076106548309326
epoch: 282, iter: 9599, loss: 0.9455053210258484, time cost3.314422369003296
epoch: 282, iter: 9600, loss: 0.3684639036655426, time cost3.1612401008605957
tensor([[137.,  79.,  93.,  ...,   1.,   1.,   1.],
        [  3.,   5.,   5.,  ...,   5.,   5.,   3.],
        [101., 200., 101.,  ...,   3.,   3.,   1.],
        ...,
        [ 48.,  50.,  17.,  ...,   9.,   9.,   9.],
        [ 32.,  27.,   4.,  ...,   1.,   1.,   1.],
        [ 54., 163., 205.,  ...,   1.,   1.,   2.]])
Epoch: 282, Iteration: 9600:
TEST A@1: 0.5466666666666666
TEST A@5: 0.8911111111111111
TEST A@10: 0.96
TEST M@B: 0.43721459104254473
TEST M@A: 0.9603064308471623
TEST W@MB: 0.2353728852449493
TEST W@MA: 0.5942516365548258
TEST Time: 95.78070306777954
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 282, iter: 9601, loss: 0.3428901731967926, time cost3.137113571166992
epoch: 282, iter: 9602, loss: 0.8857502937316895, time cost3.1715872287750244
epoch: 282, iter: 9603, loss: 0.7997974753379822, time cost3.209892749786377
epoch: 282, iter: 9604, loss: 0.3634744882583618, time cost3.2390148639678955
epoch: 282, iter: 9605, loss: 0.25469154119491577, time cost3.2025718688964844
epoch: 282, iter: 9606, loss: 0.693580687046051, time cost3.3465945720672607
epoch: 282, iter: 9607, loss: 0.4540480673313141, time cost3.2667007446289062
epoch: 282, iter: 9608, loss: 0.5892826318740845, time cost3.0299055576324463
epoch: 282, iter: 9609, loss: 0.7369155883789062, time cost3.3900861740112305
epoch: 282, iter: 9610, loss: 0.8938958644866943, time cost3.187852382659912
epoch: 282, iter: 9611, loss: 0.3838590979576111, time cost3.1758272647857666
epoch: 282, iter: 9612, loss: 0.8328292369842529, time cost3.1470656394958496
epoch: 282, iter: 9613, loss: 0.44814983010292053, time cost3.1145408153533936
epoch: 282, iter: 9614, loss: 0.7208220958709717, time cost3.2295897006988525
epoch: 282, iter: 9615, loss: 0.46490705013275146, time cost3.1209139823913574
epoch: 282, iter: 9616, loss: 0.6159093976020813, time cost3.2137320041656494
epoch: 282, iter: 9617, loss: 0.8946126699447632, time cost3.1547670364379883
epoch: 282, iter: 9618, loss: 0.48269009590148926, time cost3.210808038711548
epoch: 282, iter: 9619, loss: 0.5000223517417908, time cost3.2856545448303223
epoch: 282, iter: 9620, loss: 0.7293491363525391, time cost3.1515235900878906
epoch: 282, iter: 9621, loss: 1.2314294576644897, time cost3.2748143672943115
epoch: 282, iter: 9622, loss: 0.72318434715271, time cost2.244436264038086
epoch: 283, iter: 9623, loss: 0.5628119111061096, time cost3.2446513175964355
epoch: 283, iter: 9624, loss: 0.5676864385604858, time cost3.2787296772003174
epoch: 283, iter: 9625, loss: 0.5240038633346558, time cost3.4328014850616455
epoch: 283, iter: 9626, loss: 0.32651180028915405, time cost3.3261711597442627
epoch: 283, iter: 9627, loss: 0.9748218059539795, time cost3.1690821647644043
epoch: 283, iter: 9628, loss: 0.7031247019767761, time cost3.261587619781494
epoch: 283, iter: 9629, loss: 0.4641050398349762, time cost3.251028299331665
epoch: 283, iter: 9630, loss: 0.6615486741065979, time cost3.4214046001434326
epoch: 283, iter: 9631, loss: 0.5754826068878174, time cost3.188830614089966
epoch: 283, iter: 9632, loss: 0.838283896446228, time cost3.3026247024536133
epoch: 283, iter: 9633, loss: 0.6316815614700317, time cost3.247645854949951
epoch: 283, iter: 9634, loss: 0.6263765692710876, time cost3.1655161380767822
epoch: 283, iter: 9635, loss: 0.6968736052513123, time cost3.1956794261932373
epoch: 283, iter: 9636, loss: 0.5634737014770508, time cost3.286040782928467
epoch: 283, iter: 9637, loss: 0.757132887840271, time cost3.731031656265259
epoch: 283, iter: 9638, loss: 0.7110805511474609, time cost3.157744884490967
epoch: 283, iter: 9639, loss: 0.774555504322052, time cost3.3745200634002686
epoch: 283, iter: 9640, loss: 0.9261248707771301, time cost3.5268070697784424
epoch: 283, iter: 9641, loss: 0.7154850363731384, time cost3.217472553253174
epoch: 283, iter: 9642, loss: 0.8392778635025024, time cost3.130687952041626
epoch: 283, iter: 9643, loss: 0.2887144982814789, time cost3.1574814319610596
epoch: 283, iter: 9644, loss: 0.7617090940475464, time cost3.21842622756958
epoch: 283, iter: 9645, loss: 0.7254640460014343, time cost3.3956644535064697
epoch: 283, iter: 9646, loss: 0.4900319576263428, time cost3.2462637424468994
epoch: 283, iter: 9647, loss: 0.5268634557723999, time cost3.318805456161499
epoch: 283, iter: 9648, loss: 0.7698347568511963, time cost3.1880710124969482
epoch: 283, iter: 9649, loss: 0.5463880300521851, time cost3.1445953845977783
epoch: 283, iter: 9650, loss: 0.5154926180839539, time cost3.1540908813476562
tensor([[ 12.,   9.,   9.,  ...,   3.,   3.,   2.],
        [ 71.,  44.,  42.,  ...,  12.,  12.,   3.],
        [137., 272., 146.,  ...,   2.,   2.,   1.],
        ...,
        [ 35.,  33.,  14.,  ...,  11.,  11.,   5.],
        [135., 133.,  22.,  ...,   1.,   1.,   1.],
        [ 48.,  70.,  79.,  ...,   2.,   2.,   4.]])
Epoch: 283, Iteration: 9650:
TEST A@1: 0.5622222222222222
TEST A@5: 0.9044444444444445
TEST A@10: 0.9622222222222222
TEST M@B: 0.4304648903604034
TEST M@A: 0.9574925590606909
TEST W@MB: 0.23005620804642007
TEST W@MA: 0.5919852206868479
TEST Time: 100.33014154434204
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 283, iter: 9651, loss: 0.8404149413108826, time cost3.1543943881988525
epoch: 283, iter: 9652, loss: 0.42469316720962524, time cost3.047614336013794
epoch: 283, iter: 9653, loss: 0.8923845887184143, time cost3.1167850494384766
epoch: 283, iter: 9654, loss: 0.7995144128799438, time cost3.1622226238250732
epoch: 283, iter: 9655, loss: 0.6118521094322205, time cost3.332712411880493
epoch: 283, iter: 9656, loss: 0.6632255911827087, time cost2.31363582611084
epoch: 284, iter: 9657, loss: 1.0687707662582397, time cost3.533499002456665
epoch: 284, iter: 9658, loss: 1.0741407871246338, time cost3.392667293548584
epoch: 284, iter: 9659, loss: 0.9473036527633667, time cost3.385742425918579
epoch: 284, iter: 9660, loss: 0.6617518663406372, time cost3.3243534564971924
epoch: 284, iter: 9661, loss: 1.1845250129699707, time cost3.3041441440582275
epoch: 284, iter: 9662, loss: 0.5687066316604614, time cost3.172731399536133
epoch: 284, iter: 9663, loss: 0.6382309198379517, time cost3.268805503845215
epoch: 284, iter: 9664, loss: 0.7495446801185608, time cost3.1490366458892822
epoch: 284, iter: 9665, loss: 0.6307500600814819, time cost3.159085750579834
epoch: 284, iter: 9666, loss: 1.060837984085083, time cost3.366305112838745
epoch: 284, iter: 9667, loss: 0.7818057537078857, time cost3.263916015625
epoch: 284, iter: 9668, loss: 0.575576901435852, time cost3.209998607635498
epoch: 284, iter: 9669, loss: 0.6997871398925781, time cost3.1828317642211914
epoch: 284, iter: 9670, loss: 0.8065349459648132, time cost3.1803088188171387
epoch: 284, iter: 9671, loss: 0.6160252094268799, time cost3.2374579906463623
epoch: 284, iter: 9672, loss: 0.501271665096283, time cost3.0962815284729004
epoch: 284, iter: 9673, loss: 0.6923295855522156, time cost3.352933645248413
epoch: 284, iter: 9674, loss: 0.8581796884536743, time cost3.3027234077453613
epoch: 284, iter: 9675, loss: 0.988694429397583, time cost3.8890674114227295
epoch: 284, iter: 9676, loss: 0.4684782326221466, time cost3.297090768814087
epoch: 284, iter: 9677, loss: 0.43045148253440857, time cost3.2566215991973877
epoch: 284, iter: 9678, loss: 0.5879049897193909, time cost3.131732940673828
epoch: 284, iter: 9679, loss: 0.6599122881889343, time cost3.302061080932617
epoch: 284, iter: 9680, loss: 1.078321933746338, time cost3.0912580490112305
epoch: 284, iter: 9681, loss: 0.7680636048316956, time cost3.1754262447357178
epoch: 284, iter: 9682, loss: 0.679980993270874, time cost3.1863889694213867
epoch: 284, iter: 9683, loss: 0.8514468669891357, time cost3.138368606567383
epoch: 284, iter: 9684, loss: 0.8323419690132141, time cost3.0757226943969727
epoch: 284, iter: 9685, loss: 0.830662727355957, time cost3.110198974609375
epoch: 284, iter: 9686, loss: 0.7268047332763672, time cost3.1746907234191895
epoch: 284, iter: 9687, loss: 0.8522862195968628, time cost3.2564589977264404
epoch: 284, iter: 9688, loss: 0.855207085609436, time cost3.111204147338867
epoch: 284, iter: 9689, loss: 0.19444358348846436, time cost3.173713207244873
epoch: 284, iter: 9690, loss: 0.4694106876850128, time cost2.314081907272339
epoch: 285, iter: 9691, loss: 0.8625522255897522, time cost3.4189023971557617
epoch: 285, iter: 9692, loss: 0.7075951099395752, time cost3.3428022861480713
epoch: 285, iter: 9693, loss: 0.9765471816062927, time cost3.2945635318756104
epoch: 285, iter: 9694, loss: 0.45771878957748413, time cost3.268632650375366
epoch: 285, iter: 9695, loss: 0.8806412220001221, time cost3.287269353866577
epoch: 285, iter: 9696, loss: 0.8232678174972534, time cost3.2251715660095215
epoch: 285, iter: 9697, loss: 0.6203344464302063, time cost3.6662955284118652
epoch: 285, iter: 9698, loss: 0.6184848546981812, time cost3.3010647296905518
epoch: 285, iter: 9699, loss: 0.5326083898544312, time cost3.239081382751465
epoch: 285, iter: 9700, loss: 0.3488617241382599, time cost3.346242904663086
tensor([[ 32.,  19.,  21.,  ...,   1.,   1.,   1.],
        [ 35.,  21.,  21.,  ...,   8.,   8.,   7.],
        [ 32., 137.,  26.,  ...,   1.,   1.,   1.],
        ...,
        [ 33.,  27.,  14.,  ...,  29.,  29.,  10.],
        [ 77.,  47.,  16.,  ...,   1.,   1.,   1.],
        [ 28.,  66.,  45.,  ...,   3.,   3.,   5.]])
Epoch: 285, Iteration: 9700:
TEST A@1: 0.4711111111111111
TEST A@5: 0.8222222222222222
TEST A@10: 0.9244444444444444
TEST M@B: 0.3926575410713632
TEST M@A: 0.9537774957719125
TEST W@MB: 0.21036841201333326
TEST W@MA: 0.5895259201317409
TEST Time: 98.24147343635559
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 285, iter: 9701, loss: 0.8239280581474304, time cost3.1130404472351074
epoch: 285, iter: 9702, loss: 0.4992833435535431, time cost3.202226161956787
epoch: 285, iter: 9703, loss: 0.5298532843589783, time cost3.1743226051330566
epoch: 285, iter: 9704, loss: 1.2911866903305054, time cost3.1294569969177246
epoch: 285, iter: 9705, loss: 0.7455694675445557, time cost3.2605462074279785
epoch: 285, iter: 9706, loss: 0.27683818340301514, time cost3.2136292457580566
epoch: 285, iter: 9707, loss: 0.48879343271255493, time cost3.269163131713867
epoch: 285, iter: 9708, loss: 0.5719871520996094, time cost3.2715446949005127
epoch: 285, iter: 9709, loss: 0.630923330783844, time cost3.1501903533935547
epoch: 285, iter: 9710, loss: 0.7394468784332275, time cost3.165149211883545
epoch: 285, iter: 9711, loss: 0.2842664420604706, time cost3.224824905395508
epoch: 285, iter: 9712, loss: 0.7190836071968079, time cost3.17877197265625
epoch: 285, iter: 9713, loss: 0.856513500213623, time cost3.338589668273926
epoch: 285, iter: 9714, loss: 1.1618729829788208, time cost3.190310478210449
epoch: 285, iter: 9715, loss: 0.701103925704956, time cost3.2501113414764404
epoch: 285, iter: 9716, loss: 0.34820348024368286, time cost3.4010865688323975
epoch: 285, iter: 9717, loss: 0.40055161714553833, time cost3.3034427165985107
epoch: 285, iter: 9718, loss: 0.6744176745414734, time cost3.331965684890747
epoch: 285, iter: 9719, loss: 0.41000375151634216, time cost3.149151563644409
epoch: 285, iter: 9720, loss: 0.5947003960609436, time cost3.2517082691192627
epoch: 285, iter: 9721, loss: 0.6630417108535767, time cost3.2162790298461914
epoch: 285, iter: 9722, loss: 0.42107242345809937, time cost3.2682056427001953
epoch: 285, iter: 9723, loss: 0.8950750827789307, time cost3.2255468368530273
epoch: 285, iter: 9724, loss: 0.5711125135421753, time cost2.357224702835083
epoch: 286, iter: 9725, loss: 0.5424129962921143, time cost3.2566208839416504
epoch: 286, iter: 9726, loss: 0.22760455310344696, time cost3.1584293842315674
epoch: 286, iter: 9727, loss: 0.7274752259254456, time cost3.216820001602173
epoch: 286, iter: 9728, loss: 1.0185648202896118, time cost3.5467369556427
epoch: 286, iter: 9729, loss: 0.4777378439903259, time cost3.340712547302246
epoch: 286, iter: 9730, loss: 0.9695310592651367, time cost3.2900826930999756
epoch: 286, iter: 9731, loss: 0.6403342485427856, time cost3.486212968826294
epoch: 286, iter: 9732, loss: 0.8291696310043335, time cost3.4686062335968018
epoch: 286, iter: 9733, loss: 0.534549355506897, time cost3.410897970199585
epoch: 286, iter: 9734, loss: 0.9664648771286011, time cost3.2650458812713623
epoch: 286, iter: 9735, loss: 0.41568151116371155, time cost3.4933128356933594
epoch: 286, iter: 9736, loss: 0.7927088737487793, time cost3.268317222595215
epoch: 286, iter: 9737, loss: 0.6068282723426819, time cost3.3467648029327393
epoch: 286, iter: 9738, loss: 0.7930089831352234, time cost3.6599197387695312
epoch: 286, iter: 9739, loss: 0.6239144206047058, time cost3.4641077518463135
epoch: 286, iter: 9740, loss: 0.549693763256073, time cost3.230520725250244
epoch: 286, iter: 9741, loss: 0.4477726221084595, time cost3.21992826461792
epoch: 286, iter: 9742, loss: 0.7488031983375549, time cost2.8693392276763916
epoch: 286, iter: 9743, loss: 0.6292350888252258, time cost2.953770637512207
epoch: 286, iter: 9744, loss: 0.5998950600624084, time cost2.956753969192505
epoch: 286, iter: 9745, loss: 0.618720531463623, time cost3.381425619125366
epoch: 286, iter: 9746, loss: 0.6019641757011414, time cost3.318737268447876
epoch: 286, iter: 9747, loss: 0.3942002058029175, time cost3.2164969444274902
epoch: 286, iter: 9748, loss: 0.6263195872306824, time cost3.228384494781494
epoch: 286, iter: 9749, loss: 0.4050608277320862, time cost3.276914358139038
epoch: 286, iter: 9750, loss: 0.48165884613990784, time cost3.0849554538726807
tensor([[115.,  78.,  87.,  ...,   4.,   4.,   3.],
        [ 13.,  12.,  12.,  ...,  10.,  10.,   4.],
        [ 75., 161.,  98.,  ...,   5.,   5.,   3.],
        ...,
        [ 65.,  61.,  43.,  ...,  14.,  14.,   5.],
        [ 64.,  59.,  12.,  ...,   1.,   1.,   1.],
        [ 93., 138., 146.,  ...,   2.,   2.,   2.]])
Epoch: 286, Iteration: 9750:
TEST A@1: 0.5244444444444445
TEST A@5: 0.8933333333333333
TEST A@10: 0.9622222222222222
TEST M@B: 0.42716146815137207
TEST M@A: 0.960084986725689
TEST W@MB: 0.22961992701883852
TEST W@MA: 0.5941039325416305
TEST Time: 116.20911455154419
REAL performance: Top1: 0.5844444444444444, Top5: 0.9022222222222223, Top10: 0.9688888888888889, MB: 0.4472062327948879, MA: 0.9596503701437679, WMB: 0.24074473162826146, WMA: 0.5936992482962913
epoch: 286, iter: 9751, loss: 0.490823894739151, time cost3.075279951095581
epoch: 286, iter: 9752, loss: 0.5351682901382446, time cost3.2677392959594727
epoch: 286, iter: 9753, loss: 0.3488869369029999, time cost3.109412908554077
epoch: 286, iter: 9754, loss: 0.39503324031829834, time cost3.1759889125823975
epoch: 286, iter: 9755, loss: 0.30655571818351746, time cost3.191429376602173
epoch: 286, iter: 9756, loss: 0.27705106139183044, time cost3.1690850257873535
epoch: 286, iter: 9757, loss: 1.1217656135559082, time cost3.183131217956543
epoch: 286, iter: 9758, loss: 0.5463126301765442, time cost2.2131569385528564
epoch: 287, iter: 9759, loss: 0.4400728940963745, time cost3.2559967041015625
epoch: 287, iter: 9760, loss: 0.2926664352416992, time cost3.1360092163085938
epoch: 287, iter: 9761, loss: 0.6987367272377014, time cost3.142587900161743
epoch: 287, iter: 9762, loss: 0.6597858667373657, time cost3.2519288063049316
epoch: 287, iter: 9763, loss: 0.43717581033706665, time cost3.055109739303589
epoch: 287, iter: 9764, loss: 0.46868404746055603, time cost3.2108938694000244
epoch: 287, iter: 9765, loss: 0.7673534154891968, time cost3.2429118156433105
epoch: 287, iter: 9766, loss: 0.6607366800308228, time cost3.314861536026001
epoch: 287, iter: 9767, loss: 0.4587637484073639, time cost3.5161378383636475
epoch: 287, iter: 9768, loss: 0.4413940906524658, time cost3.216390609741211
epoch: 287, iter: 9769, loss: 0.7785300612449646, time cost3.226591110229492
epoch: 287, iter: 9770, loss: 0.5340818166732788, time cost3.3276305198669434
epoch: 287, iter: 9771, loss: 0.4672549068927765, time cost3.359837532043457
epoch: 287, iter: 9772, loss: 0.4532376527786255, time cost3.2304883003234863
epoch: 287, iter: 9773, loss: 0.6206640601158142, time cost3.4677653312683105
epoch: 287, iter: 9774, loss: 1.056800127029419, time cost3.330859899520874
epoch: 287, iter: 9775, loss: 0.42788010835647583, time cost3.517207145690918
epoch: 287, iter: 9776, loss: 0.5955641865730286, time cost3.206571340560913
epoch: 287, iter: 9777, loss: 0.706346869468689, time cost3.172062397003174
epoch: 287, iter: 9778, loss: 0.45647263526916504, time cost3.3914148807525635
epoch: 287, iter: 9779, loss: 0.2989698648452759, time cost3.306997537612915
epoch: 287, iter: 9780, loss: 0.464336633682251, time cost3.115886926651001
epoch: 287, iter: 9781, loss: 0.7239848971366882, time cost3.3254706859588623
epoch: 287, iter: 9782, loss: 0.36796650290489197, time cost3.1858460903167725
epoch: 287, iter: 9783, loss: 0.4800233244895935, time cost3.2293622493743896
epoch: 287, iter: 9784, loss: 0.47211676836013794, time cost3.279115915298462
epoch: 287, iter: 9785, loss: 0.8398382067680359, time cost3.286797046661377
epoch: 287, iter: 9786, loss: 0.737252950668335, time cost3.123292922973633
epoch: 287, iter: 9787, loss: 0.5246410369873047, time cost3.1560075283050537
epoch: 287, iter: 9788, loss: 1.247554898262024, time cost3.138286590576172
epoch: 287, iter: 9789, loss: 0.9504064917564392, time cost3.1625258922576904
epoch: 287, iter: 9790, loss: 0.4036925435066223, time cost3.2721304893493652
epoch: 287, iter: 9791, loss: 0.2946433126926422, time cost3.147118330001831
epoch: 287, iter: 9792, loss: 0.4963165521621704, time cost2.1694061756134033
epoch: 288, iter: 9793, loss: 0.4724220037460327, time cost3.2551729679107666
epoch: 288, iter: 9794, loss: 0.6596121788024902, time cost3.1728837490081787
epoch: 288, iter: 9795, loss: 0.6340948939323425, time cost3.3448002338409424
epoch: 288, iter: 9796, loss: 0.7120543122291565, time cost3.251986265182495
epoch: 288, iter: 9797, loss: 0.4794441759586334, time cost3.28120756149292
epoch: 288, iter: 9798, loss: 0.6581218242645264, time cost3.3041234016418457
epoch: 288, iter: 9799, loss: 0.4086281657218933, time cost3.137098550796509
epoch: 288, iter: 9800, loss: 0.9420880079269409, time cost3.2536826133728027
tensor([[108.,  72.,  78.,  ...,   2.,   2.,   2.],
        [ 30.,  28.,  27.,  ...,  11.,  11.,   5.],
        [ 70., 168.,  49.,  ...,   1.,   1.,   1.],
        ...,
        [ 42.,  40.,  29.,  ...,   8.,   8.,   4.],
        [ 19.,  23.,   4.,  ...,   1.,   1.,   1.],
        [ 73., 165., 167.,  ...,   1.,   1.,   1.]])
Epoch: 288, Iteration: 9800:
TEST A@1: 0.5933333333333334
TEST A@5: 0.9
TEST A@10: 0.96
TEST M@B: 0.45480400081024613
TEST M@A: 0.962217132343822
TEST W@MB: 0.24563148898567516
TEST W@MA: 0.5957424736733955
TEST Time: 103.61436867713928
Model Updated
REAL performance: Top1: 0.5933333333333334, Top5: 0.9, Top10: 0.96, MB: 0.45480400081024613, MA: 0.962217132343822, WMB: 0.24563148898567516, WMA: 0.5957424736733955
epoch: 288, iter: 9801, loss: 0.5677779912948608, time cost3.0085275173187256
epoch: 288, iter: 9802, loss: 0.49114373326301575, time cost3.2718875408172607
epoch: 288, iter: 9803, loss: 1.2265173196792603, time cost3.2068371772766113
epoch: 288, iter: 9804, loss: 0.38387569785118103, time cost3.2270359992980957
epoch: 288, iter: 9805, loss: 0.6410064101219177, time cost3.2669296264648438
epoch: 288, iter: 9806, loss: 0.3874267339706421, time cost3.2508771419525146
epoch: 288, iter: 9807, loss: 0.8120052814483643, time cost3.3370590209960938
epoch: 288, iter: 9808, loss: 0.4230017364025116, time cost3.2851057052612305
epoch: 288, iter: 9809, loss: 0.28179681301116943, time cost3.174651861190796
epoch: 288, iter: 9810, loss: 0.936876654624939, time cost3.3094234466552734
epoch: 288, iter: 9811, loss: 0.3549855947494507, time cost3.3222975730895996
epoch: 288, iter: 9812, loss: 0.9837399125099182, time cost3.2759127616882324
epoch: 288, iter: 9813, loss: 0.6893709897994995, time cost3.198288917541504
epoch: 288, iter: 9814, loss: 0.5449914932250977, time cost3.2369563579559326
epoch: 288, iter: 9815, loss: 0.6073681712150574, time cost3.2497217655181885
epoch: 288, iter: 9816, loss: 0.6576048731803894, time cost3.290678024291992
epoch: 288, iter: 9817, loss: 0.5931762456893921, time cost3.18403959274292
epoch: 288, iter: 9818, loss: 0.4367924928665161, time cost3.180509090423584
epoch: 288, iter: 9819, loss: 0.48229095339775085, time cost3.3643674850463867
epoch: 288, iter: 9820, loss: 0.3911338150501251, time cost3.131091594696045
epoch: 288, iter: 9821, loss: 0.7209708094596863, time cost3.273015022277832
epoch: 288, iter: 9822, loss: 0.6418247222900391, time cost3.2314841747283936
epoch: 288, iter: 9823, loss: 0.7766657471656799, time cost3.2192840576171875
epoch: 288, iter: 9824, loss: 0.9435389637947083, time cost3.1547975540161133
epoch: 288, iter: 9825, loss: 0.6462705135345459, time cost3.393500566482544
epoch: 288, iter: 9826, loss: 0.3759729862213135, time cost2.348766326904297
epoch: 289, iter: 9827, loss: 0.2472466081380844, time cost3.5021846294403076
epoch: 289, iter: 9828, loss: 0.555673360824585, time cost3.529677391052246
epoch: 289, iter: 9829, loss: 0.5971741676330566, time cost3.235837936401367
epoch: 289, iter: 9830, loss: 0.47662946581840515, time cost3.396073579788208
epoch: 289, iter: 9831, loss: 0.6286485195159912, time cost3.311418294906616
epoch: 289, iter: 9832, loss: 0.890185534954071, time cost3.191864013671875
epoch: 289, iter: 9833, loss: 0.5366681814193726, time cost3.2712836265563965
epoch: 289, iter: 9834, loss: 0.6792458295822144, time cost3.38486647605896
epoch: 289, iter: 9835, loss: 0.6445273756980896, time cost3.274317502975464
epoch: 289, iter: 9836, loss: 0.6287701725959778, time cost3.2895290851593018
epoch: 289, iter: 9837, loss: 0.9215719699859619, time cost3.2652337551116943
epoch: 289, iter: 9838, loss: 0.38183531165122986, time cost3.6415960788726807
epoch: 289, iter: 9839, loss: 1.1121044158935547, time cost3.3145229816436768
epoch: 289, iter: 9840, loss: 0.6194559335708618, time cost3.3926749229431152
epoch: 289, iter: 9841, loss: 0.6126134991645813, time cost3.335786819458008
epoch: 289, iter: 9842, loss: 0.4065863788127899, time cost3.373953342437744
epoch: 289, iter: 9843, loss: 0.5974875688552856, time cost3.4423248767852783
epoch: 289, iter: 9844, loss: 0.5794035196304321, time cost3.204648733139038
epoch: 289, iter: 9845, loss: 0.612099826335907, time cost3.225139617919922
epoch: 289, iter: 9846, loss: 0.9370085597038269, time cost3.1179749965667725
epoch: 289, iter: 9847, loss: 0.3890911638736725, time cost3.1686513423919678
epoch: 289, iter: 9848, loss: 0.8957050442695618, time cost3.271519660949707
epoch: 289, iter: 9849, loss: 0.48526421189308167, time cost3.28621768951416
epoch: 289, iter: 9850, loss: 0.6722145676612854, time cost3.236950159072876
tensor([[108.,  69.,  71.,  ...,   2.,   2.,   1.],
        [ 37.,  25.,  23.,  ...,   9.,   9.,   6.],
        [ 54., 181.,  66.,  ...,   1.,   1.,   1.],
        ...,
        [ 18.,  14.,   4.,  ...,   5.,   5.,   3.],
        [ 15.,  15.,   7.,  ...,   1.,   1.,   1.],
        [ 37., 115.,  97.,  ...,   1.,   1.,   2.]])
Epoch: 289, Iteration: 9850:
TEST A@1: 0.5244444444444445
TEST A@5: 0.8622222222222222
TEST A@10: 0.9511111111111111
TEST M@B: 0.4116177645936519
TEST M@A: 0.9572793867284994
TEST W@MB: 0.22144782546883301
TEST W@MA: 0.5918835747538782
TEST Time: 100.82443571090698
REAL performance: Top1: 0.5933333333333334, Top5: 0.9, Top10: 0.96, MB: 0.45480400081024613, MA: 0.962217132343822, WMB: 0.24563148898567516, WMA: 0.5957424736733955
epoch: 289, iter: 9851, loss: 0.5224331617355347, time cost3.0772244930267334
epoch: 289, iter: 9852, loss: 0.7251006364822388, time cost3.2350308895111084
epoch: 289, iter: 9853, loss: 0.5252414345741272, time cost3.2274911403656006
epoch: 289, iter: 9854, loss: 0.5991737246513367, time cost3.050931930541992
epoch: 289, iter: 9855, loss: 0.4658413827419281, time cost3.189547300338745
epoch: 289, iter: 9856, loss: 0.6246815919876099, time cost3.1029274463653564
epoch: 289, iter: 9857, loss: 0.574896514415741, time cost3.412564754486084
epoch: 289, iter: 9858, loss: 0.6391485929489136, time cost3.162053108215332
epoch: 289, iter: 9859, loss: 0.514850378036499, time cost3.0992043018341064
epoch: 289, iter: 9860, loss: 0.41377291083335876, time cost2.310274362564087
epoch: 290, iter: 9861, loss: 0.6744586229324341, time cost3.243807792663574
epoch: 290, iter: 9862, loss: 0.6655236482620239, time cost3.2418622970581055
epoch: 290, iter: 9863, loss: 0.9280874133110046, time cost3.494795322418213
epoch: 290, iter: 9864, loss: 0.7042285799980164, time cost3.382293224334717
epoch: 290, iter: 9865, loss: 0.5660102963447571, time cost3.3940725326538086
epoch: 290, iter: 9866, loss: 0.4788128137588501, time cost3.5139176845550537
epoch: 290, iter: 9867, loss: 0.5986558794975281, time cost3.240067481994629
epoch: 290, iter: 9868, loss: 0.8990327715873718, time cost3.251661539077759
epoch: 290, iter: 9869, loss: 0.5541877150535583, time cost3.317903757095337
epoch: 290, iter: 9870, loss: 1.0650880336761475, time cost3.268791437149048
epoch: 290, iter: 9871, loss: 0.5467962622642517, time cost3.394700288772583
epoch: 290, iter: 9872, loss: 0.5317220091819763, time cost3.3118371963500977
epoch: 290, iter: 9873, loss: 0.6009104251861572, time cost3.3594114780426025
epoch: 290, iter: 9874, loss: 0.5272780656814575, time cost3.169792890548706
epoch: 290, iter: 9875, loss: 0.47848832607269287, time cost3.260363817214966
epoch: 290, iter: 9876, loss: 0.6987858414649963, time cost3.3964555263519287
epoch: 290, iter: 9877, loss: 1.0056283473968506, time cost3.2901880741119385
epoch: 290, iter: 9878, loss: 0.8443260192871094, time cost3.4846112728118896
epoch: 290, iter: 9879, loss: 0.2537662088871002, time cost3.2916619777679443
epoch: 290, iter: 9880, loss: 0.44707396626472473, time cost3.302210807800293
epoch: 290, iter: 9881, loss: 0.6454700827598572, time cost3.194661855697632
epoch: 290, iter: 9882, loss: 0.7626475095748901, time cost3.372663974761963
epoch: 290, iter: 9883, loss: 0.4581270217895508, time cost3.2138288021087646
epoch: 290, iter: 9884, loss: 0.4933378994464874, time cost3.192671537399292
epoch: 290, iter: 9885, loss: 0.7337568998336792, time cost3.2884249687194824
epoch: 290, iter: 9886, loss: 0.3199920952320099, time cost3.1520655155181885
epoch: 290, iter: 9887, loss: 0.5149570107460022, time cost3.1768901348114014
epoch: 290, iter: 9888, loss: 0.9055057168006897, time cost3.1089963912963867
epoch: 290, iter: 9889, loss: 0.4112953841686249, time cost3.306433916091919
epoch: 290, iter: 9890, loss: 0.6799135804176331, time cost3.193557024002075
epoch: 290, iter: 9891, loss: 0.729050874710083, time cost3.1667797565460205
epoch: 290, iter: 9892, loss: 0.6275860667228699, time cost3.2189059257507324
epoch: 290, iter: 9893, loss: 0.8073029518127441, time cost3.142662286758423
epoch: 290, iter: 9894, loss: 0.5419667959213257, time cost2.2564849853515625
epoch: 291, iter: 9895, loss: 0.8483348488807678, time cost3.3679826259613037
epoch: 291, iter: 9896, loss: 0.3943686783313751, time cost3.3068995475769043
epoch: 291, iter: 9897, loss: 0.35611671209335327, time cost3.327948808670044
epoch: 291, iter: 9898, loss: 0.8643050193786621, time cost3.4754509925842285
epoch: 291, iter: 9899, loss: 0.5091315507888794, time cost3.3073008060455322
epoch: 291, iter: 9900, loss: 0.7032051086425781, time cost3.2570080757141113
tensor([[109.,  73.,  89.,  ...,   2.,   2.,   3.],
        [ 51.,  39.,  35.,  ...,  12.,  12.,   6.],
        [ 76., 234.,  88.,  ...,   2.,   2.,   1.],
        ...,
        [ 61.,  59.,  38.,  ...,  17.,  17.,   6.],
        [ 19.,  14.,  12.,  ...,   1.,   1.,   1.],
        [114., 198., 218.,  ...,   1.,   1.,   1.]])
Epoch: 291, Iteration: 9900:
TEST A@1: 0.5133333333333333
TEST A@5: 0.8688888888888889
TEST A@10: 0.94
TEST M@B: 0.4123146023814373
TEST M@A: 0.9577059435375804
TEST W@MB: 0.22171132339854618
TEST W@MA: 0.5922800248494278
TEST Time: 102.21532201766968
REAL performance: Top1: 0.5933333333333334, Top5: 0.9, Top10: 0.96, MB: 0.45480400081024613, MA: 0.962217132343822, WMB: 0.24563148898567516, WMA: 0.5957424736733955
epoch: 291, iter: 9901, loss: 0.33636483550071716, time cost3.0331177711486816
epoch: 291, iter: 9902, loss: 0.5524478554725647, time cost3.300405263900757
epoch: 291, iter: 9903, loss: 0.6086896657943726, time cost3.196930170059204
epoch: 291, iter: 9904, loss: 0.6315205097198486, time cost3.551888942718506
epoch: 291, iter: 9905, loss: 0.4410824477672577, time cost4.114490032196045
epoch: 291, iter: 9906, loss: 0.5441957116127014, time cost3.330064058303833
epoch: 291, iter: 9907, loss: 0.46523773670196533, time cost3.450111150741577
epoch: 291, iter: 9908, loss: 0.7083365321159363, time cost3.4293246269226074
epoch: 291, iter: 9909, loss: 0.5389667749404907, time cost2.9663658142089844
epoch: 291, iter: 9910, loss: 0.7478859424591064, time cost3.0536539554595947
epoch: 291, iter: 9911, loss: 0.7498118877410889, time cost3.2711570262908936
epoch: 291, iter: 9912, loss: 0.6946452856063843, time cost3.4476654529571533
epoch: 291, iter: 9913, loss: 0.49555325508117676, time cost3.1956140995025635
epoch: 291, iter: 9914, loss: 0.23601269721984863, time cost3.7012007236480713
epoch: 291, iter: 9915, loss: 0.38474106788635254, time cost3.364813804626465
epoch: 291, iter: 9916, loss: 1.000156283378601, time cost3.3775241374969482
epoch: 291, iter: 9917, loss: 0.7391505241394043, time cost3.3133420944213867
epoch: 291, iter: 9918, loss: 0.4933129847049713, time cost3.2381691932678223
epoch: 291, iter: 9919, loss: 0.8203557133674622, time cost3.328031301498413
epoch: 291, iter: 9920, loss: 0.6937092542648315, time cost3.0578668117523193
epoch: 291, iter: 9921, loss: 0.541128933429718, time cost3.011897325515747
epoch: 291, iter: 9922, loss: 0.505580484867096, time cost3.3153445720672607
epoch: 291, iter: 9923, loss: 0.5656724572181702, time cost3.486921548843384
epoch: 291, iter: 9924, loss: 0.8252231478691101, time cost3.385401964187622
epoch: 291, iter: 9925, loss: 0.4555363953113556, time cost3.2376351356506348
epoch: 291, iter: 9926, loss: 0.9071820378303528, time cost3.4071199893951416
epoch: 291, iter: 9927, loss: 0.5952174067497253, time cost3.1923828125
epoch: 291, iter: 9928, loss: 0.615578293800354, time cost2.3078222274780273
epoch: 292, iter: 9929, loss: 0.8398746252059937, time cost3.4294352531433105
epoch: 292, iter: 9930, loss: 1.0930718183517456, time cost3.3166778087615967
epoch: 292, iter: 9931, loss: 0.4098775088787079, time cost3.122835159301758
epoch: 292, iter: 9932, loss: 0.675792932510376, time cost3.4948790073394775
epoch: 292, iter: 9933, loss: 0.6513440608978271, time cost3.4032037258148193
epoch: 292, iter: 9934, loss: 0.6444370150566101, time cost3.179903745651245
epoch: 292, iter: 9935, loss: 0.4190792143344879, time cost3.2574939727783203
epoch: 292, iter: 9936, loss: 0.43616247177124023, time cost3.30820894241333
epoch: 292, iter: 9937, loss: 0.5562305450439453, time cost3.534677267074585
epoch: 292, iter: 9938, loss: 0.7035917639732361, time cost3.333033800125122
epoch: 292, iter: 9939, loss: 0.6442739367485046, time cost3.333420753479004
epoch: 292, iter: 9940, loss: 0.6861746907234192, time cost3.3241031169891357
epoch: 292, iter: 9941, loss: 0.5724952220916748, time cost3.2251222133636475
epoch: 292, iter: 9942, loss: 0.34626874327659607, time cost3.3214688301086426
epoch: 292, iter: 9943, loss: 0.8614147901535034, time cost3.2295384407043457
epoch: 292, iter: 9944, loss: 0.6752782464027405, time cost3.386481285095215
epoch: 292, iter: 9945, loss: 0.5440778136253357, time cost3.2963616847991943
epoch: 292, iter: 9946, loss: 0.7622551321983337, time cost3.0836539268493652
epoch: 292, iter: 9947, loss: 0.8254581689834595, time cost3.2014262676239014
epoch: 292, iter: 9948, loss: 0.5888355374336243, time cost3.4561641216278076
epoch: 292, iter: 9949, loss: 0.5626510977745056, time cost3.5282723903656006
epoch: 292, iter: 9950, loss: 0.48687002062797546, time cost3.513343095779419
tensor([[ 29.,  20.,  28.,  ...,   4.,   4.,   3.],
        [ 25.,  25.,  21.,  ...,  15.,  15.,   7.],
        [ 78., 214.,  76.,  ...,   1.,   1.,   1.],
        ...,
        [ 51.,  54.,  30.,  ...,  13.,  13.,   5.],
        [ 16.,  20.,   9.,  ...,   1.,   1.,   1.],
        [ 74., 159., 121.,  ...,   2.,   2.,   7.]])
Epoch: 292, Iteration: 9950:
TEST A@1: 0.5333333333333333
TEST A@5: 0.8711111111111111
TEST A@10: 0.9377777777777778
TEST M@B: 0.42620803525456835
TEST M@A: 0.9594209363728702
TEST W@MB: 0.23055264428842667
TEST W@MA: 0.5938344785042993
TEST Time: 103.54051661491394
REAL performance: Top1: 0.5933333333333334, Top5: 0.9, Top10: 0.96, MB: 0.45480400081024613, MA: 0.962217132343822, WMB: 0.24563148898567516, WMA: 0.5957424736733955
epoch: 292, iter: 9951, loss: 0.5167946815490723, time cost3.106956720352173
epoch: 292, iter: 9952, loss: 0.8699347972869873, time cost3.0504629611968994
epoch: 292, iter: 9953, loss: 0.6156030893325806, time cost3.023512840270996
epoch: 292, iter: 9954, loss: 0.7369779348373413, time cost3.2333133220672607
epoch: 292, iter: 9955, loss: 0.4282902777194977, time cost3.122372627258301
epoch: 292, iter: 9956, loss: 0.8623895049095154, time cost3.3071839809417725
epoch: 292, iter: 9957, loss: 0.3892472982406616, time cost3.2274889945983887
epoch: 292, iter: 9958, loss: 0.6148926615715027, time cost3.621065139770508
epoch: 292, iter: 9959, loss: 0.8318303823471069, time cost3.466303825378418
epoch: 292, iter: 9960, loss: 0.2361578345298767, time cost3.1270031929016113
epoch: 292, iter: 9961, loss: 1.0527325868606567, time cost3.1544907093048096
epoch: 292, iter: 9962, loss: 0.7103980779647827, time cost2.200200080871582
epoch: 293, iter: 9963, loss: 0.461010217666626, time cost3.312427520751953
epoch: 293, iter: 9964, loss: 0.9824573993682861, time cost3.1655404567718506
epoch: 293, iter: 9965, loss: 0.8244119882583618, time cost3.1368215084075928
epoch: 293, iter: 9966, loss: 0.8102906346321106, time cost3.147005081176758
epoch: 293, iter: 9967, loss: 0.7447282075881958, time cost3.216087818145752
epoch: 293, iter: 9968, loss: 0.6401805281639099, time cost3.2582688331604004
epoch: 293, iter: 9969, loss: 0.44564318656921387, time cost3.197521686553955
epoch: 293, iter: 9970, loss: 0.45426931977272034, time cost3.405891180038452
epoch: 293, iter: 9971, loss: 1.0291377305984497, time cost3.1254615783691406
epoch: 293, iter: 9972, loss: 0.818580150604248, time cost3.2480063438415527
epoch: 293, iter: 9973, loss: 0.5526105165481567, time cost3.3852930068969727
epoch: 293, iter: 9974, loss: 0.47057482600212097, time cost3.1667230129241943
epoch: 293, iter: 9975, loss: 0.29540425539016724, time cost3.1710877418518066
epoch: 293, iter: 9976, loss: 0.37123027443885803, time cost3.3725342750549316
epoch: 293, iter: 9977, loss: 0.49855995178222656, time cost3.3659520149230957
epoch: 293, iter: 9978, loss: 0.7740678787231445, time cost3.1230547428131104
epoch: 293, iter: 9979, loss: 0.606683075428009, time cost3.282231092453003
epoch: 293, iter: 9980, loss: 0.9954954981803894, time cost3.2490322589874268
epoch: 293, iter: 9981, loss: 0.7677230834960938, time cost3.1291284561157227
epoch: 293, iter: 9982, loss: 0.7771742343902588, time cost3.198056221008301
epoch: 293, iter: 9983, loss: 0.5129325985908508, time cost3.327268600463867
epoch: 293, iter: 9984, loss: 0.6235424280166626, time cost3.2974205017089844
epoch: 293, iter: 9985, loss: 0.8588413000106812, time cost3.2078235149383545
epoch: 293, iter: 9986, loss: 0.6947858929634094, time cost3.266055107116699
epoch: 293, iter: 9987, loss: 0.5970562696456909, time cost3.3311405181884766
epoch: 293, iter: 9988, loss: 0.40630075335502625, time cost3.147737503051758
epoch: 293, iter: 9989, loss: 0.3549080193042755, time cost3.170604705810547
epoch: 293, iter: 9990, loss: 0.904268741607666, time cost3.5613343715667725
epoch: 293, iter: 9991, loss: 1.2991628646850586, time cost3.282574415206909
epoch: 293, iter: 9992, loss: 0.4489201307296753, time cost3.22275710105896
epoch: 293, iter: 9993, loss: 0.748765230178833, time cost3.0468626022338867
epoch: 293, iter: 9994, loss: 0.513134241104126, time cost3.099877119064331
epoch: 293, iter: 9995, loss: 0.520345151424408, time cost3.0631918907165527
epoch: 293, iter: 9996, loss: 0.49295419454574585, time cost2.3093655109405518
epoch: 294, iter: 9997, loss: 0.3661712110042572, time cost3.2576346397399902
epoch: 294, iter: 9998, loss: 0.345992773771286, time cost3.4172205924987793
epoch: 294, iter: 9999, loss: 0.35742878913879395, time cost3.460057497024536
epoch: 294, iter: 10000, loss: 0.6235866546630859, time cost3.3478565216064453
tensor([[ 55.,  44.,  65.,  ...,  11.,  11.,   9.],
        [ 11.,  13.,  12.,  ...,  11.,  11.,   4.],
        [ 50., 171.,  69.,  ...,   1.,   1.,   1.],
        ...,
        [109., 109.,  68.,  ...,  13.,  13.,  12.],
        [  8.,  12.,   3.,  ...,   1.,   1.,   1.],
        [154., 202., 199.,  ...,   1.,   1.,   4.]])
Epoch: 294, Iteration: 10000:
TEST A@1: 0.5488888888888889
TEST A@5: 0.8866666666666667
TEST A@10: 0.96
TEST M@B: 0.4467015881382434
TEST M@A: 0.9617724050822417
TEST W@MB: 0.24212070200320251
TEST W@MA: 0.5955183062058566
TEST Time: 98.0152997970581
REAL performance: Top1: 0.5933333333333334, Top5: 0.9, Top10: 0.96, MB: 0.45480400081024613, MA: 0.962217132343822, WMB: 0.24563148898567516, WMA: 0.5957424736733955
epoch: 294, iter: 10001, loss: 0.42729830741882324, time cost3.141589879989624
epoch: 294, iter: 10002, loss: 0.3598830997943878, time cost3.411144733428955
epoch: 294, iter: 10003, loss: 0.5753902196884155, time cost3.181561231613159
epoch: 294, iter: 10004, loss: 0.3014231324195862, time cost3.1686465740203857
epoch: 294, iter: 10005, loss: 0.4087894558906555, time cost3.2414345741271973
epoch: 294, iter: 10006, loss: 0.3560243546962738, time cost3.2096924781799316
epoch: 294, iter: 10007, loss: 0.4926639795303345, time cost3.2176353931427
epoch: 294, iter: 10008, loss: 0.8315112590789795, time cost3.184596061706543
epoch: 294, iter: 10009, loss: 0.35072219371795654, time cost3.4780983924865723
epoch: 294, iter: 10010, loss: 0.43557578325271606, time cost3.1157195568084717
epoch: 294, iter: 10011, loss: 0.5777045488357544, time cost3.241098642349243
epoch: 294, iter: 10012, loss: 0.5772660970687866, time cost3.289085626602173
epoch: 294, iter: 10013, loss: 0.4403795003890991, time cost3.2684690952301025
epoch: 294, iter: 10014, loss: 0.5922431349754333, time cost3.176969289779663
epoch: 294, iter: 10015, loss: 0.39504003524780273, time cost3.234794855117798
epoch: 294, iter: 10016, loss: 0.4562276303768158, time cost3.3415303230285645
epoch: 294, iter: 10017, loss: 0.7412024736404419, time cost3.2583141326904297
epoch: 294, iter: 10018, loss: 0.6210777163505554, time cost3.223548173904419
epoch: 294, iter: 10019, loss: 0.5573846697807312, time cost3.32063364982605
epoch: 294, iter: 10020, loss: 0.9753249287605286, time cost3.7308578491210938
epoch: 294, iter: 10021, loss: 0.3958187401294708, time cost3.315964937210083
epoch: 294, iter: 10022, loss: 0.5029186010360718, time cost3.1259191036224365
epoch: 294, iter: 10023, loss: 0.8588476777076721, time cost3.213526964187622
epoch: 294, iter: 10024, loss: 0.6608827114105225, time cost3.0630276203155518
epoch: 294, iter: 10025, loss: 0.9852437376976013, time cost3.208322286605835
epoch: 294, iter: 10026, loss: 0.5240715146064758, time cost3.048107147216797
epoch: 294, iter: 10027, loss: 0.7157233953475952, time cost3.1146891117095947
epoch: 294, iter: 10028, loss: 0.5645026564598083, time cost3.180502414703369
epoch: 294, iter: 10029, loss: 0.7631824612617493, time cost3.166132926940918
epoch: 294, iter: 10030, loss: 0.8722593784332275, time cost2.300557851791382
epoch: 295, iter: 10031, loss: 0.8184490203857422, time cost3.396688222885132
epoch: 295, iter: 10032, loss: 0.5983902812004089, time cost3.2168195247650146
epoch: 295, iter: 10033, loss: 0.42532166838645935, time cost3.3820581436157227
epoch: 295, iter: 10034, loss: 0.5956242084503174, time cost3.1942849159240723
epoch: 295, iter: 10035, loss: 0.481147438287735, time cost3.2623884677886963
epoch: 295, iter: 10036, loss: 0.7636897563934326, time cost3.227431297302246
epoch: 295, iter: 10037, loss: 0.9015542268753052, time cost3.2468085289001465
epoch: 295, iter: 10038, loss: 0.5770772099494934, time cost3.2238893508911133
epoch: 295, iter: 10039, loss: 0.7610489726066589, time cost3.615649938583374
epoch: 295, iter: 10040, loss: 0.8713873624801636, time cost3.3597638607025146
epoch: 295, iter: 10041, loss: 0.30127793550491333, time cost3.190106153488159
epoch: 295, iter: 10042, loss: 0.8688439726829529, time cost3.2440688610076904
epoch: 295, iter: 10043, loss: 1.1146249771118164, time cost3.3846893310546875
epoch: 295, iter: 10044, loss: 1.0240925550460815, time cost2.9106709957122803
epoch: 295, iter: 10045, loss: 0.815049946308136, time cost2.8135557174682617
epoch: 295, iter: 10046, loss: 0.29901471734046936, time cost4.191610336303711
epoch: 295, iter: 10047, loss: 0.5493056178092957, time cost3.8704159259796143
epoch: 295, iter: 10048, loss: 0.736218273639679, time cost3.120128631591797
epoch: 295, iter: 10049, loss: 1.1543216705322266, time cost3.1179661750793457
epoch: 295, iter: 10050, loss: 0.5721385478973389, time cost3.1232447624206543
tensor([[ 14.,  14.,  15.,  ...,  16.,  16.,  12.],
        [ 36.,  41.,  35.,  ...,  18.,  18.,  11.],
        [164., 353., 152.,  ...,   2.,   2.,   1.],
        ...,
        [ 52.,  49.,  26.,  ...,  22.,  22.,  12.],
        [ 85.,  84.,  29.,  ...,   1.,   1.,   1.],
        [ 17.,  47.,  36.,  ...,   1.,   1.,   6.]])
Epoch: 295, Iteration: 10050:
TEST A@1: 0.46
TEST A@5: 0.8333333333333334
TEST A@10: 0.9244444444444444
TEST M@B: 0.3942405067642264
TEST M@A: 0.9550300852464186
TEST W@MB: 0.2127692763988793
TEST W@MA: 0.5901151941414764
TEST Time: 109.00440502166748
REAL performance: Top1: 0.5933333333333334, Top5: 0.9, Top10: 0.96, MB: 0.45480400081024613, MA: 0.962217132343822, WMB: 0.24563148898567516, WMA: 0.5957424736733955
epoch: 295, iter: 10051, loss: 0.7273839712142944, time cost3.134707450866699
epoch: 295, iter: 10052, loss: 0.45490238070487976, time cost3.234914541244507
epoch: 295, iter: 10053, loss: 0.6003639698028564, time cost3.184960126876831
epoch: 295, iter: 10054, loss: 0.5819330215454102, time cost3.172919511795044
epoch: 295, iter: 10055, loss: 0.4542599320411682, time cost3.336071491241455
epoch: 295, iter: 10056, loss: 0.4057208001613617, time cost3.283618211746216
epoch: 295, iter: 10057, loss: 0.692367434501648, time cost3.309046745300293
epoch: 295, iter: 10058, loss: 0.6617107391357422, time cost3.200104236602783
epoch: 295, iter: 10059, loss: 0.7778018712997437, time cost3.3389768600463867
epoch: 295, iter: 10060, loss: 0.6391103267669678, time cost3.2272658348083496
epoch: 295, iter: 10061, loss: 0.7609360218048096, time cost3.243342638015747
epoch: 295, iter: 10062, loss: 0.9072849750518799, time cost3.363806962966919
epoch: 295, iter: 10063, loss: 0.336367130279541, time cost3.282284736633301
epoch: 295, iter: 10064, loss: 0.24764731526374817, time cost2.215852737426758
epoch: 296, iter: 10065, loss: 0.4875059723854065, time cost3.448023557662964
epoch: 296, iter: 10066, loss: 0.5229957699775696, time cost3.2981765270233154
epoch: 296, iter: 10067, loss: 1.4618479013442993, time cost3.18108868598938
epoch: 296, iter: 10068, loss: 0.8559197187423706, time cost3.2135446071624756
epoch: 296, iter: 10069, loss: 0.7698863744735718, time cost3.3219170570373535
epoch: 296, iter: 10070, loss: 0.4485805034637451, time cost3.403012275695801
epoch: 296, iter: 10071, loss: 0.7717722058296204, time cost3.323383092880249
epoch: 296, iter: 10072, loss: 0.917532742023468, time cost3.2649340629577637
epoch: 296, iter: 10073, loss: 0.4884324073791504, time cost3.428802251815796
epoch: 296, iter: 10074, loss: 0.5679988861083984, time cost3.2098443508148193
epoch: 296, iter: 10075, loss: 0.6924412250518799, time cost3.424142360687256
epoch: 296, iter: 10076, loss: 0.7966053485870361, time cost3.2279789447784424
epoch: 296, iter: 10077, loss: 0.9463465809822083, time cost3.200468063354492
epoch: 296, iter: 10078, loss: 0.3955056667327881, time cost3.172694206237793
epoch: 296, iter: 10079, loss: 0.6771042346954346, time cost3.2505438327789307
epoch: 296, iter: 10080, loss: 0.27870070934295654, time cost3.185849189758301
epoch: 296, iter: 10081, loss: 0.6762514710426331, time cost3.6515724658966064
epoch: 296, iter: 10082, loss: 0.3473626673221588, time cost3.3380231857299805
epoch: 296, iter: 10083, loss: 0.22112397849559784, time cost3.2644684314727783
epoch: 296, iter: 10084, loss: 0.9662589430809021, time cost3.2938830852508545
epoch: 296, iter: 10085, loss: 0.4794404208660126, time cost3.214967966079712
epoch: 296, iter: 10086, loss: 0.5431974530220032, time cost3.569751262664795
epoch: 296, iter: 10087, loss: 0.8326041102409363, time cost3.2132740020751953
epoch: 296, iter: 10088, loss: 0.5979393720626831, time cost3.165809154510498
epoch: 296, iter: 10089, loss: 0.5029293894767761, time cost3.222381830215454
epoch: 296, iter: 10090, loss: 0.5134368538856506, time cost3.063892126083374
epoch: 296, iter: 10091, loss: 0.8612611889839172, time cost3.2649593353271484
epoch: 296, iter: 10092, loss: 0.7173278331756592, time cost3.3473281860351562
epoch: 296, iter: 10093, loss: 0.5167213678359985, time cost3.228722095489502
epoch: 296, iter: 10094, loss: 0.5710105299949646, time cost3.1267035007476807
epoch: 296, iter: 10095, loss: 0.46534818410873413, time cost3.0507590770721436
epoch: 296, iter: 10096, loss: 0.775535523891449, time cost3.231297254562378
epoch: 296, iter: 10097, loss: 0.665550947189331, time cost3.1070687770843506
epoch: 296, iter: 10098, loss: 0.8503722548484802, time cost2.312568187713623
epoch: 297, iter: 10099, loss: 0.8039689660072327, time cost3.304514169692993
epoch: 297, iter: 10100, loss: 1.2198140621185303, time cost3.4104464054107666
tensor([[ 60.,  50.,  47.,  ...,   2.,   2.,   2.],
        [  6.,   7.,   6.,  ...,   9.,   9.,   6.],
        [ 69., 179.,  85.,  ...,   2.,   2.,   1.],
        ...,
        [ 51.,  46.,  35.,  ...,  16.,  16.,   7.],
        [ 25.,  32.,   8.,  ...,   1.,   1.,   1.],
        [ 24.,  47.,  71.,  ...,   1.,   1.,   2.]])
Epoch: 297, Iteration: 10100:
TEST A@1: 0.5422222222222223
TEST A@5: 0.8755555555555555
TEST A@10: 0.96
TEST M@B: 0.42973267848398544
TEST M@A: 0.9595334263222647
TEST W@MB: 0.2314685302816066
TEST W@MA: 0.5936858434139837
TEST Time: 101.23011136054993
REAL performance: Top1: 0.5933333333333334, Top5: 0.9, Top10: 0.96, MB: 0.45480400081024613, MA: 0.962217132343822, WMB: 0.24563148898567516, WMA: 0.5957424736733955
epoch: 297, iter: 10101, loss: 0.511061429977417, time cost3.1877498626708984
epoch: 297, iter: 10102, loss: 1.030145525932312, time cost3.1155083179473877
epoch: 297, iter: 10103, loss: 0.6093766689300537, time cost3.2143797874450684
epoch: 297, iter: 10104, loss: 0.4885910749435425, time cost3.1513521671295166
epoch: 297, iter: 10105, loss: 0.5897969007492065, time cost3.119781255722046
epoch: 297, iter: 10106, loss: 0.7269759774208069, time cost3.492097854614258
epoch: 297, iter: 10107, loss: 0.39227280020713806, time cost3.3176207542419434
epoch: 297, iter: 10108, loss: 0.4990180432796478, time cost3.2904350757598877
epoch: 297, iter: 10109, loss: 0.4800509214401245, time cost3.419227123260498
epoch: 297, iter: 10110, loss: 1.0393744707107544, time cost3.2996203899383545
epoch: 297, iter: 10111, loss: 0.530187726020813, time cost3.3813791275024414
epoch: 297, iter: 10112, loss: 0.6274898648262024, time cost3.3137025833129883
epoch: 297, iter: 10113, loss: 0.7909870743751526, time cost3.2328500747680664
epoch: 297, iter: 10114, loss: 0.6167821288108826, time cost3.2975428104400635
epoch: 297, iter: 10115, loss: 0.3938746452331543, time cost3.2756612300872803
epoch: 297, iter: 10116, loss: 0.6969642639160156, time cost3.158360481262207
epoch: 297, iter: 10117, loss: 0.5904412269592285, time cost3.217393159866333
epoch: 297, iter: 10118, loss: 0.4995571970939636, time cost3.2657437324523926
epoch: 297, iter: 10119, loss: 0.45486313104629517, time cost3.183180093765259
epoch: 297, iter: 10120, loss: 1.4733885526657104, time cost3.236423969268799
epoch: 297, iter: 10121, loss: 0.9758205413818359, time cost3.289332389831543
epoch: 297, iter: 10122, loss: 0.6702982783317566, time cost3.2108380794525146
epoch: 297, iter: 10123, loss: 0.712045431137085, time cost3.3923072814941406
epoch: 297, iter: 10124, loss: 1.0442274808883667, time cost3.164778709411621
epoch: 297, iter: 10125, loss: 0.7519810795783997, time cost3.261711597442627
epoch: 297, iter: 10126, loss: 0.44968438148498535, time cost3.228818893432617
epoch: 297, iter: 10127, loss: 0.5044494271278381, time cost3.2063820362091064
epoch: 297, iter: 10128, loss: 0.7849941849708557, time cost3.233579158782959
epoch: 297, iter: 10129, loss: 0.9466779828071594, time cost3.1502275466918945
epoch: 297, iter: 10130, loss: 0.874130368232727, time cost3.2129714488983154
epoch: 297, iter: 10131, loss: 0.6360805034637451, time cost3.1069955825805664
epoch: 297, iter: 10132, loss: 0.33423301577568054, time cost2.363821268081665
epoch: 298, iter: 10133, loss: 0.5586369633674622, time cost3.3258771896362305
epoch: 298, iter: 10134, loss: 0.5444070100784302, time cost3.394233465194702
epoch: 298, iter: 10135, loss: 0.9010859131813049, time cost3.3438150882720947
epoch: 298, iter: 10136, loss: 0.6444063186645508, time cost3.240601062774658
epoch: 298, iter: 10137, loss: 0.5677784085273743, time cost3.399695634841919
epoch: 298, iter: 10138, loss: 0.3404424488544464, time cost3.4682118892669678
epoch: 298, iter: 10139, loss: 0.648093581199646, time cost3.3546206951141357
epoch: 298, iter: 10140, loss: 0.7464766502380371, time cost3.4153711795806885
epoch: 298, iter: 10141, loss: 0.7667591571807861, time cost3.2113475799560547
epoch: 298, iter: 10142, loss: 0.9968291521072388, time cost3.390378713607788
epoch: 298, iter: 10143, loss: 0.742262065410614, time cost3.231130599975586
epoch: 298, iter: 10144, loss: 0.707264244556427, time cost3.176307439804077
epoch: 298, iter: 10145, loss: 0.4274677634239197, time cost3.14917254447937
epoch: 298, iter: 10146, loss: 0.5152990818023682, time cost3.3707878589630127
epoch: 298, iter: 10147, loss: 0.2830176055431366, time cost3.3197667598724365
epoch: 298, iter: 10148, loss: 0.5199616551399231, time cost3.450922966003418
epoch: 298, iter: 10149, loss: 0.6930183172225952, time cost3.30159068107605
epoch: 298, iter: 10150, loss: 0.8350069522857666, time cost3.5411927700042725
tensor([[ 42.,  39.,  41.,  ...,  17.,  17.,  12.],
        [ 16.,  19.,  18.,  ...,   6.,   6.,   5.],
        [ 94., 303., 189.,  ...,   1.,   1.,   1.],
        ...,
        [ 52.,  50.,  36.,  ...,  19.,  19.,  12.],
        [ 42.,  60.,  13.,  ...,   1.,   1.,   1.],
        [ 14.,  61.,  46.,  ...,   2.,   2.,   4.]])
Epoch: 298, Iteration: 10150:
TEST A@1: 0.5244444444444445
TEST A@5: 0.8311111111111111
TEST A@10: 0.9222222222222223
TEST M@B: 0.4180604716924623
TEST M@A: 0.9555319411790384
TEST W@MB: 0.2252301812679728
TEST W@MA: 0.5904143552881889
TEST Time: 99.43243885040283
REAL performance: Top1: 0.5933333333333334, Top5: 0.9, Top10: 0.96, MB: 0.45480400081024613, MA: 0.962217132343822, WMB: 0.24563148898567516, WMA: 0.5957424736733955
epoch: 298, iter: 10151, loss: 0.5693485736846924, time cost3.0950722694396973
epoch: 298, iter: 10152, loss: 0.5921652317047119, time cost3.010923385620117
epoch: 298, iter: 10153, loss: 1.0545237064361572, time cost3.1543307304382324
epoch: 298, iter: 10154, loss: 0.44686657190322876, time cost3.1378588676452637
epoch: 298, iter: 10155, loss: 0.9329395294189453, time cost3.3847239017486572
epoch: 298, iter: 10156, loss: 0.39720577001571655, time cost3.2547366619110107
epoch: 298, iter: 10157, loss: 0.4906930923461914, time cost3.335371971130371
epoch: 298, iter: 10158, loss: 0.5962479710578918, time cost3.33060884475708
epoch: 298, iter: 10159, loss: 0.6241775155067444, time cost3.2498867511749268
epoch: 298, iter: 10160, loss: 0.6230414509773254, time cost3.2027831077575684
epoch: 298, iter: 10161, loss: 0.444472998380661, time cost3.0801663398742676
epoch: 298, iter: 10162, loss: 0.6551772952079773, time cost3.1498849391937256
epoch: 298, iter: 10163, loss: 1.194751262664795, time cost3.1707046031951904
epoch: 298, iter: 10164, loss: 0.49343398213386536, time cost3.082685708999634
epoch: 298, iter: 10165, loss: 0.46620801091194153, time cost3.184030294418335
epoch: 298, iter: 10166, loss: 0.466918021440506, time cost2.26457142829895
epoch: 299, iter: 10167, loss: 0.41868335008621216, time cost3.443129539489746
epoch: 299, iter: 10168, loss: 0.5157520771026611, time cost3.398163318634033
epoch: 299, iter: 10169, loss: 0.5481623411178589, time cost3.3225317001342773
epoch: 299, iter: 10170, loss: 0.49346283078193665, time cost3.2420103549957275
epoch: 299, iter: 10171, loss: 0.76554936170578, time cost3.3222734928131104
epoch: 299, iter: 10172, loss: 0.680821418762207, time cost3.585301637649536
epoch: 299, iter: 10173, loss: 0.5418861508369446, time cost3.2238223552703857
epoch: 299, iter: 10174, loss: 0.7944647669792175, time cost3.285752296447754
epoch: 299, iter: 10175, loss: 0.47550687193870544, time cost3.428075075149536
epoch: 299, iter: 10176, loss: 0.5279331803321838, time cost3.4504663944244385
epoch: 299, iter: 10177, loss: 0.5403059124946594, time cost3.525319814682007
epoch: 299, iter: 10178, loss: 0.40744200348854065, time cost3.3136484622955322
epoch: 299, iter: 10179, loss: 0.7047150135040283, time cost3.3582491874694824
epoch: 299, iter: 10180, loss: 0.5822505950927734, time cost3.344204902648926
epoch: 299, iter: 10181, loss: 0.3759090304374695, time cost3.3695261478424072
epoch: 299, iter: 10182, loss: 0.6392887234687805, time cost3.2716310024261475
epoch: 299, iter: 10183, loss: 0.5528907179832458, time cost3.332641363143921
epoch: 299, iter: 10184, loss: 0.8376966714859009, time cost3.3583269119262695
epoch: 299, iter: 10185, loss: 0.3855392336845398, time cost3.2630882263183594
epoch: 299, iter: 10186, loss: 0.7148914933204651, time cost3.2719123363494873
epoch: 299, iter: 10187, loss: 0.9305103421211243, time cost3.3352739810943604
epoch: 299, iter: 10188, loss: 0.5887644290924072, time cost3.2212839126586914
epoch: 299, iter: 10189, loss: 0.9779897928237915, time cost3.3346288204193115
epoch: 299, iter: 10190, loss: 0.32973921298980713, time cost3.3461806774139404
epoch: 299, iter: 10191, loss: 0.5746707916259766, time cost3.1981005668640137
epoch: 299, iter: 10192, loss: 0.6348745822906494, time cost3.207014799118042
epoch: 299, iter: 10193, loss: 0.6184088587760925, time cost3.3006696701049805
epoch: 299, iter: 10194, loss: 0.7033395171165466, time cost3.2594664096832275
epoch: 299, iter: 10195, loss: 0.7108822464942932, time cost3.2030088901519775
epoch: 299, iter: 10196, loss: 0.22830532491207123, time cost3.207170248031616
epoch: 299, iter: 10197, loss: 0.48193615674972534, time cost3.3259098529815674
epoch: 299, iter: 10198, loss: 0.5389764904975891, time cost3.314734697341919
epoch: 299, iter: 10199, loss: 1.017914891242981, time cost3.4001829624176025
epoch: 299, iter: 10200, loss: 0.4265003502368927, time cost2.2896389961242676
tensor([[ 34.,  29.,  34.,  ...,   8.,   8.,   5.],
        [ 11.,  10.,   9.,  ...,   9.,   9.,   3.],
        [ 47., 208.,  35.,  ...,   1.,   1.,   1.],
        ...,
        [ 89.,  82.,  60.,  ...,  17.,  17.,  11.],
        [ 12.,  18.,   6.,  ...,   1.,   1.,   1.],
        [ 29.,  68.,  58.,  ...,   2.,   2.,   3.]])
Epoch: 299, Iteration: 10200:
TEST A@1: 0.5466666666666666
TEST A@5: 0.88
TEST A@10: 0.9488888888888889
TEST M@B: 0.4289355939954151
TEST M@A: 0.9602087183547103
TEST W@MB: 0.23095916363742497
TEST W@MA: 0.5944049349894591
TEST Time: 97.52934503555298
REAL performance: Top1: 0.5933333333333334, Top5: 0.9, Top10: 0.96, MB: 0.45480400081024613, MA: 0.962217132343822, WMB: 0.24563148898567516, WMA: 0.5957424736733955
TOP1_MAX: 0.5933333333333334
TOP5_MAX: 0.9066666666666666
TOP10_MAX: 0.9688888888888889
meaIOU_MAX: 0.45480400081024613
meaMA_MAX: 0.9622973810603753
meanWMB_MAX: 0.24563148898567516
meanWMA_MAX: 0.5959421395965869
[0, 0.4177777777777778, 0.4177777777777778, 0.39111111111111113, 0.3288888888888889, 0.4066666666666667, 0.3844444444444444, 0.38222222222222224, 0.43555555555555553, 0.4888888888888889, 0.5155555555555555, 0.44222222222222224, 0.3288888888888889, 0.2733333333333333, 0.31555555555555553, 0.4488888888888889, 0.3933333333333333, 0.39555555555555555, 0.45555555555555555, 0.4488888888888889, 0.4955555555555556, 0.29777777777777775, 0.47555555555555556, 0.5422222222222223, 0.5244444444444445, 0.5, 0.5155555555555555, 0.5088888888888888, 0.4711111111111111, 0.5244444444444445, 0.5733333333333334, 0.5644444444444444, 0.43333333333333335, 0.39555555555555555, 0.49333333333333335, 0.46, 0.42, 0.5311111111111111, 0.5066666666666667, 0.5111111111111111, 0.4822222222222222, 0.5466666666666666, 0.48444444444444446, 0.4222222222222222, 0.4666666666666667, 0.4866666666666667, 0.5044444444444445, 0.5444444444444444, 0.5555555555555556, 0.5511111111111111, 0.45555555555555555, 0.40444444444444444, 0.58, 0.4666666666666667, 0.45111111111111113, 0.5311111111111111, 0.47555555555555556, 0.5155555555555555, 0.4533333333333333, 0.4311111111111111, 0.44, 0.4955555555555556, 0.5644444444444444, 0.48, 0.5333333333333333, 0.5177777777777778, 0.5244444444444445, 0.5155555555555555, 0.5266666666666666, 0.49777777777777776, 0.5088888888888888, 0.45555555555555555, 0.5133333333333333, 0.5044444444444445, 0.5688888888888889, 0.56, 0.5266666666666666, 0.5044444444444445, 0.48444444444444446, 0.5488888888888889, 0.4666666666666667, 0.48444444444444446, 0.5311111111111111, 0.5066666666666667, 0.52, 0.44666666666666666, 0.5088888888888888, 0.5333333333333333, 0.5311111111111111, 0.4822222222222222, 0.4533333333333333, 0.5422222222222223, 0.5533333333333333, 0.54, 0.49777777777777776, 0.5288888888888889, 0.48444444444444446, 0.45111111111111113, 0.4866666666666667, 0.48, 0.5488888888888889, 0.47555555555555556, 0.5266666666666666, 0.5444444444444444, 0.4911111111111111, 0.56, 0.5555555555555556, 0.5355555555555556, 0.5266666666666666, 0.5422222222222223, 0.44666666666666666, 0.5355555555555556, 0.41333333333333333, 0.5444444444444444, 0.4311111111111111, 0.4, 0.41333333333333333, 0.5044444444444445, 0.5022222222222222, 0.5177777777777778, 0.4911111111111111, 0.5311111111111111, 0.5422222222222223, 0.44222222222222224, 0.5111111111111111, 0.5111111111111111, 0.5444444444444444, 0.5155555555555555, 0.46444444444444444, 0.47555555555555556, 0.5844444444444444, 0.5844444444444444, 0.5288888888888889, 0.5577777777777778, 0.5088888888888888, 0.56, 0.5244444444444445, 0.5711111111111111, 0.5311111111111111, 0.44666666666666666, 0.4533333333333333, 0.49777777777777776, 0.4288888888888889, 0.5333333333333333, 0.5244444444444445, 0.5222222222222223, 0.5022222222222222, 0.4577777777777778, 0.5444444444444444, 0.4866666666666667, 0.5622222222222222, 0.4888888888888889, 0.5533333333333333, 0.5488888888888889, 0.5288888888888889, 0.44, 0.4866666666666667, 0.5022222222222222, 0.5777777777777777, 0.4688888888888889, 0.5133333333333333, 0.5444444444444444, 0.48444444444444446, 0.5666666666666667, 0.5333333333333333, 0.54, 0.40444444444444444, 0.5444444444444444, 0.5644444444444444, 0.5333333333333333, 0.5266666666666666, 0.5177777777777778, 0.4777777777777778, 0.5266666666666666, 0.5066666666666667, 0.48, 0.5311111111111111, 0.4777777777777778, 0.43333333333333335, 0.5466666666666666, 0.5622222222222222, 0.4711111111111111, 0.5244444444444445, 0.5933333333333334, 0.5244444444444445, 0.5133333333333333, 0.5333333333333333, 0.5488888888888889, 0.46, 0.5422222222222223, 0.5244444444444445, 0.5466666666666666]
[0, 0.8133333333333334, 0.7555555555555555, 0.7533333333333333, 0.6866666666666666, 0.7755555555555556, 0.7666666666666667, 0.7644444444444445, 0.82, 0.8133333333333334, 0.8555555555555555, 0.8266666666666667, 0.6777777777777778, 0.6377777777777778, 0.68, 0.7755555555555556, 0.7711111111111111, 0.7688888888888888, 0.8311111111111111, 0.8644444444444445, 0.8444444444444444, 0.5755555555555556, 0.7955555555555556, 0.8511111111111112, 0.84, 0.8755555555555555, 0.8688888888888889, 0.8622222222222222, 0.8066666666666666, 0.8688888888888889, 0.8688888888888889, 0.8844444444444445, 0.8044444444444444, 0.7733333333333333, 0.8177777777777778, 0.8288888888888889, 0.7688888888888888, 0.8888888888888888, 0.8266666666666667, 0.8444444444444444, 0.8311111111111111, 0.8711111111111111, 0.8488888888888889, 0.8222222222222222, 0.8377777777777777, 0.8555555555555555, 0.8422222222222222, 0.8888888888888888, 0.9022222222222223, 0.8644444444444445, 0.8555555555555555, 0.7688888888888888, 0.8911111111111111, 0.8311111111111111, 0.8177777777777778, 0.88, 0.7911111111111111, 0.8355555555555556, 0.7933333333333333, 0.7911111111111111, 0.7844444444444445, 0.8577777777777778, 0.8888888888888888, 0.8244444444444444, 0.8488888888888889, 0.8666666666666667, 0.8866666666666667, 0.8822222222222222, 0.8733333333333333, 0.8288888888888889, 0.8466666666666667, 0.8288888888888889, 0.8444444444444444, 0.8577777777777778, 0.8933333333333333, 0.8955555555555555, 0.8466666666666667, 0.8533333333333334, 0.8533333333333334, 0.8733333333333333, 0.8355555555555556, 0.8622222222222222, 0.8688888888888889, 0.8355555555555556, 0.8711111111111111, 0.8022222222222222, 0.8288888888888889, 0.8711111111111111, 0.86, 0.82, 0.8266666666666667, 0.88, 0.8933333333333333, 0.8955555555555555, 0.8733333333333333, 0.8755555555555555, 0.8133333333333334, 0.8288888888888889, 0.84, 0.8311111111111111, 0.8911111111111111, 0.8177777777777778, 0.8577777777777778, 0.8577777777777778, 0.8311111111111111, 0.8755555555555555, 0.8755555555555555, 0.8844444444444445, 0.8511111111111112, 0.8844444444444445, 0.7733333333333333, 0.8711111111111111, 0.7311111111111112, 0.8911111111111111, 0.7933333333333333, 0.78, 0.7622222222222222, 0.8777777777777778, 0.8733333333333333, 0.86, 0.8377777777777777, 0.8644444444444445, 0.8622222222222222, 0.8177777777777778, 0.8644444444444445, 0.8244444444444444, 0.8622222222222222, 0.8466666666666667, 0.8511111111111112, 0.8333333333333334, 0.9022222222222223, 0.8777777777777778, 0.8777777777777778, 0.9, 0.8444444444444444, 0.88, 0.8733333333333333, 0.8933333333333333, 0.8822222222222222, 0.78, 0.8444444444444444, 0.8155555555555556, 0.7955555555555556, 0.84, 0.8466666666666667, 0.8333333333333334, 0.86, 0.8222222222222222, 0.8777777777777778, 0.8311111111111111, 0.8977777777777778, 0.8622222222222222, 0.8755555555555555, 0.88, 0.8933333333333333, 0.8266666666666667, 0.8444444444444444, 0.8444444444444444, 0.9066666666666666, 0.82, 0.8711111111111111, 0.8688888888888889, 0.84, 0.8977777777777778, 0.8933333333333333, 0.8911111111111111, 0.7977777777777778, 0.8911111111111111, 0.8688888888888889, 0.8844444444444445, 0.8444444444444444, 0.8933333333333333, 0.8466666666666667, 0.8644444444444445, 0.8511111111111112, 0.8377777777777777, 0.88, 0.8311111111111111, 0.7888888888888889, 0.8911111111111111, 0.9044444444444445, 0.8222222222222222, 0.8933333333333333, 0.9, 0.8622222222222222, 0.8688888888888889, 0.8711111111111111, 0.8866666666666667, 0.8333333333333334, 0.8755555555555555, 0.8311111111111111, 0.88]
[0, 0.9222222222222223, 0.8844444444444445, 0.8977777777777778, 0.8333333333333334, 0.8755555555555555, 0.9044444444444445, 0.9155555555555556, 0.9066666666666666, 0.9, 0.94, 0.9355555555555556, 0.8222222222222222, 0.78, 0.8333333333333334, 0.8888888888888888, 0.9, 0.8844444444444445, 0.9133333333333333, 0.9244444444444444, 0.9244444444444444, 0.7422222222222222, 0.9022222222222223, 0.9444444444444444, 0.9311111111111111, 0.94, 0.9466666666666667, 0.9444444444444444, 0.9177777777777778, 0.9422222222222222, 0.9444444444444444, 0.9511111111111111, 0.9022222222222223, 0.9, 0.9, 0.9222222222222223, 0.8688888888888889, 0.96, 0.9222222222222223, 0.9222222222222223, 0.9222222222222223, 0.96, 0.9377777777777778, 0.92, 0.9311111111111111, 0.94, 0.92, 0.9377777777777778, 0.9533333333333334, 0.9355555555555556, 0.9355555555555556, 0.8866666666666667, 0.9444444444444444, 0.9333333333333333, 0.9288888888888889, 0.9511111111111111, 0.8933333333333333, 0.94, 0.9, 0.9044444444444445, 0.8844444444444445, 0.9377777777777778, 0.9622222222222222, 0.9244444444444444, 0.9422222222222222, 0.9444444444444444, 0.9488888888888889, 0.9422222222222222, 0.9533333333333334, 0.9244444444444444, 0.9266666666666666, 0.9044444444444445, 0.9355555555555556, 0.9422222222222222, 0.9533333333333334, 0.9488888888888889, 0.9333333333333333, 0.9311111111111111, 0.94, 0.94, 0.9244444444444444, 0.9377777777777778, 0.94, 0.9377777777777778, 0.9377777777777778, 0.8955555555555555, 0.9177777777777778, 0.9466666666666667, 0.9488888888888889, 0.9266666666666666, 0.92, 0.9311111111111111, 0.9533333333333334, 0.96, 0.9511111111111111, 0.9533333333333334, 0.8844444444444445, 0.9288888888888889, 0.9111111111111111, 0.9177777777777778, 0.9577777777777777, 0.9244444444444444, 0.9311111111111111, 0.94, 0.9244444444444444, 0.9488888888888889, 0.9577777777777777, 0.9422222222222222, 0.9355555555555556, 0.9622222222222222, 0.8933333333333333, 0.9533333333333334, 0.8533333333333334, 0.9666666666666667, 0.8866666666666667, 0.8977777777777778, 0.8866666666666667, 0.9577777777777777, 0.9577777777777777, 0.9511111111111111, 0.9333333333333333, 0.9466666666666667, 0.9377777777777778, 0.9177777777777778, 0.9533333333333334, 0.94, 0.9466666666666667, 0.9266666666666666, 0.9422222222222222, 0.9333333333333333, 0.9688888888888889, 0.9555555555555556, 0.9533333333333334, 0.96, 0.9244444444444444, 0.9422222222222222, 0.9577777777777777, 0.9688888888888889, 0.9577777777777777, 0.9222222222222223, 0.9266666666666666, 0.9066666666666666, 0.8955555555555555, 0.9355555555555556, 0.94, 0.9266666666666666, 0.9511111111111111, 0.9244444444444444, 0.9511111111111111, 0.92, 0.9555555555555556, 0.9422222222222222, 0.9577777777777777, 0.9533333333333334, 0.9666666666666667, 0.9288888888888889, 0.9333333333333333, 0.94, 0.9644444444444444, 0.9133333333333333, 0.9533333333333334, 0.9488888888888889, 0.9266666666666666, 0.9555555555555556, 0.9488888888888889, 0.9622222222222222, 0.9022222222222223, 0.9555555555555556, 0.9444444444444444, 0.9488888888888889, 0.94, 0.9577777777777777, 0.9288888888888889, 0.9622222222222222, 0.9466666666666667, 0.9333333333333333, 0.9577777777777777, 0.9266666666666666, 0.8977777777777778, 0.96, 0.9622222222222222, 0.9244444444444444, 0.9622222222222222, 0.96, 0.9511111111111111, 0.94, 0.9377777777777778, 0.96, 0.9244444444444444, 0.96, 0.9222222222222223, 0.9488888888888889]
[0.33584219120098563, 0.3302263392509321, 0.3313787370101771, 0.28847078369058654, 0.34046531534187846, 0.31890013103372383, 0.3163681933106285, 0.35513993516042586, 0.3787341227600549, 0.39635164502169196, 0.37783591921792425, 0.2938584851849545, 0.2664628725845362, 0.27184940616745573, 0.3405188792883074, 0.3422066867523947, 0.3399846578470759, 0.3679891564174083, 0.3746600768261381, 0.37744819058374457, 0.2561263717064912, 0.37983659729502267, 0.4088912725782207, 0.39317803382777156, 0.39654411001189693, 0.3984455130342927, 0.39436993071600507, 0.3825193196028671, 0.40399443086719183, 0.41889331955170545, 0.4276979936701354, 0.3613756523286798, 0.3349189704090197, 0.37898876119818464, 0.36917175453579854, 0.34727450126898046, 0.4176446731336466, 0.3821637206309368, 0.39857497177394724, 0.37198440934823135, 0.4174930158190895, 0.3907289671746687, 0.35572642100231466, 0.38681715830372126, 0.3909701179266322, 0.3908478500447937, 0.4196559001129861, 0.42443186993838933, 0.42206784936580616, 0.3859961715793648, 0.3489662548630214, 0.42934739079043527, 0.3840425471882844, 0.37685731871497685, 0.41531805895011714, 0.37493532582302563, 0.40860672646727947, 0.3651301862008721, 0.35829224199191784, 0.35358972862079746, 0.3928690046171936, 0.43198339974073197, 0.37820835833476735, 0.39600917171180566, 0.41583172790041795, 0.41727669454658517, 0.4078711565298728, 0.4201184291630606, 0.3935667108957686, 0.40780392291661227, 0.36457137953067653, 0.400043971493938, 0.3953464493168205, 0.43783030635406034, 0.4344889853133596, 0.40411197392072695, 0.39675430863661604, 0.4034505686684258, 0.4111928766477399, 0.37469343322132115, 0.396449227327529, 0.41183189266781123, 0.40070096115351767, 0.4156754946984197, 0.3531269169652328, 0.40192069967754235, 0.4233926324873031, 0.41770170222060704, 0.38684761717916444, 0.385272640010839, 0.4072959119287325, 0.4397689329167464, 0.4271576021560053, 0.39806308656435685, 0.4273155677235872, 0.3900104688057723, 0.38743819496774756, 0.3850840635429864, 0.3944827282827671, 0.4234129149698797, 0.391737270913007, 0.41312730235527917, 0.42278840487657793, 0.39071230820383573, 0.41598181234136633, 0.42784919625787327, 0.4136250943037592, 0.41717690852872413, 0.42782966921018806, 0.3576235904596643, 0.41874602275500183, 0.3342557582969943, 0.43180574748280603, 0.3622559627997764, 0.35004748266488345, 0.34790761051435704, 0.4062899466546202, 0.40116336874711533, 0.4114721521234404, 0.4034930479117836, 0.39633651861188546, 0.4217534581159119, 0.3729788363752386, 0.4204220997606893, 0.4057815546844907, 0.4033190150509773, 0.3858451838211465, 0.39558720048278156, 0.3865385488055126, 0.4472062327948879, 0.437301549490233, 0.4260836991855266, 0.43450473827718394, 0.40371106528526113, 0.42714318473582263, 0.41828976589535594, 0.4435851192012607, 0.4325493775393855, 0.37365490599863554, 0.37778416342760984, 0.39487699269222803, 0.36702647164314645, 0.4123406793168568, 0.41692198663283647, 0.4124068730951698, 0.4143268416718517, 0.40020496740231554, 0.43097189307374834, 0.39487007613739705, 0.43201414994595927, 0.3909681375082199, 0.4251859810063907, 0.44180579127725245, 0.4363987643483482, 0.3798141592834869, 0.3961563786350789, 0.41131522938905074, 0.4472035710793393, 0.3761561558572426, 0.4289207774047281, 0.42278943028104726, 0.39863428315051785, 0.43554192323272733, 0.4298938870098511, 0.4396655880463229, 0.3648670036498528, 0.4315386492247373, 0.43942508693302706, 0.42350038698177095, 0.4077414729631077, 0.4214388937937821, 0.38218130572832215, 0.42216912865181483, 0.4088531384030198, 0.3804576766198816, 0.4339269800410423, 0.3952387427165895, 0.354077258926621, 0.43721459104254473, 0.4304648903604034, 0.3926575410713632, 0.42716146815137207, 0.45480400081024613, 0.4116177645936519, 0.4123146023814373, 0.42620803525456835, 0.4467015881382434, 0.3942405067642264, 0.42973267848398544, 0.4180604716924623, 0.4289355939954151]
[0.9318302404469633, 0.9332575398633064, 0.933289355980587, 0.9265811157133949, 0.932610034001762, 0.9369077675405758, 0.9323063605610976, 0.9388225693333865, 0.944456323647783, 0.9467796523219552, 0.9430807805218188, 0.9305150786285097, 0.9216715815435681, 0.9271066578908691, 0.9352372475788664, 0.9436365829224638, 0.9405874084979886, 0.9429451698008334, 0.946208294298655, 0.9414463894612317, 0.9268129536449791, 0.9435737977937558, 0.9496961862455373, 0.9490438725614093, 0.9495860299186353, 0.9491484432427716, 0.9493794328821749, 0.9493004568459186, 0.9536440067319568, 0.9550919508909924, 0.951107505573736, 0.9406581123993097, 0.9411687352202597, 0.9476838132447104, 0.9471403833361534, 0.9470819815919395, 0.9550461349320849, 0.9512348439544587, 0.9487451485966052, 0.943815817209478, 0.9553167890956595, 0.9499713654879569, 0.9503084109186062, 0.9459631638330895, 0.9474063003670632, 0.9490065408821647, 0.9518369572222795, 0.9570609118447654, 0.9566230434067325, 0.9540912088605589, 0.9494289965892195, 0.9556317751664845, 0.9514859128409464, 0.9495928170809316, 0.9545017860754289, 0.9450880622743807, 0.953126384050127, 0.9473565959518938, 0.9486422747911383, 0.944302825633599, 0.9478127767640935, 0.9579495887547023, 0.9466989791119796, 0.954300633520361, 0.9529091815012434, 0.9560629975857243, 0.9528168425672348, 0.9578366747373744, 0.9501686292669869, 0.9525782873241734, 0.949939619490123, 0.9549844102006523, 0.9536331185680992, 0.9562582815808969, 0.9548559412602334, 0.949203663198307, 0.954000778588688, 0.953352636294018, 0.9521120664994971, 0.9476075942851382, 0.953214480770811, 0.9538793096835799, 0.9561269143475664, 0.9552468630867227, 0.9500588972551511, 0.9540251007140984, 0.9561279039625818, 0.9561841134162369, 0.9511434235310419, 0.9525063112286911, 0.9520706339134495, 0.9601156014365011, 0.9582877654699637, 0.9545107654386998, 0.9571289998060315, 0.9518849656778638, 0.9537315381953403, 0.9509511090713804, 0.954158236377067, 0.957156644911254, 0.9541064809011444, 0.9535104474416815, 0.9560912794047405, 0.9509291200768055, 0.9532961436048046, 0.9577279322388035, 0.9567327756525151, 0.9561411255986564, 0.9584881399406328, 0.9505787825318615, 0.9590277518432824, 0.9467080295327016, 0.9588187513183211, 0.9525372085417844, 0.9511128794020707, 0.9501081065330359, 0.954702725977829, 0.9541322875750354, 0.9549845520106203, 0.9555974837672114, 0.9550734972886387, 0.9563303289289868, 0.9545759545458214, 0.9574588334218023, 0.9575667275957289, 0.9514953166415531, 0.9531111117645449, 0.955756143270223, 0.953520628859555, 0.9596503701437679, 0.9563364095604268, 0.9557552239766255, 0.9568889603272508, 0.9562292932977323, 0.9589916928478457, 0.9575079726061768, 0.9601704676849028, 0.9591314036468607, 0.9531229190474879, 0.9544902614188336, 0.9530889106958453, 0.9528196707246677, 0.9552487722707409, 0.9562651401139162, 0.9577576280316072, 0.9586088318319341, 0.9577573451115527, 0.9590200451563393, 0.9549619267094467, 0.9592870226994984, 0.9539512149636147, 0.9588351548931798, 0.9608336697923285, 0.9560439079841155, 0.9547971871945535, 0.9563579035557156, 0.9550857998669916, 0.9607348962825029, 0.952021282837401, 0.9595595159927414, 0.9564439505017585, 0.9562868462539617, 0.9603286325035114, 0.9595612123004856, 0.9622973810603753, 0.9550848100693926, 0.9599980209766636, 0.959259377590085, 0.9584870794421979, 0.9585513494207286, 0.9587509464279025, 0.952596458742129, 0.9595066292280007, 0.9579163580895844, 0.9538864503553255, 0.9593490303706319, 0.9545756716748094, 0.9492777609603389, 0.9603064308471623, 0.9574925590606909, 0.9537774957719125, 0.960084986725689, 0.962217132343822, 0.9572793867284994, 0.9577059435375804, 0.9594209363728702, 0.9617724050822417, 0.9550300852464186, 0.9595334263222647, 0.9555319411790384, 0.9602087183547103]
[0.17509713006629762, 0.1741228507505533, 0.17562980392242625, 0.15318916951611938, 0.18012451574135854, 0.16887351554149607, 0.16668950402862248, 0.18788490023595159, 0.20213599404508614, 0.21074742869268315, 0.20115055961898642, 0.15602319326714068, 0.14117288583551782, 0.14445502293397736, 0.17914261189700786, 0.18266308183930519, 0.1816743055540985, 0.19539247391122855, 0.19980868785200845, 0.19987392012124958, 0.1364283695905378, 0.20220567734244208, 0.21789938269746806, 0.20877738787236588, 0.21063328649370122, 0.21206027333218225, 0.20958124463119449, 0.20499741495393703, 0.2155858904967363, 0.22395836937023944, 0.22730486740086803, 0.19229862038808027, 0.17754197082211343, 0.20169484375023747, 0.1969683215297064, 0.18573000652302205, 0.22316320341017007, 0.20445901796908364, 0.21179197124980442, 0.19744019575731037, 0.22278568516252392, 0.2087384520043048, 0.19047638880316697, 0.20606186756078923, 0.20807431662194703, 0.20728818024854162, 0.22322936906709404, 0.22648803029836082, 0.22661911148294955, 0.20729454929822358, 0.18757264894462644, 0.22928976502037554, 0.20527786809192472, 0.20181924604618495, 0.22211124647507047, 0.1994858476202503, 0.21840285531118994, 0.1951609020904033, 0.19228316135170423, 0.1879974436396425, 0.21040872159805246, 0.23192154835215115, 0.20124476316248294, 0.21253245086366626, 0.22233126297124567, 0.22372291446076636, 0.21760241521664378, 0.22639895305407245, 0.21061361141593082, 0.2187956745207493, 0.1952775700255117, 0.21438786682490607, 0.2114520119443684, 0.2339932066988706, 0.23243577132138246, 0.21605865453584067, 0.21221958549909942, 0.216976917710967, 0.21844432982138234, 0.20034024004616516, 0.21212444600712316, 0.21987988387510402, 0.21485019404077416, 0.22308463408105791, 0.1882344430016568, 0.21648608513946677, 0.22688912341053732, 0.22396772038503773, 0.2077554067716521, 0.20696232718372112, 0.21711514924205852, 0.23669329359899205, 0.2290102545540007, 0.21324372204115286, 0.2301609085688579, 0.2093938362293124, 0.20757364486868116, 0.20661005687764625, 0.21286362120687488, 0.2269748127931249, 0.21030641766823926, 0.2218821773424601, 0.22661225389215972, 0.20920699040223262, 0.22234291899489209, 0.22937230249631524, 0.22188338256606022, 0.22417781036632106, 0.22968777701118365, 0.19203057567493434, 0.22472124318017078, 0.17953120465729783, 0.23182853222490737, 0.19456951122766497, 0.18820652328801774, 0.18663050898368536, 0.2170555618691926, 0.21433403079903796, 0.2205475520793247, 0.2160162293667707, 0.2119085522167492, 0.22693151814886167, 0.20052880593188302, 0.22612168849231556, 0.21822387930604598, 0.21512645545113956, 0.2057288241784711, 0.21220091127678442, 0.20732669642905163, 0.24074473162826146, 0.23446477854487865, 0.22847277408447036, 0.23324158949286222, 0.21774448022577755, 0.23111757073172287, 0.2250797824080966, 0.23947192583878296, 0.23221369064847489, 0.2007718978600528, 0.20189381780355675, 0.21332797379914198, 0.1971776360904066, 0.22128464768685413, 0.22408186192525703, 0.22237204019333554, 0.22366479845114826, 0.21766160152076855, 0.23221171375779262, 0.21283352511849649, 0.23207667849110994, 0.2086652041926948, 0.2287129807265888, 0.23875180700231402, 0.23481400672230265, 0.20446649412240842, 0.21388127949110086, 0.2214114914305812, 0.24095475156820909, 0.2018643921475629, 0.2319068771340525, 0.22769095175523302, 0.21507175840433534, 0.2343252423995211, 0.231903853240083, 0.23699816283120373, 0.19742554850822017, 0.23253906303820457, 0.2375875036995431, 0.22777004884432425, 0.22018262682890216, 0.22605702234476477, 0.20388836667090793, 0.22703450222919852, 0.2197222931538595, 0.20330770276158033, 0.23382150740391885, 0.21258265407045782, 0.18921777927356515, 0.2353728852449493, 0.23005620804642007, 0.21036841201333326, 0.22961992701883852, 0.24563148898567516, 0.22144782546883301, 0.22171132339854618, 0.23055264428842667, 0.24212070200320251, 0.2127692763988793, 0.2314685302816066, 0.2252301812679728, 0.23095916363742497]
[0.5706814819796171, 0.5721920462405804, 0.57227342865389, 0.5673193795202974, 0.572190798622208, 0.5753999186679585, 0.5717107774861478, 0.5769716361307105, 0.5817264444488689, 0.583053714710171, 0.5798462761355287, 0.5708671440307023, 0.564393853402851, 0.5685716857317986, 0.5738992015728737, 0.5807799035624646, 0.5786560645027148, 0.5800563958402265, 0.5826650278595834, 0.5785054098093823, 0.569291713785902, 0.5805573701705857, 0.5850553450687236, 0.5849246872715151, 0.5851127573411911, 0.5849257404299396, 0.5849831370792241, 0.5852144568144737, 0.5887272645379302, 0.589896074631377, 0.5861345991495678, 0.5781475022272919, 0.5791475537802899, 0.5841166352815303, 0.5837142919529471, 0.5841785855723889, 0.5898021095065005, 0.5872109947413793, 0.5848275676096466, 0.5805814653284953, 0.5900734015776541, 0.5857464463582351, 0.5861781307764199, 0.582324919483008, 0.583446951132407, 0.5848888153809179, 0.5870635335868681, 0.5915446097247018, 0.5910419149584292, 0.5890640680568215, 0.5858861028944221, 0.5902112898665206, 0.5868725370157628, 0.5854898390094824, 0.5893655663506779, 0.582312966655712, 0.5885366256957528, 0.5844116555682922, 0.5850248698855285, 0.5819708513836944, 0.5837757574638188, 0.5922370009626536, 0.5831494671717309, 0.58956579073562, 0.5880616761237104, 0.5907093484747346, 0.5881579973401181, 0.5922614977194285, 0.5860438553185262, 0.5879493229966738, 0.5864076142302795, 0.589951699841785, 0.5888429891800777, 0.5906805103165506, 0.5893219633532107, 0.5850014712178822, 0.5891603202655991, 0.5883175358012049, 0.5872510403932092, 0.5836776124559727, 0.588162753762561, 0.5889042149197204, 0.5909394303508063, 0.5901545385782091, 0.5862008230415502, 0.5894858361850288, 0.5907195668909228, 0.5907256944551461, 0.5870373928741887, 0.588112550897793, 0.5873863751918639, 0.5939621694253282, 0.5925011391070567, 0.5893969678932596, 0.5914753591188523, 0.5880445500730899, 0.589032729851887, 0.587128101443932, 0.5896324727087017, 0.5915755564712599, 0.5894069890171019, 0.5889290105157665, 0.5908006172228165, 0.5868242051773737, 0.5886222204474123, 0.5922424457770944, 0.5914391737425634, 0.5910139616812022, 0.5926159290462243, 0.5870753362566993, 0.5931720642834949, 0.584571298185355, 0.5929966831958499, 0.5886545155938581, 0.5872276094410739, 0.5867355283099739, 0.5896232031688817, 0.5890282743213169, 0.5897845961949701, 0.5905713826242905, 0.590038733742202, 0.5910016703374233, 0.5900112589586646, 0.5919983897227818, 0.5923464495573365, 0.5871919788734191, 0.5886888759492209, 0.590796199427053, 0.5889003392554628, 0.5936992482962913, 0.5909953455524952, 0.5904105864927698, 0.5913294523451568, 0.5911133394359585, 0.5931586725257995, 0.5919590451439576, 0.5940274133090856, 0.5933327389533501, 0.5888750928360261, 0.5897892147736178, 0.5888882729910162, 0.5889652849110322, 0.5904148175347212, 0.5911012645841152, 0.5925031586449975, 0.5929934818789279, 0.592442283538372, 0.5931129706482917, 0.5904127873689418, 0.5934915371142725, 0.5893323557363911, 0.5931020624205161, 0.5947392449352952, 0.590413800168067, 0.5900521424043036, 0.5913752454289273, 0.5901776929658938, 0.5945384247832751, 0.5881005274884072, 0.5937612438470129, 0.5911885190089747, 0.5914612883756851, 0.5942160554824218, 0.5936663094609426, 0.5959421395965869, 0.5903380827174786, 0.594194245552333, 0.59366609089633, 0.5929227547219327, 0.5931142478257279, 0.5929965372699558, 0.5881907635905683, 0.593701030679403, 0.5924874552984563, 0.5894896357784178, 0.5934294994420005, 0.589702808692501, 0.5861521395980442, 0.5942516365548258, 0.5919852206868479, 0.5895259201317409, 0.5941039325416305, 0.5957424736733955, 0.5918835747538782, 0.5922800248494278, 0.5938344785042993, 0.5955183062058566, 0.5901151941414764, 0.5936858434139837, 0.5904143552881889, 0.5944049349894591]
